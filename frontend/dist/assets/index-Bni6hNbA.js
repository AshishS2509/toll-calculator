var Iy=Object.defineProperty;var ky=(y,S,P)=>S in y?Iy(y,S,{enumerable:!0,configurable:!0,writable:!0,value:P}):y[S]=P;var op=(y,S,P)=>ky(y,typeof S!="symbol"?S+"":S,P);function Ly(y,S){for(var P=0;P<S.length;P++){const R=S[P];if(typeof R!="string"&&!Array.isArray(R)){for(const B in R)if(B!=="default"&&!(B in y)){const G=Object.getOwnPropertyDescriptor(R,B);G&&Object.defineProperty(y,B,G.get?G:{enumerable:!0,get:()=>R[B]})}}}return Object.freeze(Object.defineProperty(y,Symbol.toStringTag,{value:"Module"}))}(function(){const S=document.createElement("link").relList;if(S&&S.supports&&S.supports("modulepreload"))return;for(const B of document.querySelectorAll('link[rel="modulepreload"]'))R(B);new MutationObserver(B=>{for(const G of B)if(G.type==="childList")for(const z of G.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&R(z)}).observe(document,{childList:!0,subtree:!0});function P(B){const G={};return B.integrity&&(G.integrity=B.integrity),B.referrerPolicy&&(G.referrerPolicy=B.referrerPolicy),B.crossOrigin==="use-credentials"?G.credentials="include":B.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function R(B){if(B.ep)return;B.ep=!0;const G=P(B);fetch(B.href,G)}})();function By(y){return y&&y.__esModule&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y}var Gm={exports:{}},lp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function Oy(){if(Gg)return lp;Gg=1;var y=Symbol.for("react.transitional.element"),S=Symbol.for("react.fragment");function P(R,B,G){var z=null;if(G!==void 0&&(z=""+G),B.key!==void 0&&(z=""+B.key),"key"in B){G={};for(var u in B)u!=="key"&&(G[u]=B[u])}else G=B;return B=G.ref,{$$typeof:y,type:R,key:z,ref:B!==void 0?B:null,props:G}}return lp.Fragment=S,lp.jsx=P,lp.jsxs=P,lp}var $g;function Fy(){return $g||($g=1,Gm.exports=Oy()),Gm.exports}var Jt=Fy(),$m={exports:{}},yi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qg;function jy(){if(qg)return yi;qg=1;var y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),z=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),ce=Symbol.for("react.suspense"),ae=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),Ee=Symbol.iterator;function be(ve){return ve===null||typeof ve!="object"?null:(ve=Ee&&ve[Ee]||ve["@@iterator"],typeof ve=="function"?ve:null)}var oe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},we=Object.assign,ze={};function dt(ve,rt,At){this.props=ve,this.context=rt,this.refs=ze,this.updater=At||oe}dt.prototype.isReactComponent={},dt.prototype.setState=function(ve,rt){if(typeof ve!="object"&&typeof ve!="function"&&ve!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ve,rt,"setState")},dt.prototype.forceUpdate=function(ve){this.updater.enqueueForceUpdate(this,ve,"forceUpdate")};function gt(){}gt.prototype=dt.prototype;function St(ve,rt,At){this.props=ve,this.context=rt,this.refs=ze,this.updater=At||oe}var vt=St.prototype=new gt;vt.constructor=St,we(vt,dt.prototype),vt.isPureReactComponent=!0;var at=Array.isArray,Oe={H:null,A:null,T:null,S:null},ut=Object.prototype.hasOwnProperty;function yt(ve,rt,At,Lt,wt,Xt){return At=Xt.ref,{$$typeof:y,type:ve,key:rt,ref:At!==void 0?At:null,props:Xt}}function xt(ve,rt){return yt(ve.type,rt,void 0,void 0,void 0,ve.props)}function lt(ve){return typeof ve=="object"&&ve!==null&&ve.$$typeof===y}function Q(ve){var rt={"=":"=0",":":"=2"};return"$"+ve.replace(/[=:]/g,function(At){return rt[At]})}var st=/\/+/g;function Et(ve,rt){return typeof ve=="object"&&ve!==null&&ve.key!=null?Q(""+ve.key):rt.toString(36)}function Vt(){}function ei(ve){switch(ve.status){case"fulfilled":return ve.value;case"rejected":throw ve.reason;default:switch(typeof ve.status=="string"?ve.then(Vt,Vt):(ve.status="pending",ve.then(function(rt){ve.status==="pending"&&(ve.status="fulfilled",ve.value=rt)},function(rt){ve.status==="pending"&&(ve.status="rejected",ve.reason=rt)})),ve.status){case"fulfilled":return ve.value;case"rejected":throw ve.reason}}throw ve}function di(ve,rt,At,Lt,wt){var Xt=typeof ve;(Xt==="undefined"||Xt==="boolean")&&(ve=null);var Yt=!1;if(ve===null)Yt=!0;else switch(Xt){case"bigint":case"string":case"number":Yt=!0;break;case"object":switch(ve.$$typeof){case y:case S:Yt=!0;break;case Ce:return Yt=ve._init,di(Yt(ve._payload),rt,At,Lt,wt)}}if(Yt)return wt=wt(ve),Yt=Lt===""?"."+Et(ve,0):Lt,at(wt)?(At="",Yt!=null&&(At=Yt.replace(st,"$&/")+"/"),di(wt,rt,At,"",function(vi){return vi})):wt!=null&&(lt(wt)&&(wt=xt(wt,At+(wt.key==null||ve&&ve.key===wt.key?"":(""+wt.key).replace(st,"$&/")+"/")+Yt)),rt.push(wt)),1;Yt=0;var Xi=Lt===""?".":Lt+":";if(at(ve))for(var hi=0;hi<ve.length;hi++)Lt=ve[hi],Xt=Xi+Et(Lt,hi),Yt+=di(Lt,rt,At,Xt,wt);else if(hi=be(ve),typeof hi=="function")for(ve=hi.call(ve),hi=0;!(Lt=ve.next()).done;)Lt=Lt.value,Xt=Xi+Et(Lt,hi++),Yt+=di(Lt,rt,At,Xt,wt);else if(Xt==="object"){if(typeof ve.then=="function")return di(ei(ve),rt,At,Lt,wt);throw rt=String(ve),Error("Objects are not valid as a React child (found: "+(rt==="[object Object]"?"object with keys {"+Object.keys(ve).join(", ")+"}":rt)+"). If you meant to render a collection of children, use an array instead.")}return Yt}function Je(ve,rt,At){if(ve==null)return ve;var Lt=[],wt=0;return di(ve,Lt,"","",function(Xt){return rt.call(At,Xt,wt++)}),Lt}function Zt(ve){if(ve._status===-1){var rt=ve._result;rt=rt(),rt.then(function(At){(ve._status===0||ve._status===-1)&&(ve._status=1,ve._result=At)},function(At){(ve._status===0||ve._status===-1)&&(ve._status=2,ve._result=At)}),ve._status===-1&&(ve._status=0,ve._result=rt)}if(ve._status===1)return ve._result.default;throw ve._result}var kt=typeof reportError=="function"?reportError:function(ve){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var rt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ve=="object"&&ve!==null&&typeof ve.message=="string"?String(ve.message):String(ve),error:ve});if(!window.dispatchEvent(rt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ve);return}console.error(ve)};function Wt(){}return yi.Children={map:Je,forEach:function(ve,rt,At){Je(ve,function(){rt.apply(this,arguments)},At)},count:function(ve){var rt=0;return Je(ve,function(){rt++}),rt},toArray:function(ve){return Je(ve,function(rt){return rt})||[]},only:function(ve){if(!lt(ve))throw Error("React.Children.only expected to receive a single React element child.");return ve}},yi.Component=dt,yi.Fragment=P,yi.Profiler=B,yi.PureComponent=St,yi.StrictMode=R,yi.Suspense=ce,yi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Oe,yi.act=function(){throw Error("act(...) is not supported in production builds of React.")},yi.cache=function(ve){return function(){return ve.apply(null,arguments)}},yi.cloneElement=function(ve,rt,At){if(ve==null)throw Error("The argument must be a React element, but you passed "+ve+".");var Lt=we({},ve.props),wt=ve.key,Xt=void 0;if(rt!=null)for(Yt in rt.ref!==void 0&&(Xt=void 0),rt.key!==void 0&&(wt=""+rt.key),rt)!ut.call(rt,Yt)||Yt==="key"||Yt==="__self"||Yt==="__source"||Yt==="ref"&&rt.ref===void 0||(Lt[Yt]=rt[Yt]);var Yt=arguments.length-2;if(Yt===1)Lt.children=At;else if(1<Yt){for(var Xi=Array(Yt),hi=0;hi<Yt;hi++)Xi[hi]=arguments[hi+2];Lt.children=Xi}return yt(ve.type,wt,void 0,void 0,Xt,Lt)},yi.createContext=function(ve){return ve={$$typeof:z,_currentValue:ve,_currentValue2:ve,_threadCount:0,Provider:null,Consumer:null},ve.Provider=ve,ve.Consumer={$$typeof:G,_context:ve},ve},yi.createElement=function(ve,rt,At){var Lt,wt={},Xt=null;if(rt!=null)for(Lt in rt.key!==void 0&&(Xt=""+rt.key),rt)ut.call(rt,Lt)&&Lt!=="key"&&Lt!=="__self"&&Lt!=="__source"&&(wt[Lt]=rt[Lt]);var Yt=arguments.length-2;if(Yt===1)wt.children=At;else if(1<Yt){for(var Xi=Array(Yt),hi=0;hi<Yt;hi++)Xi[hi]=arguments[hi+2];wt.children=Xi}if(ve&&ve.defaultProps)for(Lt in Yt=ve.defaultProps,Yt)wt[Lt]===void 0&&(wt[Lt]=Yt[Lt]);return yt(ve,Xt,void 0,void 0,null,wt)},yi.createRef=function(){return{current:null}},yi.forwardRef=function(ve){return{$$typeof:u,render:ve}},yi.isValidElement=lt,yi.lazy=function(ve){return{$$typeof:Ce,_payload:{_status:-1,_result:ve},_init:Zt}},yi.memo=function(ve,rt){return{$$typeof:ae,type:ve,compare:rt===void 0?null:rt}},yi.startTransition=function(ve){var rt=Oe.T,At={};Oe.T=At;try{var Lt=ve(),wt=Oe.S;wt!==null&&wt(At,Lt),typeof Lt=="object"&&Lt!==null&&typeof Lt.then=="function"&&Lt.then(Wt,kt)}catch(Xt){kt(Xt)}finally{Oe.T=rt}},yi.unstable_useCacheRefresh=function(){return Oe.H.useCacheRefresh()},yi.use=function(ve){return Oe.H.use(ve)},yi.useActionState=function(ve,rt,At){return Oe.H.useActionState(ve,rt,At)},yi.useCallback=function(ve,rt){return Oe.H.useCallback(ve,rt)},yi.useContext=function(ve){return Oe.H.useContext(ve)},yi.useDebugValue=function(){},yi.useDeferredValue=function(ve,rt){return Oe.H.useDeferredValue(ve,rt)},yi.useEffect=function(ve,rt){return Oe.H.useEffect(ve,rt)},yi.useId=function(){return Oe.H.useId()},yi.useImperativeHandle=function(ve,rt,At){return Oe.H.useImperativeHandle(ve,rt,At)},yi.useInsertionEffect=function(ve,rt){return Oe.H.useInsertionEffect(ve,rt)},yi.useLayoutEffect=function(ve,rt){return Oe.H.useLayoutEffect(ve,rt)},yi.useMemo=function(ve,rt){return Oe.H.useMemo(ve,rt)},yi.useOptimistic=function(ve,rt){return Oe.H.useOptimistic(ve,rt)},yi.useReducer=function(ve,rt,At){return Oe.H.useReducer(ve,rt,At)},yi.useRef=function(ve){return Oe.H.useRef(ve)},yi.useState=function(ve){return Oe.H.useState(ve)},yi.useSyncExternalStore=function(ve,rt,At){return Oe.H.useSyncExternalStore(ve,rt,At)},yi.useTransition=function(){return Oe.H.useTransition()},yi.version="19.0.0",yi}var Hg;function vg(){return Hg||(Hg=1,$m.exports=jy()),$m.exports}var pt=vg();const rh=By(pt),ng=Ly({__proto__:null,default:rh},[pt]);var qm={exports:{}},cp={},Hm={exports:{}},Xm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function Ny(){return Xg||(Xg=1,function(y){function S(Je,Zt){var kt=Je.length;Je.push(Zt);e:for(;0<kt;){var Wt=kt-1>>>1,ve=Je[Wt];if(0<B(ve,Zt))Je[Wt]=Zt,Je[kt]=ve,kt=Wt;else break e}}function P(Je){return Je.length===0?null:Je[0]}function R(Je){if(Je.length===0)return null;var Zt=Je[0],kt=Je.pop();if(kt!==Zt){Je[0]=kt;e:for(var Wt=0,ve=Je.length,rt=ve>>>1;Wt<rt;){var At=2*(Wt+1)-1,Lt=Je[At],wt=At+1,Xt=Je[wt];if(0>B(Lt,kt))wt<ve&&0>B(Xt,Lt)?(Je[Wt]=Xt,Je[wt]=kt,Wt=wt):(Je[Wt]=Lt,Je[At]=kt,Wt=At);else if(wt<ve&&0>B(Xt,kt))Je[Wt]=Xt,Je[wt]=kt,Wt=wt;else break e}}return Zt}function B(Je,Zt){var kt=Je.sortIndex-Zt.sortIndex;return kt!==0?kt:Je.id-Zt.id}if(y.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var G=performance;y.unstable_now=function(){return G.now()}}else{var z=Date,u=z.now();y.unstable_now=function(){return z.now()-u}}var ce=[],ae=[],Ce=1,Ee=null,be=3,oe=!1,we=!1,ze=!1,dt=typeof setTimeout=="function"?setTimeout:null,gt=typeof clearTimeout=="function"?clearTimeout:null,St=typeof setImmediate<"u"?setImmediate:null;function vt(Je){for(var Zt=P(ae);Zt!==null;){if(Zt.callback===null)R(ae);else if(Zt.startTime<=Je)R(ae),Zt.sortIndex=Zt.expirationTime,S(ce,Zt);else break;Zt=P(ae)}}function at(Je){if(ze=!1,vt(Je),!we)if(P(ce)!==null)we=!0,ei();else{var Zt=P(ae);Zt!==null&&di(at,Zt.startTime-Je)}}var Oe=!1,ut=-1,yt=5,xt=-1;function lt(){return!(y.unstable_now()-xt<yt)}function Q(){if(Oe){var Je=y.unstable_now();xt=Je;var Zt=!0;try{e:{we=!1,ze&&(ze=!1,gt(ut),ut=-1),oe=!0;var kt=be;try{t:{for(vt(Je),Ee=P(ce);Ee!==null&&!(Ee.expirationTime>Je&&lt());){var Wt=Ee.callback;if(typeof Wt=="function"){Ee.callback=null,be=Ee.priorityLevel;var ve=Wt(Ee.expirationTime<=Je);if(Je=y.unstable_now(),typeof ve=="function"){Ee.callback=ve,vt(Je),Zt=!0;break t}Ee===P(ce)&&R(ce),vt(Je)}else R(ce);Ee=P(ce)}if(Ee!==null)Zt=!0;else{var rt=P(ae);rt!==null&&di(at,rt.startTime-Je),Zt=!1}}break e}finally{Ee=null,be=kt,oe=!1}Zt=void 0}}finally{Zt?st():Oe=!1}}}var st;if(typeof St=="function")st=function(){St(Q)};else if(typeof MessageChannel<"u"){var Et=new MessageChannel,Vt=Et.port2;Et.port1.onmessage=Q,st=function(){Vt.postMessage(null)}}else st=function(){dt(Q,0)};function ei(){Oe||(Oe=!0,st())}function di(Je,Zt){ut=dt(function(){Je(y.unstable_now())},Zt)}y.unstable_IdlePriority=5,y.unstable_ImmediatePriority=1,y.unstable_LowPriority=4,y.unstable_NormalPriority=3,y.unstable_Profiling=null,y.unstable_UserBlockingPriority=2,y.unstable_cancelCallback=function(Je){Je.callback=null},y.unstable_continueExecution=function(){we||oe||(we=!0,ei())},y.unstable_forceFrameRate=function(Je){0>Je||125<Je?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):yt=0<Je?Math.floor(1e3/Je):5},y.unstable_getCurrentPriorityLevel=function(){return be},y.unstable_getFirstCallbackNode=function(){return P(ce)},y.unstable_next=function(Je){switch(be){case 1:case 2:case 3:var Zt=3;break;default:Zt=be}var kt=be;be=Zt;try{return Je()}finally{be=kt}},y.unstable_pauseExecution=function(){},y.unstable_requestPaint=function(){},y.unstable_runWithPriority=function(Je,Zt){switch(Je){case 1:case 2:case 3:case 4:case 5:break;default:Je=3}var kt=be;be=Je;try{return Zt()}finally{be=kt}},y.unstable_scheduleCallback=function(Je,Zt,kt){var Wt=y.unstable_now();switch(typeof kt=="object"&&kt!==null?(kt=kt.delay,kt=typeof kt=="number"&&0<kt?Wt+kt:Wt):kt=Wt,Je){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=kt+ve,Je={id:Ce++,callback:Zt,priorityLevel:Je,startTime:kt,expirationTime:ve,sortIndex:-1},kt>Wt?(Je.sortIndex=kt,S(ae,Je),P(ce)===null&&Je===P(ae)&&(ze?(gt(ut),ut=-1):ze=!0,di(at,kt-Wt))):(Je.sortIndex=ve,S(ce,Je),we||oe||(we=!0,ei())),Je},y.unstable_shouldYield=lt,y.unstable_wrapCallback=function(Je){var Zt=be;return function(){var kt=be;be=Zt;try{return Je.apply(this,arguments)}finally{be=kt}}}}(Xm)),Xm}var Yg;function Uy(){return Yg||(Yg=1,Hm.exports=Ny()),Hm.exports}var Ym={exports:{}},Ba={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function Vy(){if(Kg)return Ba;Kg=1;var y=vg();function S(ce){var ae="https://react.dev/errors/"+ce;if(1<arguments.length){ae+="?args[]="+encodeURIComponent(arguments[1]);for(var Ce=2;Ce<arguments.length;Ce++)ae+="&args[]="+encodeURIComponent(arguments[Ce])}return"Minified React error #"+ce+"; visit "+ae+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(){}var R={d:{f:P,r:function(){throw Error(S(522))},D:P,C:P,L:P,m:P,X:P,S:P,M:P},p:0,findDOMNode:null},B=Symbol.for("react.portal");function G(ce,ae,Ce){var Ee=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:Ee==null?null:""+Ee,children:ce,containerInfo:ae,implementation:Ce}}var z=y.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(ce,ae){if(ce==="font")return"";if(typeof ae=="string")return ae==="use-credentials"?ae:""}return Ba.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ba.createPortal=function(ce,ae){var Ce=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ae||ae.nodeType!==1&&ae.nodeType!==9&&ae.nodeType!==11)throw Error(S(299));return G(ce,ae,null,Ce)},Ba.flushSync=function(ce){var ae=z.T,Ce=R.p;try{if(z.T=null,R.p=2,ce)return ce()}finally{z.T=ae,R.p=Ce,R.d.f()}},Ba.preconnect=function(ce,ae){typeof ce=="string"&&(ae?(ae=ae.crossOrigin,ae=typeof ae=="string"?ae==="use-credentials"?ae:"":void 0):ae=null,R.d.C(ce,ae))},Ba.prefetchDNS=function(ce){typeof ce=="string"&&R.d.D(ce)},Ba.preinit=function(ce,ae){if(typeof ce=="string"&&ae&&typeof ae.as=="string"){var Ce=ae.as,Ee=u(Ce,ae.crossOrigin),be=typeof ae.integrity=="string"?ae.integrity:void 0,oe=typeof ae.fetchPriority=="string"?ae.fetchPriority:void 0;Ce==="style"?R.d.S(ce,typeof ae.precedence=="string"?ae.precedence:void 0,{crossOrigin:Ee,integrity:be,fetchPriority:oe}):Ce==="script"&&R.d.X(ce,{crossOrigin:Ee,integrity:be,fetchPriority:oe,nonce:typeof ae.nonce=="string"?ae.nonce:void 0})}},Ba.preinitModule=function(ce,ae){if(typeof ce=="string")if(typeof ae=="object"&&ae!==null){if(ae.as==null||ae.as==="script"){var Ce=u(ae.as,ae.crossOrigin);R.d.M(ce,{crossOrigin:Ce,integrity:typeof ae.integrity=="string"?ae.integrity:void 0,nonce:typeof ae.nonce=="string"?ae.nonce:void 0})}}else ae==null&&R.d.M(ce)},Ba.preload=function(ce,ae){if(typeof ce=="string"&&typeof ae=="object"&&ae!==null&&typeof ae.as=="string"){var Ce=ae.as,Ee=u(Ce,ae.crossOrigin);R.d.L(ce,Ce,{crossOrigin:Ee,integrity:typeof ae.integrity=="string"?ae.integrity:void 0,nonce:typeof ae.nonce=="string"?ae.nonce:void 0,type:typeof ae.type=="string"?ae.type:void 0,fetchPriority:typeof ae.fetchPriority=="string"?ae.fetchPriority:void 0,referrerPolicy:typeof ae.referrerPolicy=="string"?ae.referrerPolicy:void 0,imageSrcSet:typeof ae.imageSrcSet=="string"?ae.imageSrcSet:void 0,imageSizes:typeof ae.imageSizes=="string"?ae.imageSizes:void 0,media:typeof ae.media=="string"?ae.media:void 0})}},Ba.preloadModule=function(ce,ae){if(typeof ce=="string")if(ae){var Ce=u(ae.as,ae.crossOrigin);R.d.m(ce,{as:typeof ae.as=="string"&&ae.as!=="script"?ae.as:void 0,crossOrigin:Ce,integrity:typeof ae.integrity=="string"?ae.integrity:void 0})}else R.d.m(ce)},Ba.requestFormReset=function(ce){R.d.r(ce)},Ba.unstable_batchedUpdates=function(ce,ae){return ce(ae)},Ba.useFormState=function(ce,ae,Ce){return z.H.useFormState(ce,ae,Ce)},Ba.useFormStatus=function(){return z.H.useHostTransitionStatus()},Ba.version="19.0.0",Ba}var Wg;function Zy(){if(Wg)return Ym.exports;Wg=1;function y(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y)}catch(S){console.error(S)}}return y(),Ym.exports=Vy(),Ym.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qg;function Gy(){if(Qg)return cp;Qg=1;var y=Uy(),S=vg(),P=Zy();function R(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function B(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var G=Symbol.for("react.element"),z=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),ae=Symbol.for("react.strict_mode"),Ce=Symbol.for("react.profiler"),Ee=Symbol.for("react.provider"),be=Symbol.for("react.consumer"),oe=Symbol.for("react.context"),we=Symbol.for("react.forward_ref"),ze=Symbol.for("react.suspense"),dt=Symbol.for("react.suspense_list"),gt=Symbol.for("react.memo"),St=Symbol.for("react.lazy"),vt=Symbol.for("react.offscreen"),at=Symbol.for("react.memo_cache_sentinel"),Oe=Symbol.iterator;function ut(i){return i===null||typeof i!="object"?null:(i=Oe&&i[Oe]||i["@@iterator"],typeof i=="function"?i:null)}var yt=Symbol.for("react.client.reference");function xt(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===yt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ce:return"Fragment";case u:return"Portal";case Ce:return"Profiler";case ae:return"StrictMode";case ze:return"Suspense";case dt:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case oe:return(i.displayName||"Context")+".Provider";case be:return(i._context.displayName||"Context")+".Consumer";case we:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case gt:return s=i.displayName||null,s!==null?s:xt(i.type)||"Memo";case St:s=i._payload,i=i._init;try{return xt(i(s))}catch{}}return null}var lt=S.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Q=Object.assign,st,Et;function Vt(i){if(st===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);st=s&&s[1]||"",Et=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+st+i+Et}var ei=!1;function di(i,s){if(!i||ei)return"";ei=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(s){var ht=function(){throw Error()};if(Object.defineProperty(ht.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ht,[])}catch(Ye){var Ue=Ye}Reflect.construct(i,[],ht)}else{try{ht.call()}catch(Ye){Ue=Ye}i.call(ht.prototype)}}else{try{throw Error()}catch(Ye){Ue=Ye}(ht=i())&&typeof ht.catch=="function"&&ht.catch(function(){})}}catch(Ye){if(Ye&&Ue&&typeof Ye.stack=="string")return[Ye.stack,Ue.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),V=C[0],K=C[1];if(V&&K){var he=V.split(`
`),Te=K.split(`
`);for(b=p=0;p<he.length&&!he[p].includes("DetermineComponentFrameRoot");)p++;for(;b<Te.length&&!Te[b].includes("DetermineComponentFrameRoot");)b++;if(p===he.length||b===Te.length)for(p=he.length-1,b=Te.length-1;1<=p&&0<=b&&he[p]!==Te[b];)b--;for(;1<=p&&0<=b;p--,b--)if(he[p]!==Te[b]){if(p!==1||b!==1)do if(p--,b--,0>b||he[p]!==Te[b]){var Qe=`
`+he[p].replace(" at new "," at ");return i.displayName&&Qe.includes("<anonymous>")&&(Qe=Qe.replace("<anonymous>",i.displayName)),Qe}while(1<=p&&0<=b);break}}}finally{ei=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Vt(c):""}function Je(i){switch(i.tag){case 26:case 27:case 5:return Vt(i.type);case 16:return Vt("Lazy");case 13:return Vt("Suspense");case 19:return Vt("SuspenseList");case 0:case 15:return i=di(i.type,!1),i;case 11:return i=di(i.type.render,!1),i;case 1:return i=di(i.type,!0),i;default:return""}}function Zt(i){try{var s="";do s+=Je(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function kt(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function Wt(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function ve(i){if(kt(i)!==i)throw Error(R(188))}function rt(i){var s=i.alternate;if(!s){if(s=kt(i),s===null)throw Error(R(188));return s!==i?null:i}for(var c=i,p=s;;){var b=c.return;if(b===null)break;var C=b.alternate;if(C===null){if(p=b.return,p!==null){c=p;continue}break}if(b.child===C.child){for(C=b.child;C;){if(C===c)return ve(b),i;if(C===p)return ve(b),s;C=C.sibling}throw Error(R(188))}if(c.return!==p.return)c=b,p=C;else{for(var V=!1,K=b.child;K;){if(K===c){V=!0,c=b,p=C;break}if(K===p){V=!0,p=b,c=C;break}K=K.sibling}if(!V){for(K=C.child;K;){if(K===c){V=!0,c=C,p=b;break}if(K===p){V=!0,p=C,c=b;break}K=K.sibling}if(!V)throw Error(R(189))}}if(c.alternate!==p)throw Error(R(190))}if(c.tag!==3)throw Error(R(188));return c.stateNode.current===c?i:s}function At(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=At(i),s!==null)return s;i=i.sibling}return null}var Lt=Array.isArray,wt=P.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Xt={pending:!1,data:null,method:null,action:null},Yt=[],Xi=-1;function hi(i){return{current:i}}function vi(i){0>Xi||(i.current=Yt[Xi],Yt[Xi]=null,Xi--)}function Ci(i,s){Xi++,Yt[Xi]=i.current,i.current=s}var Ai=hi(null),Bi=hi(null),zr=hi(null),Ei=hi(null);function qn(i,s){switch(Ci(zr,s),Ci(Bi,i),Ci(Ai,null),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?Ju(s):0;break;default:if(i=i===8?s.parentNode:s,s=i.tagName,i=i.namespaceURI)i=Ju(i),s=Qd(i,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}vi(Ai),Ci(Ai,s)}function yn(){vi(Ai),vi(Bi),vi(zr)}function Sr(i){i.memoizedState!==null&&Ci(Ei,i);var s=Ai.current,c=Qd(s,i.type);s!==c&&(Ci(Bi,i),Ci(Ai,c))}function zi(i){Bi.current===i&&(vi(Ai),vi(Bi)),Ei.current===i&&(vi(Ei),Y._currentValue=Xt)}var nn=Object.prototype.hasOwnProperty,Pr=y.unstable_scheduleCallback,vn=y.unstable_cancelCallback,ti=y.unstable_shouldYield,rs=y.unstable_requestPaint,Yr=y.unstable_now,bs=y.unstable_getCurrentPriorityLevel,Fa=y.unstable_ImmediatePriority,na=y.unstable_UserBlockingPriority,Oi=y.unstable_NormalPriority,hr=y.unstable_LowPriority,fr=y.unstable_IdlePriority,ja=y.log,an=y.unstable_setDisableYieldValue,Kr=null,Rr=null;function Ae(i){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(Kr,i,void 0,(i.current.flags&128)===128)}catch{}}function L(i){if(typeof ja=="function"&&an(i),Rr&&typeof Rr.setStrictMode=="function")try{Rr.setStrictMode(Kr,i)}catch{}}var X=Math.clz32?Math.clz32:me,J=Math.log,ne=Math.LN2;function me(i){return i>>>=0,i===0?32:31-(J(i)/ne|0)|0}var Se=128,Le=4194304;function xe(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ge(i,s){var c=i.pendingLanes;if(c===0)return 0;var p=0,b=i.suspendedLanes,C=i.pingedLanes,V=i.warmLanes;i=i.finishedLanes!==0;var K=c&134217727;return K!==0?(c=K&~b,c!==0?p=xe(c):(C&=K,C!==0?p=xe(C):i||(V=K&~V,V!==0&&(p=xe(V))))):(K=c&~b,K!==0?p=xe(K):C!==0?p=xe(C):i||(V=c&~V,V!==0&&(p=xe(V)))),p===0?0:s!==0&&s!==p&&(s&b)===0&&(b=p&-p,V=s&-s,b>=V||b===32&&(V&4194176)!==0)?s:p}function Ne(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Pe(i,s){switch(i){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function We(){var i=Se;return Se<<=1,(Se&4194176)===0&&(Se=128),i}function Re(){var i=Le;return Le<<=1,(Le&62914560)===0&&(Le=4194304),i}function _t(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function Dt(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ii(i,s,c,p,b,C){var V=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var K=i.entanglements,he=i.expirationTimes,Te=i.hiddenUpdates;for(c=V&~c;0<c;){var Qe=31-X(c),ht=1<<Qe;K[Qe]=0,he[Qe]=-1;var Ue=Te[Qe];if(Ue!==null)for(Te[Qe]=null,Qe=0;Qe<Ue.length;Qe++){var Ye=Ue[Qe];Ye!==null&&(Ye.lane&=-536870913)}c&=~ht}p!==0&&Ht(i,p,0),C!==0&&b===0&&i.tag!==0&&(i.suspendedLanes|=C&~(V&~s))}function Ht(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var p=31-X(s);i.entangledLanes|=s,i.entanglements[p]=i.entanglements[p]|1073741824|c&4194218}function Xe(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var p=31-X(c),b=1<<p;b&s|i[p]&s&&(i[p]|=s),c&=~b}}function zt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Tt(){var i=wt.p;return i!==0?i:(i=window.event,i===void 0?32:cr(i.type))}function li(i,s){var c=wt.p;try{return wt.p=i,s()}finally{wt.p=c}}var Nt=Math.random().toString(36).slice(2),$t="__reactFiber$"+Nt,Mt="__reactProps$"+Nt,ba="__reactContainer$"+Nt,Tr="__reactEvents$"+Nt,Wr="__reactListeners$"+Nt,Yi="__reactHandles$"+Nt,ic="__reactResources$"+Nt,sn="__reactMarker$"+Nt;function Pi(i){delete i[$t],delete i[Mt],delete i[Tr],delete i[Wr],delete i[Yi]}function Gs(i){var s=i[$t];if(s)return s;for(var c=i.parentNode;c;){if(s=c[ba]||c[$t]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=ep(i);i!==null;){if(c=i[$t])return c;i=ep(i)}return s}i=c,c=i.parentNode}return null}function ns(i){if(i=i[$t]||i[ba]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function Co(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(R(33))}function aa(i){var s=i[ic];return s||(s=i[ic]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function dr(i){i[sn]=!0}var Wc=new Set,oh={};function $s(i,s){Na(i,s),Na(i+"Capture",s)}function Na(i,s){for(oh[i]=s,i=0;i<s.length;i++)Wc.add(s[i])}var as=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),cd=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sf={},of={};function lh(i){return nn.call(of,i)?!0:nn.call(sf,i)?!1:cd.test(i)?of[i]=!0:(sf[i]=!0,!1)}function ws(i,s,c){if(lh(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var p=s.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function al(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Ua(i,s,c,p){if(p===null)i.removeAttribute(c);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+p)}}function xn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qc(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ch(i){var s=Qc(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),p=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,C=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return b.call(this)},set:function(V){p=""+V,C.call(this,V)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(V){p=""+V},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Eo(i){i._valueTracker||(i._valueTracker=ch(i))}function Jc(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),p="";return i&&(p=Qc(i)?i.checked?"true":"false":i.value),i=p,i!==c?(s.setValue(i),!0):!1}function ss(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Va=/[\n"\\]/g;function ai(i){return i.replace(Va,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Bn(i,s,c,p,b,C,V,K){i.name="",V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?i.type=V:i.removeAttribute("type"),s!=null?V==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+xn(s)):i.value!==""+xn(s)&&(i.value=""+xn(s)):V!=="submit"&&V!=="reset"||i.removeAttribute("value"),s!=null?pi(i,V,xn(s)):c!=null?pi(i,V,xn(c)):p!=null&&i.removeAttribute("value"),b==null&&C!=null&&(i.defaultChecked=!!C),b!=null&&(i.checked=b&&typeof b!="function"&&typeof b!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?i.name=""+xn(K):i.removeAttribute("name")}function sa(i,s,c,p,b,C,V,K){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(i.type=C),s!=null||c!=null){if(!(C!=="submit"&&C!=="reset"||s!=null))return;c=c!=null?""+xn(c):"",s=s!=null?""+xn(s):c,K||s===i.value||(i.value=s),i.defaultValue=s}p=p??b,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=K?i.checked:!!p,i.defaultChecked=!!p,V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(i.name=V)}function pi(i,s,c){s==="number"&&ss(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Ss(i,s,c,p){if(i=i.options,s){s={};for(var b=0;b<c.length;b++)s["$"+c[b]]=!0;for(c=0;c<i.length;c++)b=s.hasOwnProperty("$"+i[c].value),i[c].selected!==b&&(i[c].selected=b),b&&p&&(i[c].defaultSelected=!0)}else{for(c=""+xn(c),s=null,b=0;b<i.length;b++){if(i[b].value===c){i[b].selected=!0,p&&(i[b].defaultSelected=!0);return}s!==null||i[b].disabled||(s=i[b])}s!==null&&(s.selected=!0)}}function eu(i,s,c){if(s!=null&&(s=""+xn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+xn(c):""}function oa(i,s,c,p){if(s==null){if(p!=null){if(c!=null)throw Error(R(92));if(Lt(p)){if(1<p.length)throw Error(R(93));p=p[0]}c=p}c==null&&(c=""),s=c}c=xn(s),i.defaultValue=c,p=i.textContent,p===c&&p!==""&&p!==null&&(i.value=p)}function Mr(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var on=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nr(i,s,c){var p=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?p?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":p?i.setProperty(s,c):typeof c!="number"||c===0||on.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function tu(i,s,c){if(s!=null&&typeof s!="object")throw Error(R(62));if(i=i.style,c!=null){for(var p in c)!c.hasOwnProperty(p)||s!=null&&s.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var b in s)p=s[b],s.hasOwnProperty(b)&&c[b]!==p&&nr(i,b,p)}else for(var C in s)s.hasOwnProperty(C)&&nr(i,C,s[C])}function Nr(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var On=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ao(i){return Hn.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var la=null;function Cr(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ca=null,bn=null;function sl(i){var s=ns(i);if(s&&(i=s.stateNode)){var c=i[Mt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Bn(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ai(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var p=c[s];if(p!==i&&p.form===i.form){var b=p[Mt]||null;if(!b)throw Error(R(90));Bn(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name)}}for(s=0;s<c.length;s++)p=c[s],p.form===i.form&&Jc(p)}break e;case"textarea":eu(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Ss(i,!!c.multiple,s,!1)}}}var Xn=!1;function iu(i,s,c){if(Xn)return i(s,c);Xn=!0;try{var p=i(s);return p}finally{if(Xn=!1,(ca!==null||bn!==null)&&($h(),ca&&(s=ca,i=bn,bn=ca=null,sl(s),i)))for(s=0;s<i.length;s++)sl(i[s])}}function Fn(i,s){var c=i.stateNode;if(c===null)return null;var p=c[Mt]||null;if(p===null)return null;c=p[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(R(231,s,typeof c));return c}var Ui=!1;if(as)try{var qs={};Object.defineProperty(qs,"passive",{get:function(){Ui=!0}}),window.addEventListener("test",qs,qs),window.removeEventListener("test",qs,qs)}catch{Ui=!1}var oi=null,ni=null,Ts=null;function mi(){if(Ts)return Ts;var i,s=ni,c=s.length,p,b="value"in oi?oi.value:oi.textContent,C=b.length;for(i=0;i<c&&s[i]===b[i];i++);var V=c-i;for(p=1;p<=V&&s[c-p]===b[C-p];p++);return Ts=b.slice(i,1<p?1-p:void 0)}function Hs(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function jn(){return!0}function ol(){return!1}function wn(i){function s(c,p,b,C,V){this._reactName=c,this._targetInst=b,this.type=p,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var K in i)i.hasOwnProperty(K)&&(c=i[K],this[K]=c?c(C):C[K]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?jn:ol,this.isPropagationStopped=ol,this}return Q(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=jn)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=jn)},persist:function(){},isPersistent:jn}),s}var Za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ms=wn(Za),os=Q({},Za,{view:0,detail:0}),ud=wn(os),ll,rc,Cs,Qr=Q({},os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Es,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Cs&&(Cs&&i.type==="mousemove"?(ll=i.screenX-Cs.screenX,rc=i.screenY-Cs.screenY):rc=ll=0,Cs=i),ll)},movementY:function(i){return"movementY"in i?i.movementY:rc}}),Sn=wn(Qr),ru=Q({},Qr,{dataTransfer:0}),ua=wn(ru),Dr=Q({},os,{relatedTarget:0}),nc=wn(Dr),nu=Q({},Za,{animationName:0,elapsedTime:0,pseudoElement:0}),zo=wn(nu),hd=Q({},Za,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),au=wn(hd),uh=Q({},Za,{data:0}),lf=wn(uh),su={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ou={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Yn[i])?!!s[i]:!1}function Es(){return lu}var hh=Q({},os,{key:function(i){if(i.key){var s=su[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Hs(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?ou[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Es,charCode:function(i){return i.type==="keypress"?Hs(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Hs(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ac=wn(hh),ls=Q({},Qr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cf=wn(ls),fh=Q({},os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Es}),sc=wn(fh),Xs=Q({},Za,{propertyName:0,elapsedTime:0,pseudoElement:0}),fd=wn(Xs),oc=Q({},Qr,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),uf=wn(oc),cl=Q({},Za,{newState:0,oldState:0}),hf=wn(cl),ff=[9,13,27,32],dh=as&&"CompositionEvent"in window,ul=null;as&&"documentMode"in document&&(ul=document.documentMode);var ph=as&&"TextEvent"in window&&!ul,mh=as&&(!dh||ul&&8<ul&&11>=ul),cu=" ",uu=!1;function hu(i,s){switch(i){case"keyup":return ff.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ys(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Po=!1;function df(i,s){switch(i){case"compositionend":return Ys(s);case"keypress":return s.which!==32?null:(uu=!0,cu);case"textInput":return i=s.data,i===cu&&uu?null:i;default:return null}}function Ro(i,s){if(Po)return i==="compositionend"||!dh&&hu(i,s)?(i=mi(),Ts=ni=oi=null,Po=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return mh&&s.locale!=="ko"?null:s.data;default:return null}}var dd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lc(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!dd[i.type]:s==="textarea"}function pf(i,s,c,p){ca?bn?bn.push(p):bn=[p]:ca=p,s=Yh(s,"onChange"),0<s.length&&(c=new Ms("onChange","change",null,c,p),i.push({event:c,listeners:s}))}var hl=null,Do=null;function mf(i){Hd(i,0)}function cc(i){var s=Co(i);if(Jc(s))return i}function uc(i,s){if(i==="change")return s}var fu=!1;if(as){var fl;if(as){var Ga="oninput"in document;if(!Ga){var du=document.createElement("div");du.setAttribute("oninput","return;"),Ga=typeof du.oninput=="function"}fl=Ga}else fl=!1;fu=fl&&(!document.documentMode||9<document.documentMode)}function hc(){hl&&(hl.detachEvent("onpropertychange",pu),Do=hl=null)}function pu(i){if(i.propertyName==="value"&&cc(Do)){var s=[];pf(s,Do,i,Cr(i)),iu(mf,s)}}function gf(i,s,c){i==="focusin"?(hc(),hl=s,Do=c,hl.attachEvent("onpropertychange",pu)):i==="focusout"&&hc()}function gh(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return cc(Do)}function Io(i,s){if(i==="click")return cc(s)}function Ti(i,s){if(i==="input"||i==="change")return cc(s)}function pd(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var ha=typeof Object.is=="function"?Object.is:pd;function fc(i,s){if(ha(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),p=Object.keys(s);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var b=c[p];if(!nn.call(s,b)||!ha(i[b],s[b]))return!1}return!0}function _f(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function _h(i,s){var c=_f(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=s&&p>=s)return{node:c,offset:s-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=_f(c)}}function yf(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?yf(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function yh(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=ss(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=ss(i.document)}return s}function dl(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function mu(i,s){var c=yh(s);s=i.focusedElem;var p=i.selectionRange;if(c!==s&&s&&s.ownerDocument&&yf(s.ownerDocument.documentElement,s)){if(p!==null&&dl(s)){if(i=p.start,c=p.end,c===void 0&&(c=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(c,s.value.length);else if(c=(i=s.ownerDocument||document)&&i.defaultView||window,c.getSelection){c=c.getSelection();var b=s.textContent.length,C=Math.min(p.start,b);p=p.end===void 0?C:Math.min(p.end,b),!c.extend&&C>p&&(b=p,p=C,C=b),b=_h(s,C);var V=_h(s,p);b&&V&&(c.rangeCount!==1||c.anchorNode!==b.node||c.anchorOffset!==b.offset||c.focusNode!==V.node||c.focusOffset!==V.offset)&&(i=i.createRange(),i.setStart(b.node,b.offset),c.removeAllRanges(),C>p?(c.addRange(i),c.extend(V.node,V.offset)):(i.setEnd(V.node,V.offset),c.addRange(i)))}}for(i=[],c=s;c=c.parentNode;)c.nodeType===1&&i.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)c=i[s],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var gu=as&&"documentMode"in document&&11>=document.documentMode,Ks=null,As=null,cs=null,Kn=!1;function vh(i,s,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Kn||Ks==null||Ks!==ss(p)||(p=Ks,"selectionStart"in p&&dl(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),cs&&fc(cs,p)||(cs=p,p=Yh(As,"onSelect"),0<p.length&&(s=new Ms("onSelect","select",null,s,c),i.push({event:s,listeners:p}),s.target=Ks)))}function Ws(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var Qs={animationend:Ws("Animation","AnimationEnd"),animationiteration:Ws("Animation","AnimationIteration"),animationstart:Ws("Animation","AnimationStart"),transitionrun:Ws("Transition","TransitionRun"),transitionstart:Ws("Transition","TransitionStart"),transitioncancel:Ws("Transition","TransitionCancel"),transitionend:Ws("Transition","TransitionEnd")},zs={},dc={};as&&(dc=document.createElement("div").style,"AnimationEvent"in window||(delete Qs.animationend.animation,delete Qs.animationiteration.animation,delete Qs.animationstart.animation),"TransitionEvent"in window||delete Qs.transitionend.transition);function us(i){if(zs[i])return zs[i];if(!Qs[i])return i;var s=Qs[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in dc)return zs[i]=s[c];return i}var pl=us("animationend"),pc=us("animationiteration"),xh=us("animationstart"),ml=us("transitionrun"),gl=us("transitionstart"),vf=us("transitioncancel"),_u=us("transitionend"),xi=new Map,mc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function $a(i,s){xi.set(i,s),$s(s,[i])}var fa=[],wa=0,bh=0;function yu(){for(var i=wa,s=bh=wa=0;s<i;){var c=fa[s];fa[s++]=null;var p=fa[s];fa[s++]=null;var b=fa[s];fa[s++]=null;var C=fa[s];if(fa[s++]=null,p!==null&&b!==null){var V=p.pending;V===null?b.next=b:(b.next=V.next,V.next=b),p.pending=b}C!==0&&_c(c,b,C)}}function gc(i,s,c,p){fa[wa++]=i,fa[wa++]=s,fa[wa++]=c,fa[wa++]=p,bh|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function vu(i,s,c,p){return gc(i,s,c,p),fs(i)}function hs(i,s){return gc(i,null,null,s),fs(i)}function _c(i,s,c){i.lanes|=c;var p=i.alternate;p!==null&&(p.lanes|=c);for(var b=!1,C=i.return;C!==null;)C.childLanes|=c,p=C.alternate,p!==null&&(p.childLanes|=c),C.tag===22&&(i=C.stateNode,i===null||i._visibility&1||(b=!0)),i=C,C=C.return;b&&s!==null&&i.tag===3&&(C=i.stateNode,b=31-X(c),C=C.hiddenUpdates,i=C[b],i===null?C[b]=[s]:i.push(s),s.lane=c|536870912)}function fs(i){if(50<Uc)throw Uc=0,kf=null,Error(R(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Ps={},xu=new WeakMap;function da(i,s){if(typeof i=="object"&&i!==null){var c=xu.get(i);return c!==void 0?c:(s={value:i,source:s,stack:Zt(s)},xu.set(i,s),s)}return{value:i,source:s,stack:Zt(s)}}var Rs=[],Ds=0,_l=null,yc=0,Nn=[],Sa=0,Js=null,pa=1,Ta="";function Is(i,s){Rs[Ds++]=yc,Rs[Ds++]=_l,_l=i,yc=s}function bu(i,s,c){Nn[Sa++]=pa,Nn[Sa++]=Ta,Nn[Sa++]=Js,Js=i;var p=pa;i=Ta;var b=32-X(p)-1;p&=~(1<<b),c+=1;var C=32-X(s)+b;if(30<C){var V=b-b%5;C=(p&(1<<V)-1).toString(32),p>>=V,b-=V,pa=1<<32-X(s)+b|c<<b|p,Ta=C+i}else pa=1<<C|c<<b|p,Ta=i}function eo(i){i.return!==null&&(Is(i,1),bu(i,1,0))}function ko(i){for(;i===_l;)_l=Rs[--Ds],Rs[Ds]=null,yc=Rs[--Ds],Rs[Ds]=null;for(;i===Js;)Js=Nn[--Sa],Nn[Sa]=null,Ta=Nn[--Sa],Nn[Sa]=null,pa=Nn[--Sa],Nn[Sa]=null}var Tn=null,Ir=null,Qt=!1,Mn=null,kr=!1,vc=Error(R(519));function ks(i){var s=Error(R(418,""));throw yl(da(s,i)),vc}function wh(i){var s=i.stateNode,c=i.type,p=i.memoizedProps;switch(s[$t]=i,s[Mt]=p,c){case"dialog":gi("cancel",s),gi("close",s);break;case"iframe":case"object":case"embed":gi("load",s);break;case"video":case"audio":for(c=0;c<Ku.length;c++)gi(Ku[c],s);break;case"source":gi("error",s);break;case"img":case"image":case"link":gi("error",s),gi("load",s);break;case"details":gi("toggle",s);break;case"input":gi("invalid",s),sa(s,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Eo(s);break;case"select":gi("invalid",s);break;case"textarea":gi("invalid",s),oa(s,p.value,p.defaultValue,p.children),Eo(s)}c=p.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||p.suppressHydrationWarning===!0||Yd(s.textContent,c)?(p.popover!=null&&(gi("beforetoggle",s),gi("toggle",s)),p.onScroll!=null&&gi("scroll",s),p.onScrollEnd!=null&&gi("scrollend",s),p.onClick!=null&&(s.onclick=js),s=!0):s=!1,s||ks(i)}function to(i){for(Tn=i.return;Tn;)switch(Tn.tag){case 3:case 27:kr=!0;return;case 5:case 13:kr=!1;return;default:Tn=Tn.return}}function ds(i){if(i!==Tn)return!1;if(!Qt)return to(i),Qt=!0,!1;var s=!1,c;if((c=i.tag!==3&&i.tag!==27)&&((c=i.tag===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||eh(i.type,i.memoizedProps)),c=!c),c&&(s=!0),s&&Ir&&ks(i),to(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){Ir=ys(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}Ir=null}}else Ir=Tn?ys(i.stateNode.nextSibling):null;return!0}function ps(){Ir=Tn=null,Qt=!1}function yl(i){Mn===null?Mn=[i]:Mn.push(i)}var Lo=Error(R(460)),wu=Error(R(474)),Su={then:function(){}};function Tu(i){return i=i.status,i==="fulfilled"||i==="rejected"}function qa(){}function Bo(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(qa,qa),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i===Lo?Error(R(483)):i;default:if(typeof s.status=="string")s.then(qa,qa);else{if(i=tr,i!==null&&100<i.shellSuspendCounter)throw Error(R(482));i=s,i.status="pending",i.then(function(p){if(s.status==="pending"){var b=s;b.status="fulfilled",b.value=p}},function(p){if(s.status==="pending"){var b=s;b.status="rejected",b.reason=p}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i===Lo?Error(R(483)):i}throw vl=s,Lo}}var vl=null;function Sh(){if(vl===null)throw Error(R(459));var i=vl;return vl=null,i}var Oo=null,xl=0;function xc(i){var s=xl;return xl+=1,Oo===null&&(Oo=[]),Bo(Oo,i,s)}function bl(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Ha(i,s){throw s.$$typeof===G?Error(R(525)):(i=Object.prototype.toString.call(s),Error(R(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Fo(i){var s=i._init;return s(i._payload)}function ar(i){function s(De,Me){if(i){var Fe=De.deletions;Fe===null?(De.deletions=[Me],De.flags|=16):Fe.push(Me)}}function c(De,Me){if(!i)return null;for(;Me!==null;)s(De,Me),Me=Me.sibling;return null}function p(De){for(var Me=new Map;De!==null;)De.key!==null?Me.set(De.key,De):Me.set(De.index,De),De=De.sibling;return Me}function b(De,Me){return De=jl(De,Me),De.index=0,De.sibling=null,De}function C(De,Me,Fe){return De.index=Fe,i?(Fe=De.alternate,Fe!==null?(Fe=Fe.index,Fe<Me?(De.flags|=33554434,Me):Fe):(De.flags|=33554434,Me)):(De.flags|=1048576,Me)}function V(De){return i&&De.alternate===null&&(De.flags|=33554434),De}function K(De,Me,Fe,it){return Me===null||Me.tag!==6?(Me=Dd(Fe,De.mode,it),Me.return=De,Me):(Me=b(Me,Fe),Me.return=De,Me)}function he(De,Me,Fe,it){var Bt=Fe.type;return Bt===ce?Qe(De,Me,Fe.props.children,it,Fe.key):Me!==null&&(Me.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===St&&Fo(Bt)===Me.type)?(Me=b(Me,Fe.props),bl(Me,Fe),Me.return=De,Me):(Me=Nh(Fe.type,Fe.key,Fe.props,null,De.mode,it),bl(Me,Fe),Me.return=De,Me)}function Te(De,Me,Fe,it){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Fe.containerInfo||Me.stateNode.implementation!==Fe.implementation?(Me=Fc(Fe,De.mode,it),Me.return=De,Me):(Me=b(Me,Fe.children||[]),Me.return=De,Me)}function Qe(De,Me,Fe,it,Bt){return Me===null||Me.tag!==7?(Me=Nl(Fe,De.mode,it,Bt),Me.return=De,Me):(Me=b(Me,Fe),Me.return=De,Me)}function ht(De,Me,Fe){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=Dd(""+Me,De.mode,Fe),Me.return=De,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case z:return Fe=Nh(Me.type,Me.key,Me.props,null,De.mode,Fe),bl(Fe,Me),Fe.return=De,Fe;case u:return Me=Fc(Me,De.mode,Fe),Me.return=De,Me;case St:var it=Me._init;return Me=it(Me._payload),ht(De,Me,Fe)}if(Lt(Me)||ut(Me))return Me=Nl(Me,De.mode,Fe,null),Me.return=De,Me;if(typeof Me.then=="function")return ht(De,xc(Me),Fe);if(Me.$$typeof===oe)return ht(De,Mf(De,Me),Fe);Ha(De,Me)}return null}function Ue(De,Me,Fe,it){var Bt=Me!==null?Me.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return Bt!==null?null:K(De,Me,""+Fe,it);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case z:return Fe.key===Bt?he(De,Me,Fe,it):null;case u:return Fe.key===Bt?Te(De,Me,Fe,it):null;case St:return Bt=Fe._init,Fe=Bt(Fe._payload),Ue(De,Me,Fe,it)}if(Lt(Fe)||ut(Fe))return Bt!==null?null:Qe(De,Me,Fe,it,null);if(typeof Fe.then=="function")return Ue(De,Me,xc(Fe),it);if(Fe.$$typeof===oe)return Ue(De,Me,Mf(De,Fe),it);Ha(De,Fe)}return null}function Ye(De,Me,Fe,it,Bt){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return De=De.get(Fe)||null,K(Me,De,""+it,Bt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case z:return De=De.get(it.key===null?Fe:it.key)||null,he(Me,De,it,Bt);case u:return De=De.get(it.key===null?Fe:it.key)||null,Te(Me,De,it,Bt);case St:var _i=it._init;return it=_i(it._payload),Ye(De,Me,Fe,it,Bt)}if(Lt(it)||ut(it))return De=De.get(Fe)||null,Qe(Me,De,it,Bt,null);if(typeof it.then=="function")return Ye(De,Me,Fe,xc(it),Bt);if(it.$$typeof===oe)return Ye(De,Me,Fe,Mf(Me,it),Bt);Ha(Me,it)}return null}function qt(De,Me,Fe,it){for(var Bt=null,_i=null,Kt=Me,ri=Me=0,kn=null;Kt!==null&&ri<Fe.length;ri++){Kt.index>ri?(kn=Kt,Kt=null):kn=Kt.sibling;var si=Ue(De,Kt,Fe[ri],it);if(si===null){Kt===null&&(Kt=kn);break}i&&Kt&&si.alternate===null&&s(De,Kt),Me=C(si,Me,ri),_i===null?Bt=si:_i.sibling=si,_i=si,Kt=kn}if(ri===Fe.length)return c(De,Kt),Qt&&Is(De,ri),Bt;if(Kt===null){for(;ri<Fe.length;ri++)Kt=ht(De,Fe[ri],it),Kt!==null&&(Me=C(Kt,Me,ri),_i===null?Bt=Kt:_i.sibling=Kt,_i=Kt);return Qt&&Is(De,ri),Bt}for(Kt=p(Kt);ri<Fe.length;ri++)kn=Ye(Kt,De,ri,Fe[ri],it),kn!==null&&(i&&kn.alternate!==null&&Kt.delete(kn.key===null?ri:kn.key),Me=C(kn,Me,ri),_i===null?Bt=kn:_i.sibling=kn,_i=kn);return i&&Kt.forEach(function(mn){return s(De,mn)}),Qt&&Is(De,ri),Bt}function ui(De,Me,Fe,it){if(Fe==null)throw Error(R(151));for(var Bt=null,_i=null,Kt=Me,ri=Me=0,kn=null,si=Fe.next();Kt!==null&&!si.done;ri++,si=Fe.next()){Kt.index>ri?(kn=Kt,Kt=null):kn=Kt.sibling;var mn=Ue(De,Kt,si.value,it);if(mn===null){Kt===null&&(Kt=kn);break}i&&Kt&&mn.alternate===null&&s(De,Kt),Me=C(mn,Me,ri),_i===null?Bt=mn:_i.sibling=mn,_i=mn,Kt=kn}if(si.done)return c(De,Kt),Qt&&Is(De,ri),Bt;if(Kt===null){for(;!si.done;ri++,si=Fe.next())si=ht(De,si.value,it),si!==null&&(Me=C(si,Me,ri),_i===null?Bt=si:_i.sibling=si,_i=si);return Qt&&Is(De,ri),Bt}for(Kt=p(Kt);!si.done;ri++,si=Fe.next())si=Ye(Kt,De,ri,si.value,it),si!==null&&(i&&si.alternate!==null&&Kt.delete(si.key===null?ri:si.key),Me=C(si,Me,ri),_i===null?Bt=si:_i.sibling=si,_i=si);return i&&Kt.forEach(function(qc){return s(De,qc)}),Qt&&Is(De,ri),Bt}function Hr(De,Me,Fe,it){if(typeof Fe=="object"&&Fe!==null&&Fe.type===ce&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case z:e:{for(var Bt=Fe.key;Me!==null;){if(Me.key===Bt){if(Bt=Fe.type,Bt===ce){if(Me.tag===7){c(De,Me.sibling),it=b(Me,Fe.props.children),it.return=De,De=it;break e}}else if(Me.elementType===Bt||typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===St&&Fo(Bt)===Me.type){c(De,Me.sibling),it=b(Me,Fe.props),bl(it,Fe),it.return=De,De=it;break e}c(De,Me);break}else s(De,Me);Me=Me.sibling}Fe.type===ce?(it=Nl(Fe.props.children,De.mode,it,Fe.key),it.return=De,De=it):(it=Nh(Fe.type,Fe.key,Fe.props,null,De.mode,it),bl(it,Fe),it.return=De,De=it)}return V(De);case u:e:{for(Bt=Fe.key;Me!==null;){if(Me.key===Bt)if(Me.tag===4&&Me.stateNode.containerInfo===Fe.containerInfo&&Me.stateNode.implementation===Fe.implementation){c(De,Me.sibling),it=b(Me,Fe.children||[]),it.return=De,De=it;break e}else{c(De,Me);break}else s(De,Me);Me=Me.sibling}it=Fc(Fe,De.mode,it),it.return=De,De=it}return V(De);case St:return Bt=Fe._init,Fe=Bt(Fe._payload),Hr(De,Me,Fe,it)}if(Lt(Fe))return qt(De,Me,Fe,it);if(ut(Fe)){if(Bt=ut(Fe),typeof Bt!="function")throw Error(R(150));return Fe=Bt.call(Fe),ui(De,Me,Fe,it)}if(typeof Fe.then=="function")return Hr(De,Me,xc(Fe),it);if(Fe.$$typeof===oe)return Hr(De,Me,Mf(De,Fe),it);Ha(De,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint"?(Fe=""+Fe,Me!==null&&Me.tag===6?(c(De,Me.sibling),it=b(Me,Fe),it.return=De,De=it):(c(De,Me),it=Dd(Fe,De.mode,it),it.return=De,De=it),V(De)):c(De,Me)}return function(De,Me,Fe,it){try{xl=0;var Bt=Hr(De,Me,Fe,it);return Oo=null,Bt}catch(Kt){if(Kt===Lo)throw Kt;var _i=ra(29,Kt,null,De.mode);return _i.lanes=it,_i.return=De,_i}finally{}}}var Ur=ar(!0),Mu=ar(!1),Un=hi(null),Ls=hi(0);function wl(i,s){i=yo,Ci(Ls,i),Ci(Un,s),yo=i|s.baseLanes}function Cu(){Ci(Ls,yo),Ci(Un,Un.current)}function bc(){yo=Ls.current,vi(Un),vi(Ls)}var Ma=hi(null),ma=null;function Ca(i){var s=i.alternate;Ci(Lr,Lr.current&1),Ci(Ma,i),ma===null&&(s===null||Un.current!==null||s.memoizedState!==null)&&(ma=i)}function Wn(i){if(i.tag===22){if(Ci(Lr,Lr.current),Ci(Ma,i),ma===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(ma=i)}}else bt()}function bt(){Ci(Lr,Lr.current),Ci(Ma,Ma.current)}function Qn(i){vi(Ma),ma===i&&(ma=null),vi(Lr)}var Lr=hi(0);function wc(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var io=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,p){i.push(p)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},Sc=y.unstable_scheduleCallback,Eu=y.unstable_NormalPriority,Gt={$$typeof:oe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sl(){return{controller:new io,data:new Map,refCount:0}}function Tl(i){i.refCount--,i.refCount===0&&Sc(Eu,function(){i.controller.abort()})}var ro=null,Au=0,no=0,ao=null;function Th(i,s){if(ro===null){var c=ro=[];Au=0,no=$d(),ao={status:"pending",value:void 0,then:function(p){c.push(p)}}}return Au++,s.then(zu,zu),s}function zu(){if(--Au===0&&ro!==null){ao!==null&&(ao.status="fulfilled");var i=ro;ro=null,no=0,ao=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function md(i,s){var c=[],p={status:"pending",value:null,reason:null,then:function(b){c.push(b)}};return i.then(function(){p.status="fulfilled",p.value=s;for(var b=0;b<c.length;b++)(0,c[b])(s)},function(b){for(p.status="rejected",p.reason=b,b=0;b<c.length;b++)(0,c[b])(void 0)}),p}var Pu=lt.S;lt.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&Th(i,s),Pu!==null&&Pu(i,s)};var so=hi(null);function Ru(){var i=so.current;return i!==null?i:tr.pooledCache}function Xa(i,s){s===null?Ci(so,so.current):Ci(so,s.pool)}function Ki(){var i=Ru();return i===null?null:{parent:Gt._currentValue,pool:i}}var Ea=0,ci=null,Ri=null,Er=null,oo=!1,Ml=!1,ln=!1,jo=0,It=0,Ft=null,Tc=0;function sr(){throw Error(R(321))}function Mc(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!ha(i[c],s[c]))return!1;return!0}function Pn(i,s,c,p,b,C){return Ea=C,ci=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,lt.H=i===null||i.memoizedState===null?er:or,ln=!1,C=c(p,b),ln=!1,Ml&&(C=Ya(s,c,p,b)),Mh(i),C}function Mh(i){lt.H=Zi;var s=Ri!==null&&Ri.next!==null;if(Ea=0,Er=Ri=ci=null,oo=!1,It=0,Ft=null,s)throw Error(R(300));i===null||en||(i=i.dependencies,i!==null&&ta(i)&&(en=!0))}function Ya(i,s,c,p){ci=i;var b=0;do{if(Ml&&(Ft=null),It=0,Ml=!1,25<=b)throw Error(R(301));if(b+=1,Er=Ri=null,i.updateQueue!=null){var C=i.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}lt.H=Jn,C=s(c,p)}while(Ml);return C}function gd(){var i=lt.H,s=i.useState()[0];return s=typeof s.then=="function"?Uo(s):s,i=i.useState()[0],(Ri!==null?Ri.memoizedState:null)!==i&&(ci.flags|=1024),s}function Aa(){var i=jo!==0;return jo=0,i}function Qi(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function pr(i){if(oo){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}oo=!1}Ea=0,Er=Ri=ci=null,Ml=!1,It=jo=0,Ft=null}function Vn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?ci.memoizedState=Er=i:Er=Er.next=i,Er}function Ji(){if(Ri===null){var i=ci.alternate;i=i!==null?i.memoizedState:null}else i=Ri.next;var s=Er===null?ci.memoizedState:Er.next;if(s!==null)Er=s,Ri=i;else{if(i===null)throw ci.alternate===null?Error(R(467)):Error(R(310));Ri=i,i={memoizedState:Ri.memoizedState,baseState:Ri.baseState,baseQueue:Ri.baseQueue,queue:Ri.queue,next:null},Er===null?ci.memoizedState=Er=i:Er=Er.next=i}return Er}var No;No=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Uo(i){var s=It;return It+=1,Ft===null&&(Ft=[]),i=Bo(Ft,i,s),s=ci,(Er===null?s.memoizedState:Er.next)===null&&(s=s.alternate,lt.H=s===null||s.memoizedState===null?er:or),i}function za(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Uo(i);if(i.$$typeof===oe)return Rn(i)}throw Error(R(438,String(i)))}function Cl(i){var s=null,c=ci.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var p=ci.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(s={data:p.data.map(function(b){return b.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=No(),ci.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),p=0;p<i;p++)c[p]=at;return s.index++,c}function Zn(i,s){return typeof s=="function"?s(i):s}function Vo(i){var s=Ji();return Zo(s,Ri,i)}function Zo(i,s,c){var p=i.queue;if(p===null)throw Error(R(311));p.lastRenderedReducer=c;var b=i.baseQueue,C=p.pending;if(C!==null){if(b!==null){var V=b.next;b.next=C.next,C.next=V}s.baseQueue=b=C,p.pending=null}if(C=i.baseState,b===null)i.memoizedState=C;else{s=b.next;var K=V=null,he=null,Te=s,Qe=!1;do{var ht=Te.lane&-536870913;if(ht!==Te.lane?(Si&ht)===ht:(Ea&ht)===ht){var Ue=Te.revertLane;if(Ue===0)he!==null&&(he=he.next={lane:0,revertLane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),ht===no&&(Qe=!0);else if((Ea&Ue)===Ue){Te=Te.next,Ue===no&&(Qe=!0);continue}else ht={lane:0,revertLane:Te.revertLane,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null},he===null?(K=he=ht,V=C):he=he.next=ht,ci.lanes|=Ue,Ul|=Ue;ht=Te.action,ln&&c(C,ht),C=Te.hasEagerState?Te.eagerState:c(C,ht)}else Ue={lane:ht,revertLane:Te.revertLane,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null},he===null?(K=he=Ue,V=C):he=he.next=Ue,ci.lanes|=ht,Ul|=ht;Te=Te.next}while(Te!==null&&Te!==s);if(he===null?V=C:he.next=K,!ha(C,i.memoizedState)&&(en=!0,Qe&&(c=ao,c!==null)))throw c;i.memoizedState=C,i.baseState=V,i.baseQueue=he,p.lastRenderedState=C}return b===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Cc(i){var s=Ji(),c=s.queue;if(c===null)throw Error(R(311));c.lastRenderedReducer=i;var p=c.dispatch,b=c.pending,C=s.memoizedState;if(b!==null){c.pending=null;var V=b=b.next;do C=i(C,V.action),V=V.next;while(V!==b);ha(C,s.memoizedState)||(en=!0),s.memoizedState=C,s.baseQueue===null&&(s.baseState=C),c.lastRenderedState=C}return[C,p]}function Go(i,s,c){var p=ci,b=Ji(),C=Qt;if(C){if(c===void 0)throw Error(R(407));c=c()}else c=s();var V=!ha((Ri||b).memoizedState,c);if(V&&(b.memoizedState=c,en=!0),b=b.queue,ee(Ec.bind(null,p,b,i),[i]),b.getSnapshot!==s||V||Er!==null&&Er.memoizedState.tag&1){if(p.flags|=2048,O(9,Du.bind(null,p,b,c,s),{destroy:void 0},null),tr===null)throw Error(R(349));C||(Ea&60)!==0||lo(p,s,c)}return c}function lo(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=ci.updateQueue,s===null?(s=No(),ci.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function Du(i,s,c,p){s.value=c,s.getSnapshot=p,co(s)&&Ac(i)}function Ec(i,s,c){return c(function(){co(s)&&Ac(i)})}function co(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!ha(i,c)}catch{return!0}}function Ac(i){var s=hs(i,2);s!==null&&En(s,i,2)}function zc(i){var s=Vn();if(typeof i=="function"){var c=i;if(i=c(),ln){L(!0);try{c()}finally{L(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:i},s}function Pc(i,s,c,p){return i.baseState=c,Zo(i,Ri,typeof p=="function"?p:Zn)}function Iu(i,s,c,p,b){if(bi(i))throw Error(R(485));if(i=s.action,i!==null){var C={payload:b,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(V){C.listeners.push(V)}};lt.T!==null?c(!0):C.isTransition=!1,p(C),c=s.pending,c===null?(C.next=s.pending=C,d(s,C)):(C.next=c.next,s.pending=c.next=C)}}function d(i,s){var c=s.action,p=s.payload,b=i.state;if(s.isTransition){var C=lt.T,V={};lt.T=V;try{var K=c(b,p),he=lt.S;he!==null&&he(V,K),e(i,s,K)}catch(Te){l(i,s,Te)}finally{lt.T=C}}else try{C=c(b,p),e(i,s,C)}catch(Te){l(i,s,Te)}}function e(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(p){r(i,s,p)},function(p){return l(i,s,p)}):r(i,s,c)}function r(i,s,c){s.status="fulfilled",s.value=c,h(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,d(i,c)))}function l(i,s,c){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do s.status="rejected",s.reason=c,h(s),s=s.next;while(s!==p)}i.action=null}function h(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function m(i,s){return s}function v(i,s){if(Qt){var c=tr.formState;if(c!==null){e:{var p=ci;if(Qt){if(Ir){t:{for(var b=Ir,C=kr;b.nodeType!==8;){if(!C){b=null;break t}if(b=ys(b.nextSibling),b===null){b=null;break t}}C=b.data,b=C==="F!"||C==="F"?b:null}if(b){Ir=ys(b.nextSibling),p=b.data==="F!";break e}}ks(p)}p=!1}p&&(s=c[0])}}return c=Vn(),c.memoizedState=c.baseState=s,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:s},c.queue=p,c=Di.bind(null,ci,p),p.dispatch=c,p=zc(!1),C=Fi.bind(null,ci,!1,p.queue),p=Vn(),b={state:s,dispatch:null,action:i,pending:null},p.queue=b,c=Iu.bind(null,ci,b,C,c),b.dispatch=c,p.memoizedState=i,[s,c,!1]}function w(i){var s=Ji();return M(s,Ri,i)}function M(i,s,c){s=Zo(i,s,m)[0],i=Vo(Zn)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?Uo(s):s;var p=Ji(),b=p.queue,C=b.dispatch;return c!==p.memoizedState&&(ci.flags|=2048,O(9,A.bind(null,b,c),{destroy:void 0},null)),[s,C,i]}function A(i,s){i.action=s}function k(i){var s=Ji(),c=Ri;if(c!==null)return M(s,c,i);Ji(),s=s.memoizedState,c=Ji();var p=c.queue.dispatch;return c.memoizedState=i,[s,p,!1]}function O(i,s,c,p){return i={tag:i,create:s,inst:c,deps:p,next:null},s=ci.updateQueue,s===null&&(s=No(),ci.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,s.lastEffect=i),i}function F(){return Ji().memoizedState}function $(i,s,c,p){var b=Vn();ci.flags|=i,b.memoizedState=O(1|s,c,{destroy:void 0},p===void 0?null:p)}function q(i,s,c,p){var b=Ji();p=p===void 0?null:p;var C=b.memoizedState.inst;Ri!==null&&p!==null&&Mc(p,Ri.memoizedState.deps)?b.memoizedState=O(s,c,C,p):(ci.flags|=i,b.memoizedState=O(1|s,c,C,p))}function te(i,s){$(8390656,8,i,s)}function ee(i,s){q(2048,8,i,s)}function ie(i,s){return q(4,2,i,s)}function se(i,s){return q(4,4,i,s)}function fe(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function de(i,s,c){c=c!=null?c.concat([i]):null,q(4,4,fe.bind(null,s,i),c)}function pe(){}function ye(i,s){var c=Ji();s=s===void 0?null:s;var p=c.memoizedState;return s!==null&&Mc(s,p[1])?p[0]:(c.memoizedState=[i,s],i)}function ge(i,s){var c=Ji();s=s===void 0?null:s;var p=c.memoizedState;if(s!==null&&Mc(s,p[1]))return p[0];if(p=i(),ln){L(!0);try{i()}finally{L(!1)}}return c.memoizedState=[p,s],p}function Ie(i,s,c){return c===void 0||(Ea&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=Zh(),ci.lanes|=i,Ul|=i,c)}function Be(i,s,c,p){return ha(c,s)?c:Un.current!==null?(i=Ie(i,c,p),ha(i,s)||(en=!0),i):(Ea&42)===0?(en=!0,i.memoizedState=c):(i=Zh(),ci.lanes|=i,Ul|=i,s)}function $e(i,s,c,p,b){var C=wt.p;wt.p=C!==0&&8>C?C:8;var V=lt.T,K={};lt.T=K,Fi(i,!1,s,c);try{var he=b(),Te=lt.S;if(Te!==null&&Te(K,he),he!==null&&typeof he=="object"&&typeof he.then=="function"){var Qe=md(he,p);Li(i,s,Qe,cn(i))}else Li(i,s,p,cn(i))}catch(ht){Li(i,s,{then:function(){},status:"rejected",reason:ht},cn())}finally{wt.p=C,lt.T=V}}function qe(){}function Ze(i,s,c,p){if(i.tag!==5)throw Error(R(476));var b=mt(i).queue;$e(i,b,s,Xt,c===null?qe:function(){return ft(i),c(p)})}function mt(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Xt,baseState:Xt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:Xt},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zn,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function ft(i){var s=mt(i).next.queue;Li(i,s,{},cn())}function et(){return Rn(Y)}function Rt(){return Ji().memoizedState}function Ot(){return Ji().memoizedState}function Mi(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=cn();i=Il(c);var p=go(s,i,c);p!==null&&(En(p,s,c),Dc(p,s,c)),s={cache:Sl()},i.payload=s;return}s=s.return}}function Vi(i,s,c){var p=cn();c={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},bi(i)?Ii(s,c):(c=vu(i,s,c,p),c!==null&&(En(c,i,p),Jr(c,s,p)))}function Di(i,s,c){var p=cn();Li(i,s,c,p)}function Li(i,s,c,p){var b={lane:p,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(bi(i))Ii(s,b);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=s.lastRenderedReducer,C!==null))try{var V=s.lastRenderedState,K=C(V,c);if(b.hasEagerState=!0,b.eagerState=K,ha(K,V))return gc(i,s,b,0),tr===null&&yu(),!1}catch{}finally{}if(c=vu(i,s,b,p),c!==null)return En(c,i,p),Jr(c,s,p),!0}return!1}function Fi(i,s,c,p){if(p={lane:2,revertLane:$d(),action:p,hasEagerState:!1,eagerState:null,next:null},bi(i)){if(s)throw Error(R(479))}else s=vu(i,c,p,2),s!==null&&En(s,i,2)}function bi(i){var s=i.alternate;return i===ci||s!==null&&s===ci}function Ii(i,s){Ml=oo=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function Jr(i,s,c){if((c&4194176)!==0){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,Xe(i,c)}}var Zi={readContext:Rn,use:za,useCallback:sr,useContext:sr,useEffect:sr,useImperativeHandle:sr,useLayoutEffect:sr,useInsertionEffect:sr,useMemo:sr,useReducer:sr,useRef:sr,useState:sr,useDebugValue:sr,useDeferredValue:sr,useTransition:sr,useSyncExternalStore:sr,useId:sr};Zi.useCacheRefresh=sr,Zi.useMemoCache=sr,Zi.useHostTransitionStatus=sr,Zi.useFormState=sr,Zi.useActionState=sr,Zi.useOptimistic=sr;var er={readContext:Rn,use:za,useCallback:function(i,s){return Vn().memoizedState=[i,s===void 0?null:s],i},useContext:Rn,useEffect:te,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,$(4194308,4,fe.bind(null,s,i),c)},useLayoutEffect:function(i,s){return $(4194308,4,i,s)},useInsertionEffect:function(i,s){$(4,2,i,s)},useMemo:function(i,s){var c=Vn();s=s===void 0?null:s;var p=i();if(ln){L(!0);try{i()}finally{L(!1)}}return c.memoizedState=[p,s],p},useReducer:function(i,s,c){var p=Vn();if(c!==void 0){var b=c(s);if(ln){L(!0);try{c(s)}finally{L(!1)}}}else b=s;return p.memoizedState=p.baseState=b,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:b},p.queue=i,i=i.dispatch=Vi.bind(null,ci,i),[p.memoizedState,i]},useRef:function(i){var s=Vn();return i={current:i},s.memoizedState=i},useState:function(i){i=zc(i);var s=i.queue,c=Di.bind(null,ci,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:pe,useDeferredValue:function(i,s){var c=Vn();return Ie(c,i,s)},useTransition:function(){var i=zc(!1);return i=$e.bind(null,ci,i.queue,!0,!1),Vn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var p=ci,b=Vn();if(Qt){if(c===void 0)throw Error(R(407));c=c()}else{if(c=s(),tr===null)throw Error(R(349));(Si&60)!==0||lo(p,s,c)}b.memoizedState=c;var C={value:c,getSnapshot:s};return b.queue=C,te(Ec.bind(null,p,C,i),[i]),p.flags|=2048,O(9,Du.bind(null,p,C,c,s),{destroy:void 0},null),c},useId:function(){var i=Vn(),s=tr.identifierPrefix;if(Qt){var c=Ta,p=pa;c=(p&~(1<<32-X(p)-1)).toString(32)+c,s=":"+s+"R"+c,c=jo++,0<c&&(s+="H"+c.toString(32)),s+=":"}else c=Tc++,s=":"+s+"r"+c.toString(32)+":";return i.memoizedState=s},useCacheRefresh:function(){return Vn().memoizedState=Mi.bind(null,ci)}};er.useMemoCache=Cl,er.useHostTransitionStatus=et,er.useFormState=v,er.useActionState=v,er.useOptimistic=function(i){var s=Vn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Fi.bind(null,ci,!0,c),c.dispatch=s,[i,s]};var or={readContext:Rn,use:za,useCallback:ye,useContext:Rn,useEffect:ee,useImperativeHandle:de,useInsertionEffect:ie,useLayoutEffect:se,useMemo:ge,useReducer:Vo,useRef:F,useState:function(){return Vo(Zn)},useDebugValue:pe,useDeferredValue:function(i,s){var c=Ji();return Be(c,Ri.memoizedState,i,s)},useTransition:function(){var i=Vo(Zn)[0],s=Ji().memoizedState;return[typeof i=="boolean"?i:Uo(i),s]},useSyncExternalStore:Go,useId:Rt};or.useCacheRefresh=Ot,or.useMemoCache=Cl,or.useHostTransitionStatus=et,or.useFormState=w,or.useActionState=w,or.useOptimistic=function(i,s){var c=Ji();return Pc(c,Ri,i,s)};var Jn={readContext:Rn,use:za,useCallback:ye,useContext:Rn,useEffect:ee,useImperativeHandle:de,useInsertionEffect:ie,useLayoutEffect:se,useMemo:ge,useReducer:Cc,useRef:F,useState:function(){return Cc(Zn)},useDebugValue:pe,useDeferredValue:function(i,s){var c=Ji();return Ri===null?Ie(c,i,s):Be(c,Ri.memoizedState,i,s)},useTransition:function(){var i=Cc(Zn)[0],s=Ji().memoizedState;return[typeof i=="boolean"?i:Uo(i),s]},useSyncExternalStore:Go,useId:Rt};Jn.useCacheRefresh=Ot,Jn.useMemoCache=Cl,Jn.useHostTransitionStatus=et,Jn.useFormState=k,Jn.useActionState=k,Jn.useOptimistic=function(i,s){var c=Ji();return Ri!==null?Pc(c,Ri,i,s):(c.baseState=i,[i,c.queue.dispatch])};function Ka(i,s,c,p){s=i.memoizedState,c=c(p,s),c=c==null?s:Q({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var Pa={isMounted:function(i){return(i=i._reactInternals)?kt(i)===i:!1},enqueueSetState:function(i,s,c){i=i._reactInternals;var p=cn(),b=Il(p);b.payload=s,c!=null&&(b.callback=c),s=go(i,b,p),s!==null&&(En(s,i,p),Dc(s,i,p))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var p=cn(),b=Il(p);b.tag=1,b.payload=s,c!=null&&(b.callback=c),s=go(i,b,p),s!==null&&(En(s,i,p),Dc(s,i,p))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=cn(),p=Il(c);p.tag=2,s!=null&&(p.callback=s),s=go(i,p,c),s!==null&&(En(s,i,c),Dc(s,i,c))}};function ga(i,s,c,p,b,C,V){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,C,V):s.prototype&&s.prototype.isPureReactComponent?!fc(c,p)||!fc(b,C):!0}function uo(i,s,c,p){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,p),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,p),s.state!==i&&Pa.enqueueReplaceState(s,s.state,null)}function Wa(i,s){var c=s;if("ref"in s){c={};for(var p in s)p!=="ref"&&(c[p]=s[p])}if(i=i.defaultProps){c===s&&(c=Q({},c));for(var b in i)c[b]===void 0&&(c[b]=i[b])}return c}var ms=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function _a(i){ms(i)}function Qa(i){console.error(i)}function Ra(i){ms(i)}function ya(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(p){setTimeout(function(){throw p})}}function ji(i,s,c){try{var p=i.onCaughtError;p(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function ki(i,s,c){return c=Il(c),c.tag=3,c.payload={element:null},c.callback=function(){ya(i,s)},c}function Vr(i){return i=Il(i),i.tag=3,i}function Zr(i,s,c,p){var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var C=p.value;i.payload=function(){return b(C)},i.callback=function(){ji(s,c,p)}}var V=c.stateNode;V!==null&&typeof V.componentDidCatch=="function"&&(i.callback=function(){ji(s,c,p),typeof b!="function"&&(Vl===null?Vl=new Set([this]):Vl.add(this));var K=p.stack;this.componentDidCatch(p.value,{componentStack:K!==null?K:""})})}function $o(i,s,c,p,b){if(c.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(s=c.alternate,s!==null&&qo(s,c,b,!0),c=Ma.current,c!==null){switch(c.tag){case 13:return ma===null?qh():c.alternate===null&&Gr===0&&(Gr=3),c.flags&=-257,c.flags|=65536,c.lanes=b,p===Su?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([p]):s.add(p),Ud(i,p,b)),!1;case 22:return c.flags|=65536,p===Su?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([p])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([p]):c.add(p)),Ud(i,p,b)),!1}throw Error(R(435,c.tag))}return Ud(i,p,b),qh(),!1}if(Qt)return s=Ma.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=b,p!==vc&&(i=Error(R(422),{cause:p}),yl(da(i,c)))):(p!==vc&&(s=Error(R(423),{cause:p}),yl(da(s,c))),i=i.current.alternate,i.flags|=65536,b&=-b,i.lanes|=b,p=da(p,c),b=ki(i.stateNode,p,b),Cf(i,b),Gr!==4&&(Gr=2)),!1;var C=Error(R(520),{cause:p});if(C=da(C,c),yr===null?yr=[C]:yr.push(C),Gr!==4&&(Gr=2),s===null)return!0;p=da(p,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=b&-b,c.lanes|=i,i=ki(c.stateNode,p,i),Cf(c,i),!1;case 1:if(s=c.type,C=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Vl===null||!Vl.has(C))))return c.flags|=65536,b&=-b,c.lanes|=b,b=Vr(b),Zr(b,i,c,p),Cf(c,b),!1}c=c.return}while(c!==null);return!1}var xf=Error(R(461)),en=!1;function tn(i,s,c,p){s.child=i===null?Mu(s,null,c,p):Ur(s,i.child,c,p)}function Ch(i,s,c,p,b){c=c.render;var C=s.ref;if("ref"in p){var V={};for(var K in p)K!=="ref"&&(V[K]=p[K])}else V=p;return Rl(s),p=Pn(i,s,c,V,C,b),K=Aa(),i!==null&&!en?(Qi(i,s,b),po(i,s,b)):(Qt&&K&&eo(s),s.flags|=1,tn(i,s,p,b),s.child)}function ho(i,s,c,p,b){if(i===null){var C=c.type;return typeof C=="function"&&!jh(C)&&C.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=C,ea(i,s,C,p,b)):(i=Nh(c.type,null,p,s,s.mode,b),i.ref=s.ref,i.return=s,s.child=i)}if(C=i.child,!wf(i,b)){var V=C.memoizedProps;if(c=c.compare,c=c!==null?c:fc,c(V,p)&&i.ref===s.ref)return po(i,s,b)}return s.flags|=1,i=jl(C,p),i.ref=s.ref,i.return=s,s.child=i}function ea(i,s,c,p,b){if(i!==null){var C=i.memoizedProps;if(fc(C,p)&&i.ref===s.ref)if(en=!1,s.pendingProps=p=C,wf(i,b))(i.flags&131072)!==0&&(en=!0);else return s.lanes=i.lanes,po(i,s,b)}return El(i,s,c,p,b)}function ku(i,s,c){var p=s.pendingProps,b=p.children,C=(s.stateNode._pendingVisibility&2)!==0,V=i!==null?i.memoizedState:null;if(fo(i,s),p.mode==="hidden"||C){if((s.flags&128)!==0){if(p=V!==null?V.baseLanes|c:c,i!==null){for(b=s.child=i.child,C=0;b!==null;)C=C|b.lanes|b.childLanes,b=b.sibling;s.childLanes=C&~p}else s.childLanes=0,s.child=null;return Eh(i,s,p,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Xa(s,V!==null?V.cachePool:null),V!==null?wl(s,V):Cu(),Wn(s);else return s.lanes=s.childLanes=536870912,Eh(i,s,V!==null?V.baseLanes|c:c,c)}else V!==null?(Xa(s,V.cachePool),wl(s,V),bt(),s.memoizedState=null):(i!==null&&Xa(s,null),Cu(),bt());return tn(i,s,b,c),s.child}function Eh(i,s,c,p){var b=Ru();return b=b===null?null:{parent:Gt._currentValue,pool:b},s.memoizedState={baseLanes:c,cachePool:b},i!==null&&Xa(s,null),Cu(),Wn(s),i!==null&&qo(i,s,p,!0),null}function fo(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=2097664);else{if(typeof c!="function"&&typeof c!="object")throw Error(R(284));(i===null||i.ref!==c)&&(s.flags|=2097664)}}function El(i,s,c,p,b){return Rl(s),c=Pn(i,s,c,p,void 0,b),p=Aa(),i!==null&&!en?(Qi(i,s,b),po(i,s,b)):(Qt&&p&&eo(s),s.flags|=1,tn(i,s,c,b),s.child)}function Ah(i,s,c,p,b,C){return Rl(s),s.updateQueue=null,c=Ya(s,p,c,b),Mh(i),p=Aa(),i!==null&&!en?(Qi(i,s,C),po(i,s,C)):(Qt&&p&&eo(s),s.flags|=1,tn(i,s,c,C),s.child)}function Rc(i,s,c,p,b){if(Rl(s),s.stateNode===null){var C=Ps,V=c.contextType;typeof V=="object"&&V!==null&&(C=Rn(V)),C=new c(p,C),s.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=Pa,s.stateNode=C,C._reactInternals=s,C=s.stateNode,C.props=p,C.state=s.memoizedState,C.refs={},bd(s),V=c.contextType,C.context=typeof V=="object"&&V!==null?Rn(V):Ps,C.state=s.memoizedState,V=c.getDerivedStateFromProps,typeof V=="function"&&(Ka(s,c,V,p),C.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(V=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),V!==C.state&&Pa.enqueueReplaceState(C,C.state,null),Ih(s,p,C,b),Xo(),C.state=s.memoizedState),typeof C.componentDidMount=="function"&&(s.flags|=4194308),p=!0}else if(i===null){C=s.stateNode;var K=s.memoizedProps,he=Wa(c,K);C.props=he;var Te=C.context,Qe=c.contextType;V=Ps,typeof Qe=="object"&&Qe!==null&&(V=Rn(Qe));var ht=c.getDerivedStateFromProps;Qe=typeof ht=="function"||typeof C.getSnapshotBeforeUpdate=="function",K=s.pendingProps!==K,Qe||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(K||Te!==V)&&uo(s,C,p,V),Dl=!1;var Ue=s.memoizedState;C.state=Ue,Ih(s,p,C,b),Xo(),Te=s.memoizedState,K||Ue!==Te||Dl?(typeof ht=="function"&&(Ka(s,c,ht,p),Te=s.memoizedState),(he=Dl||ga(s,c,he,p,Ue,Te,V))?(Qe||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(s.flags|=4194308)):(typeof C.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=p,s.memoizedState=Te),C.props=p,C.state=Te,C.context=V,p=he):(typeof C.componentDidMount=="function"&&(s.flags|=4194308),p=!1)}else{C=s.stateNode,wd(i,s),V=s.memoizedProps,Qe=Wa(c,V),C.props=Qe,ht=s.pendingProps,Ue=C.context,Te=c.contextType,he=Ps,typeof Te=="object"&&Te!==null&&(he=Rn(Te)),K=c.getDerivedStateFromProps,(Te=typeof K=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(V!==ht||Ue!==he)&&uo(s,C,p,he),Dl=!1,Ue=s.memoizedState,C.state=Ue,Ih(s,p,C,b),Xo();var Ye=s.memoizedState;V!==ht||Ue!==Ye||Dl||i!==null&&i.dependencies!==null&&ta(i.dependencies)?(typeof K=="function"&&(Ka(s,c,K,p),Ye=s.memoizedState),(Qe=Dl||ga(s,c,Qe,p,Ue,Ye,he)||i!==null&&i.dependencies!==null&&ta(i.dependencies))?(Te||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,Ye,he),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,Ye,he)),typeof C.componentDidUpdate=="function"&&(s.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof C.componentDidUpdate!="function"||V===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=1024),s.memoizedProps=p,s.memoizedState=Ye),C.props=p,C.state=Ye,C.context=he,p=Qe):(typeof C.componentDidUpdate!="function"||V===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||V===i.memoizedProps&&Ue===i.memoizedState||(s.flags|=1024),p=!1)}return C=p,fo(i,s),p=(s.flags&128)!==0,C||p?(C=s.stateNode,c=p&&typeof c.getDerivedStateFromError!="function"?null:C.render(),s.flags|=1,i!==null&&p?(s.child=Ur(s,i.child,null,b),s.child=Ur(s,null,c,b)):tn(i,s,c,b),s.memoizedState=C.state,i=s.child):i=po(i,s,b),i}function zp(i,s,c,p){return ps(),s.flags|=256,tn(i,s,c,p),s.child}var zh={dehydrated:null,treeContext:null,retryLane:0};function _d(i){return{baseLanes:i,cachePool:Ki()}}function Ph(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=Ia),i}function yd(i,s,c){var p=s.pendingProps,b=!1,C=(s.flags&128)!==0,V;if((V=C)||(V=i!==null&&i.memoizedState===null?!1:(Lr.current&2)!==0),V&&(b=!0,s.flags&=-129),V=(s.flags&32)!==0,s.flags&=-33,i===null){if(Qt){if(b?Ca(s):bt(),Qt){var K=Ir,he;if(he=K){e:{for(he=K,K=kr;he.nodeType!==8;){if(!K){K=null;break e}if(he=ys(he.nextSibling),he===null){K=null;break e}}K=he}K!==null?(s.memoizedState={dehydrated:K,treeContext:Js!==null?{id:pa,overflow:Ta}:null,retryLane:536870912},he=ra(18,null,null,0),he.stateNode=K,he.return=s,s.child=he,Tn=s,Ir=null,he=!0):he=!1}he||ks(s)}if(K=s.memoizedState,K!==null&&(K=K.dehydrated,K!==null))return K.data==="$!"?s.lanes=16:s.lanes=536870912,null;Qn(s)}return K=p.children,p=p.fallback,b?(bt(),b=s.mode,K=Al({mode:"hidden",children:K},b),p=Nl(p,b,c,null),K.return=s,p.return=s,K.sibling=p,s.child=K,b=s.child,b.memoizedState=_d(c),b.childLanes=Ph(i,V,c),s.memoizedState=zh,p):(Ca(s),bf(s,K))}if(he=i.memoizedState,he!==null&&(K=he.dehydrated,K!==null)){if(C)s.flags&256?(Ca(s),s.flags&=-257,s=vd(i,s,c)):s.memoizedState!==null?(bt(),s.child=i.child,s.flags|=128,s=null):(bt(),b=p.fallback,K=s.mode,p=Al({mode:"visible",children:p.children},K),b=Nl(b,K,c,null),b.flags|=2,p.return=s,b.return=s,p.sibling=b,s.child=p,Ur(s,i.child,null,c),p=s.child,p.memoizedState=_d(c),p.childLanes=Ph(i,V,c),s.memoizedState=zh,s=b);else if(Ca(s),K.data==="$!"){if(V=K.nextSibling&&K.nextSibling.dataset,V)var Te=V.dgst;V=Te,p=Error(R(419)),p.stack="",p.digest=V,yl({value:p,source:null,stack:null}),s=vd(i,s,c)}else if(en||qo(i,s,c,!1),V=(c&i.childLanes)!==0,en||V){if(V=tr,V!==null){if(p=c&-c,(p&42)!==0)p=1;else switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=64;break;case 268435456:p=134217728;break;default:p=0}if(p=(p&(V.suspendedLanes|c))!==0?0:p,p!==0&&p!==he.retryLane)throw he.retryLane=p,hs(i,p),En(V,i,p),xf}K.data==="$?"||qh(),s=vd(i,s,c)}else K.data==="$?"?(s.flags|=128,s.child=i.child,s=jm.bind(null,i),K._reactRetry=s,s=null):(i=he.treeContext,Ir=ys(K.nextSibling),Tn=s,Qt=!0,Mn=null,kr=!1,i!==null&&(Nn[Sa++]=pa,Nn[Sa++]=Ta,Nn[Sa++]=Js,pa=i.id,Ta=i.overflow,Js=s),s=bf(s,p.children),s.flags|=4096);return s}return b?(bt(),b=p.fallback,K=s.mode,he=i.child,Te=he.sibling,p=jl(he,{mode:"hidden",children:p.children}),p.subtreeFlags=he.subtreeFlags&31457280,Te!==null?b=jl(Te,b):(b=Nl(b,K,c,null),b.flags|=2),b.return=s,p.return=s,p.sibling=b,s.child=p,p=b,b=s.child,K=i.child.memoizedState,K===null?K=_d(c):(he=K.cachePool,he!==null?(Te=Gt._currentValue,he=he.parent!==Te?{parent:Te,pool:Te}:he):he=Ki(),K={baseLanes:K.baseLanes|c,cachePool:he}),b.memoizedState=K,b.childLanes=Ph(i,V,c),s.memoizedState=zh,p):(Ca(s),c=i.child,i=c.sibling,c=jl(c,{mode:"visible",children:p.children}),c.return=s,c.sibling=null,i!==null&&(V=s.deletions,V===null?(s.deletions=[i],s.flags|=16):V.push(i)),s.child=c,s.memoizedState=null,c)}function bf(i,s){return s=Al({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Al(i,s){return jp(i,s,0,null)}function vd(i,s,c){return Ur(s,i.child,null,c),i=bf(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Lu(i,s,c){i.lanes|=s;var p=i.alternate;p!==null&&(p.lanes|=s),Tf(i.return,s,c)}function Bu(i,s,c,p,b){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:b}:(C.isBackwards=s,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=c,C.tailMode=b)}function Rh(i,s,c){var p=s.pendingProps,b=p.revealOrder,C=p.tail;if(tn(i,s,p.children,c),p=Lr.current,(p&2)!==0)p=p&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Lu(i,c,s);else if(i.tag===19)Lu(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(Ci(Lr,p),b){case"forwards":for(c=s.child,b=null;c!==null;)i=c.alternate,i!==null&&wc(i)===null&&(b=c),c=c.sibling;c=b,c===null?(b=s.child,s.child=null):(b=c.sibling,c.sibling=null),Bu(s,!1,b,c,C);break;case"backwards":for(c=null,b=s.child,s.child=null;b!==null;){if(i=b.alternate,i!==null&&wc(i)===null){s.child=b;break}i=b.sibling,b.sibling=c,c=b,b=i}Bu(s,!0,c,null,C);break;case"together":Bu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function po(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Ul|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(qo(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(R(153));if(s.child!==null){for(i=s.child,c=jl(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=jl(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function wf(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&ta(i)))}function Dm(i,s,c){switch(s.tag){case 3:qn(s,s.stateNode.containerInfo),Pl(s,Gt,i.memoizedState.cache),ps();break;case 27:case 5:Sr(s);break;case 4:qn(s,s.stateNode.containerInfo);break;case 10:Pl(s,s.type,s.memoizedProps.value);break;case 13:var p=s.memoizedState;if(p!==null)return p.dehydrated!==null?(Ca(s),s.flags|=128,null):(c&s.child.childLanes)!==0?yd(i,s,c):(Ca(s),i=po(i,s,c),i!==null?i.sibling:null);Ca(s);break;case 19:var b=(i.flags&128)!==0;if(p=(c&s.childLanes)!==0,p||(qo(i,s,c,!1),p=(c&s.childLanes)!==0),b){if(p)return Rh(i,s,c);s.flags|=128}if(b=s.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Ci(Lr,Lr.current),p)break;return null;case 22:case 23:return s.lanes=0,ku(i,s,c);case 24:Pl(s,Gt,i.memoizedState.cache)}return po(i,s,c)}function Pp(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)en=!0;else{if(!wf(i,c)&&(s.flags&128)===0)return en=!1,Dm(i,s,c);en=(i.flags&131072)!==0}else en=!1,Qt&&(s.flags&1048576)!==0&&bu(s,yc,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var p=s.elementType,b=p._init;if(p=b(p._payload),s.type=p,typeof p=="function")jh(p)?(i=Wa(p,i),s.tag=1,s=Rc(null,s,p,i,c)):(s.tag=0,s=El(null,s,p,i,c));else{if(p!=null){if(b=p.$$typeof,b===we){s.tag=11,s=Ch(null,s,p,i,c);break e}else if(b===gt){s.tag=14,s=ho(null,s,p,i,c);break e}}throw s=xt(p)||p,Error(R(306,s,""))}}return s;case 0:return El(i,s,s.type,s.pendingProps,c);case 1:return p=s.type,b=Wa(p,s.pendingProps),Rc(i,s,p,b,c);case 3:e:{if(qn(s,s.stateNode.containerInfo),i===null)throw Error(R(387));var C=s.pendingProps;b=s.memoizedState,p=b.element,wd(i,s),Ih(s,C,null,c);var V=s.memoizedState;if(C=V.cache,Pl(s,Gt,C),C!==b.cache&&Dh(s,[Gt],c,!0),Xo(),C=V.element,b.isDehydrated)if(b={element:C,isDehydrated:!1,cache:V.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=zp(i,s,C,c);break e}else if(C!==p){p=da(Error(R(424)),s),yl(p),s=zp(i,s,C,c);break e}else for(Ir=ys(s.stateNode.containerInfo.firstChild),Tn=s,Qt=!0,Mn=null,kr=!0,c=Mu(s,null,C,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ps(),C===p){s=po(i,s,c);break e}tn(i,s,C,c)}s=s.child}return s;case 26:return fo(i,s),i===null?(c=Jf(s.type,null,s.pendingProps,null))?s.memoizedState=c:Qt||(c=s.type,i=s.pendingProps,p=Kh(zr.current).createElement(c),p[$t]=s,p[Mt]=i,Dn(p,c,i),dr(p),s.stateNode=p):s.memoizedState=Jf(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Sr(s),i===null&&Qt&&(p=s.stateNode=Wf(s.type,s.pendingProps,zr.current),Tn=s,kr=!0,Ir=ys(p.firstChild)),p=s.pendingProps.children,i!==null||Qt?tn(i,s,p,c):s.child=Ur(s,null,p,c),fo(i,s),s.child;case 5:return i===null&&Qt&&((b=p=Ir)&&(p=ql(p,s.type,s.pendingProps,kr),p!==null?(s.stateNode=p,Tn=s,Ir=ys(p.firstChild),kr=!1,b=!0):b=!1),b||ks(s)),Sr(s),b=s.type,C=s.pendingProps,V=i!==null?i.memoizedProps:null,p=C.children,eh(b,C)?p=null:V!==null&&eh(b,V)&&(s.flags|=32),s.memoizedState!==null&&(b=Pn(i,s,gd,null,null,c),Y._currentValue=b),fo(i,s),tn(i,s,p,c),s.child;case 6:return i===null&&Qt&&((i=c=Ir)&&(c=Jd(c,s.pendingProps,kr),c!==null?(s.stateNode=c,Tn=s,Ir=null,i=!0):i=!1),i||ks(s)),null;case 13:return yd(i,s,c);case 4:return qn(s,s.stateNode.containerInfo),p=s.pendingProps,i===null?s.child=Ur(s,null,p,c):tn(i,s,p,c),s.child;case 11:return Ch(i,s,s.type,s.pendingProps,c);case 7:return tn(i,s,s.pendingProps,c),s.child;case 8:return tn(i,s,s.pendingProps.children,c),s.child;case 12:return tn(i,s,s.pendingProps.children,c),s.child;case 10:return p=s.pendingProps,Pl(s,s.type,p.value),tn(i,s,p.children,c),s.child;case 9:return b=s.type._context,p=s.pendingProps.children,Rl(s),b=Rn(b),p=p(b),s.flags|=1,tn(i,s,p,c),s.child;case 14:return ho(i,s,s.type,s.pendingProps,c);case 15:return ea(i,s,s.type,s.pendingProps,c);case 19:return Rh(i,s,c);case 22:return ku(i,s,c);case 24:return Rl(s),p=Rn(Gt),i===null?(b=Ru(),b===null&&(b=tr,C=Sl(),b.pooledCache=C,C.refCount++,C!==null&&(b.pooledCacheLanes|=c),b=C),s.memoizedState={parent:p,cache:b},bd(s),Pl(s,Gt,b)):((i.lanes&c)!==0&&(wd(i,s),Ih(s,null,null,c),Xo()),b=i.memoizedState,C=s.memoizedState,b.parent!==p?(b={parent:p,cache:p},s.memoizedState=b,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=b),Pl(s,Gt,p)):(p=C.cache,Pl(s,Gt,p),p!==b.cache&&Dh(s,[Gt],c,!0))),tn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(R(156,s.tag))}var Sf=hi(null),zl=null,mo=null;function Pl(i,s,c){Ci(Sf,s._currentValue),s._currentValue=c}function Bs(i){i._currentValue=Sf.current,vi(Sf)}function Tf(i,s,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,p!==null&&(p.childLanes|=s)):p!==null&&(p.childLanes&s)!==s&&(p.childLanes|=s),i===c)break;i=i.return}}function Dh(i,s,c,p){var b=i.child;for(b!==null&&(b.return=i);b!==null;){var C=b.dependencies;if(C!==null){var V=b.child;C=C.firstContext;e:for(;C!==null;){var K=C;C=b;for(var he=0;he<s.length;he++)if(K.context===s[he]){C.lanes|=c,K=C.alternate,K!==null&&(K.lanes|=c),Tf(C.return,c,i),p||(V=null);break e}C=K.next}}else if(b.tag===18){if(V=b.return,V===null)throw Error(R(341));V.lanes|=c,C=V.alternate,C!==null&&(C.lanes|=c),Tf(V,c,i),V=null}else V=b.child;if(V!==null)V.return=b;else for(V=b;V!==null;){if(V===i){V=null;break}if(b=V.sibling,b!==null){b.return=V.return,V=b;break}V=V.return}b=V}}function qo(i,s,c,p){i=null;for(var b=s,C=!1;b!==null;){if(!C){if((b.flags&524288)!==0)C=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var V=b.alternate;if(V===null)throw Error(R(387));if(V=V.memoizedProps,V!==null){var K=b.type;ha(b.pendingProps.value,V.value)||(i!==null?i.push(K):i=[K])}}else if(b===Ei.current){if(V=b.alternate,V===null)throw Error(R(387));V.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(i!==null?i.push(Y):i=[Y])}b=b.return}i!==null&&Dh(s,i,c,p),s.flags|=262144}function ta(i){for(i=i.firstContext;i!==null;){if(!ha(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Rl(i){zl=i,mo=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Rn(i){return xd(zl,i)}function Mf(i,s){return zl===null&&Rl(i),xd(i,s)}function xd(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},mo===null){if(i===null)throw Error(R(308));mo=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else mo=mo.next=s;return c}var Dl=!1;function bd(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wd(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Il(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function go(i,s,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,(Ar&2)!==0){var b=p.pending;return b===null?s.next=s:(s.next=b.next,b.next=s),p.pending=s,s=fs(i),_c(i,null,c),s}return gc(i,p,s,c),fs(i)}function Dc(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194176)!==0)){var p=s.lanes;p&=i.pendingLanes,c|=p,s.lanes=c,Xe(i,c)}}function Cf(i,s){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var b=null,C=null;if(c=c.firstBaseUpdate,c!==null){do{var V={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};C===null?b=C=V:C=C.next=V,c=c.next}while(c!==null);C===null?b=C=s:C=C.next=s}else b=C=s;c={baseState:p.baseState,firstBaseUpdate:b,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var Ho=!1;function Xo(){if(Ho){var i=ao;if(i!==null)throw i}}function Ih(i,s,c,p){Ho=!1;var b=i.updateQueue;Dl=!1;var C=b.firstBaseUpdate,V=b.lastBaseUpdate,K=b.shared.pending;if(K!==null){b.shared.pending=null;var he=K,Te=he.next;he.next=null,V===null?C=Te:V.next=Te,V=he;var Qe=i.alternate;Qe!==null&&(Qe=Qe.updateQueue,K=Qe.lastBaseUpdate,K!==V&&(K===null?Qe.firstBaseUpdate=Te:K.next=Te,Qe.lastBaseUpdate=he))}if(C!==null){var ht=b.baseState;V=0,Qe=Te=he=null,K=C;do{var Ue=K.lane&-536870913,Ye=Ue!==K.lane;if(Ye?(Si&Ue)===Ue:(p&Ue)===Ue){Ue!==0&&Ue===no&&(Ho=!0),Qe!==null&&(Qe=Qe.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var qt=i,ui=K;Ue=s;var Hr=c;switch(ui.tag){case 1:if(qt=ui.payload,typeof qt=="function"){ht=qt.call(Hr,ht,Ue);break e}ht=qt;break e;case 3:qt.flags=qt.flags&-65537|128;case 0:if(qt=ui.payload,Ue=typeof qt=="function"?qt.call(Hr,ht,Ue):qt,Ue==null)break e;ht=Q({},ht,Ue);break e;case 2:Dl=!0}}Ue=K.callback,Ue!==null&&(i.flags|=64,Ye&&(i.flags|=8192),Ye=b.callbacks,Ye===null?b.callbacks=[Ue]:Ye.push(Ue))}else Ye={lane:Ue,tag:K.tag,payload:K.payload,callback:K.callback,next:null},Qe===null?(Te=Qe=Ye,he=ht):Qe=Qe.next=Ye,V|=Ue;if(K=K.next,K===null){if(K=b.shared.pending,K===null)break;Ye=K,K=Ye.next,Ye.next=null,b.lastBaseUpdate=Ye,b.shared.pending=null}}while(!0);Qe===null&&(he=ht),b.baseState=he,b.firstBaseUpdate=Te,b.lastBaseUpdate=Qe,C===null&&(b.shared.lanes=0),Ul|=V,i.lanes=V,i.memoizedState=ht}}function Rp(i,s){if(typeof i!="function")throw Error(R(191,i));i.call(s)}function Dp(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Rp(c[i],s)}function kh(i,s){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var b=p.next;c=b;do{if((c.tag&i)===i){p=void 0;var C=c.create,V=c.inst;p=C(),V.destroy=p}c=c.next}while(c!==b)}}catch(K){ir(s,s.return,K)}}function kl(i,s,c){try{var p=s.updateQueue,b=p!==null?p.lastEffect:null;if(b!==null){var C=b.next;p=C;do{if((p.tag&i)===i){var V=p.inst,K=V.destroy;if(K!==void 0){V.destroy=void 0,b=s;var he=c;try{K()}catch(Te){ir(b,he,Te)}}}p=p.next}while(p!==C)}}catch(Te){ir(s,s.return,Te)}}function Ip(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{Dp(s,c)}catch(p){ir(i,i.return,p)}}}function kp(i,s,c){c.props=Wa(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(p){ir(i,s,p)}}function Yo(i,s){try{var c=i.ref;if(c!==null){var p=i.stateNode;switch(i.tag){case 26:case 27:case 5:var b=p;break;default:b=p}typeof c=="function"?i.refCleanup=c(b):c.current=b}}catch(C){ir(i,s,C)}}function Ja(i,s){var c=i.ref,p=i.refCleanup;if(c!==null)if(typeof p=="function")try{p()}catch(b){ir(i,s,b)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(b){ir(i,s,b)}else c.current=null}function Sd(i){var s=i.type,c=i.memoizedProps,p=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&p.focus();break e;case"img":c.src?p.src=c.src:c.srcSet&&(p.srcset=c.srcSet)}}catch(b){ir(i,i.return,b)}}function Ou(i,s,c){try{var p=i.stateNode;Jp(p,i.type,c,s),p[Mt]=s}catch(b){ir(i,i.return,b)}}function Lp(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function mr(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Lp(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Ll(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?c.nodeType===8?c.parentNode.insertBefore(i,s):c.insertBefore(i,s):(c.nodeType===8?(s=c.parentNode,s.insertBefore(i,c)):(s=c,s.appendChild(i)),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=js));else if(p!==4&&p!==27&&(i=i.child,i!==null))for(Ll(i,s,c),i=i.sibling;i!==null;)Ll(i,s,c),i=i.sibling}function Lh(i,s,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(p!==4&&p!==27&&(i=i.child,i!==null))for(Lh(i,s,c),i=i.sibling;i!==null;)Lh(i,s,c),i=i.sibling}var gs=!1,gr=!1,Ic=!1,Td=typeof WeakSet=="function"?WeakSet:Set,Cn=null,Fu=!1;function Md(i,s){if(i=i.containerInfo,Kd=ct,i=yh(i),dl(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var b=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{c.nodeType,C.nodeType}catch{c=null;break e}var V=0,K=-1,he=-1,Te=0,Qe=0,ht=i,Ue=null;t:for(;;){for(var Ye;ht!==c||b!==0&&ht.nodeType!==3||(K=V+b),ht!==C||p!==0&&ht.nodeType!==3||(he=V+p),ht.nodeType===3&&(V+=ht.nodeValue.length),(Ye=ht.firstChild)!==null;)Ue=ht,ht=Ye;for(;;){if(ht===i)break t;if(Ue===c&&++Te===b&&(K=V),Ue===C&&++Qe===p&&(he=V),(Ye=ht.nextSibling)!==null)break;ht=Ue,Ue=ht.parentNode}ht=Ye}c=K===-1||he===-1?null:{start:K,end:he}}else c=null}c=c||{start:0,end:0}}else c=null;for(Wd={focusedElem:i,selectionRange:c},ct=!1,Cn=s;Cn!==null;)if(s=Cn,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,Cn=i;else for(;Cn!==null;){switch(s=Cn,C=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&C!==null){i=void 0,c=s,b=C.memoizedProps,C=C.memoizedState,p=c.stateNode;try{var qt=Wa(c.type,b,c.elementType===c.type);i=p.getSnapshotBeforeUpdate(qt,C),p.__reactInternalSnapshotBeforeUpdate=i}catch(ui){ir(c,c.return,ui)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)un(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":un(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(R(163))}if(i=s.sibling,i!==null){i.return=s.return,Cn=i;break}Cn=s.return}return qt=Fu,Fu=!1,qt}function kc(i,s,c){var p=c.flags;switch(c.tag){case 0:case 11:case 15:Wo(i,c),p&4&&kh(5,c);break;case 1:if(Wo(i,c),p&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(K){ir(c,c.return,K)}else{var b=Wa(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(b,s,i.__reactInternalSnapshotBeforeUpdate)}catch(K){ir(c,c.return,K)}}p&64&&Ip(c),p&512&&Yo(c,c.return);break;case 3:if(Wo(i,c),p&64&&(p=c.updateQueue,p!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Dp(p,i)}catch(K){ir(c,c.return,K)}}break;case 26:Wo(i,c),p&512&&Yo(c,c.return);break;case 27:case 5:Wo(i,c),s===null&&p&4&&Sd(c),p&512&&Yo(c,c.return);break;case 12:Wo(i,c);break;case 13:Wo(i,c),p&4&&Bl(i,c);break;case 22:if(b=c.memoizedState!==null||gs,!b){s=s!==null&&s.memoizedState!==null||gr;var C=gs,V=gr;gs=b,(gr=s)&&!V?Ol(i,c,(c.subtreeFlags&8772)!==0):Wo(i,c),gs=C,gr=V}p&512&&(c.memoizedProps.mode==="manual"?Yo(c,c.return):Ja(c,c.return));break;default:Wo(i,c)}}function Bh(i){var s=i.alternate;s!==null&&(i.alternate=null,Bh(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Pi(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var _r=null,Gn=!1;function Ko(i,s,c){for(c=c.child;c!==null;)Cd(i,s,c),c=c.sibling}function Cd(i,s,c){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(Kr,c)}catch{}switch(c.tag){case 26:gr||Ja(c,s),Ko(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:gr||Ja(c,s);var p=_r,b=Gn;for(_r=c.stateNode,Ko(i,s,c),c=c.stateNode,s=c.attributes;s.length;)c.removeAttributeNode(s[0]);Pi(c),_r=p,Gn=b;break;case 5:gr||Ja(c,s);case 6:b=_r;var C=Gn;if(_r=null,Ko(i,s,c),_r=b,Gn=C,_r!==null)if(Gn)try{i=_r,p=c.stateNode,i.nodeType===8?i.parentNode.removeChild(p):i.removeChild(p)}catch(V){ir(c,s,V)}else try{_r.removeChild(c.stateNode)}catch(V){ir(c,s,V)}break;case 18:_r!==null&&(Gn?(s=_r,c=c.stateNode,s.nodeType===8?$l(s.parentNode,c):s.nodeType===1&&$l(s,c),va(s)):$l(_r,c.stateNode));break;case 4:p=_r,b=Gn,_r=c.stateNode.containerInfo,Gn=!0,Ko(i,s,c),_r=p,Gn=b;break;case 0:case 11:case 14:case 15:gr||kl(2,c,s),gr||kl(4,c,s),Ko(i,s,c);break;case 1:gr||(Ja(c,s),p=c.stateNode,typeof p.componentWillUnmount=="function"&&kp(c,s,p)),Ko(i,s,c);break;case 21:Ko(i,s,c);break;case 22:gr||Ja(c,s),gr=(p=gr)||c.memoizedState!==null,Ko(i,s,c),gr=p;break;default:Ko(i,s,c)}}function Bl(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{va(i)}catch(c){ir(s,s.return,c)}}function Im(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Td),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Td),s;default:throw Error(R(435,i.tag))}}function Ef(i,s){var c=Im(i);s.forEach(function(p){var b=Vd.bind(null,i,p);c.has(p)||(c.add(p),p.then(b,b))})}function ia(i,s){var c=s.deletions;if(c!==null)for(var p=0;p<c.length;p++){var b=c[p],C=i,V=s,K=V;e:for(;K!==null;){switch(K.tag){case 27:case 5:_r=K.stateNode,Gn=!1;break e;case 3:_r=K.stateNode.containerInfo,Gn=!0;break e;case 4:_r=K.stateNode.containerInfo,Gn=!0;break e}K=K.return}if(_r===null)throw Error(R(160));Cd(C,V,b),_r=null,Gn=!1,C=b.alternate,C!==null&&(C.return=null),b.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Ed(s,i),s=s.sibling}var es=null;function Ed(i,s){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ia(s,i),ts(i),p&4&&(kl(3,i,i.return),kh(3,i),kl(5,i,i.return));break;case 1:ia(s,i),ts(i),p&512&&(gr||c===null||Ja(c,c.return)),p&64&&gs&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?p:c.concat(p))));break;case 26:var b=es;if(ia(s,i),ts(i),p&512&&(gr||c===null||Ja(c,c.return)),p&4){var C=c!==null?c.memoizedState:null;if(p=i.memoizedState,c===null)if(p===null)if(i.stateNode===null){e:{p=i.type,c=i.memoizedProps,b=b.ownerDocument||b;t:switch(p){case"title":C=b.getElementsByTagName("title")[0],(!C||C[sn]||C[$t]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=b.createElement(p),b.head.insertBefore(C,b.querySelector("head > title"))),Dn(C,p,c),C[$t]=i,dr(C),p=C;break e;case"link":var V=E("link","href",b).get(p+(c.href||""));if(V){for(var K=0;K<V.length;K++)if(C=V[K],C.getAttribute("href")===(c.href==null?null:c.href)&&C.getAttribute("rel")===(c.rel==null?null:c.rel)&&C.getAttribute("title")===(c.title==null?null:c.title)&&C.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){V.splice(K,1);break t}}C=b.createElement(p),Dn(C,p,c),b.head.appendChild(C);break;case"meta":if(V=E("meta","content",b).get(p+(c.content||""))){for(K=0;K<V.length;K++)if(C=V[K],C.getAttribute("content")===(c.content==null?null:""+c.content)&&C.getAttribute("name")===(c.name==null?null:c.name)&&C.getAttribute("property")===(c.property==null?null:c.property)&&C.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&C.getAttribute("charset")===(c.charSet==null?null:c.charSet)){V.splice(K,1);break t}}C=b.createElement(p),Dn(C,p,c),b.head.appendChild(C);break;default:throw Error(R(468,p))}C[$t]=i,dr(C),p=C}i.stateNode=p}else D(b,i.type,i.stateNode);else i.stateNode=f(b,p,i.memoizedProps);else C!==p?(C===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):C.count--,p===null?D(b,i.type,i.stateNode):f(b,p,i.memoizedProps)):p===null&&i.stateNode!==null&&Ou(i,i.memoizedProps,c.memoizedProps)}break;case 27:if(p&4&&i.alternate===null){b=i.stateNode,C=i.memoizedProps;try{for(var he=b.firstChild;he;){var Te=he.nextSibling,Qe=he.nodeName;he[sn]||Qe==="HEAD"||Qe==="BODY"||Qe==="SCRIPT"||Qe==="STYLE"||Qe==="LINK"&&he.rel.toLowerCase()==="stylesheet"||b.removeChild(he),he=Te}for(var ht=i.type,Ue=b.attributes;Ue.length;)b.removeAttributeNode(Ue[0]);Dn(b,ht,C),b[$t]=i,b[Mt]=C}catch(qt){ir(i,i.return,qt)}}case 5:if(ia(s,i),ts(i),p&512&&(gr||c===null||Ja(c,c.return)),i.flags&32){b=i.stateNode;try{Mr(b,"")}catch(qt){ir(i,i.return,qt)}}p&4&&i.stateNode!=null&&(b=i.memoizedProps,Ou(i,b,c!==null?c.memoizedProps:b)),p&1024&&(Ic=!0);break;case 6:if(ia(s,i),ts(i),p&4){if(i.stateNode===null)throw Error(R(162));p=i.memoizedProps,c=i.stateNode;try{c.nodeValue=p}catch(qt){ir(i,i.return,qt)}}break;case 3:if(T=null,b=es,es=Qh(s.containerInfo),ia(s,i),es=b,ts(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{va(s.containerInfo)}catch(qt){ir(i,i.return,qt)}Ic&&(Ic=!1,Bp(i));break;case 4:p=es,es=Qh(i.stateNode.containerInfo),ia(s,i),ts(i),es=p;break;case 12:ia(s,i),ts(i);break;case 13:ia(s,i),ts(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Rf=Yr()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Ef(i,p)));break;case 22:if(p&512&&(gr||c===null||Ja(c,c.return)),he=i.memoizedState!==null,Te=c!==null&&c.memoizedState!==null,Qe=gs,ht=gr,gs=Qe||he,gr=ht||Te,ia(s,i),gr=ht,gs=Qe,ts(i),s=i.stateNode,s._current=i,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,p&8192&&(s._visibility=he?s._visibility&-2:s._visibility|1,he&&(s=gs||gr,c===null||Te||s||ju(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(c=null,s=i;;){if(s.tag===5||s.tag===26||s.tag===27){if(c===null){Te=c=s;try{if(b=Te.stateNode,he)C=b.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{V=Te.stateNode,K=Te.memoizedProps.style;var Ye=K!=null&&K.hasOwnProperty("display")?K.display:null;V.style.display=Ye==null||typeof Ye=="boolean"?"":(""+Ye).trim()}}catch(qt){ir(Te,Te.return,qt)}}}else if(s.tag===6){if(c===null){Te=s;try{Te.stateNode.nodeValue=he?"":Te.memoizedProps}catch(qt){ir(Te,Te.return,qt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}p&4&&(p=i.updateQueue,p!==null&&(c=p.retryQueue,c!==null&&(p.retryQueue=null,Ef(i,c))));break;case 19:ia(s,i),ts(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,Ef(i,p)));break;case 21:break;default:ia(s,i),ts(i)}}function ts(i){var s=i.flags;if(s&2){try{if(i.tag!==27){e:{for(var c=i.return;c!==null;){if(Lp(c)){var p=c;break e}c=c.return}throw Error(R(160))}switch(p.tag){case 27:var b=p.stateNode,C=mr(i);Lh(i,C,b);break;case 5:var V=p.stateNode;p.flags&32&&(Mr(V,""),p.flags&=-33);var K=mr(i);Lh(i,K,V);break;case 3:case 4:var he=p.stateNode.containerInfo,Te=mr(i);Ll(i,Te,he);break;default:throw Error(R(161))}}}catch(Qe){ir(i,i.return,Qe)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Bp(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Bp(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Wo(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)kc(i,s.alternate,s),s=s.sibling}function ju(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:kl(4,s,s.return),ju(s);break;case 1:Ja(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&kp(s,s.return,c),ju(s);break;case 26:case 27:case 5:Ja(s,s.return),ju(s);break;case 22:Ja(s,s.return),s.memoizedState===null&&ju(s);break;default:ju(s)}i=i.sibling}}function Ol(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var p=s.alternate,b=i,C=s,V=C.flags;switch(C.tag){case 0:case 11:case 15:Ol(b,C,c),kh(4,C);break;case 1:if(Ol(b,C,c),p=C,b=p.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(Te){ir(p,p.return,Te)}if(p=C,b=p.updateQueue,b!==null){var K=p.stateNode;try{var he=b.shared.hiddenCallbacks;if(he!==null)for(b.shared.hiddenCallbacks=null,b=0;b<he.length;b++)Rp(he[b],K)}catch(Te){ir(p,p.return,Te)}}c&&V&64&&Ip(C),Yo(C,C.return);break;case 26:case 27:case 5:Ol(b,C,c),c&&p===null&&V&4&&Sd(C),Yo(C,C.return);break;case 12:Ol(b,C,c);break;case 13:Ol(b,C,c),c&&V&4&&Bl(b,C);break;case 22:C.memoizedState===null&&Ol(b,C,c),Yo(C,C.return);break;default:Ol(b,C,c)}s=s.sibling}}function Ad(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Tl(c))}function Oh(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Tl(i))}function Qo(i,s,c,p){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Af(i,s,c,p),s=s.sibling}function Af(i,s,c,p){var b=s.flags;switch(s.tag){case 0:case 11:case 15:Qo(i,s,c,p),b&2048&&kh(9,s);break;case 3:Qo(i,s,c,p),b&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Tl(i)));break;case 12:if(b&2048){Qo(i,s,c,p),i=s.stateNode;try{var C=s.memoizedProps,V=C.id,K=C.onPostCommit;typeof K=="function"&&K(V,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(he){ir(s,s.return,he)}}else Qo(i,s,c,p);break;case 23:break;case 22:C=s.stateNode,s.memoizedState!==null?C._visibility&4?Qo(i,s,c,p):Bc(i,s):C._visibility&4?Qo(i,s,c,p):(C._visibility|=4,Lc(i,s,c,p,(s.subtreeFlags&10256)!==0)),b&2048&&Ad(s.alternate,s);break;case 24:Qo(i,s,c,p),b&2048&&Oh(s.alternate,s);break;default:Qo(i,s,c,p)}}function Lc(i,s,c,p,b){for(b=b&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var C=i,V=s,K=c,he=p,Te=V.flags;switch(V.tag){case 0:case 11:case 15:Lc(C,V,K,he,b),kh(8,V);break;case 23:break;case 22:var Qe=V.stateNode;V.memoizedState!==null?Qe._visibility&4?Lc(C,V,K,he,b):Bc(C,V):(Qe._visibility|=4,Lc(C,V,K,he,b)),b&&Te&2048&&Ad(V.alternate,V);break;case 24:Lc(C,V,K,he,b),b&&Te&2048&&Oh(V.alternate,V);break;default:Lc(C,V,K,he,b)}s=s.sibling}}function Bc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,p=s,b=p.flags;switch(p.tag){case 22:Bc(c,p),b&2048&&Ad(p.alternate,p);break;case 24:Bc(c,p),b&2048&&Oh(p.alternate,p);break;default:Bc(c,p)}s=s.sibling}}var Nu=8192;function Oc(i){if(i.subtreeFlags&Nu)for(i=i.child;i!==null;)Fh(i),i=i.sibling}function Fh(i){switch(i.tag){case 26:Oc(i),i.flags&Nu&&i.memoizedState!==null&&H(es,i.memoizedState,i.memoizedProps);break;case 5:Oc(i);break;case 3:case 4:var s=es;es=Qh(i.stateNode.containerInfo),Oc(i),es=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=Nu,Nu=16777216,Oc(i),Nu=s):Oc(i));break;default:Oc(i)}}function zd(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Uu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];Cn=p,Op(p,i)}zd(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Pd(i),i=i.sibling}function Pd(i){switch(i.tag){case 0:case 11:case 15:Uu(i),i.flags&2048&&kl(9,i,i.return);break;case 3:Uu(i);break;case 12:Uu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&4&&(i.return===null||i.return.tag!==13)?(s._visibility&=-5,Fl(i)):Uu(i);break;default:Uu(i)}}function Fl(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var p=s[c];Cn=p,Op(p,i)}zd(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:kl(8,s,s.return),Fl(s);break;case 22:c=s.stateNode,c._visibility&4&&(c._visibility&=-5,Fl(s));break;default:Fl(s)}i=i.sibling}}function Op(i,s){for(;Cn!==null;){var c=Cn;switch(c.tag){case 0:case 11:case 15:kl(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var p=c.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Tl(c.memoizedState.cache)}if(p=c.child,p!==null)p.return=c,Cn=p;else e:for(c=i;Cn!==null;){p=Cn;var b=p.sibling,C=p.return;if(Bh(p),p===c){Cn=null;break e}if(b!==null){b.return=C,Cn=b;break e}Cn=C}}}function Rd(i,s,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ra(i,s,c,p){return new Rd(i,s,c,p)}function jh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function jl(i,s){var c=i.alternate;return c===null?(c=ra(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&31457280,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function Fp(i,s){i.flags&=31457282;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Nh(i,s,c,p,b,C){var V=0;if(p=i,typeof i=="function")jh(i)&&(V=1);else if(typeof i=="string")V=I(i,c,Ai.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case ce:return Nl(c.children,b,C,s);case ae:V=8,b|=24;break;case Ce:return i=ra(12,c,s,b|2),i.elementType=Ce,i.lanes=C,i;case ze:return i=ra(13,c,s,b),i.elementType=ze,i.lanes=C,i;case dt:return i=ra(19,c,s,b),i.elementType=dt,i.lanes=C,i;case vt:return jp(c,b,C,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Ee:case oe:V=10;break e;case be:V=9;break e;case we:V=11;break e;case gt:V=14;break e;case St:V=16,p=null;break e}V=29,c=Error(R(130,i===null?"null":typeof i,"")),p=null}return s=ra(V,c,s,b),s.elementType=i,s.type=p,s.lanes=C,s}function Nl(i,s,c,p){return i=ra(7,i,p,s),i.lanes=c,i}function jp(i,s,c,p){i=ra(22,i,p,s),i.elementType=vt,i.lanes=c;var b={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var C=b._current;if(C===null)throw Error(R(456));if((b._pendingVisibility&2)===0){var V=hs(C,2);V!==null&&(b._pendingVisibility|=2,En(V,C,2))}},attach:function(){var C=b._current;if(C===null)throw Error(R(456));if((b._pendingVisibility&2)!==0){var V=hs(C,2);V!==null&&(b._pendingVisibility&=-3,En(V,C,2))}}};return i.stateNode=b,i}function Dd(i,s,c){return i=ra(6,i,null,s),i.lanes=c,i}function Fc(i,s,c){return s=ra(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function _o(i){i.flags|=4}function Np(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!j(s)){if(s=Ma.current,s!==null&&((Si&4194176)===Si?ma!==null:(Si&62914560)!==Si&&(Si&536870912)===0||s!==ma))throw vl=Su,wu;i.flags|=8192}}function zf(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Re():536870912,i.lanes|=s,jc|=s)}function Uh(i,s){if(!Qt)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Br(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(s)for(var b=i.child;b!==null;)c|=b.lanes|b.childLanes,p|=b.subtreeFlags&31457280,p|=b.flags&31457280,b.return=i,b=b.sibling;else for(b=i.child;b!==null;)c|=b.lanes|b.childLanes,p|=b.subtreeFlags,p|=b.flags,b.return=i,b=b.sibling;return i.subtreeFlags|=p,i.childLanes=c,s}function km(i,s,c){var p=s.pendingProps;switch(ko(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Br(s),null;case 1:return Br(s),null;case 3:return c=s.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),s.memoizedState.cache!==p&&(s.flags|=2048),Bs(Gt),yn(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(ds(s)?_o(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Mn!==null&&($u(Mn),Mn=null))),Br(s),null;case 26:return c=s.memoizedState,i===null?(_o(s),c!==null?(Br(s),Np(s,c)):(Br(s),s.flags&=-16777217)):c?c!==i.memoizedState?(_o(s),Br(s),Np(s,c)):(Br(s),s.flags&=-16777217):(i.memoizedProps!==p&&_o(s),Br(s),s.flags&=-16777217),null;case 27:zi(s),c=zr.current;var b=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==p&&_o(s);else{if(!p){if(s.stateNode===null)throw Error(R(166));return Br(s),null}i=Ai.current,ds(s)?wh(s):(i=Wf(b,p,c),s.stateNode=i,_o(s))}return Br(s),null;case 5:if(zi(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==p&&_o(s);else{if(!p){if(s.stateNode===null)throw Error(R(166));return Br(s),null}if(i=Ai.current,ds(s))wh(s);else{switch(b=Kh(zr.current),i){case 1:i=b.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=b.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=b.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=b.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=b.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?b.createElement("select",{is:p.is}):b.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?b.createElement(c,{is:p.is}):b.createElement(c)}}i[$t]=s,i[Mt]=p;e:for(b=s.child;b!==null;){if(b.tag===5||b.tag===6)i.appendChild(b.stateNode);else if(b.tag!==4&&b.tag!==27&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===s)break e;for(;b.sibling===null;){if(b.return===null||b.return===s)break e;b=b.return}b.sibling.return=b.return,b=b.sibling}s.stateNode=i;e:switch(Dn(i,c,p),c){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&_o(s)}}return Br(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==p&&_o(s);else{if(typeof p!="string"&&s.stateNode===null)throw Error(R(166));if(i=zr.current,ds(s)){if(i=s.stateNode,c=s.memoizedProps,p=null,b=Tn,b!==null)switch(b.tag){case 27:case 5:p=b.memoizedProps}i[$t]=s,i=!!(i.nodeValue===c||p!==null&&p.suppressHydrationWarning===!0||Yd(i.nodeValue,c)),i||ks(s)}else i=Kh(i).createTextNode(p),i[$t]=s,s.stateNode=i}return Br(s),null;case 13:if(p=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(b=ds(s),p!==null&&p.dehydrated!==null){if(i===null){if(!b)throw Error(R(318));if(b=s.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(R(317));b[$t]=s}else ps(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Br(s),b=!1}else Mn!==null&&($u(Mn),Mn=null),b=!0;if(!b)return s.flags&256?(Qn(s),s):(Qn(s),null)}if(Qn(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=p!==null,i=i!==null&&i.memoizedState!==null,c){p=s.child,b=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(b=p.alternate.memoizedState.cachePool.pool);var C=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==b&&(p.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),zf(s,s.updateQueue),Br(s),null;case 4:return yn(),i===null&&qf(s.stateNode.containerInfo),Br(s),null;case 10:return Bs(s.type),Br(s),null;case 19:if(vi(Lr),b=s.memoizedState,b===null)return Br(s),null;if(p=(s.flags&128)!==0,C=b.rendering,C===null)if(p)Uh(b,!1);else{if(Gr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(C=wc(i),C!==null){for(s.flags|=128,Uh(b,!1),i=C.updateQueue,s.updateQueue=i,zf(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)Fp(c,i),c=c.sibling;return Ci(Lr,Lr.current&1|2),s.child}i=i.sibling}b.tail!==null&&Yr()>Zu&&(s.flags|=128,p=!0,Uh(b,!1),s.lanes=4194304)}else{if(!p)if(i=wc(C),i!==null){if(s.flags|=128,p=!0,i=i.updateQueue,s.updateQueue=i,zf(s,i),Uh(b,!0),b.tail===null&&b.tailMode==="hidden"&&!C.alternate&&!Qt)return Br(s),null}else 2*Yr()-b.renderingStartTime>Zu&&c!==536870912&&(s.flags|=128,p=!0,Uh(b,!1),s.lanes=4194304);b.isBackwards?(C.sibling=s.child,s.child=C):(i=b.last,i!==null?i.sibling=C:s.child=C,b.last=C)}return b.tail!==null?(s=b.tail,b.rendering=s,b.tail=s.sibling,b.renderingStartTime=Yr(),s.sibling=null,i=Lr.current,Ci(Lr,p?i&1|2:i&1),s):(Br(s),null);case 22:case 23:return Qn(s),bc(),p=s.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(s.flags|=8192):p&&(s.flags|=8192),p?(c&536870912)!==0&&(s.flags&128)===0&&(Br(s),s.subtreeFlags&6&&(s.flags|=8192)):Br(s),c=s.updateQueue,c!==null&&zf(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),p=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(p=s.memoizedState.cachePool.pool),p!==c&&(s.flags|=2048),i!==null&&vi(so),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Bs(Gt),Br(s),null;case 25:return null}throw Error(R(156,s.tag))}function Lm(i,s){switch(ko(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Bs(Gt),yn(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return zi(s),null;case 13:if(Qn(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(R(340));ps()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return vi(Lr),null;case 4:return yn(),null;case 10:return Bs(s.type),null;case 22:case 23:return Qn(s),bc(),i!==null&&vi(so),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Bs(Gt),null;case 25:return null;default:return null}}function Id(i,s){switch(ko(s),s.tag){case 3:Bs(Gt),yn();break;case 26:case 27:case 5:zi(s);break;case 4:yn();break;case 13:Qn(s);break;case 19:vi(Lr);break;case 10:Bs(s.type);break;case 22:case 23:Qn(s),bc(),i!==null&&vi(so);break;case 24:Bs(Gt)}}var kd={getCacheForType:function(i){var s=Rn(Gt),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},Up=typeof WeakMap=="function"?WeakMap:Map,Ar=0,tr=null,wi=null,Si=0,lr=0,Da=null,Jo=!1,Vu=!1,Ld=!1,yo=0,Gr=0,Ul=0,Os=0,Pf=0,Ia=0,jc=0,yr=null,_s=null,Bd=!1,Rf=0,Zu=1/0,Gu=null,Vl=null,Df=!1,Nc=null,Vh=0,If=0,$n=null,Uc=0,kf=null;function cn(){if((Ar&2)!==0&&Si!==0)return Si&-Si;if(lt.T!==null){var i=no;return i!==0?i:$d()}return Tt()}function Zh(){Ia===0&&(Ia=(Si&536870912)===0||Qt?We():536870912);var i=Ma.current;return i!==null&&(i.flags|=32),Ia}function En(i,s,c){(i===tr&&lr===2||i.cancelPendingCommit!==null)&&(qu(i,0),el(i,Si,Ia,!1)),Dt(i,c),((Ar&2)===0||i!==tr)&&(i===tr&&((Ar&2)===0&&(Os|=c),Gr===4&&el(i,Si,Ia,!1)),Fs(i))}function Vc(i,s,c){if((Ar&6)!==0)throw Error(R(327));var p=!c&&(s&60)===0&&(s&i.expiredLanes)===0||Ne(i,s),b=p?Om(i,s):jd(i,s,!0),C=p;do{if(b===0){Vu&&!p&&el(i,s,0,!1);break}else if(b===6)el(i,s,0,!Jo);else{if(c=i.current.alternate,C&&!Bm(c)){b=jd(i,s,!1),C=!1;continue}if(b===2){if(C=s,i.errorRecoveryDisabledLanes&C)var V=0;else V=i.pendingLanes&-536870913,V=V!==0?V:V&536870912?536870912:0;if(V!==0){s=V;e:{var K=i;b=yr;var he=K.current.memoizedState.isDehydrated;if(he&&(qu(K,V).flags|=256),V=jd(K,V,!1),V!==2){if(Ld&&!he){K.errorRecoveryDisabledLanes|=C,Os|=C,b=4;break e}C=_s,_s=b,C!==null&&$u(C)}b=V}if(C=!1,b!==2)continue}}if(b===1){qu(i,0),el(i,s,0,!0);break}e:{switch(p=i,b){case 0:case 1:throw Error(R(345));case 4:if((s&4194176)===s){el(p,s,Ia,!Jo);break e}break;case 2:_s=null;break;case 3:case 5:break;default:throw Error(R(329))}if(p.finishedWork=c,p.finishedLanes=s,(s&62914560)===s&&(C=Rf+300-Yr(),10<C)){if(el(p,s,Ia,!Jo),Ge(p,0)!==0)break e;p.timeoutHandle=Wh(Gh.bind(null,p,c,_s,Gu,Bd,s,Ia,Os,jc,Jo,2,-0,0),C);break e}Gh(p,c,_s,Gu,Bd,s,Ia,Os,jc,Jo,0,-0,0)}}break}while(!0);Fs(i)}function $u(i){_s===null?_s=i:_s.push.apply(_s,i)}function Gh(i,s,c,p,b,C,V,K,he,Te,Qe,ht,Ue){var Ye=s.subtreeFlags;if((Ye&8192||(Ye&16785408)===16785408)&&(N={stylesheets:null,count:0,unsuspend:Z},Fh(s),s=W(),s!==null)){i.cancelPendingCommit=s(Xu.bind(null,i,c,p,b,V,K,he,1,ht,Ue)),el(i,C,V,!Te);return}Xu(i,c,p,b,V,K,he,Qe,ht,Ue)}function Bm(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var p=0;p<c.length;p++){var b=c[p],C=b.getSnapshot;b=b.value;try{if(!ha(C(),b))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function el(i,s,c,p){s&=~Pf,s&=~Os,i.suspendedLanes|=s,i.pingedLanes&=~s,p&&(i.warmLanes|=s),p=i.expirationTimes;for(var b=s;0<b;){var C=31-X(b),V=1<<C;p[C]=-1,b&=~V}c!==0&&Ht(i,c,s)}function $h(){return(Ar&6)===0?(Xh(0),!1):!0}function Lf(){if(wi!==null){if(lr===0)var i=wi.return;else i=wi,mo=zl=null,pr(i),Oo=null,xl=0,i=wi;for(;i!==null;)Id(i.alternate,i),i=i.return;wi=null}}function qu(i,s){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,Kf(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),Lf(),tr=i,wi=c=jl(i.current,null),Si=s,lr=0,Da=null,Jo=!1,Vu=Ne(i,s),Ld=!1,jc=Ia=Pf=Os=Ul=Gr=0,_s=yr=null,Bd=!1,(s&8)!==0&&(s|=s&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=s;0<p;){var b=31-X(p),C=1<<b;s|=i[b],p&=~C}return yo=s,yu(),c}function Od(i,s){ci=null,lt.H=Zi,s===Lo?(s=Sh(),lr=3):s===wu?(s=Sh(),lr=4):lr=s===xf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Da=s,wi===null&&(Gr=1,ya(i,da(s,i.current)))}function Fd(){var i=lt.H;return lt.H=Zi,i===null?Zi:i}function Bf(){var i=lt.A;return lt.A=kd,i}function qh(){Gr=4,Jo||(Si&4194176)!==Si&&Ma.current!==null||(Vu=!0),(Ul&134217727)===0&&(Os&134217727)===0||tr===null||el(tr,Si,Ia,!1)}function jd(i,s,c){var p=Ar;Ar|=2;var b=Fd(),C=Bf();(tr!==i||Si!==s)&&(Gu=null,qu(i,s)),s=!1;var V=Gr;e:do try{if(lr!==0&&wi!==null){var K=wi,he=Da;switch(lr){case 8:Lf(),V=6;break e;case 3:case 2:case 6:Ma.current===null&&(s=!0);var Te=lr;if(lr=0,Da=null,Hu(i,K,he,Te),c&&Vu){V=0;break e}break;default:Te=lr,lr=0,Da=null,Hu(i,K,he,Te)}}Vp(),V=Gr;break}catch(Qe){Od(i,Qe)}while(!0);return s&&i.shellSuspendCounter++,mo=zl=null,Ar=p,lt.H=b,lt.A=C,wi===null&&(tr=null,Si=0,yu()),V}function Vp(){for(;wi!==null;)Zp(wi)}function Om(i,s){var c=Ar;Ar|=2;var p=Fd(),b=Bf();tr!==i||Si!==s?(Gu=null,Zu=Yr()+500,qu(i,s)):Vu=Ne(i,s);e:do try{if(lr!==0&&wi!==null){s=wi;var C=Da;t:switch(lr){case 1:lr=0,Da=null,Hu(i,s,C,1);break;case 2:if(Tu(C)){lr=0,Da=null,Gp(s);break}s=function(){lr===2&&tr===i&&(lr=7),Fs(i)},C.then(s,s);break e;case 3:lr=7;break e;case 4:lr=5;break e;case 7:Tu(C)?(lr=0,Da=null,Gp(s)):(lr=0,Da=null,Hu(i,s,C,7));break;case 5:var V=null;switch(wi.tag){case 26:V=wi.memoizedState;case 5:case 27:var K=wi;if(!V||j(V)){lr=0,Da=null;var he=K.sibling;if(he!==null)wi=he;else{var Te=K.return;Te!==null?(wi=Te,Hh(Te)):wi=null}break t}}lr=0,Da=null,Hu(i,s,C,5);break;case 6:lr=0,Da=null,Hu(i,s,C,6);break;case 8:Lf(),Gr=6;break e;default:throw Error(R(462))}}Fm();break}catch(Qe){Od(i,Qe)}while(!0);return mo=zl=null,lt.H=p,lt.A=b,Ar=c,wi!==null?0:(tr=null,Si=0,yu(),Gr)}function Fm(){for(;wi!==null&&!ti();)Zp(wi)}function Zp(i){var s=Pp(i.alternate,i,yo);i.memoizedProps=i.pendingProps,s===null?Hh(i):wi=s}function Gp(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=Ah(c,s,s.pendingProps,s.type,void 0,Si);break;case 11:s=Ah(c,s,s.pendingProps,s.type.render,s.ref,Si);break;case 5:pr(s);default:Id(c,s),s=wi=Fp(s,yo),s=Pp(c,s,yo)}i.memoizedProps=i.pendingProps,s===null?Hh(i):wi=s}function Hu(i,s,c,p){mo=zl=null,pr(s),Oo=null,xl=0;var b=s.return;try{if($o(i,b,s,c,Si)){Gr=1,ya(i,da(c,i.current)),wi=null;return}}catch(C){if(b!==null)throw wi=b,C;Gr=1,ya(i,da(c,i.current)),wi=null;return}s.flags&32768?(Qt||p===1?i=!0:Vu||(Si&536870912)!==0?i=!1:(Jo=i=!0,(p===2||p===3||p===6)&&(p=Ma.current,p!==null&&p.tag===13&&(p.flags|=16384))),Nd(s,i)):Hh(s)}function Hh(i){var s=i;do{if((s.flags&32768)!==0){Nd(s,Jo);return}i=s.return;var c=km(s.alternate,s,yo);if(c!==null){wi=c;return}if(s=s.sibling,s!==null){wi=s;return}wi=s=i}while(s!==null);Gr===0&&(Gr=5)}function Nd(i,s){do{var c=Lm(i.alternate,i);if(c!==null){c.flags&=32767,wi=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){wi=i;return}wi=i=c}while(i!==null);Gr=6,wi=null}function Xu(i,s,c,p,b,C,V,K,he,Te){var Qe=lt.T,ht=wt.p;try{wt.p=2,lt.T=null,vo(i,s,c,p,ht,b,C,V,K,he,Te)}finally{lt.T=Qe,wt.p=ht}}function vo(i,s,c,p,b,C,V,K){do Zc();while(Nc!==null);if((Ar&6)!==0)throw Error(R(327));var he=i.finishedWork;if(p=i.finishedLanes,he===null)return null;if(i.finishedWork=null,i.finishedLanes=0,he===i.current)throw Error(R(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var Te=he.lanes|he.childLanes;if(Te|=bh,ii(i,p,Te,C,V,K),i===tr&&(wi=tr=null,Si=0),(he.subtreeFlags&10256)===0&&(he.flags&10256)===0||Df||(Df=!0,If=Te,$n=c,Zd(Oi,function(){return Zc(),null})),c=(he.flags&15990)!==0,(he.subtreeFlags&15990)!==0||c?(c=lt.T,lt.T=null,C=wt.p,wt.p=2,V=Ar,Ar|=4,Md(i,he),Ed(he,i),mu(Wd,i.containerInfo),ct=!!Kd,Wd=Kd=null,i.current=he,kc(i,he.alternate,he),rs(),Ar=V,wt.p=C,lt.T=c):i.current=he,Df?(Df=!1,Nc=i,Vh=p):tl(i,Te),Te=i.pendingLanes,Te===0&&(Vl=null),Ae(he.stateNode),Fs(i),s!==null)for(b=i.onRecoverableError,he=0;he<s.length;he++)Te=s[he],b(Te.value,{componentStack:Te.stack});return(Vh&3)!==0&&Zc(),Te=i.pendingLanes,(p&4194218)!==0&&(Te&42)!==0?i===kf?Uc++:(Uc=0,kf=i):Uc=0,Xh(0),null}function tl(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Tl(s)))}function Zc(){if(Nc!==null){var i=Nc,s=If;If=0;var c=zt(Vh),p=lt.T,b=wt.p;try{if(wt.p=32>c?32:c,lt.T=null,Nc===null)var C=!1;else{c=$n,$n=null;var V=Nc,K=Vh;if(Nc=null,Vh=0,(Ar&6)!==0)throw Error(R(331));var he=Ar;if(Ar|=4,Pd(V.current),Af(V,V.current,K,c),Ar=he,Xh(0,!1),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(Kr,V)}catch{}C=!0}return C}finally{wt.p=b,lt.T=p,tl(i,s)}}return!1}function Of(i,s,c){s=da(c,s),s=ki(i.stateNode,s,2),i=go(i,s,2),i!==null&&(Dt(i,2),Fs(i))}function ir(i,s,c){if(i.tag===3)Of(i,i,c);else for(;s!==null;){if(s.tag===3){Of(s,i,c);break}else if(s.tag===1){var p=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Vl===null||!Vl.has(p))){i=da(c,i),c=Vr(2),p=go(s,c,2),p!==null&&(Zr(c,p,s,i),Dt(p,2),Fs(p));break}}s=s.return}}function Ud(i,s,c){var p=i.pingCache;if(p===null){p=i.pingCache=new Up;var b=new Set;p.set(s,b)}else b=p.get(s),b===void 0&&(b=new Set,p.set(s,b));b.has(c)||(Ld=!0,b.add(c),i=Ff.bind(null,i,s,c),s.then(i,i))}function Ff(i,s,c){var p=i.pingCache;p!==null&&p.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,tr===i&&(Si&c)===c&&(Gr===4||Gr===3&&(Si&62914560)===Si&&300>Yr()-Rf?(Ar&2)===0&&qu(i,0):Pf|=c,jc===Si&&(jc=0)),Fs(i)}function jf(i,s){s===0&&(s=Re()),i=hs(i,s),i!==null&&(Dt(i,s),Fs(i))}function jm(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),jf(i,c)}function Vd(i,s){var c=0;switch(i.tag){case 13:var p=i.stateNode,b=i.memoizedState;b!==null&&(c=b.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(R(314))}p!==null&&p.delete(s),jf(i,c)}function Zd(i,s){return Pr(i,s)}var il=null,Gc=null,Nf=!1,Yu=!1,Uf=!1,xo=0;function Fs(i){i!==Gc&&i.next===null&&(Gc===null?il=Gc=i:Gc=Gc.next=i),Yu=!0,Nf||(Nf=!0,Um(Nm))}function Xh(i,s){if(!Uf&&Yu){Uf=!0;do for(var c=!1,p=il;p!==null;){if(i!==0){var b=p.pendingLanes;if(b===0)var C=0;else{var V=p.suspendedLanes,K=p.pingedLanes;C=(1<<31-X(42|i)+1)-1,C&=b&~(V&~K),C=C&201326677?C&201326677|1:C?C|2:0}C!==0&&(c=!0,qp(p,C))}else C=Si,C=Ge(p,p===tr?C:0),(C&3)===0||Ne(p,C)||(c=!0,qp(p,C));p=p.next}while(c);Uf=!1}}function Nm(){Yu=Nf=!1;var i=0;xo!==0&&(Yf()&&(i=xo),xo=0);for(var s=Yr(),c=null,p=il;p!==null;){var b=p.next,C=Gd(p,s);C===0?(p.next=null,c===null?il=b:c.next=b,b===null&&(Gc=c)):(c=p,(i!==0||(C&3)!==0)&&(Yu=!0)),p=b}Xh(i)}function Gd(i,s){for(var c=i.suspendedLanes,p=i.pingedLanes,b=i.expirationTimes,C=i.pendingLanes&-62914561;0<C;){var V=31-X(C),K=1<<V,he=b[V];he===-1?((K&c)===0||(K&p)!==0)&&(b[V]=Pe(K,s)):he<=s&&(i.expiredLanes|=K),C&=~K}if(s=tr,c=Si,c=Ge(i,i===s?c:0),p=i.callbackNode,c===0||i===s&&lr===2||i.cancelPendingCommit!==null)return p!==null&&p!==null&&vn(p),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||Ne(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(p!==null&&vn(p),zt(c)){case 2:case 8:c=na;break;case 32:c=Oi;break;case 268435456:c=fr;break;default:c=Oi}return p=$p.bind(null,i),c=Pr(c,p),i.callbackPriority=s,i.callbackNode=c,s}return p!==null&&p!==null&&vn(p),i.callbackPriority=2,i.callbackNode=null,2}function $p(i,s){var c=i.callbackNode;if(Zc()&&i.callbackNode!==c)return null;var p=Si;return p=Ge(i,i===tr?p:0),p===0?null:(Vc(i,p,s),Gd(i,Yr()),i.callbackNode!=null&&i.callbackNode===c?$p.bind(null,i):null)}function qp(i,s){if(Zc())return null;Vc(i,s,!0)}function Um(i){Vm(function(){(Ar&6)!==0?Pr(Fa,i):i()})}function $d(){return xo===0&&(xo=We()),xo}function Hp(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Ao(""+i)}function Vf(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function Zl(i,s,c,p,b){if(s==="submit"&&c&&c.stateNode===b){var C=Hp((b[Mt]||null).action),V=p.submitter;V&&(s=(s=V[Mt]||null)?Hp(s.formAction):V.getAttribute("formAction"),s!==null&&(C=s,V=null));var K=new Ms("action","action",null,p,b);i.push({event:K,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(xo!==0){var he=V?Vf(b,V):new FormData(b);Ze(c,{pending:!0,data:he,method:b.method,action:C},null,he)}}else typeof C=="function"&&(K.preventDefault(),he=V?Vf(b,V):new FormData(b),Ze(c,{pending:!0,data:he,method:b.method,action:C},C,he))},currentTarget:b}]})}}for(var Zf=0;Zf<mc.length;Zf++){var Gf=mc[Zf],Xp=Gf.toLowerCase(),Yp=Gf[0].toUpperCase()+Gf.slice(1);$a(Xp,"on"+Yp)}$a(pl,"onAnimationEnd"),$a(pc,"onAnimationIteration"),$a(xh,"onAnimationStart"),$a("dblclick","onDoubleClick"),$a("focusin","onFocus"),$a("focusout","onBlur"),$a(ml,"onTransitionRun"),$a(gl,"onTransitionStart"),$a(vf,"onTransitionCancel"),$a(_u,"onTransitionEnd"),Na("onMouseEnter",["mouseout","mouseover"]),Na("onMouseLeave",["mouseout","mouseover"]),Na("onPointerEnter",["pointerout","pointerover"]),Na("onPointerLeave",["pointerout","pointerover"]),$s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$s("onBeforeInput",["compositionend","keypress","textInput","paste"]),$s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ku="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ku));function Hd(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],b=p.event;p=p.listeners;e:{var C=void 0;if(s)for(var V=p.length-1;0<=V;V--){var K=p[V],he=K.instance,Te=K.currentTarget;if(K=K.listener,he!==C&&b.isPropagationStopped())break e;C=K,b.currentTarget=Te;try{C(b)}catch(Qe){ms(Qe)}b.currentTarget=null,C=he}else for(V=0;V<p.length;V++){if(K=p[V],he=K.instance,Te=K.currentTarget,K=K.listener,he!==C&&b.isPropagationStopped())break e;C=K,b.currentTarget=Te;try{C(b)}catch(Qe){ms(Qe)}b.currentTarget=null,C=he}}}}function gi(i,s){var c=s[Tr];c===void 0&&(c=s[Tr]=new Set);var p=i+"__bubble";c.has(p)||(ka(s,i,2,!1),c.add(p))}function $f(i,s,c){var p=0;s&&(p|=4),ka(c,i,p,s)}var Wu="_reactListening"+Math.random().toString(36).slice(2);function qf(i){if(!i[Wu]){i[Wu]=!0,Wc.forEach(function(c){c!=="selectionchange"&&(qd.has(c)||$f(c,!1,i),$f(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Wu]||(s[Wu]=!0,$f("selectionchange",!1,s))}}function ka(i,s,c,p){switch(cr(s)){case 2:var b=He;break;case 8:b=Ct;break;default:b=Ut}c=b.bind(null,s,c,i),b=void 0,!Ui||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(b=!0),p?b!==void 0?i.addEventListener(s,c,{capture:!0,passive:b}):i.addEventListener(s,c,!0):b!==void 0?i.addEventListener(s,c,{passive:b}):i.addEventListener(s,c,!1)}function Gl(i,s,c,p,b){var C=p;if((s&1)===0&&(s&2)===0&&p!==null)e:for(;;){if(p===null)return;var V=p.tag;if(V===3||V===4){var K=p.stateNode.containerInfo;if(K===b||K.nodeType===8&&K.parentNode===b)break;if(V===4)for(V=p.return;V!==null;){var he=V.tag;if((he===3||he===4)&&(he=V.stateNode.containerInfo,he===b||he.nodeType===8&&he.parentNode===b))return;V=V.return}for(;K!==null;){if(V=Gs(K),V===null)return;if(he=V.tag,he===5||he===6||he===26||he===27){p=C=V;continue e}K=K.parentNode}}p=p.return}iu(function(){var Te=C,Qe=Cr(c),ht=[];e:{var Ue=xi.get(i);if(Ue!==void 0){var Ye=Ms,qt=i;switch(i){case"keypress":if(Hs(c)===0)break e;case"keydown":case"keyup":Ye=ac;break;case"focusin":qt="focus",Ye=nc;break;case"focusout":qt="blur",Ye=nc;break;case"beforeblur":case"afterblur":Ye=nc;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=Sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=ua;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=sc;break;case pl:case pc:case xh:Ye=zo;break;case _u:Ye=fd;break;case"scroll":case"scrollend":Ye=ud;break;case"wheel":Ye=uf;break;case"copy":case"cut":case"paste":Ye=au;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=cf;break;case"toggle":case"beforetoggle":Ye=hf}var ui=(s&4)!==0,Hr=!ui&&(i==="scroll"||i==="scrollend"),De=ui?Ue!==null?Ue+"Capture":null:Ue;ui=[];for(var Me=Te,Fe;Me!==null;){var it=Me;if(Fe=it.stateNode,it=it.tag,it!==5&&it!==26&&it!==27||Fe===null||De===null||(it=Fn(Me,De),it!=null&&ui.push(Qu(Me,it,Fe))),Hr)break;Me=Me.return}0<ui.length&&(Ue=new Ye(Ue,qt,null,c,Qe),ht.push({event:Ue,listeners:ui}))}}if((s&7)===0){e:{if(Ue=i==="mouseover"||i==="pointerover",Ye=i==="mouseout"||i==="pointerout",Ue&&c!==la&&(qt=c.relatedTarget||c.fromElement)&&(Gs(qt)||qt[ba]))break e;if((Ye||Ue)&&(Ue=Qe.window===Qe?Qe:(Ue=Qe.ownerDocument)?Ue.defaultView||Ue.parentWindow:window,Ye?(qt=c.relatedTarget||c.toElement,Ye=Te,qt=qt?Gs(qt):null,qt!==null&&(Hr=kt(qt),ui=qt.tag,qt!==Hr||ui!==5&&ui!==27&&ui!==6)&&(qt=null)):(Ye=null,qt=Te),Ye!==qt)){if(ui=Sn,it="onMouseLeave",De="onMouseEnter",Me="mouse",(i==="pointerout"||i==="pointerover")&&(ui=cf,it="onPointerLeave",De="onPointerEnter",Me="pointer"),Hr=Ye==null?Ue:Co(Ye),Fe=qt==null?Ue:Co(qt),Ue=new ui(it,Me+"leave",Ye,c,Qe),Ue.target=Hr,Ue.relatedTarget=Fe,it=null,Gs(Qe)===Te&&(ui=new ui(De,Me+"enter",qt,c,Qe),ui.target=Fe,ui.relatedTarget=Hr,it=ui),Hr=it,Ye&&qt)t:{for(ui=Ye,De=qt,Me=0,Fe=ui;Fe;Fe=$c(Fe))Me++;for(Fe=0,it=De;it;it=$c(it))Fe++;for(;0<Me-Fe;)ui=$c(ui),Me--;for(;0<Fe-Me;)De=$c(De),Fe--;for(;Me--;){if(ui===De||De!==null&&ui===De.alternate)break t;ui=$c(ui),De=$c(De)}ui=null}else ui=null;Ye!==null&&Xd(ht,Ue,Ye,ui,!1),qt!==null&&Hr!==null&&Xd(ht,Hr,qt,ui,!0)}}e:{if(Ue=Te?Co(Te):window,Ye=Ue.nodeName&&Ue.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&Ue.type==="file")var Bt=uc;else if(lc(Ue))if(fu)Bt=Ti;else{Bt=gh;var _i=gf}else Ye=Ue.nodeName,!Ye||Ye.toLowerCase()!=="input"||Ue.type!=="checkbox"&&Ue.type!=="radio"?Te&&Nr(Te.elementType)&&(Bt=uc):Bt=Io;if(Bt&&(Bt=Bt(i,Te))){pf(ht,Bt,c,Qe);break e}_i&&_i(i,Ue,Te),i==="focusout"&&Te&&Ue.type==="number"&&Te.memoizedProps.value!=null&&pi(Ue,"number",Ue.value)}switch(_i=Te?Co(Te):window,i){case"focusin":(lc(_i)||_i.contentEditable==="true")&&(Ks=_i,As=Te,cs=null);break;case"focusout":cs=As=Ks=null;break;case"mousedown":Kn=!0;break;case"contextmenu":case"mouseup":case"dragend":Kn=!1,vh(ht,c,Qe);break;case"selectionchange":if(gu)break;case"keydown":case"keyup":vh(ht,c,Qe)}var Kt;if(dh)e:{switch(i){case"compositionstart":var ri="onCompositionStart";break e;case"compositionend":ri="onCompositionEnd";break e;case"compositionupdate":ri="onCompositionUpdate";break e}ri=void 0}else Po?hu(i,c)&&(ri="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(ri="onCompositionStart");ri&&(mh&&c.locale!=="ko"&&(Po||ri!=="onCompositionStart"?ri==="onCompositionEnd"&&Po&&(Kt=mi()):(oi=Qe,ni="value"in oi?oi.value:oi.textContent,Po=!0)),_i=Yh(Te,ri),0<_i.length&&(ri=new lf(ri,i,null,c,Qe),ht.push({event:ri,listeners:_i}),Kt?ri.data=Kt:(Kt=Ys(c),Kt!==null&&(ri.data=Kt)))),(Kt=ph?df(i,c):Ro(i,c))&&(ri=Yh(Te,"onBeforeInput"),0<ri.length&&(_i=new lf("onBeforeInput","beforeinput",null,c,Qe),ht.push({event:_i,listeners:ri}),_i.data=Kt)),Zl(ht,i,Te,c,Qe)}Hd(ht,s)})}function Qu(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Yh(i,s){for(var c=s+"Capture",p=[];i!==null;){var b=i,C=b.stateNode;b=b.tag,b!==5&&b!==26&&b!==27||C===null||(b=Fn(i,c),b!=null&&p.unshift(Qu(i,b,C)),b=Fn(i,s),b!=null&&p.push(Qu(i,b,C))),i=i.return}return p}function $c(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Xd(i,s,c,p,b){for(var C=s._reactName,V=[];c!==null&&c!==p;){var K=c,he=K.alternate,Te=K.stateNode;if(K=K.tag,he!==null&&he===p)break;K!==5&&K!==26&&K!==27||Te===null||(he=Te,b?(Te=Fn(c,C),Te!=null&&V.unshift(Qu(c,Te,he))):b||(Te=Fn(c,C),Te!=null&&V.push(Qu(c,Te,he)))),c=c.return}V.length!==0&&i.push({event:s,listeners:V})}var Kp=/\r\n?/g,Wp=/\u0000|\uFFFD/g;function Qp(i){return(typeof i=="string"?i:""+i).replace(Kp,`
`).replace(Wp,"")}function Yd(i,s){return s=Qp(s),Qp(i)===s}function js(){}function Gi(i,s,c,p,b,C){switch(c){case"children":typeof p=="string"?s==="body"||s==="textarea"&&p===""||Mr(i,p):(typeof p=="number"||typeof p=="bigint")&&s!=="body"&&Mr(i,""+p);break;case"className":al(i,"class",p);break;case"tabIndex":al(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":al(i,c,p);break;case"style":tu(i,p,C);break;case"data":if(s!=="object"){al(i,"data",p);break}case"src":case"href":if(p===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=Ao(""+p),i.setAttribute(c,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(c==="formAction"?(s!=="input"&&Gi(i,s,"name",b.name,b,null),Gi(i,s,"formEncType",b.formEncType,b,null),Gi(i,s,"formMethod",b.formMethod,b,null),Gi(i,s,"formTarget",b.formTarget,b,null)):(Gi(i,s,"encType",b.encType,b,null),Gi(i,s,"method",b.method,b,null),Gi(i,s,"target",b.target,b,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(c);break}p=Ao(""+p),i.setAttribute(c,p);break;case"onClick":p!=null&&(i.onclick=js);break;case"onScroll":p!=null&&gi("scroll",i);break;case"onScrollEnd":p!=null&&gi("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(R(61));if(c=p.__html,c!=null){if(b.children!=null)throw Error(R(60));i.innerHTML=c}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}c=Ao(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""+p):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":p===!0?i.setAttribute(c,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(c,p):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(c,p):i.removeAttribute(c);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(c):i.setAttribute(c,p);break;case"popover":gi("beforetoggle",i),gi("toggle",i),ws(i,"popover",p);break;case"xlinkActuate":Ua(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Ua(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Ua(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Ua(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Ua(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Ua(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Ua(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Ua(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Ua(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":ws(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=On.get(c)||c,ws(i,c,p))}}function Hf(i,s,c,p,b,C){switch(c){case"style":tu(i,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(R(61));if(c=p.__html,c!=null){if(b.children!=null)throw Error(R(60));i.innerHTML=c}}break;case"children":typeof p=="string"?Mr(i,p):(typeof p=="number"||typeof p=="bigint")&&Mr(i,""+p);break;case"onScroll":p!=null&&gi("scroll",i);break;case"onScrollEnd":p!=null&&gi("scrollend",i);break;case"onClick":p!=null&&(i.onclick=js);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!oh.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(b=c.endsWith("Capture"),s=c.slice(2,b?c.length-7:void 0),C=i[Mt]||null,C=C!=null?C[c]:null,typeof C=="function"&&i.removeEventListener(s,C,b),typeof p=="function")){typeof C!="function"&&C!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,p,b);break e}c in i?i[c]=p:p===!0?i.setAttribute(c,""):ws(i,c,p)}}}function Dn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gi("error",i),gi("load",i);var p=!1,b=!1,C;for(C in c)if(c.hasOwnProperty(C)){var V=c[C];if(V!=null)switch(C){case"src":p=!0;break;case"srcSet":b=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(R(137,s));default:Gi(i,s,C,V,c,null)}}b&&Gi(i,s,"srcSet",c.srcSet,c,null),p&&Gi(i,s,"src",c.src,c,null);return;case"input":gi("invalid",i);var K=C=V=b=null,he=null,Te=null;for(p in c)if(c.hasOwnProperty(p)){var Qe=c[p];if(Qe!=null)switch(p){case"name":b=Qe;break;case"type":V=Qe;break;case"checked":he=Qe;break;case"defaultChecked":Te=Qe;break;case"value":C=Qe;break;case"defaultValue":K=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(R(137,s));break;default:Gi(i,s,p,Qe,c,null)}}sa(i,C,K,he,Te,V,b,!1),Eo(i);return;case"select":gi("invalid",i),p=V=C=null;for(b in c)if(c.hasOwnProperty(b)&&(K=c[b],K!=null))switch(b){case"value":C=K;break;case"defaultValue":V=K;break;case"multiple":p=K;default:Gi(i,s,b,K,c,null)}s=C,c=V,i.multiple=!!p,s!=null?Ss(i,!!p,s,!1):c!=null&&Ss(i,!!p,c,!0);return;case"textarea":gi("invalid",i),C=b=p=null;for(V in c)if(c.hasOwnProperty(V)&&(K=c[V],K!=null))switch(V){case"value":p=K;break;case"defaultValue":b=K;break;case"children":C=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(R(91));break;default:Gi(i,s,V,K,c,null)}oa(i,p,b,C),Eo(i);return;case"option":for(he in c)if(c.hasOwnProperty(he)&&(p=c[he],p!=null))switch(he){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Gi(i,s,he,p,c,null)}return;case"dialog":gi("cancel",i),gi("close",i);break;case"iframe":case"object":gi("load",i);break;case"video":case"audio":for(p=0;p<Ku.length;p++)gi(Ku[p],i);break;case"image":gi("error",i),gi("load",i);break;case"details":gi("toggle",i);break;case"embed":case"source":case"link":gi("error",i),gi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Te in c)if(c.hasOwnProperty(Te)&&(p=c[Te],p!=null))switch(Te){case"children":case"dangerouslySetInnerHTML":throw Error(R(137,s));default:Gi(i,s,Te,p,c,null)}return;default:if(Nr(s)){for(Qe in c)c.hasOwnProperty(Qe)&&(p=c[Qe],p!==void 0&&Hf(i,s,Qe,p,c,void 0));return}}for(K in c)c.hasOwnProperty(K)&&(p=c[K],p!=null&&Gi(i,s,K,p,c,null))}function Jp(i,s,c,p){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var b=null,C=null,V=null,K=null,he=null,Te=null,Qe=null;for(Ye in c){var ht=c[Ye];if(c.hasOwnProperty(Ye)&&ht!=null)switch(Ye){case"checked":break;case"value":break;case"defaultValue":he=ht;default:p.hasOwnProperty(Ye)||Gi(i,s,Ye,null,p,ht)}}for(var Ue in p){var Ye=p[Ue];if(ht=c[Ue],p.hasOwnProperty(Ue)&&(Ye!=null||ht!=null))switch(Ue){case"type":C=Ye;break;case"name":b=Ye;break;case"checked":Te=Ye;break;case"defaultChecked":Qe=Ye;break;case"value":V=Ye;break;case"defaultValue":K=Ye;break;case"children":case"dangerouslySetInnerHTML":if(Ye!=null)throw Error(R(137,s));break;default:Ye!==ht&&Gi(i,s,Ue,Ye,p,ht)}}Bn(i,V,K,he,Te,Qe,C,b);return;case"select":Ye=V=K=Ue=null;for(C in c)if(he=c[C],c.hasOwnProperty(C)&&he!=null)switch(C){case"value":break;case"multiple":Ye=he;default:p.hasOwnProperty(C)||Gi(i,s,C,null,p,he)}for(b in p)if(C=p[b],he=c[b],p.hasOwnProperty(b)&&(C!=null||he!=null))switch(b){case"value":Ue=C;break;case"defaultValue":K=C;break;case"multiple":V=C;default:C!==he&&Gi(i,s,b,C,p,he)}s=K,c=V,p=Ye,Ue!=null?Ss(i,!!c,Ue,!1):!!p!=!!c&&(s!=null?Ss(i,!!c,s,!0):Ss(i,!!c,c?[]:"",!1));return;case"textarea":Ye=Ue=null;for(K in c)if(b=c[K],c.hasOwnProperty(K)&&b!=null&&!p.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:Gi(i,s,K,null,p,b)}for(V in p)if(b=p[V],C=c[V],p.hasOwnProperty(V)&&(b!=null||C!=null))switch(V){case"value":Ue=b;break;case"defaultValue":Ye=b;break;case"children":break;case"dangerouslySetInnerHTML":if(b!=null)throw Error(R(91));break;default:b!==C&&Gi(i,s,V,b,p,C)}eu(i,Ue,Ye);return;case"option":for(var qt in c)if(Ue=c[qt],c.hasOwnProperty(qt)&&Ue!=null&&!p.hasOwnProperty(qt))switch(qt){case"selected":i.selected=!1;break;default:Gi(i,s,qt,null,p,Ue)}for(he in p)if(Ue=p[he],Ye=c[he],p.hasOwnProperty(he)&&Ue!==Ye&&(Ue!=null||Ye!=null))switch(he){case"selected":i.selected=Ue&&typeof Ue!="function"&&typeof Ue!="symbol";break;default:Gi(i,s,he,Ue,p,Ye)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ui in c)Ue=c[ui],c.hasOwnProperty(ui)&&Ue!=null&&!p.hasOwnProperty(ui)&&Gi(i,s,ui,null,p,Ue);for(Te in p)if(Ue=p[Te],Ye=c[Te],p.hasOwnProperty(Te)&&Ue!==Ye&&(Ue!=null||Ye!=null))switch(Te){case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(R(137,s));break;default:Gi(i,s,Te,Ue,p,Ye)}return;default:if(Nr(s)){for(var Hr in c)Ue=c[Hr],c.hasOwnProperty(Hr)&&Ue!==void 0&&!p.hasOwnProperty(Hr)&&Hf(i,s,Hr,void 0,p,Ue);for(Qe in p)Ue=p[Qe],Ye=c[Qe],!p.hasOwnProperty(Qe)||Ue===Ye||Ue===void 0&&Ye===void 0||Hf(i,s,Qe,Ue,p,Ye);return}}for(var De in c)Ue=c[De],c.hasOwnProperty(De)&&Ue!=null&&!p.hasOwnProperty(De)&&Gi(i,s,De,null,p,Ue);for(ht in p)Ue=p[ht],Ye=c[ht],!p.hasOwnProperty(ht)||Ue===Ye||Ue==null&&Ye==null||Gi(i,s,ht,Ue,p,Ye)}var Kd=null,Wd=null;function Kh(i){return i.nodeType===9?i:i.ownerDocument}function Ju(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qd(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function eh(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Xf=null;function Yf(){var i=window.event;return i&&i.type==="popstate"?i===Xf?!1:(Xf=i,!0):(Xf=null,!1)}var Wh=typeof setTimeout=="function"?setTimeout:void 0,Kf=typeof clearTimeout=="function"?clearTimeout:void 0,em=typeof Promise=="function"?Promise:void 0,Vm=typeof queueMicrotask=="function"?queueMicrotask:typeof em<"u"?function(i){return em.resolve(null).then(i).catch(Zm)}:Wh;function Zm(i){setTimeout(function(){throw i})}function $l(i,s){var c=s,p=0;do{var b=c.nextSibling;if(i.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(p===0){i.removeChild(b),va(s);return}p--}else c!=="$"&&c!=="$?"&&c!=="$!"||p++;c=b}while(c);va(s)}function un(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":un(c),Pi(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function ql(i,s,c,p){for(;i.nodeType===1;){var b=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[sn])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(C=i.getAttribute("rel"),C==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(C!==b.rel||i.getAttribute("href")!==(b.href==null?null:b.href)||i.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin)||i.getAttribute("title")!==(b.title==null?null:b.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(C=i.getAttribute("src"),(C!==(b.src==null?null:b.src)||i.getAttribute("type")!==(b.type==null?null:b.type)||i.getAttribute("crossorigin")!==(b.crossOrigin==null?null:b.crossOrigin))&&C&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var C=b.name==null?null:""+b.name;if(b.type==="hidden"&&i.getAttribute("name")===C)return i}else return i;if(i=ys(i.nextSibling),i===null)break}return null}function Jd(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=ys(i.nextSibling),i===null))return null;return i}function ys(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}function ep(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function Wf(i,s,c){switch(s=Kh(c),i){case"html":if(i=s.documentElement,!i)throw Error(R(452));return i;case"head":if(i=s.head,!i)throw Error(R(453));return i;case"body":if(i=s.body,!i)throw Error(R(454));return i;default:throw Error(R(451))}}var vs=new Map,tp=new Set;function Qh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var rl=wt.d;wt.d={f:tm,r:ip,D:Jh,C:np,L:im,m:ap,X:ef,S:Qf,M:sp};function tm(){var i=rl.f(),s=$h();return i||s}function ip(i){var s=ns(i);s!==null&&s.tag===5&&s.type==="form"?ft(s):rl.r(i)}var Hl=typeof document>"u"?null:document;function rp(i,s,c){var p=Hl;if(p&&typeof s=="string"&&s){var b=ai(s);b='link[rel="'+i+'"][href="'+b+'"]',typeof c=="string"&&(b+='[crossorigin="'+c+'"]'),tp.has(b)||(tp.add(b),i={rel:i,crossOrigin:c,href:s},p.querySelector(b)===null&&(s=p.createElement("link"),Dn(s,"link",i),dr(s),p.head.appendChild(s)))}}function Jh(i){rl.D(i),rp("dns-prefetch",i,null)}function np(i,s){rl.C(i,s),rp("preconnect",i,s)}function im(i,s,c){rl.L(i,s,c);var p=Hl;if(p&&i&&s){var b='link[rel="preload"][as="'+ai(s)+'"]';s==="image"&&c&&c.imageSrcSet?(b+='[imagesrcset="'+ai(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(b+='[imagesizes="'+ai(c.imageSizes)+'"]')):b+='[href="'+ai(i)+'"]';var C=b;switch(s){case"style":C=Xl(i);break;case"script":C=n(i)}vs.has(C)||(i=Q({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),vs.set(C,i),p.querySelector(b)!==null||s==="style"&&p.querySelector(tf(C))||s==="script"&&p.querySelector(o(C))||(s=p.createElement("link"),Dn(s,"link",i),dr(s),p.head.appendChild(s)))}}function ap(i,s){rl.m(i,s);var c=Hl;if(c&&i){var p=s&&typeof s.as=="string"?s.as:"script",b='link[rel="modulepreload"][as="'+ai(p)+'"][href="'+ai(i)+'"]',C=b;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=n(i)}if(!vs.has(C)&&(i=Q({rel:"modulepreload",href:i},s),vs.set(C,i),c.querySelector(b)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(o(C)))return}p=c.createElement("link"),Dn(p,"link",i),dr(p),c.head.appendChild(p)}}}function Qf(i,s,c){rl.S(i,s,c);var p=Hl;if(p&&i){var b=aa(p).hoistableStyles,C=Xl(i);s=s||"default";var V=b.get(C);if(!V){var K={loading:0,preload:null};if(V=p.querySelector(tf(C)))K.loading=5;else{i=Q({rel:"stylesheet",href:i,"data-precedence":s},c),(c=vs.get(C))&&_(i,c);var he=V=p.createElement("link");dr(he),Dn(he,"link",i),he._p=new Promise(function(Te,Qe){he.onload=Te,he.onerror=Qe}),he.addEventListener("load",function(){K.loading|=1}),he.addEventListener("error",function(){K.loading|=2}),K.loading|=4,g(V,s,p)}V={type:"stylesheet",instance:V,count:1,state:K},b.set(C,V)}}}function ef(i,s){rl.X(i,s);var c=Hl;if(c&&i){var p=aa(c).hoistableScripts,b=n(i),C=p.get(b);C||(C=c.querySelector(o(b)),C||(i=Q({src:i,async:!0},s),(s=vs.get(b))&&x(i,s),C=c.createElement("script"),dr(C),Dn(C,"link",i),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(b,C))}}function sp(i,s){rl.M(i,s);var c=Hl;if(c&&i){var p=aa(c).hoistableScripts,b=n(i),C=p.get(b);C||(C=c.querySelector(o(b)),C||(i=Q({src:i,async:!0,type:"module"},s),(s=vs.get(b))&&x(i,s),C=c.createElement("script"),dr(C),Dn(C,"link",i),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(b,C))}}function Jf(i,s,c,p){var b=(b=zr.current)?Qh(b):null;if(!b)throw Error(R(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Xl(c.href),c=aa(b).hoistableStyles,p=c.get(s),p||(p={type:"style",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Xl(c.href);var C=aa(b).hoistableStyles,V=C.get(i);if(V||(b=b.ownerDocument||b,V={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(i,V),(C=b.querySelector(tf(i)))&&!C._p&&(V.instance=C,V.state.loading=5),vs.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},vs.set(i,c),C||t(b,i,c,V.state))),s&&p===null)throw Error(R(528,""));return V}if(s&&p!==null)throw Error(R(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=n(c),c=aa(b).hoistableScripts,p=c.get(s),p||(p={type:"script",instance:null,count:0,state:null},c.set(s,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(R(444,i))}}function Xl(i){return'href="'+ai(i)+'"'}function tf(i){return'link[rel="stylesheet"]['+i+"]"}function a(i){return Q({},i,{"data-precedence":i.precedence,precedence:null})}function t(i,s,c,p){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?p.loading=1:(s=i.createElement("link"),p.preload=s,s.addEventListener("load",function(){return p.loading|=1}),s.addEventListener("error",function(){return p.loading|=2}),Dn(s,"link",c),dr(s),i.head.appendChild(s))}function n(i){return'[src="'+ai(i)+'"]'}function o(i){return"script[async]"+i}function f(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var p=i.querySelector('style[data-href~="'+ai(c.href)+'"]');if(p)return s.instance=p,dr(p),p;var b=Q({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),dr(p),Dn(p,"style",b),g(p,c.precedence,i),s.instance=p;case"stylesheet":b=Xl(c.href);var C=i.querySelector(tf(b));if(C)return s.state.loading|=4,s.instance=C,dr(C),C;p=a(c),(b=vs.get(b))&&_(p,b),C=(i.ownerDocument||i).createElement("link"),dr(C);var V=C;return V._p=new Promise(function(K,he){V.onload=K,V.onerror=he}),Dn(C,"link",p),s.state.loading|=4,g(C,c.precedence,i),s.instance=C;case"script":return C=n(c.src),(b=i.querySelector(o(C)))?(s.instance=b,dr(b),b):(p=c,(b=vs.get(C))&&(p=Q({},c),x(p,b)),i=i.ownerDocument||i,b=i.createElement("script"),dr(b),Dn(b,"link",p),i.head.appendChild(b),s.instance=b);case"void":return null;default:throw Error(R(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(p=s.instance,s.state.loading|=4,g(p,c.precedence,i));return s.instance}function g(i,s,c){for(var p=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),b=p.length?p[p.length-1]:null,C=b,V=0;V<p.length;V++){var K=p[V];if(K.dataset.precedence===s)C=K;else if(C!==b)break}C?C.parentNode.insertBefore(i,C.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function _(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function x(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var T=null;function E(i,s,c){if(T===null){var p=new Map,b=T=new Map;b.set(c,p)}else b=T,p=b.get(c),p||(p=new Map,b.set(c,p));if(p.has(i))return p;for(p.set(i,null),c=c.getElementsByTagName(i),b=0;b<c.length;b++){var C=c[b];if(!(C[sn]||C[$t]||i==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var V=C.getAttribute(s)||"";V=i+V;var K=p.get(V);K?K.push(C):p.set(V,[C])}}return p}function D(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function I(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function j(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var N=null;function Z(){}function H(i,s,c){if(N===null)throw Error(R(475));var p=N;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var b=Xl(c.href),C=i.querySelector(tf(b));if(C){i=C._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=re.bind(p),i.then(p,p)),s.state.loading|=4,s.instance=C,dr(C);return}C=i.ownerDocument||i,c=a(c),(b=vs.get(b))&&_(c,b),C=C.createElement("link"),dr(C);var V=C;V._p=new Promise(function(K,he){V.onload=K,V.onerror=he}),Dn(C,"link",c),s.instance=C}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(p.count++,s=re.bind(p),i.addEventListener("load",s),i.addEventListener("error",s))}}function W(){if(N===null)throw Error(R(475));var i=N;return i.stylesheets&&i.count===0&&le(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&le(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function re(){if(this.count--,this.count===0){if(this.stylesheets)le(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var _e=null;function le(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,_e=new Map,s.forEach(U,i),_e=null,re.call(i))}function U(i,s){if(!(s.state.loading&4)){var c=_e.get(i);if(c)var p=c.get(null);else{c=new Map,_e.set(i,c);for(var b=i.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<b.length;C++){var V=b[C];(V.nodeName==="LINK"||V.getAttribute("media")!=="not all")&&(c.set(V.dataset.precedence,V),p=V)}p&&c.set(null,p)}b=s.instance,V=b.getAttribute("data-precedence"),C=c.get(V)||p,C===p&&c.set(null,b),c.set(V,b),this.count++,p=re.bind(this),b.addEventListener("load",p),b.addEventListener("error",p),C?C.parentNode.insertBefore(b,C.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(b,i.firstChild)),s.state.loading|=4}}var Y={$$typeof:oe,Provider:null,Consumer:null,_currentValue:Xt,_currentValue2:Xt,_threadCount:0};function ue(i,s,c,p,b,C,V,K){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_t(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_t(0),this.hiddenUpdates=_t(null),this.identifierPrefix=p,this.onUncaughtError=b,this.onCaughtError=C,this.onRecoverableError=V,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function ke(i,s,c,p,b,C,V,K,he,Te,Qe,ht){return i=new ue(i,s,c,V,K,he,Te,ht),s=1,C===!0&&(s|=24),C=ra(3,null,null,s),i.current=C,C.stateNode=i,s=Sl(),s.refCount++,i.pooledCache=s,s.refCount++,C.memoizedState={element:p,isDehydrated:c,cache:s},bd(C),i}function tt(i){return i?(i=Ps,i):Ps}function je(i,s,c,p,b,C){b=tt(b),p.context===null?p.context=b:p.pendingContext=b,p=Il(s),p.payload={element:c},C=C===void 0?null:C,C!==null&&(p.callback=C),c=go(i,p,s),c!==null&&(En(c,i,s),Dc(c,i,s))}function Ve(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function ot(i,s){Ve(i,s),(i=i.alternate)&&Ve(i,s)}function nt(i){if(i.tag===13){var s=hs(i,67108864);s!==null&&En(s,i,67108864),ot(i,67108864)}}var ct=!0;function He(i,s,c,p){var b=lt.T;lt.T=null;var C=wt.p;try{wt.p=2,Ut(i,s,c,p)}finally{wt.p=C,lt.T=b}}function Ct(i,s,c,p){var b=lt.T;lt.T=null;var C=wt.p;try{wt.p=8,Ut(i,s,c,p)}finally{wt.p=C,lt.T=b}}function Ut(i,s,c,p){if(ct){var b=jt(p);if(b===null)Gl(i,s,p,Pt,c),fn(i,p);else if(is(b,i,s,c,p))p.stopPropagation();else if(fn(i,p),s&4&&-1<An.indexOf(i)){for(;b!==null;){var C=ns(b);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var V=xe(C.pendingLanes);if(V!==0){var K=C;for(K.pendingLanes|=2,K.entangledLanes|=2;V;){var he=1<<31-X(V);K.entanglements[1]|=he,V&=~he}Fs(C),(Ar&6)===0&&(Zu=Yr()+500,Xh(0))}}break;case 13:K=hs(C,2),K!==null&&En(K,C,2),$h(),ot(C,2)}if(C=jt(p),C===null&&Gl(i,s,p,Pt,c),C===b)break;b=C}b!==null&&p.stopPropagation()}else Gl(i,s,p,null,c)}}function jt(i){return i=Cr(i),fi(i)}var Pt=null;function fi(i){if(Pt=null,i=Gs(i),i!==null){var s=kt(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=Wt(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Pt=i,null}function cr(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(bs()){case Fa:return 2;case na:return 8;case Oi:case hr:return 32;case fr:return 268435456;default:return 32}default:return 32}}var Or=!1,vr=null,hn=null,$r=null,Fr=new Map,Ni=new Map,rr=[],An="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fn(i,s){switch(i){case"focusin":case"focusout":vr=null;break;case"dragenter":case"dragleave":hn=null;break;case"mouseover":case"mouseout":$r=null;break;case"pointerover":case"pointerout":Fr.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ni.delete(s.pointerId)}}function dn(i,s,c,p,b,C){return i===null||i.nativeEvent!==C?(i={blockedOn:s,domEventName:c,eventSystemFlags:p,nativeEvent:C,targetContainers:[b]},s!==null&&(s=ns(s),s!==null&&nt(s)),i):(i.eventSystemFlags|=p,s=i.targetContainers,b!==null&&s.indexOf(b)===-1&&s.push(b),i)}function is(i,s,c,p,b){switch(s){case"focusin":return vr=dn(vr,i,s,c,p,b),!0;case"dragenter":return hn=dn(hn,i,s,c,p,b),!0;case"mouseover":return $r=dn($r,i,s,c,p,b),!0;case"pointerover":var C=b.pointerId;return Fr.set(C,dn(Fr.get(C)||null,i,s,c,p,b)),!0;case"gotpointercapture":return C=b.pointerId,Ni.set(C,dn(Ni.get(C)||null,i,s,c,p,b)),!0}return!1}function rn(i){var s=Gs(i.target);if(s!==null){var c=kt(s);if(c!==null){if(s=c.tag,s===13){if(s=Wt(c),s!==null){i.blockedOn=s,li(i.priority,function(){if(c.tag===13){var p=cn(),b=hs(c,p);b!==null&&En(b,c,p),ot(c,p)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function In(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=jt(i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);la=p,c.target.dispatchEvent(p),la=null}else return s=ns(c),s!==null&&nt(s),i.blockedOn=c,!1;s.shift()}return!0}function qr(i,s,c){In(i)&&c.delete(s)}function pn(){Or=!1,vr!==null&&In(vr)&&(vr=null),hn!==null&&In(hn)&&(hn=null),$r!==null&&In($r)&&($r=null),Fr.forEach(qr),Ni.forEach(qr)}function jr(i,s){i.blockedOn===s&&(i.blockedOn=null,Or||(Or=!0,y.unstable_scheduleCallback(y.unstable_NormalPriority,pn)))}var xr=null;function $i(i){xr!==i&&(xr=i,y.unstable_scheduleCallback(y.unstable_NormalPriority,function(){xr===i&&(xr=null);for(var s=0;s<i.length;s+=3){var c=i[s],p=i[s+1],b=i[s+2];if(typeof p!="function"){if(fi(p||c)===null)continue;break}var C=ns(c);C!==null&&(i.splice(s,3),s-=3,Ze(C,{pending:!0,data:b,method:c.method,action:p},p,b))}}))}function va(i){function s(he){return jr(he,i)}vr!==null&&jr(vr,i),hn!==null&&jr(hn,i),$r!==null&&jr($r,i),Fr.forEach(s),Ni.forEach(s);for(var c=0;c<rr.length;c++){var p=rr[c];p.blockedOn===i&&(p.blockedOn=null)}for(;0<rr.length&&(c=rr[0],c.blockedOn===null);)rn(c),c.blockedOn===null&&rr.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(p=0;p<c.length;p+=3){var b=c[p],C=c[p+1],V=b[Mt]||null;if(typeof C=="function")V||$i(c);else if(V){var K=null;if(C&&C.hasAttribute("formAction")){if(b=C,V=C[Mt]||null)K=V.formAction;else if(fi(b)!==null)continue}else K=V.action;typeof K=="function"?c[p+1]=K:(c.splice(p,3),p-=3),$i(c)}}}function Yl(i){this._internalRoot=i}La.prototype.render=Yl.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(R(409));var c=s.current,p=cn();je(c,p,i,s,null,null)},La.prototype.unmount=Yl.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;i.tag===0&&Zc(),je(i.current,2,null,i,null,null),$h(),s[ba]=null}};function La(i){this._internalRoot=i}La.prototype.unstable_scheduleHydration=function(i){if(i){var s=Tt();i={blockedOn:null,target:i,priority:s};for(var c=0;c<rr.length&&s!==0&&s<rr[c].priority;c++);rr.splice(c,0,i),c===0&&rn(i)}};var rm=S.version;if(rm!=="19.0.0")throw Error(R(527,rm,"19.0.0"));wt.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(R(188)):(i=Object.keys(i).join(","),Error(R(268,i)));return i=rt(s),i=i!==null?At(i):null,i=i===null?null:i.stateNode,i};var th={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:lt,findFiberByHostInstance:Gs,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Kr=bo.inject(th),Rr=bo}catch{}}return cp.createRoot=function(i,s){if(!B(i))throw Error(R(299));var c=!1,p="",b=_a,C=Qa,V=Ra,K=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(p=s.identifierPrefix),s.onUncaughtError!==void 0&&(b=s.onUncaughtError),s.onCaughtError!==void 0&&(C=s.onCaughtError),s.onRecoverableError!==void 0&&(V=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(K=s.unstable_transitionCallbacks)),s=ke(i,1,!1,null,null,c,p,b,C,V,K,null),i[ba]=s.current,qf(i.nodeType===8?i.parentNode:i),new Yl(s)},cp.hydrateRoot=function(i,s,c){if(!B(i))throw Error(R(299));var p=!1,b="",C=_a,V=Qa,K=Ra,he=null,Te=null;return c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(b=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(V=c.onCaughtError),c.onRecoverableError!==void 0&&(K=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(he=c.unstable_transitionCallbacks),c.formState!==void 0&&(Te=c.formState)),s=ke(i,1,!0,s,c??null,p,b,C,V,K,he,Te),s.context=tt(null),c=s.current,p=cn(),b=Il(p),b.callback=null,go(c,b,p),s.current.lanes=p,Dt(s,p),Fs(s),i[ba]=s.current,qf(i),new La(s)},cp.version="19.0.0",cp}var Jg;function $y(){if(Jg)return qm.exports;Jg=1;function y(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y)}catch(S){console.error(S)}}return y(),qm.exports=Gy(),qm.exports}var qy=$y(),lm={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */var Hy=lm.exports,e_;function Xy(){return e_||(e_=1,function(y,S){(function(P,R){y.exports=R()})(Hy,function(){var P={},R={};function B(z,u,ce){if(R[z]=ce,z==="index"){var ae="var sharedModule = {}; ("+R.shared+")(sharedModule); ("+R.worker+")(sharedModule);",Ce={};return R.shared(Ce),R.index(P,Ce),typeof window<"u"&&P.setWorkerUrl(window.URL.createObjectURL(new Blob([ae],{type:"text/javascript"}))),P}}B("shared",["exports"],function(z){function u(a,t,n,o){return new(n||(n=Promise))(function(f,g){function _(E){try{T(o.next(E))}catch(D){g(D)}}function x(E){try{T(o.throw(E))}catch(D){g(D)}}function T(E){var D;E.done?f(E.value):(D=E.value,D instanceof n?D:new n(function(I){I(D)})).then(_,x)}T((o=o.apply(a,t||[])).next())})}function ce(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ae,Ce;function Ee(){if(Ce)return ae;function a(t,n){this.x=t,this.y=n}return Ce=1,ae=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,n){return this.clone()._rotateAround(t,n)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var n=t.x-this.x,o=t.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,n){return Math.atan2(this.x*n-this.y*t,this.x*t+this.y*n)},_matMult:function(t){var n=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var n=Math.cos(t),o=Math.sin(t),f=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=f,this},_rotateAround:function(t,n){var o=Math.cos(t),f=Math.sin(t),g=n.y+f*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-f*(this.y-n.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},ae}typeof SuppressedError=="function"&&SuppressedError;var be,oe,we=ce(Ee()),ze=function(){if(oe)return be;function a(t,n,o,f){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(f-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=o,this.p2y=f}return oe=1,be=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,f=0;f<8;f++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<n)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var x=0,T=1;for(o=t,f=0;f<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<n));f++)t>g?x=o:T=o,o=.5*(T-x)+x;return o},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},be}(),dt=ce(ze);let gt,St;function vt(){return gt==null&&(gt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),gt}function at(){if(St==null&&(St=!1,vt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let o=0;o<5*5;o++){const f=4*o;t.fillStyle=`rgb(${f},${f+1},${f+2})`,t.fillRect(o%5,Math.floor(o/5),1,1)}const n=t.getImageData(0,0,5,5).data;for(let o=0;o<5*5*4;o++)if(o%4!=3&&n[o]!==o){St=!0;break}}}return St||!1}var Oe,ut=1e-6,yt=typeof Float32Array<"u"?Float32Array:Array;function xt(){var a=new yt(9);return yt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function lt(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Q(){var a=new yt(3);return yt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function st(a,t,n){var o=new yt(3);return o[0]=a,o[1]=t,o[2]=n,o}function Et(a,t,n){var o=t[0],f=t[1],g=t[2],_=t[3];return a[0]=n[0]*o+n[4]*f+n[8]*g+n[12]*_,a[1]=n[1]*o+n[5]*f+n[9]*g+n[13]*_,a[2]=n[2]*o+n[6]*f+n[10]*g+n[14]*_,a[3]=n[3]*o+n[7]*f+n[11]*g+n[15]*_,a}function Vt(){var a=new yt(4);return yt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function ei(){var a=new yt(2);return yt!=Float32Array&&(a[0]=0,a[1]=0),a}function di(a,t){var n=new yt(2);return n[0]=a,n[1]=t,n}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)}),Q(),Oe=new yt(4),yt!=Float32Array&&(Oe[0]=0,Oe[1]=0,Oe[2]=0,Oe[3]=0),Q(),st(1,0,0),st(0,1,0),Vt(),Vt(),xt(),ei();const Je=8192;function Zt(a,t,n){return t*(Je/(a.tileSize*Math.pow(2,n-a.tileID.overscaledZ)))}function kt(a,t){return(a%t+t)%t}function Wt(a,t,n){return a*(1-n)+t*n}function ve(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,n=t*a;return 4*(a<.5?n:3*(a-t)+n-.75)}function rt(a,t,n,o){const f=new dt(a,t,n,o);return g=>f.solve(g)}const At=rt(.25,.1,.25,1);function Lt(a,t,n){return Math.min(n,Math.max(t,a))}function wt(a,t,n){const o=n-t,f=((a-t)%o+o)%o+t;return f===t?n:f}function Xt(a,...t){for(const n of t)for(const o in n)a[o]=n[o];return a}let Yt=1;function Xi(a,t,n){const o={};for(const f in a)o[f]=t.call(this,a[f],f,a);return o}function hi(a,t,n){const o={};for(const f in a)t.call(this,a[f],f,a)&&(o[f]=a[f]);return o}function vi(a){return Array.isArray(a)?a.map(vi):typeof a=="object"&&a?Xi(a,vi):a}const Ci={};function Ai(a){Ci[a]||(typeof console<"u"&&console.warn(a),Ci[a]=!0)}function Bi(a,t,n){return(n.y-a.y)*(t.x-a.x)>(t.y-a.y)*(n.x-a.x)}function zr(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let Ei=null;function qn(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const yn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Sr(a,t,n,o,f){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const g=new VideoFrame(a,{timestamp:0});try{const _=g==null?void 0:g.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const x=_.startsWith("BGR"),T=new Uint8ClampedArray(o*f*4);if(yield g.copyTo(T,function(E,D,I,j,N){const Z=4*Math.max(1,0),H=(Math.max(0,I)-I)*j*4+Z,W=4*j,re=Math.max(0,D),_e=Math.max(0,I);return{rect:{x:re,y:_e,width:Math.min(E.width,D+j)-re,height:Math.min(E.height,I+N)-_e},layout:[{offset:H,stride:W}]}}(a,t,n,o,f)),x)for(let E=0;E<T.length;E+=4){const D=T[E];T[E]=T[E+2],T[E+2]=D}return T}finally{g.close()}})}let zi,nn;function Pr(a,t,n,o){return a.addEventListener(t,n,o),{unsubscribe:()=>{a.removeEventListener(t,n,o)}}}function vn(a){return a/Math.PI*180}const ti="AbortError";function rs(){return new Error(ti)}const Yr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function bs(a){return Yr.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Fa="global-dispatcher";class na extends Error{constructor(t,n,o,f){super(`AJAXError: ${n} (${t}): ${o}`),this.status=t,this.statusText=n,this.url=o,this.body=f}}const Oi=()=>zr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,hr=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const o=bs(a.url);if(o)return o(a,t);if(zr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Fa},t)}if(!(/^file:/.test(n=a.url)||/^file:/.test(Oi())&&!/^\w+:/.test(n))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(o,f){return u(this,void 0,void 0,function*(){const g=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:Oi(),signal:f.signal});let _,x;o.type!=="json"||g.headers.has("Accept")||g.headers.set("Accept","application/json");try{_=yield fetch(g)}catch(E){throw new na(0,E.message,o.url,new Blob)}if(!_.ok){const E=yield _.blob();throw new na(_.status,_.statusText,o.url,E)}x=o.type==="arrayBuffer"||o.type==="image"?_.arrayBuffer():o.type==="json"?_.json():_.text();const T=yield x;if(f.signal.aborted)throw rs();return{data:T,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(a,t);if(zr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Fa},t)}var n;return function(o,f){return new Promise((g,_)=>{var x;const T=new XMLHttpRequest;T.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(T.responseType="arraybuffer");for(const E in o.headers)T.setRequestHeader(E,o.headers[E]);o.type==="json"&&(T.responseType="text",!((x=o.headers)===null||x===void 0)&&x.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials=o.credentials==="include",T.onerror=()=>{_(new Error(T.statusText))},T.onload=()=>{if(!f.signal.aborted)if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let E=T.response;if(o.type==="json")try{E=JSON.parse(T.response)}catch(D){return void _(D)}g({data:E,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const E=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});_(new na(T.status,T.statusText,o.url,E))}},f.signal.addEventListener("abort",()=>{T.abort(),_(rs())}),T.send(o.body)})}(a,t)};function fr(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function ja(a,t,n){n[a]&&n[a].indexOf(t)!==-1||(n[a]=n[a]||[],n[a].push(t))}function an(a,t,n){if(n&&n[a]){const o=n[a].indexOf(t);o!==-1&&n[a].splice(o,1)}}class Kr{constructor(t,n={}){Xt(this,n),this.type=t}}class Rr extends Kr{constructor(t,n={}){super("error",Xt({error:t},n))}}class Ae{on(t,n){return this._listeners=this._listeners||{},ja(t,n,this._listeners),{unsubscribe:()=>{this.off(t,n)}}}off(t,n){return an(t,n,this._listeners),an(t,n,this._oneTimeListeners),this}once(t,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},ja(t,n,this._oneTimeListeners),this):new Promise(o=>this.once(t,o))}fire(t,n){typeof t=="string"&&(t=new Kr(t,n||{}));const o=t.type;if(this.listens(o)){t.target=this;const f=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const x of f)x.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const x of g)an(o,x,this._oneTimeListeners),x.call(this,t);const _=this._eventedParent;_&&(Xt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof Rr&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,n){return this._eventedParent=t,this._eventedParentData=n,this}}var L={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const X=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function J(a,t){const n={};for(const o in a)o!=="ref"&&(n[o]=a[o]);return X.forEach(o=>{o in t&&(n[o]=t[o])}),n}function ne(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let n=0;n<a.length;n++)if(!ne(a[n],t[n]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const n in a)if(!ne(a[n],t[n]))return!1;return!0}return a===t}function me(a,t){a.push(t)}function Se(a,t,n){me(n,{command:"addSource",args:[a,t[a]]})}function Le(a,t,n){me(t,{command:"removeSource",args:[a]}),n[a]=!0}function xe(a,t,n,o){Le(a,n,o),Se(a,t,n)}function Ge(a,t,n){let o;for(o in a[n])if(Object.prototype.hasOwnProperty.call(a[n],o)&&o!=="data"&&!ne(a[n][o],t[n][o]))return!1;for(o in t[n])if(Object.prototype.hasOwnProperty.call(t[n],o)&&o!=="data"&&!ne(a[n][o],t[n][o]))return!1;return!0}function Ne(a,t,n,o,f,g){a=a||{},t=t||{};for(const _ in a)Object.prototype.hasOwnProperty.call(a,_)&&(ne(a[_],t[_])||n.push({command:g,args:[o,_,t[_],f]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(a,_)&&(ne(a[_],t[_])||n.push({command:g,args:[o,_,t[_],f]}))}function Pe(a){return a.id}function We(a,t){return a[t.id]=t,a}class Re{constructor(t,n,o,f){this.message=(t?`${t}: `:"")+o,f&&(this.identifier=f),n!=null&&n.__line__&&(this.line=n.__line__)}}function _t(a,...t){for(const n of t)for(const o in n)a[o]=n[o];return a}class Dt extends Error{constructor(t,n){super(n),this.message=n,this.key=t}}class ii{constructor(t,n=[]){this.parent=t,this.bindings={};for(const[o,f]of n)this.bindings[o]=f}concat(t){return new ii(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Ht={kind:"null"},Xe={kind:"number"},zt={kind:"string"},Tt={kind:"boolean"},li={kind:"color"},Nt={kind:"projectionDefinition"},$t={kind:"object"},Mt={kind:"value"},ba={kind:"collator"},Tr={kind:"formatted"},Wr={kind:"padding"},Yi={kind:"resolvedImage"},ic={kind:"variableAnchorOffsetCollection"};function sn(a,t){return{kind:"array",itemType:a,N:t}}function Pi(a){if(a.kind==="array"){const t=Pi(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const Gs=[Ht,Xe,zt,Tt,li,Nt,Tr,$t,sn(Mt),Wr,Yi,ic];function ns(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ns(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const n of Gs)if(!ns(n,t))return null}}return`Expected ${Pi(a)} but found ${Pi(t)} instead.`}function Co(a,t){return t.some(n=>n.kind===a.kind)}function aa(a,t){return t.some(n=>n==="null"?a===null:n==="array"?Array.isArray(a):n==="object"?a&&!Array.isArray(a)&&typeof a=="object":n===typeof a)}function dr(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const Wc=.96422,oh=.82521,$s=4/29,Na=6/29,as=3*Na*Na,cd=Na*Na*Na,sf=Math.PI/180,of=180/Math.PI;function lh(a){return(a%=360)<0&&(a+=360),a}function ws([a,t,n,o]){let f,g;const _=Ua((.2225045*(a=al(a))+.7168786*(t=al(t))+.0606169*(n=al(n)))/1);a===t&&t===n?f=g=_:(f=Ua((.4360747*a+.3850649*t+.1430804*n)/Wc),g=Ua((.0139322*a+.0971045*t+.7141733*n)/oh));const x=116*_-16;return[x<0?0:x,500*(f-_),200*(_-g),o]}function al(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Ua(a){return a>cd?Math.pow(a,1/3):a/as+$s}function xn([a,t,n,o]){let f=(a+16)/116,g=isNaN(t)?f:f+t/500,_=isNaN(n)?f:f-n/200;return f=1*ch(f),g=Wc*ch(g),_=oh*ch(_),[Qc(3.1338561*g-1.6168667*f-.4906146*_),Qc(-.9787684*g+1.9161415*f+.033454*_),Qc(.0719453*g-.2289914*f+1.4052427*_),o]}function Qc(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function ch(a){return a>Na?a*a*a:as*(a-$s)}function Eo(a){return parseInt(a.padEnd(2,a),16)/255}function Jc(a,t){return ss(t?a/100:a,0,1)}function ss(a,t,n){return Math.min(Math.max(t,a),n)}function Va(a){return!a.some(Number.isNaN)}const ai={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Bn(a,t,n){return a+n*(t-a)}function sa(a,t,n){return a.map((o,f)=>Bn(o,t[f],n))}class pi{constructor(t,n,o,f=1,g=!0){this.r=t,this.g=n,this.b=o,this.a=f,g||(this.r*=f,this.g*=f,this.b*=f,f||this.overwriteGetter("rgb",[t,n,o,f]))}static parse(t){if(t instanceof pi)return t;if(typeof t!="string")return;const n=function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const f=ai[o];if(f){const[_,x,T]=f;return[_/255,x/255,T/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const _=o.length<6?1:2;let x=1;return[Eo(o.slice(x,x+=_)),Eo(o.slice(x,x+=_)),Eo(o.slice(x,x+=_)),Eo(o.slice(x,x+_)||"ff")]}if(o.startsWith("rgb")){const _=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[x,T,E,D,I,j,N,Z,H,W,re,_e]=_,le=[D||" ",N||" ",W].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const U=[E,j,H].join(""),Y=U==="%%%"?100:U===""?255:0;if(Y){const ue=[ss(+T/Y,0,1),ss(+I/Y,0,1),ss(+Z/Y,0,1),re?Jc(+re,_e):1];if(Va(ue))return ue}}return}}const g=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[_,x,T,E,D,I,j,N,Z]=g,H=[T||" ",D||" ",j].join("");if(H==="  "||H==="  /"||H===",,"||H===",,,"){const W=[+x,ss(+E,0,100),ss(+I,0,100),N?Jc(+N,Z):1];if(Va(W))return function([re,_e,le,U]){function Y(ue){const ke=(ue+re/30)%12,tt=_e*Math.min(le,1-le);return le-tt*Math.max(-1,Math.min(ke-3,9-ke,1))}return re=lh(re),_e/=100,le/=100,[Y(0),Y(8),Y(4),U]}(W)}}}(t);return n?new pi(...n,!1):void 0}get rgb(){const{r:t,g:n,b:o,a:f}=this,g=f||1/0;return this.overwriteGetter("rgb",[t/g,n/g,o/g,f])}get hcl(){return this.overwriteGetter("hcl",function(t){const[n,o,f,g]=ws(t),_=Math.sqrt(o*o+f*f);return[Math.round(1e4*_)?lh(Math.atan2(f,o)*of):NaN,_,n,g]}(this.rgb))}get lab(){return this.overwriteGetter("lab",ws(this.rgb))}overwriteGetter(t,n){return Object.defineProperty(this,t,{value:n}),n}toString(){const[t,n,o,f]=this.rgb;return`rgba(${[t,n,o].map(g=>Math.round(255*g)).join(",")},${f})`}static interpolate(t,n,o,f="rgb"){switch(f){case"rgb":{const[g,_,x,T]=sa(t.rgb,n.rgb,o);return new pi(g,_,x,T,!1)}case"hcl":{const[g,_,x,T]=t.hcl,[E,D,I,j]=n.hcl;let N,Z;if(isNaN(g)||isNaN(E))isNaN(g)?isNaN(E)?N=NaN:(N=E,x!==1&&x!==0||(Z=D)):(N=g,I!==1&&I!==0||(Z=_));else{let le=E-g;E>g&&le>180?le-=360:E<g&&g-E>180&&(le+=360),N=g+o*le}const[H,W,re,_e]=function([le,U,Y,ue]){return le=isNaN(le)?0:le*sf,xn([Y,Math.cos(le)*U,Math.sin(le)*U,ue])}([N,Z??Bn(_,D,o),Bn(x,I,o),Bn(T,j,o)]);return new pi(H,W,re,_e,!1)}case"lab":{const[g,_,x,T]=xn(sa(t.lab,n.lab,o));return new pi(g,_,x,T,!1)}}}}pi.black=new pi(0,0,0,1),pi.white=new pi(1,1,1,1),pi.transparent=new pi(0,0,0,0),pi.red=new pi(1,0,0,1);class Ss{constructor(t,n,o){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,n){return this.collator.compare(t,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const eu=["bottom","center","top"];class oa{constructor(t,n,o,f,g,_){this.text=t,this.image=n,this.scale=o,this.fontStack=f,this.textColor=g,this.verticalAlign=_}}class Mr{constructor(t){this.sections=t}static fromString(t){return new Mr([new oa(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Mr?t:Mr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class on{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof on)return t;if(typeof t=="number")return new on([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const n of t)if(typeof n!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new on(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){return new on(sa(t.values,n.values,o))}}class nr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const tu=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Nr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Nr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let n=0;n<t.length;n+=2){const o=t[n],f=t[n+1];if(typeof o!="string"||!tu.has(o)||!Array.isArray(f)||f.length!==2||typeof f[0]!="number"||typeof f[1]!="number")return}return new Nr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,n,o){const f=t.values,g=n.values;if(f.length!==g.length)throw new nr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${n.toString()}`);const _=[];for(let x=0;x<f.length;x+=2){if(f[x]!==g[x])throw new nr(`Cannot interpolate values containing mismatched anchors. from[${x}]: ${f[x]}, to[${x}]: ${g[x]}`);_.push(f[x]);const[T,E]=f[x+1],[D,I]=g[x+1];_.push([Bn(T,D,o),Bn(E,I,o)])}return new Nr(_)}}class On{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new On({name:t,available:!1}):null}}class Hn{constructor(t,n,o){this.from=t,this.to=n,this.transition=o}static interpolate(t,n,o){return new Hn(t,n,o)}static parse(t){return t instanceof Hn?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Hn(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Hn(t.from,t.to,t.transition):typeof t=="string"?new Hn(t,t,1):void 0}}function Ao(a,t,n,o){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof n=="number"&&n>=0&&n<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[a,t,n,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[a,t,n,o]:[a,t,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function la(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Hn||a instanceof pi||a instanceof Ss||a instanceof Mr||a instanceof on||a instanceof Nr||a instanceof On)return!0;if(Array.isArray(a)){for(const t of a)if(!la(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!la(a[t]))return!1;return!0}return!1}function Cr(a){if(a===null)return Ht;if(typeof a=="string")return zt;if(typeof a=="boolean")return Tt;if(typeof a=="number")return Xe;if(a instanceof pi)return li;if(a instanceof Hn)return Nt;if(a instanceof Ss)return ba;if(a instanceof Mr)return Tr;if(a instanceof on)return Wr;if(a instanceof Nr)return ic;if(a instanceof On)return Yi;if(Array.isArray(a)){const t=a.length;let n;for(const o of a){const f=Cr(o);if(n){if(n===f)continue;n=Mt;break}n=f}return sn(n||Mt,t)}return $t}function ca(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof pi||a instanceof Hn||a instanceof Mr||a instanceof on||a instanceof Nr||a instanceof On?a.toString():JSON.stringify(a)}class bn{constructor(t,n){this.type=t,this.value=n}static parse(t,n){if(t.length!==2)return n.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!la(t[1]))return n.error("invalid value");const o=t[1];let f=Cr(o);const g=n.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new bn(f,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const sl={string:zt,number:Xe,boolean:Tt,object:$t};class Xn{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let o,f=1;const g=t[0];if(g==="array"){let x,T;if(t.length>2){const E=t[1];if(typeof E!="string"||!(E in sl)||E==="object")return n.error('The item type argument of "array" must be one of string, number, boolean',1);x=sl[E],f++}else x=Mt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);T=t[2],f++}o=sn(x,T)}else{if(!sl[g])throw new Error(`Types doesn't contain name = ${g}`);o=sl[g]}const _=[];for(;f<t.length;f++){const x=n.parse(t[f],f,Mt);if(!x)return null;_.push(x)}return new Xn(o,_)}evaluate(t){for(let n=0;n<this.args.length;n++){const o=this.args[n].evaluate(t);if(!ns(this.type,Cr(o)))return o;if(n===this.args.length-1)throw new nr(`Expected value to be of type ${Pi(this.type)}, but found ${Pi(Cr(o))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const iu={"to-boolean":Tt,"to-color":li,"to-number":Xe,"to-string":zt};class Fn{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const o=t[0];if(!iu[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&t.length!==2)return n.error("Expected one argument.");const f=iu[o],g=[];for(let _=1;_<t.length;_++){const x=n.parse(t[_],_,Mt);if(!x)return null;g.push(x)}return new Fn(f,g)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let n,o;for(const f of this.args){if(n=f.evaluate(t),o=null,n instanceof pi)return n;if(typeof n=="string"){const g=t.parseColor(n);if(g)return g}else if(Array.isArray(n)&&(o=n.length<3||n.length>4?`Invalid rgba value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Ao(n[0],n[1],n[2],n[3]),!o))return new pi(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new nr(o||`Could not parse color from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"padding":{let n;for(const o of this.args){n=o.evaluate(t);const f=on.parse(n);if(f)return f}throw new nr(`Could not parse padding from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"variableAnchorOffsetCollection":{let n;for(const o of this.args){n=o.evaluate(t);const f=Nr.parse(n);if(f)return f}throw new nr(`Could not parse variableAnchorOffsetCollection from value '${typeof n=="string"?n:JSON.stringify(n)}'`)}case"number":{let n=null;for(const o of this.args){if(n=o.evaluate(t),n===null)return 0;const f=Number(n);if(!isNaN(f))return f}throw new nr(`Could not convert ${JSON.stringify(n)} to number.`)}case"formatted":return Mr.fromString(ca(this.args[0].evaluate(t)));case"resolvedImage":return On.fromString(ca(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ca(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Ui=["Unknown","Point","LineString","Polygon"];class qs{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ui[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let n=this._parseColorCache[t];return n||(n=this._parseColorCache[t]=pi.parse(t)),n}}class oi{constructor(t,n,o=[],f,g=new ii,_=[]){this.registry=t,this.path=o,this.key=o.map(x=>`[${x}]`).join(""),this.scope=g,this.errors=_,this.expectedType=f,this._isConstant=n}parse(t,n,o,f,g={}){return n?this.concat(n,o,f)._parse(t,g):this._parse(t,g)}_parse(t,n){function o(f,g,_){return _==="assert"?new Xn(g,[f]):_==="coerce"?new Fn(g,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[f];if(g){let _=g.parse(t,this);if(!_)return null;if(this.expectedType){const x=this.expectedType,T=_.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||T.kind!=="value")if(x.kind!=="projectionDefinition"||T.kind!=="string"&&T.kind!=="array")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string")if(x.kind!=="padding"||T.kind!=="value"&&T.kind!=="number"&&T.kind!=="array")if(x.kind!=="variableAnchorOffsetCollection"||T.kind!=="value"&&T.kind!=="array"){if(this.checkSubtype(x,T))return null}else _=o(_,x,n.typeAnnotation||"coerce");else _=o(_,x,n.typeAnnotation||"coerce");else _=o(_,x,n.typeAnnotation||"coerce");else _=o(_,x,n.typeAnnotation||"coerce");else _=o(_,x,n.typeAnnotation||"assert")}if(!(_ instanceof bn)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const x=new qs;try{_=new bn(_.type,_.evaluate(x))}catch(T){return this.error(T.message),null}}return _}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,n,o){const f=typeof t=="number"?this.path.concat(t):this.path,g=o?this.scope.concat(o):this.scope;return new oi(this.registry,this._isConstant,f,n||null,g,this.errors)}error(t,...n){const o=`${this.key}${n.map(f=>`[${f}]`).join("")}`;this.errors.push(new Dt(o,t))}checkSubtype(t,n){const o=ns(t,n);return o&&this.error(o),o}}class ni{constructor(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const n of this.bindings)t(n[1]);t(this.result)}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const o=[];for(let g=1;g<t.length-1;g+=2){const _=t[g];if(typeof _!="string")return n.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return n.error("Variable names must contain only alphanumeric characters or '_'.",g);const x=n.parse(t[g+1],g+1);if(!x)return null;o.push([_,x])}const f=n.parse(t[t.length-1],t.length-1,n.expectedType,o);return f?new ni(o,f):null}outputDefined(){return this.result.outputDefined()}}class Ts{constructor(t,n){this.type=n.type,this.name=t,this.boundExpression=n}static parse(t,n){if(t.length!==2||typeof t[1]!="string")return n.error("'var' expression requires exactly one string literal argument.");const o=t[1];return n.scope.has(o)?new Ts(o,n.scope.get(o)):n.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class mi{constructor(t,n,o){this.type=t,this.index=n,this.input=o}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Xe),f=n.parse(t[2],2,sn(n.expectedType||Mt));return o&&f?new mi(f.type.itemType,o,f):null}evaluate(t){const n=this.index.evaluate(t),o=this.input.evaluate(t);if(n<0)throw new nr(`Array index out of bounds: ${n} < 0.`);if(n>=o.length)throw new nr(`Array index out of bounds: ${n} > ${o.length-1}.`);if(n!==Math.floor(n))throw new nr(`Array index must be an integer, but found ${n} instead.`);return o[n]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Hs{constructor(t,n){this.type=Tt,this.needle=t,this.haystack=n}static parse(t,n){if(t.length!==3)return n.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Mt),f=n.parse(t[2],2,Mt);return o&&f?Co(o.type,[Tt,zt,Xe,Ht,Mt])?new Hs(o,f):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(o.type)} instead`):null}evaluate(t){const n=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!o)return!1;if(!aa(n,["boolean","string","number","null"]))throw new nr(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(Cr(n))} instead.`);if(!aa(o,["string","array"]))throw new nr(`Expected second argument to be of type array or string, but found ${Pi(Cr(o))} instead.`);return o.indexOf(n)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class jn{constructor(t,n,o){this.type=Xe,this.needle=t,this.haystack=n,this.fromIndex=o}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Mt),f=n.parse(t[2],2,Mt);if(!o||!f)return null;if(!Co(o.type,[Tt,zt,Xe,Ht,Mt]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(o.type)} instead`);if(t.length===4){const g=n.parse(t[3],3,Xe);return g?new jn(o,f,g):null}return new jn(o,f)}evaluate(t){const n=this.needle.evaluate(t),o=this.haystack.evaluate(t);if(!aa(n,["boolean","string","number","null"]))throw new nr(`Expected first argument to be of type boolean, string, number or null, but found ${Pi(Cr(n))} instead.`);let f;if(this.fromIndex&&(f=this.fromIndex.evaluate(t)),aa(o,["string"])){const g=o.indexOf(n,f);return g===-1?-1:[...o.slice(0,g)].length}if(aa(o,["array"]))return o.indexOf(n,f);throw new nr(`Expected second argument to be of type array or string, but found ${Pi(Cr(o))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class ol{constructor(t,n,o,f,g,_){this.inputType=t,this.type=n,this.input=o,this.cases=f,this.outputs=g,this.otherwise=_}static parse(t,n){if(t.length<5)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return n.error("Expected an even number of arguments.");let o,f;n.expectedType&&n.expectedType.kind!=="value"&&(f=n.expectedType);const g={},_=[];for(let E=2;E<t.length-1;E+=2){let D=t[E];const I=t[E+1];Array.isArray(D)||(D=[D]);const j=n.concat(E);if(D.length===0)return j.error("Expected at least one branch label.");for(const Z of D){if(typeof Z!="number"&&typeof Z!="string")return j.error("Branch labels must be numbers or strings.");if(typeof Z=="number"&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Z=="number"&&Math.floor(Z)!==Z)return j.error("Numeric branch labels must be integer values.");if(o){if(j.checkSubtype(o,Cr(Z)))return null}else o=Cr(Z);if(g[String(Z)]!==void 0)return j.error("Branch labels must be unique.");g[String(Z)]=_.length}const N=n.parse(I,E,f);if(!N)return null;f=f||N.type,_.push(N)}const x=n.parse(t[1],1,Mt);if(!x)return null;const T=n.parse(t[t.length-1],t.length-1,f);return T?x.type.kind!=="value"&&n.concat(1).checkSubtype(o,x.type)?null:new ol(o,f,x,g,_,T):null}evaluate(t){const n=this.input.evaluate(t);return(Cr(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class wn{constructor(t,n,o){this.type=t,this.branches=n,this.otherwise=o}static parse(t,n){if(t.length<4)return n.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return n.error("Expected an odd number of arguments.");let o;n.expectedType&&n.expectedType.kind!=="value"&&(o=n.expectedType);const f=[];for(let _=1;_<t.length-1;_+=2){const x=n.parse(t[_],_,Tt);if(!x)return null;const T=n.parse(t[_+1],_+1,o);if(!T)return null;f.push([x,T]),o=o||T.type}const g=n.parse(t[t.length-1],t.length-1,o);if(!g)return null;if(!o)throw new Error("Can't infer output type");return new wn(o,f,g)}evaluate(t){for(const[n,o]of this.branches)if(n.evaluate(t))return o.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[n,o]of this.branches)t(n),t(o);t(this.otherwise)}outputDefined(){return this.branches.every(([t,n])=>n.outputDefined())&&this.otherwise.outputDefined()}}class Za{constructor(t,n,o,f){this.type=t,this.input=n,this.beginIndex=o,this.endIndex=f}static parse(t,n){if(t.length<=2||t.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const o=n.parse(t[1],1,Mt),f=n.parse(t[2],2,Xe);if(!o||!f)return null;if(!Co(o.type,[sn(Mt),zt,Mt]))return n.error(`Expected first argument to be of type array or string, but found ${Pi(o.type)} instead`);if(t.length===4){const g=n.parse(t[3],3,Xe);return g?new Za(o.type,o,f,g):null}return new Za(o.type,o,f)}evaluate(t){const n=this.input.evaluate(t),o=this.beginIndex.evaluate(t);let f;if(this.endIndex&&(f=this.endIndex.evaluate(t)),aa(n,["string"]))return[...n].slice(o,f).join("");if(aa(n,["array"]))return n.slice(o,f);throw new nr(`Expected first argument to be of type array or string, but found ${Pi(Cr(n))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Ms(a,t){const n=a.length-1;let o,f,g=0,_=n,x=0;for(;g<=_;)if(x=Math.floor((g+_)/2),o=a[x],f=a[x+1],o<=t){if(x===n||t<f)return x;g=x+1}else{if(!(o>t))throw new nr("Input is not a number.");_=x-1}return 0}class os{constructor(t,n,o){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(const[f,g]of o)this.labels.push(f),this.outputs.push(g)}static parse(t,n){if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");const o=n.parse(t[1],1,Xe);if(!o)return null;const f=[];let g=null;n.expectedType&&n.expectedType.kind!=="value"&&(g=n.expectedType);for(let _=1;_<t.length;_+=2){const x=_===1?-1/0:t[_],T=t[_+1],E=_,D=_+1;if(typeof x!="number")return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(f.length&&f[f.length-1][0]>=x)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const I=n.parse(T,D,g);if(!I)return null;g=g||I.type,f.push([x,I])}return new os(g,o,f)}evaluate(t){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(t);const f=this.input.evaluate(t);if(f<=n[0])return o[0].evaluate(t);const g=n.length;return f>=n[g-1]?o[g-1].evaluate(t):o[Ms(n,f)].evaluate(t)}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ud(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var ll,rc,Cs=function(){if(rc)return ll;function a(t,n,o,f){this.cx=3*t,this.bx=3*(o-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(f-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=n,this.p2x=o,this.p2y=f}return rc=1,ll=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,n){if(n===void 0&&(n=1e-6),t<0)return 0;if(t>1)return 1;for(var o=t,f=0;f<8;f++){var g=this.sampleCurveX(o)-t;if(Math.abs(g)<n)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=g/_}var x=0,T=1;for(o=t,f=0;f<20&&(g=this.sampleCurveX(o),!(Math.abs(g-t)<n));f++)t>g?x=o:T=o,o=.5*(T-x)+x;return o},solve:function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))}},ll}(),Qr=ud(Cs);class Sn{constructor(t,n,o,f,g){this.type=t,this.operator=n,this.interpolation=o,this.input=f,this.labels=[],this.outputs=[];for(const[_,x]of g)this.labels.push(_),this.outputs.push(x)}static interpolationFactor(t,n,o,f){let g=0;if(t.name==="exponential")g=ru(n,t.base,o,f);else if(t.name==="linear")g=ru(n,1,o,f);else if(t.name==="cubic-bezier"){const _=t.controlPoints;g=new Qr(_[0],_[1],_[2],_[3]).solve(ru(n,1,o,f))}return g}static parse(t,n){let[o,f,g,..._]=t;if(!Array.isArray(f)||f.length===0)return n.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const E=f[1];if(typeof E!="number")return n.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:E}}else{if(f[0]!=="cubic-bezier")return n.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const E=f.slice(1);if(E.length!==4||E.some(D=>typeof D!="number"||D<0||D>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:E}}}if(t.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(g=n.parse(g,2,Xe),!g)return null;const x=[];let T=null;o==="interpolate-hcl"||o==="interpolate-lab"?T=li:n.expectedType&&n.expectedType.kind!=="value"&&(T=n.expectedType);for(let E=0;E<_.length;E+=2){const D=_[E],I=_[E+1],j=E+3,N=E+4;if(typeof D!="number")return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(x.length&&x[x.length-1][0]>=D)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const Z=n.parse(I,N,T);if(!Z)return null;T=T||Z.type,x.push([D,Z])}return dr(T,Xe)||dr(T,Nt)||dr(T,li)||dr(T,Wr)||dr(T,ic)||dr(T,sn(Xe))?new Sn(T,o,f,g,x):n.error(`Type ${Pi(T)} is not interpolatable.`)}evaluate(t){const n=this.labels,o=this.outputs;if(n.length===1)return o[0].evaluate(t);const f=this.input.evaluate(t);if(f<=n[0])return o[0].evaluate(t);const g=n.length;if(f>=n[g-1])return o[g-1].evaluate(t);const _=Ms(n,f),x=Sn.interpolationFactor(this.interpolation,f,n[_],n[_+1]),T=o[_].evaluate(t),E=o[_+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Bn(T,E,x);case"color":return pi.interpolate(T,E,x);case"padding":return on.interpolate(T,E,x);case"variableAnchorOffsetCollection":return Nr.interpolate(T,E,x);case"array":return sa(T,E,x);case"projectionDefinition":return Hn.interpolate(T,E,x)}case"interpolate-hcl":return pi.interpolate(T,E,x,"hcl");case"interpolate-lab":return pi.interpolate(T,E,x,"lab")}}eachChild(t){t(this.input);for(const n of this.outputs)t(n)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ru(a,t,n,o){const f=o-n,g=a-n;return f===0?0:t===1?g/f:(Math.pow(t,g)-1)/(Math.pow(t,f)-1)}const ua={color:pi.interpolate,number:Bn,padding:on.interpolate,variableAnchorOffsetCollection:Nr.interpolate,array:sa};class Dr{constructor(t,n){this.type=t,this.args=n}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");let o=null;const f=n.expectedType;f&&f.kind!=="value"&&(o=f);const g=[];for(const x of t.slice(1)){const T=n.parse(x,1+g.length,o,void 0,{typeAnnotation:"omit"});if(!T)return null;o=o||T.type,g.push(T)}if(!o)throw new Error("No output type");const _=f&&g.some(x=>ns(f,x.type));return new Dr(_?Mt:o,g)}evaluate(t){let n,o=null,f=0;for(const g of this.args)if(f++,o=g.evaluate(t),o&&o instanceof On&&!o.available&&(n||(n=o.name),o=null,f===this.args.length&&(o=n)),o!==null)break;return o}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function nc(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function nu(a,t,n,o){return o.compare(t,n)===0}function zo(a,t,n){const o=a!=="=="&&a!=="!=";return class Z_{constructor(g,_,x){this.type=Tt,this.lhs=g,this.rhs=_,this.collator=x,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const x=g[0];let T=_.parse(g[1],1,Mt);if(!T)return null;if(!nc(x,T.type))return _.concat(1).error(`"${x}" comparisons are not supported for type '${Pi(T.type)}'.`);let E=_.parse(g[2],2,Mt);if(!E)return null;if(!nc(x,E.type))return _.concat(2).error(`"${x}" comparisons are not supported for type '${Pi(E.type)}'.`);if(T.type.kind!==E.type.kind&&T.type.kind!=="value"&&E.type.kind!=="value")return _.error(`Cannot compare types '${Pi(T.type)}' and '${Pi(E.type)}'.`);o&&(T.type.kind==="value"&&E.type.kind!=="value"?T=new Xn(E.type,[T]):T.type.kind!=="value"&&E.type.kind==="value"&&(E=new Xn(T.type,[E])));let D=null;if(g.length===4){if(T.type.kind!=="string"&&E.type.kind!=="string"&&T.type.kind!=="value"&&E.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(D=_.parse(g[3],3,ba),!D)return null}return new Z_(T,E,D)}evaluate(g){const _=this.lhs.evaluate(g),x=this.rhs.evaluate(g);if(o&&this.hasUntypedArgument){const T=Cr(_),E=Cr(x);if(T.kind!==E.kind||T.kind!=="string"&&T.kind!=="number")throw new nr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${E.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const T=Cr(_),E=Cr(x);if(T.kind!=="string"||E.kind!=="string")return t(g,_,x)}return this.collator?n(g,_,x,this.collator.evaluate(g)):t(g,_,x)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const hd=zo("==",function(a,t,n){return t===n},nu),au=zo("!=",function(a,t,n){return t!==n},function(a,t,n,o){return!nu(0,t,n,o)}),uh=zo("<",function(a,t,n){return t<n},function(a,t,n,o){return o.compare(t,n)<0}),lf=zo(">",function(a,t,n){return t>n},function(a,t,n,o){return o.compare(t,n)>0}),su=zo("<=",function(a,t,n){return t<=n},function(a,t,n,o){return o.compare(t,n)<=0}),ou=zo(">=",function(a,t,n){return t>=n},function(a,t,n,o){return o.compare(t,n)>=0});class Yn{constructor(t,n,o){this.type=ba,this.locale=o,this.caseSensitive=t,this.diacriticSensitive=n}static parse(t,n){if(t.length!==2)return n.error("Expected one argument.");const o=t[1];if(typeof o!="object"||Array.isArray(o))return n.error("Collator options argument must be an object.");const f=n.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,Tt);if(!f)return null;const g=n.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,Tt);if(!g)return null;let _=null;return o.locale&&(_=n.parse(o.locale,1,zt),!_)?null:new Yn(f,g,_)}evaluate(t){return new Ss(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class lu{constructor(t,n,o,f,g){this.type=zt,this.number=t,this.locale=n,this.currency=o,this.minFractionDigits=f,this.maxFractionDigits=g}static parse(t,n){if(t.length!==3)return n.error("Expected two arguments.");const o=n.parse(t[1],1,Xe);if(!o)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return n.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=n.parse(f.locale,1,zt),!g))return null;let _=null;if(f.currency&&(_=n.parse(f.currency,1,zt),!_))return null;let x=null;if(f["min-fraction-digits"]&&(x=n.parse(f["min-fraction-digits"],1,Xe),!x))return null;let T=null;return f["max-fraction-digits"]&&(T=n.parse(f["max-fraction-digits"],1,Xe),!T)?null:new lu(o,g,_,x,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Es{constructor(t){this.type=Tr,this.sections=t}static parse(t,n){if(t.length<2)return n.error("Expected at least one argument.");const o=t[1];if(!Array.isArray(o)&&typeof o=="object")return n.error("First argument must be an image or text section.");const f=[];let g=!1;for(let _=1;_<=t.length-1;++_){const x=t[_];if(g&&typeof x=="object"&&!Array.isArray(x)){g=!1;let T=null;if(x["font-scale"]&&(T=n.parse(x["font-scale"],1,Xe),!T))return null;let E=null;if(x["text-font"]&&(E=n.parse(x["text-font"],1,sn(zt)),!E))return null;let D=null;if(x["text-color"]&&(D=n.parse(x["text-color"],1,li),!D))return null;let I=null;if(x["vertical-align"]){if(typeof x["vertical-align"]=="string"&&!eu.includes(x["vertical-align"]))return n.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${x["vertical-align"]}' instead.`);if(I=n.parse(x["vertical-align"],1,zt),!I)return null}const j=f[f.length-1];j.scale=T,j.font=E,j.textColor=D,j.verticalAlign=I}else{const T=n.parse(t[_],1,Mt);if(!T)return null;const E=T.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Es(f)}evaluate(t){return new Mr(this.sections.map(n=>{const o=n.content.evaluate(t);return Cr(o)===Yi?new oa("",o,null,null,null,n.verticalAlign?n.verticalAlign.evaluate(t):null):new oa(ca(o),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null,n.verticalAlign?n.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const n of this.sections)t(n.content),n.scale&&t(n.scale),n.font&&t(n.font),n.textColor&&t(n.textColor),n.verticalAlign&&t(n.verticalAlign)}outputDefined(){return!1}}class hh{constructor(t){this.type=Yi,this.input=t}static parse(t,n){if(t.length!==2)return n.error("Expected two arguments.");const o=n.parse(t[1],1,zt);return o?new hh(o):n.error("No image name provided.")}evaluate(t){const n=this.input.evaluate(t),o=On.fromString(n);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(n)>-1),o}eachChild(t){t(this.input)}outputDefined(){return!1}}class ac{constructor(t){this.type=Xe,this.input=t}static parse(t,n){if(t.length!==2)return n.error(`Expected 1 argument, but found ${t.length-1} instead.`);const o=n.parse(t[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?n.error(`Expected argument of type string or array, but found ${Pi(o.type)} instead.`):new ac(o):null}evaluate(t){const n=this.input.evaluate(t);if(typeof n=="string")return[...n].length;if(Array.isArray(n))return n.length;throw new nr(`Expected value to be of type string or array, but found ${Pi(Cr(n))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const ls=8192;function cf(a,t){const n=(180+a[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(n*f*ls),Math.round(o*f*ls)]}function fh(a,t){const n=Math.pow(2,t.z);return[(f=(a[0]/ls+t.x)/n,360*f-180),(o=(a[1]/ls+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,f}function sc(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function Xs(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function fd(a,t,n){const o=a[0]-t[0],f=a[1]-t[1],g=a[0]-n[0],_=a[1]-n[1];return o*_-g*f==0&&o*g<=0&&f*_<=0}function oc(a,t,n,o){return(f=[o[0]-n[0],o[1]-n[1]])[0]*(g=[t[0]-a[0],t[1]-a[1]])[1]-f[1]*g[0]!=0&&!(!ul(a,t,n,o)||!ul(n,o,a,t));var f,g}function uf(a,t,n){for(const o of n)for(let f=0;f<o.length-1;++f)if(oc(a,t,o[f],o[f+1]))return!0;return!1}function cl(a,t,n=!1){let o=!1;for(const x of t)for(let T=0;T<x.length-1;T++){if(fd(a,x[T],x[T+1]))return n;(g=x[T])[1]>(f=a)[1]!=(_=x[T+1])[1]>f[1]&&f[0]<(_[0]-g[0])*(f[1]-g[1])/(_[1]-g[1])+g[0]&&(o=!o)}var f,g,_;return o}function hf(a,t){for(const n of t)if(cl(a,n))return!0;return!1}function ff(a,t){for(const n of a)if(!cl(n,t))return!1;for(let n=0;n<a.length-1;++n)if(uf(a[n],a[n+1],t))return!1;return!0}function dh(a,t){for(const n of t)if(ff(a,n))return!0;return!1}function ul(a,t,n,o){const f=o[0]-n[0],g=o[1]-n[1],_=(a[0]-n[0])*g-f*(a[1]-n[1]),x=(t[0]-n[0])*g-f*(t[1]-n[1]);return _>0&&x<0||_<0&&x>0}function ph(a,t,n){const o=[];for(let f=0;f<a.length;f++){const g=[];for(let _=0;_<a[f].length;_++){const x=cf(a[f][_],n);sc(t,x),g.push(x)}o.push(g)}return o}function mh(a,t,n){const o=[];for(let f=0;f<a.length;f++){const g=ph(a[f],t,n);o.push(g)}return o}function cu(a,t,n,o){if(a[0]<n[0]||a[0]>n[2]){const f=.5*o;let g=a[0]-n[0]>f?-o:n[0]-a[0]>f?o:0;g===0&&(g=a[0]-n[2]>f?-o:n[2]-a[0]>f?o:0),a[0]+=g}sc(t,a)}function uu(a,t,n,o){const f=Math.pow(2,o.z)*ls,g=[o.x*ls,o.y*ls],_=[];for(const x of a)for(const T of x){const E=[T.x+g[0],T.y+g[1]];cu(E,t,n,f),_.push(E)}return _}function hu(a,t,n,o){const f=Math.pow(2,o.z)*ls,g=[o.x*ls,o.y*ls],_=[];for(const T of a){const E=[];for(const D of T){const I=[D.x+g[0],D.y+g[1]];sc(t,I),E.push(I)}_.push(E)}if(t[2]-t[0]<=f/2){(x=t)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const T of _)for(const E of T)cu(E,t,n,f)}var x;return _}class Ys{constructor(t,n){this.type=Tt,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(la(t[1])){const o=t[1];if(o.type==="FeatureCollection"){const f=[];for(const g of o.features){const{type:_,coordinates:x}=g.geometry;_==="Polygon"&&f.push(x),_==="MultiPolygon"&&f.push(...x)}if(f.length)return new Ys(o,{type:"MultiPolygon",coordinates:f})}else if(o.type==="Feature"){const f=o.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Ys(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new Ys(o,o)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,o){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(o.type==="Polygon"){const x=ph(o.coordinates,g,_),T=uu(n.geometry(),f,g,_);if(!Xs(f,g))return!1;for(const E of T)if(!cl(E,x))return!1}if(o.type==="MultiPolygon"){const x=mh(o.coordinates,g,_),T=uu(n.geometry(),f,g,_);if(!Xs(f,g))return!1;for(const E of T)if(!hf(E,x))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,o){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=n.canonicalID();if(o.type==="Polygon"){const x=ph(o.coordinates,g,_),T=hu(n.geometry(),f,g,_);if(!Xs(f,g))return!1;for(const E of T)if(!ff(E,x))return!1}if(o.type==="MultiPolygon"){const x=mh(o.coordinates,g,_),T=hu(n.geometry(),f,g,_);if(!Xs(f,g))return!1;for(const E of T)if(!dh(E,x))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Po=class{constructor(a=[],t=(n,o)=>n<o?-1:n>o?1:0){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:n}=this,o=t[a];for(;a>0;){const f=a-1>>1,g=t[f];if(n(o,g)>=0)break;t[a]=g,a=f}t[a]=o}_down(a){const{data:t,compare:n}=this,o=this.length>>1,f=t[a];for(;a<o;){let g=1+(a<<1);const _=g+1;if(_<this.length&&n(t[_],t[g])<0&&(g=_),n(t[g],f)>=0)break;t[a]=t[g],a=g}t[a]=f}};function df(a,t,n=0,o=a.length-1,f=dd){for(;o>n;){if(o-n>600){const T=o-n+1,E=t-n+1,D=Math.log(T),I=.5*Math.exp(2*D/3),j=.5*Math.sqrt(D*I*(T-I)/T)*(E-T/2<0?-1:1);df(a,t,Math.max(n,Math.floor(t-E*I/T+j)),Math.min(o,Math.floor(t+(T-E)*I/T+j)),f)}const g=a[t];let _=n,x=o;for(Ro(a,n,t),f(a[o],g)>0&&Ro(a,n,o);_<x;){for(Ro(a,_,x),_++,x--;f(a[_],g)<0;)_++;for(;f(a[x],g)>0;)x--}f(a[n],g)===0?Ro(a,n,x):(x++,Ro(a,x,o)),x<=t&&(n=x+1),t<=x&&(o=x-1)}}function Ro(a,t,n){const o=a[t];a[t]=a[n],a[n]=o}function dd(a,t){return a<t?-1:a>t?1:0}function lc(a,t){if(a.length<=1)return[a];const n=[];let o,f;for(const g of a){const _=hl(g);_!==0&&(g.area=Math.abs(_),f===void 0&&(f=_<0),f===_<0?(o&&n.push(o),o=[g]):o.push(g))}if(o&&n.push(o),t>1)for(let g=0;g<n.length;g++)n[g].length<=t||(df(n[g],t,1,n[g].length-1,pf),n[g]=n[g].slice(0,t));return n}function pf(a,t){return t.area-a.area}function hl(a){let t=0;for(let n,o,f=0,g=a.length,_=g-1;f<g;_=f++)n=a[f],o=a[_],t+=(o.x-n.x)*(n.y+o.y);return t}const Do=1/298.257223563,mf=Do*(2-Do),cc=Math.PI/180;class uc{constructor(t){const n=6378.137*cc*1e3,o=Math.cos(t*cc),f=1/(1-mf*(1-o*o)),g=Math.sqrt(f);this.kx=n*g*o,this.ky=n*g*f*(1-mf)}distance(t,n){const o=this.wrap(t[0]-n[0])*this.kx,f=(t[1]-n[1])*this.ky;return Math.sqrt(o*o+f*f)}pointOnLine(t,n){let o,f,g,_,x=1/0;for(let T=0;T<t.length-1;T++){let E=t[T][0],D=t[T][1],I=this.wrap(t[T+1][0]-E)*this.kx,j=(t[T+1][1]-D)*this.ky,N=0;I===0&&j===0||(N=(this.wrap(n[0]-E)*this.kx*I+(n[1]-D)*this.ky*j)/(I*I+j*j),N>1?(E=t[T+1][0],D=t[T+1][1]):N>0&&(E+=I/this.kx*N,D+=j/this.ky*N)),I=this.wrap(n[0]-E)*this.kx,j=(n[1]-D)*this.ky;const Z=I*I+j*j;Z<x&&(x=Z,o=E,f=D,g=T,_=N)}return{point:[o,f],index:g,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function fu(a,t){return t[0]-a[0]}function fl(a){return a[1]-a[0]+1}function Ga(a,t){return a[1]>=a[0]&&a[1]<t}function du(a,t){if(a[0]>a[1])return[null,null];const n=fl(a);if(t){if(n===2)return[a,null];const f=Math.floor(n/2);return[[a[0],a[0]+f],[a[0]+f,a[1]]]}if(n===1)return[a,null];const o=Math.floor(n/2)-1;return[[a[0],a[0]+o],[a[0]+o+1,a[1]]]}function hc(a,t){if(!Ga(t,a.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let o=t[0];o<=t[1];++o)sc(n,a[o]);return n}function pu(a){const t=[1/0,1/0,-1/0,-1/0];for(const n of a)for(const o of n)sc(t,o);return t}function gf(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function gh(a,t,n){if(!gf(a)||!gf(t))return NaN;let o=0,f=0;return a[2]<t[0]&&(o=t[0]-a[2]),a[0]>t[2]&&(o=a[0]-t[2]),a[1]>t[3]&&(f=a[1]-t[3]),a[3]<t[1]&&(f=t[1]-a[3]),n.distance([0,0],[o,f])}function Io(a,t,n){const o=n.pointOnLine(t,a);return n.distance(a,o.point)}function Ti(a,t,n,o,f){const g=Math.min(Io(a,[n,o],f),Io(t,[n,o],f)),_=Math.min(Io(n,[a,t],f),Io(o,[a,t],f));return Math.min(g,_)}function pd(a,t,n,o,f){if(!Ga(t,a.length)||!Ga(o,n.length))return 1/0;let g=1/0;for(let _=t[0];_<t[1];++_){const x=a[_],T=a[_+1];for(let E=o[0];E<o[1];++E){const D=n[E],I=n[E+1];if(oc(x,T,D,I))return 0;g=Math.min(g,Ti(x,T,D,I,f))}}return g}function ha(a,t,n,o,f){if(!Ga(t,a.length)||!Ga(o,n.length))return NaN;let g=1/0;for(let _=t[0];_<=t[1];++_)for(let x=o[0];x<=o[1];++x)if(g=Math.min(g,f.distance(a[_],n[x])),g===0)return g;return g}function fc(a,t,n){if(cl(a,t,!0))return 0;let o=1/0;for(const f of t){const g=f[0],_=f[f.length-1];if(g!==_&&(o=Math.min(o,Io(a,[_,g],n)),o===0))return o;const x=n.pointOnLine(f,a);if(o=Math.min(o,n.distance(a,x.point)),o===0)return o}return o}function _f(a,t,n,o){if(!Ga(t,a.length))return NaN;for(let g=t[0];g<=t[1];++g)if(cl(a[g],n,!0))return 0;let f=1/0;for(let g=t[0];g<t[1];++g){const _=a[g],x=a[g+1];for(const T of n)for(let E=0,D=T.length,I=D-1;E<D;I=E++){const j=T[I],N=T[E];if(oc(_,x,j,N))return 0;f=Math.min(f,Ti(_,x,j,N,o))}}return f}function _h(a,t){for(const n of a)for(const o of n)if(cl(o,t,!0))return!0;return!1}function yf(a,t,n,o=1/0){const f=pu(a),g=pu(t);if(o!==1/0&&gh(f,g,n)>=o)return o;if(Xs(f,g)){if(_h(a,t))return 0}else if(_h(t,a))return 0;let _=1/0;for(const x of a)for(let T=0,E=x.length,D=E-1;T<E;D=T++){const I=x[D],j=x[T];for(const N of t)for(let Z=0,H=N.length,W=H-1;Z<H;W=Z++){const re=N[W],_e=N[Z];if(oc(I,j,re,_e))return 0;_=Math.min(_,Ti(I,j,re,_e,n))}}return _}function yh(a,t,n,o,f,g){if(!g)return;const _=gh(hc(o,g),f,n);_<t&&a.push([_,g,[0,0]])}function dl(a,t,n,o,f,g,_){if(!g||!_)return;const x=gh(hc(o,g),hc(f,_),n);x<t&&a.push([x,g,_])}function mu(a,t,n,o,f=1/0){let g=Math.min(o.distance(a[0],n[0][0]),f);if(g===0)return g;const _=new Po([[0,[0,a.length-1],[0,0]]],fu),x=pu(n);for(;_.length>0;){const T=_.pop();if(T[0]>=g)continue;const E=T[1],D=t?50:100;if(fl(E)<=D){if(!Ga(E,a.length))return NaN;if(t){const I=_f(a,E,n,o);if(isNaN(I)||I===0)return I;g=Math.min(g,I)}else for(let I=E[0];I<=E[1];++I){const j=fc(a[I],n,o);if(g=Math.min(g,j),g===0)return 0}}else{const I=du(E,t);yh(_,g,o,a,x,I[0]),yh(_,g,o,a,x,I[1])}}return g}function gu(a,t,n,o,f,g=1/0){let _=Math.min(g,f.distance(a[0],n[0]));if(_===0)return _;const x=new Po([[0,[0,a.length-1],[0,n.length-1]]],fu);for(;x.length>0;){const T=x.pop();if(T[0]>=_)continue;const E=T[1],D=T[2],I=t?50:100,j=o?50:100;if(fl(E)<=I&&fl(D)<=j){if(!Ga(E,a.length)&&Ga(D,n.length))return NaN;let N;if(t&&o)N=pd(a,E,n,D,f),_=Math.min(_,N);else if(t&&!o){const Z=a.slice(E[0],E[1]+1);for(let H=D[0];H<=D[1];++H)if(N=Io(n[H],Z,f),_=Math.min(_,N),_===0)return _}else if(!t&&o){const Z=n.slice(D[0],D[1]+1);for(let H=E[0];H<=E[1];++H)if(N=Io(a[H],Z,f),_=Math.min(_,N),_===0)return _}else N=ha(a,E,n,D,f),_=Math.min(_,N)}else{const N=du(E,t),Z=du(D,o);dl(x,_,f,a,n,N[0],Z[0]),dl(x,_,f,a,n,N[0],Z[1]),dl(x,_,f,a,n,N[1],Z[0]),dl(x,_,f,a,n,N[1],Z[1])}}return _}function Ks(a){return a.type==="MultiPolygon"?a.coordinates.map(t=>({type:"Polygon",coordinates:t})):a.type==="MultiLineString"?a.coordinates.map(t=>({type:"LineString",coordinates:t})):a.type==="MultiPoint"?a.coordinates.map(t=>({type:"Point",coordinates:t})):[a]}class As{constructor(t,n){this.type=Xe,this.geojson=t,this.geometries=n}static parse(t,n){if(t.length!==2)return n.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(la(t[1])){const o=t[1];if(o.type==="FeatureCollection")return new As(o,o.features.map(f=>Ks(f.geometry)).flat());if(o.type==="Feature")return new As(o,Ks(o.geometry));if("type"in o&&"coordinates"in o)return new As(o,Ks(o))}return n.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(n,o){const f=n.geometry(),g=f.flat().map(T=>fh([T.x,T.y],n.canonical));if(f.length===0)return NaN;const _=new uc(g[0][1]);let x=1/0;for(const T of o){switch(T.type){case"Point":x=Math.min(x,gu(g,!1,[T.coordinates],!1,_,x));break;case"LineString":x=Math.min(x,gu(g,!1,T.coordinates,!0,_,x));break;case"Polygon":x=Math.min(x,mu(g,!1,T.coordinates,_,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="LineString")return function(n,o){const f=n.geometry(),g=f.flat().map(T=>fh([T.x,T.y],n.canonical));if(f.length===0)return NaN;const _=new uc(g[0][1]);let x=1/0;for(const T of o){switch(T.type){case"Point":x=Math.min(x,gu(g,!0,[T.coordinates],!1,_,x));break;case"LineString":x=Math.min(x,gu(g,!0,T.coordinates,!0,_,x));break;case"Polygon":x=Math.min(x,mu(g,!0,T.coordinates,_,x))}if(x===0)return x}return x}(t,this.geometries);if(t.geometryType()==="Polygon")return function(n,o){const f=n.geometry();if(f.length===0||f[0].length===0)return NaN;const g=lc(f,0).map(T=>T.map(E=>E.map(D=>fh([D.x,D.y],n.canonical)))),_=new uc(g[0][0][0][1]);let x=1/0;for(const T of o)for(const E of g){switch(T.type){case"Point":x=Math.min(x,mu([T.coordinates],!1,E,_,x));break;case"LineString":x=Math.min(x,mu(T.coordinates,!0,E,_,x));break;case"Polygon":x=Math.min(x,yf(E,T.coordinates,_,x))}if(x===0)return x}return x}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const cs={"==":hd,"!=":au,">":lf,"<":uh,">=":ou,"<=":su,array:Xn,at:mi,boolean:Xn,case:wn,coalesce:Dr,collator:Yn,format:Es,image:hh,in:Hs,"index-of":jn,interpolate:Sn,"interpolate-hcl":Sn,"interpolate-lab":Sn,length:ac,let:ni,literal:bn,match:ol,number:Xn,"number-format":lu,object:Xn,slice:Za,step:os,string:Xn,"to-boolean":Fn,"to-color":Fn,"to-number":Fn,"to-string":Fn,var:Ts,within:Ys,distance:As};class Kn{constructor(t,n,o,f){this.name=t,this.type=n,this._evaluate=o,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,n){const o=t[0],f=Kn.definitions[o];if(!f)return n.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(f)?f[0]:f.type,_=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,x=_.filter(([E])=>!Array.isArray(E)||E.length===t.length-1);let T=null;for(const[E,D]of x){T=new oi(n.registry,dc,n.path,null,n.scope);const I=[];let j=!1;for(let N=1;N<t.length;N++){const Z=t[N],H=Array.isArray(E)?E[N-1]:E.type,W=T.parse(Z,1+I.length,H);if(!W){j=!0;break}I.push(W)}if(!j)if(Array.isArray(E)&&E.length!==I.length)T.error(`Expected ${E.length} arguments, but found ${I.length} instead.`);else{for(let N=0;N<I.length;N++){const Z=Array.isArray(E)?E[N]:E.type,H=I[N];T.concat(N+1).checkSubtype(Z,H.type)}if(T.errors.length===0)return new Kn(o,g,D,I)}}if(x.length===1)n.errors.push(...T.errors);else{const E=(x.length?x:_).map(([I])=>{return j=I,Array.isArray(j)?`(${j.map(Pi).join(", ")})`:`(${Pi(j.type)}...)`;var j}).join(" | "),D=[];for(let I=1;I<t.length;I++){const j=n.parse(t[I],1+D.length);if(!j)return null;D.push(Pi(j.type))}n.error(`Expected arguments of type ${E}, but found (${D.join(", ")}) instead.`)}return null}static register(t,n){Kn.definitions=n;for(const o in n)t[o]=Kn}}function vh(a,[t,n,o,f]){t=t.evaluate(a),n=n.evaluate(a),o=o.evaluate(a);const g=f?f.evaluate(a):1,_=Ao(t,n,o,g);if(_)throw new nr(_);return new pi(t/255,n/255,o/255,g,!1)}function Ws(a,t){return a in t}function Qs(a,t){const n=t[a];return n===void 0?null:n}function zs(a){return{type:a}}function dc(a){if(a instanceof Ts)return dc(a.boundExpression);if(a instanceof Kn&&a.name==="error"||a instanceof Yn||a instanceof Ys||a instanceof As)return!1;const t=a instanceof Fn||a instanceof Xn;let n=!0;return a.eachChild(o=>{n=t?n&&dc(o):n&&o instanceof bn}),!!n&&us(a)&&pc(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function us(a){if(a instanceof Kn&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Ys||a instanceof As)return!1;let t=!0;return a.eachChild(n=>{t&&!us(n)&&(t=!1)}),t}function pl(a){if(a instanceof Kn&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(n=>{t&&!pl(n)&&(t=!1)}),t}function pc(a,t){if(a instanceof Kn&&t.indexOf(a.name)>=0)return!1;let n=!0;return a.eachChild(o=>{n&&!pc(o,t)&&(n=!1)}),n}function xh(a){return{result:"success",value:a}}function ml(a){return{result:"error",value:a}}function gl(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function vf(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function _u(a){return!!a.expression&&a.expression.interpolated}function xi(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function mc(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function $a(a){return a}function fa(a,t){const n=t.type==="color",o=a.stops&&typeof a.stops[0][0]=="object",f=o||!(o||a.property!==void 0),g=a.type||(_u(t)?"exponential":"interval");if(n||t.type==="padding"){const D=n?pi.parse:on.parse;(a=_t({},a)).stops&&(a.stops=a.stops.map(I=>[I[0],D(I[1])])),a.default=D(a.default?a.default:t.default)}if(a.colorSpace&&(_=a.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var _;let x,T,E;if(g==="exponential")x=gc;else if(g==="interval")x=yu;else if(g==="categorical"){x=bh,T=Object.create(null);for(const D of a.stops)T[D[0]]=D[1];E=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);x=vu}if(o){const D={},I=[];for(let Z=0;Z<a.stops.length;Z++){const H=a.stops[Z],W=H[0].zoom;D[W]===void 0&&(D[W]={zoom:W,type:a.type,property:a.property,default:a.default,stops:[]},I.push(W)),D[W].stops.push([H[0].value,H[1]])}const j=[];for(const Z of I)j.push([D[Z].zoom,fa(D[Z],t)]);const N={name:"linear"};return{kind:"composite",interpolationType:N,interpolationFactor:Sn.interpolationFactor.bind(void 0,N),zoomStops:j.map(Z=>Z[0]),evaluate:({zoom:Z},H)=>gc({stops:j,base:a.base},t,Z).evaluate(Z,H)}}if(f){const D=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Sn.interpolationFactor.bind(void 0,D),zoomStops:a.stops.map(I=>I[0]),evaluate:({zoom:I})=>x(a,t,I,T,E)}}return{kind:"source",evaluate(D,I){const j=I&&I.properties?I.properties[a.property]:void 0;return j===void 0?wa(a.default,t.default):x(a,t,j,T,E)}}}function wa(a,t,n){return a!==void 0?a:t!==void 0?t:n!==void 0?n:void 0}function bh(a,t,n,o,f){return wa(typeof n===f?o[n]:void 0,a.default,t.default)}function yu(a,t,n){if(xi(n)!=="number")return wa(a.default,t.default);const o=a.stops.length;if(o===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[o-1][0])return a.stops[o-1][1];const f=Ms(a.stops.map(g=>g[0]),n);return a.stops[f][1]}function gc(a,t,n){const o=a.base!==void 0?a.base:1;if(xi(n)!=="number")return wa(a.default,t.default);const f=a.stops.length;if(f===1||n<=a.stops[0][0])return a.stops[0][1];if(n>=a.stops[f-1][0])return a.stops[f-1][1];const g=Ms(a.stops.map(D=>D[0]),n),_=function(D,I,j,N){const Z=N-j,H=D-j;return Z===0?0:I===1?H/Z:(Math.pow(I,H)-1)/(Math.pow(I,Z)-1)}(n,o,a.stops[g][0],a.stops[g+1][0]),x=a.stops[g][1],T=a.stops[g+1][1],E=ua[t.type]||$a;return typeof x.evaluate=="function"?{evaluate(...D){const I=x.evaluate.apply(void 0,D),j=T.evaluate.apply(void 0,D);if(I!==void 0&&j!==void 0)return E(I,j,_,a.colorSpace)}}:E(x,T,_,a.colorSpace)}function vu(a,t,n){switch(t.type){case"color":n=pi.parse(n);break;case"formatted":n=Mr.fromString(n.toString());break;case"resolvedImage":n=On.fromString(n.toString());break;case"padding":n=on.parse(n);break;default:xi(n)===t.type||t.type==="enum"&&t.values[n]||(n=void 0)}return wa(n,a.default,t.default)}Kn.register(cs,{error:[{kind:"error"},[zt],(a,[t])=>{throw new nr(t.evaluate(a))}],typeof:[zt,[Mt],(a,[t])=>Pi(Cr(t.evaluate(a)))],"to-rgba":[sn(Xe,4),[li],(a,[t])=>{const[n,o,f,g]=t.evaluate(a).rgb;return[255*n,255*o,255*f,g]}],rgb:[li,[Xe,Xe,Xe],vh],rgba:[li,[Xe,Xe,Xe,Xe],vh],has:{type:Tt,overloads:[[[zt],(a,[t])=>Ws(t.evaluate(a),a.properties())],[[zt,$t],(a,[t,n])=>Ws(t.evaluate(a),n.evaluate(a))]]},get:{type:Mt,overloads:[[[zt],(a,[t])=>Qs(t.evaluate(a),a.properties())],[[zt,$t],(a,[t,n])=>Qs(t.evaluate(a),n.evaluate(a))]]},"feature-state":[Mt,[zt],(a,[t])=>Qs(t.evaluate(a),a.featureState||{})],properties:[$t,[],a=>a.properties()],"geometry-type":[zt,[],a=>a.geometryType()],id:[Mt,[],a=>a.id()],zoom:[Xe,[],a=>a.globals.zoom],"heatmap-density":[Xe,[],a=>a.globals.heatmapDensity||0],"line-progress":[Xe,[],a=>a.globals.lineProgress||0],accumulated:[Mt,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Xe,zs(Xe),(a,t)=>{let n=0;for(const o of t)n+=o.evaluate(a);return n}],"*":[Xe,zs(Xe),(a,t)=>{let n=1;for(const o of t)n*=o.evaluate(a);return n}],"-":{type:Xe,overloads:[[[Xe,Xe],(a,[t,n])=>t.evaluate(a)-n.evaluate(a)],[[Xe],(a,[t])=>-t.evaluate(a)]]},"/":[Xe,[Xe,Xe],(a,[t,n])=>t.evaluate(a)/n.evaluate(a)],"%":[Xe,[Xe,Xe],(a,[t,n])=>t.evaluate(a)%n.evaluate(a)],ln2:[Xe,[],()=>Math.LN2],pi:[Xe,[],()=>Math.PI],e:[Xe,[],()=>Math.E],"^":[Xe,[Xe,Xe],(a,[t,n])=>Math.pow(t.evaluate(a),n.evaluate(a))],sqrt:[Xe,[Xe],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[Xe,[Xe],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[Xe,[Xe],(a,[t])=>Math.log(t.evaluate(a))],log2:[Xe,[Xe],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[Xe,[Xe],(a,[t])=>Math.sin(t.evaluate(a))],cos:[Xe,[Xe],(a,[t])=>Math.cos(t.evaluate(a))],tan:[Xe,[Xe],(a,[t])=>Math.tan(t.evaluate(a))],asin:[Xe,[Xe],(a,[t])=>Math.asin(t.evaluate(a))],acos:[Xe,[Xe],(a,[t])=>Math.acos(t.evaluate(a))],atan:[Xe,[Xe],(a,[t])=>Math.atan(t.evaluate(a))],min:[Xe,zs(Xe),(a,t)=>Math.min(...t.map(n=>n.evaluate(a)))],max:[Xe,zs(Xe),(a,t)=>Math.max(...t.map(n=>n.evaluate(a)))],abs:[Xe,[Xe],(a,[t])=>Math.abs(t.evaluate(a))],round:[Xe,[Xe],(a,[t])=>{const n=t.evaluate(a);return n<0?-Math.round(-n):Math.round(n)}],floor:[Xe,[Xe],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[Xe,[Xe],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[Tt,[zt,Mt],(a,[t,n])=>a.properties()[t.value]===n.value],"filter-id-==":[Tt,[Mt],(a,[t])=>a.id()===t.value],"filter-type-==":[Tt,[zt],(a,[t])=>a.geometryType()===t.value],"filter-<":[Tt,[zt,Mt],(a,[t,n])=>{const o=a.properties()[t.value],f=n.value;return typeof o==typeof f&&o<f}],"filter-id-<":[Tt,[Mt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n<o}],"filter->":[Tt,[zt,Mt],(a,[t,n])=>{const o=a.properties()[t.value],f=n.value;return typeof o==typeof f&&o>f}],"filter-id->":[Tt,[Mt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n>o}],"filter-<=":[Tt,[zt,Mt],(a,[t,n])=>{const o=a.properties()[t.value],f=n.value;return typeof o==typeof f&&o<=f}],"filter-id-<=":[Tt,[Mt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n<=o}],"filter->=":[Tt,[zt,Mt],(a,[t,n])=>{const o=a.properties()[t.value],f=n.value;return typeof o==typeof f&&o>=f}],"filter-id->=":[Tt,[Mt],(a,[t])=>{const n=a.id(),o=t.value;return typeof n==typeof o&&n>=o}],"filter-has":[Tt,[Mt],(a,[t])=>t.value in a.properties()],"filter-has-id":[Tt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Tt,[sn(zt)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[Tt,[sn(Mt)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[Tt,[zt,sn(Mt)],(a,[t,n])=>n.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[Tt,[zt,sn(Mt)],(a,[t,n])=>function(o,f,g,_){for(;g<=_;){const x=g+_>>1;if(f[x]===o)return!0;f[x]>o?_=x-1:g=x+1}return!1}(a.properties()[t.value],n.value,0,n.value.length-1)],all:{type:Tt,overloads:[[[Tt,Tt],(a,[t,n])=>t.evaluate(a)&&n.evaluate(a)],[zs(Tt),(a,t)=>{for(const n of t)if(!n.evaluate(a))return!1;return!0}]]},any:{type:Tt,overloads:[[[Tt,Tt],(a,[t,n])=>t.evaluate(a)||n.evaluate(a)],[zs(Tt),(a,t)=>{for(const n of t)if(n.evaluate(a))return!0;return!1}]]},"!":[Tt,[Tt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[Tt,[zt],(a,[t])=>{const n=a.globals&&a.globals.isSupportedScript;return!n||n(t.evaluate(a))}],upcase:[zt,[zt],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[zt,[zt],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[zt,zs(Mt),(a,t)=>t.map(n=>ca(n.evaluate(a))).join("")],"resolved-locale":[zt,[ba],(a,[t])=>t.evaluate(a).resolvedLocale()]});class hs{constructor(t,n){var o;this.expression=t,this._warningHistory={},this._evaluator=new qs,this._defaultValue=n?(o=n).type==="color"&&mc(o.default)?new pi(0,0,0,0):o.type==="color"?pi.parse(o.default)||null:o.type==="padding"?on.parse(o.default)||null:o.type==="variableAnchorOffsetCollection"?Nr.parse(o.default)||null:o.type==="projectionDefinition"?Hn.parse(o.default)||null:o.default===void 0?null:o.default:null,this._enumValues=n&&n.type==="enum"?n.values:null}evaluateWithoutErrorHandling(t,n,o,f,g,_){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=o,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,n,o,f,g,_){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=o||null,this._evaluator.canonical=f,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new nr(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function _c(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in cs}function fs(a,t){const n=new oi(cs,dc,[],t?function(f){const g={color:li,string:zt,number:Xe,enum:zt,boolean:Tt,formatted:Tr,padding:Wr,projectionDefinition:Nt,resolvedImage:Yi,variableAnchorOffsetCollection:ic};return f.type==="array"?sn(g[f.value]||Mt,f.length):g[f.type]}(t):void 0),o=n.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return o?xh(new hs(o,t)):ml(n.errors)}class Ps{constructor(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent=t!=="constant"&&!pl(n.expression)}evaluateWithoutErrorHandling(t,n,o,f,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,o,f,g,_)}evaluate(t,n,o,f,g,_){return this._styleExpression.evaluate(t,n,o,f,g,_)}}class xu{constructor(t,n,o,f){this.kind=t,this.zoomStops=o,this._styleExpression=n,this.isStateDependent=t!=="camera"&&!pl(n.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,n,o,f,g,_){return this._styleExpression.evaluateWithoutErrorHandling(t,n,o,f,g,_)}evaluate(t,n,o,f,g,_){return this._styleExpression.evaluate(t,n,o,f,g,_)}interpolationFactor(t,n,o){return this.interpolationType?Sn.interpolationFactor(this.interpolationType,t,n,o):0}}function da(a,t){const n=fs(a,t);if(n.result==="error")return n;const o=n.value.expression,f=us(o);if(!f&&!gl(t))return ml([new Dt("","data expressions not supported")]);const g=pc(o,["zoom"]);if(!g&&!vf(t))return ml([new Dt("","zoom expressions not supported")]);const _=Ds(o);return _||g?_ instanceof Dt?ml([_]):_ instanceof Sn&&!_u(t)?ml([new Dt("",'"interpolate" expressions cannot be used with this property')]):xh(_?new xu(f?"camera":"composite",n.value,_.labels,_ instanceof Sn?_.interpolation:void 0):new Ps(f?"constant":"source",n.value)):ml([new Dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Rs{constructor(t,n){this._parameters=t,this._specification=n,_t(this,fa(this._parameters,this._specification))}static deserialize(t){return new Rs(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ds(a){let t=null;if(a instanceof ni)t=Ds(a.result);else if(a instanceof Dr){for(const n of a.args)if(t=Ds(n),t)break}else(a instanceof os||a instanceof Sn)&&a.input instanceof Kn&&a.input.name==="zoom"&&(t=a);return t instanceof Dt||a.eachChild(n=>{const o=Ds(n);o instanceof Dt?t=o:!t&&o?t=new Dt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&o&&t!==o&&(t=new Dt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function _l(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!_l(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const yc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nn(a){if(a==null)return{filter:()=>!0,needGeometry:!1};_l(a)||(a=pa(a));const t=fs(a,yc);if(t.result==="error")throw new Error(t.value.map(n=>`${n.key}: ${n.message}`).join(", "));return{filter:(n,o,f)=>t.value.evaluate(n,o,{},f),needGeometry:Js(a)}}function Sa(a,t){return a<t?-1:a>t?1:0}function Js(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(Js(a[t]))return!0;return!1}function pa(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?Ta(a[1],a[2],"=="):t==="!="?eo(Ta(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ta(a[1],a[2],t):t==="any"?(n=a.slice(1),["any"].concat(n.map(pa))):t==="all"?["all"].concat(a.slice(1).map(pa)):t==="none"?["all"].concat(a.slice(1).map(pa).map(eo)):t==="in"?Is(a[1],a.slice(2)):t==="!in"?eo(Is(a[1],a.slice(2))):t==="has"?bu(a[1]):t!=="!has"||eo(bu(a[1]));var n}function Ta(a,t,n){switch(a){case"$type":return[`filter-type-${n}`,t];case"$id":return[`filter-id-${n}`,t];default:return[`filter-${n}`,a,t]}}function Is(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(n=>typeof n!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Sa)]]:["filter-in-small",a,["literal",t]]}}function bu(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function eo(a){return["!",a]}function ko(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let f="[";for(const g of a)f+=`${ko(g)},`;return`${f}]`}const n=Object.keys(a).sort();let o="{";for(let f=0;f<n.length;f++)o+=`${JSON.stringify(n[f])}:${ko(a[n[f]])},`;return`${o}}`}function Tn(a){let t="";for(const n of X)t+=`/${ko(a[n])}`;return t}function Ir(a){const t=a.value;return t?[new Re(a.key,t,"constants have been deprecated as of v8")]:[]}function Qt(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Mn(a){if(Array.isArray(a))return a.map(Mn);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const n in a)t[n]=Mn(a[n]);return t}return Qt(a)}function kr(a){const t=a.key,n=a.value,o=a.valueSpec||{},f=a.objectElementValidators||{},g=a.style,_=a.styleSpec,x=a.validateSpec;let T=[];const E=xi(n);if(E!=="object")return[new Re(t,n,`object expected, ${E} found`)];for(const D in n){const I=D.split(".")[0],j=o[I]||o["*"];let N;if(f[I])N=f[I];else if(o[I])N=x;else if(f["*"])N=f["*"];else{if(!o["*"]){T.push(new Re(t,n[D],`unknown property "${D}"`));continue}N=x}T=T.concat(N({key:(t&&`${t}.`)+D,value:n[D],valueSpec:j,style:g,styleSpec:_,object:n,objectKey:D,validateSpec:x},n))}for(const D in o)f[D]||o[D].required&&o[D].default===void 0&&n[D]===void 0&&T.push(new Re(t,n,`missing required property "${D}"`));return T}function vc(a){const t=a.value,n=a.valueSpec,o=a.style,f=a.styleSpec,g=a.key,_=a.arrayElementValidator||a.validateSpec;if(xi(t)!=="array")return[new Re(g,t,`array expected, ${xi(t)} found`)];if(n.length&&t.length!==n.length)return[new Re(g,t,`array length ${n.length} expected, length ${t.length} found`)];if(n["min-length"]&&t.length<n["min-length"])return[new Re(g,t,`array length at least ${n["min-length"]} expected, length ${t.length} found`)];let x={type:n.value,values:n.values};f.$version<7&&(x.function=n.function),xi(n.value)==="object"&&(x=n.value);let T=[];for(let E=0;E<t.length;E++)T=T.concat(_({array:t,arrayIndex:E,value:t[E],valueSpec:x,validateSpec:a.validateSpec,style:o,styleSpec:f,key:`${g}[${E}]`}));return T}function ks(a){const t=a.key,n=a.value,o=a.valueSpec;let f=xi(n);return f==="number"&&n!=n&&(f="NaN"),f!=="number"?[new Re(t,n,`number expected, ${f} found`)]:"minimum"in o&&n<o.minimum?[new Re(t,n,`${n} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&n>o.maximum?[new Re(t,n,`${n} is greater than the maximum value ${o.maximum}`)]:[]}function wh(a){const t=a.valueSpec,n=Qt(a.value.type);let o,f,g,_={};const x=n!=="categorical"&&a.value.property===void 0,T=!x,E=xi(a.value.stops)==="array"&&xi(a.value.stops[0])==="array"&&xi(a.value.stops[0][0])==="object",D=kr({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(N){if(n==="identity")return[new Re(N.key,N.value,'identity function may not have a "stops" property')];let Z=[];const H=N.value;return Z=Z.concat(vc({key:N.key,value:H,valueSpec:N.valueSpec,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:I})),xi(H)==="array"&&H.length===0&&Z.push(new Re(N.key,H,"array must have at least one stop")),Z},default:function(N){return N.validateSpec({key:N.key,value:N.value,valueSpec:t,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec})}}});return n==="identity"&&x&&D.push(new Re(a.key,a.value,'missing required property "property"')),n==="identity"||a.value.stops||D.push(new Re(a.key,a.value,'missing required property "stops"')),n==="exponential"&&a.valueSpec.expression&&!_u(a.valueSpec)&&D.push(new Re(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!gl(a.valueSpec)?D.push(new Re(a.key,a.value,"property functions not supported")):x&&!vf(a.valueSpec)&&D.push(new Re(a.key,a.value,"zoom functions not supported"))),n!=="categorical"&&!E||a.value.property!==void 0||D.push(new Re(a.key,a.value,'"property" property is required')),D;function I(N){let Z=[];const H=N.value,W=N.key;if(xi(H)!=="array")return[new Re(W,H,`array expected, ${xi(H)} found`)];if(H.length!==2)return[new Re(W,H,`array length 2 expected, length ${H.length} found`)];if(E){if(xi(H[0])!=="object")return[new Re(W,H,`object expected, ${xi(H[0])} found`)];if(H[0].zoom===void 0)return[new Re(W,H,"object stop key must have zoom")];if(H[0].value===void 0)return[new Re(W,H,"object stop key must have value")];if(g&&g>Qt(H[0].zoom))return[new Re(W,H[0].zoom,"stop zoom values must appear in ascending order")];Qt(H[0].zoom)!==g&&(g=Qt(H[0].zoom),f=void 0,_={}),Z=Z.concat(kr({key:`${W}[0]`,value:H[0],valueSpec:{zoom:{}},validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:ks,value:j}}))}else Z=Z.concat(j({key:`${W}[0]`,value:H[0],validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec},H));return _c(Mn(H[1]))?Z.concat([new Re(`${W}[1]`,H[1],"expressions are not allowed in function stops.")]):Z.concat(N.validateSpec({key:`${W}[1]`,value:H[1],valueSpec:t,validateSpec:N.validateSpec,style:N.style,styleSpec:N.styleSpec}))}function j(N,Z){const H=xi(N.value),W=Qt(N.value),re=N.value!==null?N.value:Z;if(o){if(H!==o)return[new Re(N.key,re,`${H} stop domain type must match previous stop domain type ${o}`)]}else o=H;if(H!=="number"&&H!=="string"&&H!=="boolean")return[new Re(N.key,re,"stop domain value must be a number, string, or boolean")];if(H!=="number"&&n!=="categorical"){let _e=`number expected, ${H} found`;return gl(t)&&n===void 0&&(_e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Re(N.key,re,_e)]}return n!=="categorical"||H!=="number"||isFinite(W)&&Math.floor(W)===W?n!=="categorical"&&H==="number"&&f!==void 0&&W<f?[new Re(N.key,re,"stop domain values must appear in ascending order")]:(f=W,n==="categorical"&&W in _?[new Re(N.key,re,"stop domain values must be unique")]:(_[W]=!0,[])):[new Re(N.key,re,`integer expected, found ${W}`)]}}function to(a){const t=(a.expressionContext==="property"?da:fs)(Mn(a.value),a.valueSpec);if(t.result==="error")return t.value.map(o=>new Re(`${a.key}${o.key}`,a.value,o.message));const n=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!n.outputDefined())return[new Re(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!pl(n))return[new Re(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!pl(n))return[new Re(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!pc(n,["zoom","feature-state"]))return[new Re(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!us(n))return[new Re(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ds(a){const t=a.key,n=a.value,o=a.valueSpec,f=[];return Array.isArray(o.values)?o.values.indexOf(Qt(n))===-1&&f.push(new Re(t,n,`expected one of [${o.values.join(", ")}], ${JSON.stringify(n)} found`)):Object.keys(o.values).indexOf(Qt(n))===-1&&f.push(new Re(t,n,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(n)} found`)),f}function ps(a){return _l(Mn(a.value))?to(_t({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yl(a)}function yl(a){const t=a.value,n=a.key;if(xi(t)!=="array")return[new Re(n,t,`array expected, ${xi(t)} found`)];const o=a.styleSpec;let f,g=[];if(t.length<1)return[new Re(n,t,"filter array must have at least 1 element")];switch(g=g.concat(ds({key:`${n}[0]`,value:t[0],valueSpec:o.filter_operator,style:a.style,styleSpec:a.styleSpec})),Qt(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Qt(t[1])==="$type"&&g.push(new Re(n,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new Re(n,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=xi(t[1]),f!=="string"&&g.push(new Re(`${n}[1]`,t[1],`string expected, ${f} found`)));for(let _=2;_<t.length;_++)f=xi(t[_]),Qt(t[1])==="$type"?g=g.concat(ds({key:`${n}[${_}]`,value:t[_],valueSpec:o.geometry_type,style:a.style,styleSpec:a.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&g.push(new Re(`${n}[${_}]`,t[_],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)g=g.concat(yl({key:`${n}[${_}]`,value:t[_],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":f=xi(t[1]),t.length!==2?g.push(new Re(n,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&g.push(new Re(`${n}[1]`,t[1],`string expected, ${f} found`))}return g}function Lo(a,t){const n=a.key,o=a.validateSpec,f=a.style,g=a.styleSpec,_=a.value,x=a.objectKey,T=g[`${t}_${a.layerType}`];if(!T)return[];const E=x.match(/^(.*)-transition$/);if(t==="paint"&&E&&T[E[1]]&&T[E[1]].transition)return o({key:n,value:_,valueSpec:g.transition,style:f,styleSpec:g});const D=a.valueSpec||T[x];if(!D)return[new Re(n,_,`unknown property "${x}"`)];let I;if(xi(_)==="string"&&gl(D)&&!D.tokens&&(I=/^{([^}]+)}$/.exec(_)))return[new Re(n,_,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(I[1])} }\`.`)];const j=[];return a.layerType==="symbol"&&(x==="text-field"&&f&&!f.glyphs&&j.push(new Re(n,_,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&mc(Mn(_))&&Qt(_.type)==="identity"&&j.push(new Re(n,_,'"text-font" does not support identity functions'))),j.concat(o({key:a.key,value:_,valueSpec:D,style:f,styleSpec:g,expressionContext:"property",propertyType:t,propertyKey:x}))}function wu(a){return Lo(a,"paint")}function Su(a){return Lo(a,"layout")}function Tu(a){let t=[];const n=a.value,o=a.key,f=a.style,g=a.styleSpec;n.type||n.ref||t.push(new Re(o,n,'either "type" or "ref" is required'));let _=Qt(n.type);const x=Qt(n.ref);if(n.id){const T=Qt(n.id);for(let E=0;E<a.arrayIndex;E++){const D=f.layers[E];Qt(D.id)===T&&t.push(new Re(o,n.id,`duplicate layer id "${n.id}", previously used at line ${D.id.__line__}`))}}if("ref"in n){let T;["type","source","source-layer","filter","layout"].forEach(E=>{E in n&&t.push(new Re(o,n[E],`"${E}" is prohibited for ref layers`))}),f.layers.forEach(E=>{Qt(E.id)===x&&(T=E)}),T?T.ref?t.push(new Re(o,n.ref,"ref cannot reference another ref layer")):_=Qt(T.type):t.push(new Re(o,n.ref,`ref layer "${x}" not found`))}else if(_!=="background")if(n.source){const T=f.sources&&f.sources[n.source],E=T&&Qt(T.type);T?E==="vector"&&_==="raster"?t.push(new Re(o,n.source,`layer "${n.id}" requires a raster source`)):E!=="raster-dem"&&_==="hillshade"?t.push(new Re(o,n.source,`layer "${n.id}" requires a raster-dem source`)):E==="raster"&&_!=="raster"?t.push(new Re(o,n.source,`layer "${n.id}" requires a vector source`)):E!=="vector"||n["source-layer"]?E==="raster-dem"&&_!=="hillshade"?t.push(new Re(o,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!n.paint||!n.paint["line-gradient"]||E==="geojson"&&T.lineMetrics||t.push(new Re(o,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Re(o,n,`layer "${n.id}" must specify a "source-layer"`)):t.push(new Re(o,n.source,`source "${n.source}" not found`))}else t.push(new Re(o,n,'missing required property "source"'));return t=t.concat(kr({key:o,value:n,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${o}.type`,value:n.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:n,objectKey:"type"}),filter:ps,layout:T=>kr({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":E=>Su(_t({layerType:_},E))}}),paint:T=>kr({layer:n,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":E=>wu(_t({layerType:_},E))}})}})),t}function qa(a){const t=a.value,n=a.key,o=xi(t);return o!=="string"?[new Re(n,t,`string expected, ${o} found`)]:[]}const Bo={promoteId:function({key:a,value:t}){if(xi(t)==="string")return qa({key:a,value:t});{const n=[];for(const o in t)n.push(...qa({key:`${a}.${o}`,value:t[o]}));return n}}};function vl(a){const t=a.value,n=a.key,o=a.styleSpec,f=a.style,g=a.validateSpec;if(!t.type)return[new Re(n,t,'"type" is required')];const _=Qt(t.type);let x;switch(_){case"vector":case"raster":return x=kr({key:n,value:t,valueSpec:o[`source_${_.replace("-","_")}`],style:a.style,styleSpec:o,objectElementValidators:Bo,validateSpec:g}),x;case"raster-dem":return x=function(T){var E;const D=(E=T.sourceName)!==null&&E!==void 0?E:"",I=T.value,j=T.styleSpec,N=j.source_raster_dem,Z=T.style;let H=[];const W=xi(I);if(I===void 0)return H;if(W!=="object")return H.push(new Re("source_raster_dem",I,`object expected, ${W} found`)),H;const re=Qt(I.encoding)==="custom",_e=["redFactor","greenFactor","blueFactor","baseShift"],le=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const U in I)!re&&_e.includes(U)?H.push(new Re(U,I[U],`In "${D}": "${U}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):N[U]?H=H.concat(T.validateSpec({key:U,value:I[U],valueSpec:N[U],validateSpec:T.validateSpec,style:Z,styleSpec:j})):H.push(new Re(U,I[U],`unknown property "${U}"`));return H}({sourceName:n,value:t,style:a.style,styleSpec:o,validateSpec:g}),x;case"geojson":if(x=kr({key:n,value:t,valueSpec:o.source_geojson,style:f,styleSpec:o,validateSpec:g,objectElementValidators:Bo}),t.cluster)for(const T in t.clusterProperties){const[E,D]=t.clusterProperties[T],I=typeof E=="string"?[E,["accumulated"],["get",T]]:E;x.push(...to({key:`${n}.${T}.map`,value:D,expressionContext:"cluster-map"})),x.push(...to({key:`${n}.${T}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return x;case"video":return kr({key:n,value:t,valueSpec:o.source_video,style:f,validateSpec:g,styleSpec:o});case"image":return kr({key:n,value:t,valueSpec:o.source_image,style:f,validateSpec:g,styleSpec:o});case"canvas":return[new Re(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ds({key:`${n}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Sh(a){const t=a.value,n=a.styleSpec,o=n.light,f=a.style;let g=[];const _=xi(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Re("light",t,`object expected, ${_} found`)]),g;for(const x in t){const T=x.match(/^(.*)-transition$/);g=g.concat(T&&o[T[1]]&&o[T[1]].transition?a.validateSpec({key:x,value:t[x],valueSpec:n.transition,validateSpec:a.validateSpec,style:f,styleSpec:n}):o[x]?a.validateSpec({key:x,value:t[x],valueSpec:o[x],validateSpec:a.validateSpec,style:f,styleSpec:n}):[new Re(x,t[x],`unknown property "${x}"`)])}return g}function Oo(a){const t=a.value,n=a.styleSpec,o=n.sky,f=a.style,g=xi(t);if(t===void 0)return[];if(g!=="object")return[new Re("sky",t,`object expected, ${g} found`)];let _=[];for(const x in t)_=_.concat(o[x]?a.validateSpec({key:x,value:t[x],valueSpec:o[x],style:f,styleSpec:n}):[new Re(x,t[x],`unknown property "${x}"`)]);return _}function xl(a){const t=a.value,n=a.styleSpec,o=n.terrain,f=a.style;let g=[];const _=xi(t);if(t===void 0)return g;if(_!=="object")return g=g.concat([new Re("terrain",t,`object expected, ${_} found`)]),g;for(const x in t)g=g.concat(o[x]?a.validateSpec({key:x,value:t[x],valueSpec:o[x],validateSpec:a.validateSpec,style:f,styleSpec:n}):[new Re(x,t[x],`unknown property "${x}"`)]);return g}function xc(a){let t=[];const n=a.value,o=a.key;if(Array.isArray(n)){const f=[],g=[];for(const _ in n)n[_].id&&f.includes(n[_].id)&&t.push(new Re(o,n,`all the sprites' ids must be unique, but ${n[_].id} is duplicated`)),f.push(n[_].id),n[_].url&&g.includes(n[_].url)&&t.push(new Re(o,n,`all the sprites' URLs must be unique, but ${n[_].url} is duplicated`)),g.push(n[_].url),t=t.concat(kr({key:`${o}[${_}]`,value:n[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return qa({key:o,value:n})}const bl={"*":()=>[],array:vc,boolean:function(a){const t=a.value,n=a.key,o=xi(t);return o!=="boolean"?[new Re(n,t,`boolean expected, ${o} found`)]:[]},number:ks,color:function(a){const t=a.key,n=a.value,o=xi(n);return o!=="string"?[new Re(t,n,`color expected, ${o} found`)]:pi.parse(String(n))?[]:[new Re(t,n,`color expected, "${n}" found`)]},constants:Ir,enum:ds,filter:ps,function:wh,layer:Tu,object:kr,source:vl,light:Sh,sky:Oo,terrain:xl,projection:function(a){const t=a.value,n=a.styleSpec,o=n.projection,f=a.style,g=xi(t);if(t===void 0)return[];if(g!=="object")return[new Re("projection",t,`object expected, ${g} found`)];let _=[];for(const x in t)_=_.concat(o[x]?a.validateSpec({key:x,value:t[x],valueSpec:o[x],style:f,styleSpec:n}):[new Re(x,t[x],`unknown property "${x}"`)]);return _},projectionDefinition:function(a){const t=a.key;let n=a.value;n=n instanceof String?n.valueOf():n;const o=xi(n);return o!=="array"||function(f){return Array.isArray(f)&&f.length===3&&typeof f[0]=="string"&&typeof f[1]=="string"&&typeof f[2]=="number"}(n)||function(f){return!!["interpolate","step","literal"].includes(f[0])}(n)?["array","string"].includes(o)?[]:[new Re(t,n,`projection expected, invalid type "${o}" found`)]:[new Re(t,n,`projection expected, invalid array ${JSON.stringify(n)} found`)]},string:qa,formatted:function(a){return qa(a).length===0?[]:to(a)},resolvedImage:function(a){return qa(a).length===0?[]:to(a)},padding:function(a){const t=a.key,n=a.value;if(xi(n)==="array"){if(n.length<1||n.length>4)return[new Re(t,n,`padding requires 1 to 4 values; ${n.length} values found`)];const o={type:"number"};let f=[];for(let g=0;g<n.length;g++)f=f.concat(a.validateSpec({key:`${t}[${g}]`,value:n[g],validateSpec:a.validateSpec,valueSpec:o}));return f}return ks({key:t,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const t=a.key,n=a.value,o=xi(n),f=a.styleSpec;if(o!=="array"||n.length<1||n.length%2!=0)return[new Re(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let g=[];for(let _=0;_<n.length;_+=2)g=g.concat(ds({key:`${t}[${_}]`,value:n[_],valueSpec:f.layout_symbol["text-anchor"]})),g=g.concat(vc({key:`${t}[${_+1}]`,value:n[_+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:f}));return g},sprite:xc};function Ha(a){const t=a.value,n=a.valueSpec,o=a.styleSpec;return a.validateSpec=Ha,n.expression&&mc(Qt(t))?wh(a):n.expression&&_c(Mn(t))?to(a):n.type&&bl[n.type]?bl[n.type](a):kr(_t({},a,{valueSpec:n.type?o[n.type]:n}))}function Fo(a){const t=a.value,n=a.key,o=qa(a);return o.length||(t.indexOf("{fontstack}")===-1&&o.push(new Re(n,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&o.push(new Re(n,t,'"glyphs" url must include a "{range}" token'))),o}function ar(a,t=L){let n=[];return n=n.concat(Ha({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:Ha,objectElementValidators:{glyphs:Fo,"*":()=>[]}})),a.constants&&(n=n.concat(Ir({key:"constants",value:a.constants}))),Mu(n)}function Ur(a){return function(t){return a({...t,validateSpec:Ha})}}function Mu(a){return[].concat(a).sort((t,n)=>t.line-n.line)}function Un(a){return function(...t){return Mu(a.apply(this,t))}}ar.source=Un(Ur(vl)),ar.sprite=Un(Ur(xc)),ar.glyphs=Un(Ur(Fo)),ar.light=Un(Ur(Sh)),ar.sky=Un(Ur(Oo)),ar.terrain=Un(Ur(xl)),ar.layer=Un(Ur(Tu)),ar.filter=Un(Ur(ps)),ar.paintProperty=Un(Ur(wu)),ar.layoutProperty=Un(Ur(Su));const Ls=ar,wl=Ls.light,Cu=Ls.sky,bc=Ls.paintProperty,Ma=Ls.layoutProperty;function ma(a,t){let n=!1;if(t&&t.length)for(const o of t)a.fire(new Rr(new Error(o.message))),n=!0;return n}class Ca{constructor(t,n,o){const f=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(n=_[1])+2*(o=_[2]);for(let T=0;T<this.d*this.d;T++){const E=_[3+T],D=_[3+T+1];f.push(E===D?null:_.subarray(E,D))}const x=_[3+f.length+1];this.keys=_.subarray(_[3+f.length],x),this.bboxes=_.subarray(x),this.insert=this._insertReadonly}else{this.d=n+2*o;for(let _=0;_<this.d*this.d;_++)f.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=t,this.padding=o,this.scale=n/t,this.uid=0;const g=o/n*t;this.min=-g,this.max=t+g}insert(t,n,o,f,g){this._forEachCell(n,o,f,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(n),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,n,o,f,g,_){this.cells[g].push(_)}query(t,n,o,f,g){const _=this.min,x=this.max;if(t<=_&&n<=_&&x<=o&&x<=f&&!g)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(t,n,o,f,this._queryCell,T,{},g),T}}_queryCell(t,n,o,f,g,_,x,T){const E=this.cells[g];if(E!==null){const D=this.keys,I=this.bboxes;for(let j=0;j<E.length;j++){const N=E[j];if(x[N]===void 0){const Z=4*N;(T?T(I[Z+0],I[Z+1],I[Z+2],I[Z+3]):t<=I[Z+2]&&n<=I[Z+3]&&o>=I[Z+0]&&f>=I[Z+1])?(x[N]=!0,_.push(D[N])):x[N]=!1}}}}_forEachCell(t,n,o,f,g,_,x,T){const E=this._convertToCellCoord(t),D=this._convertToCellCoord(n),I=this._convertToCellCoord(o),j=this._convertToCellCoord(f);for(let N=E;N<=I;N++)for(let Z=D;Z<=j;Z++){const H=this.d*Z+N;if((!T||T(this._convertFromCellCoord(N),this._convertFromCellCoord(Z),this._convertFromCellCoord(N+1),this._convertFromCellCoord(Z+1)))&&g.call(this,t,n,o,f,H,_,x,T))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,n=3+this.cells.length+1+1;let o=0;for(let _=0;_<this.cells.length;_++)o+=this.cells[_].length;const f=new Int32Array(n+o+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;let g=n;for(let _=0;_<t.length;_++){const x=t[_];f[3+_]=g,f.set(x,g),g+=x.length}return f[3+t.length]=g,f.set(this.keys,g),g+=this.keys.length,f[3+t.length+1]=g,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer}static serialize(t,n){const o=t.toArrayBuffer();return n&&n.push(o),{buffer:o}}static deserialize(t){return new Ca(t.buffer)}}const Wn={};function bt(a,t,n={}){if(Wn[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),Wn[a]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}bt("Object",Object),bt("TransferableGridIndex",Ca),bt("Color",pi),bt("Error",Error),bt("AJAXError",na),bt("ResolvedImage",On),bt("StylePropertyFunction",Rs),bt("StyleExpression",hs,{omit:["_evaluator"]}),bt("ZoomDependentExpression",xu),bt("ZoomConstantExpression",Ps),bt("CompoundExpression",Kn,{omit:["_evaluate"]});for(const a in cs)cs[a]._classRegistryKey||bt(`Expression_${a}`,cs[a]);function Qn(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Lr(a){return a.$name||a.constructor._classRegistryKey}function wc(a){return!function(t){if(t===null||typeof t!="object")return!1;const n=Lr(t);return!(!n||n==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||Qn(a)||qn(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function io(a,t){if(wc(a))return(Qn(a)||qn(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const g=[];for(const _ of a)g.push(io(_,t));return g}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const n=Lr(a);if(!n)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Wn[n])throw new Error(`${n} is not registered.`);const{klass:o}=Wn[n],f=o.serialize?o.serialize(a,t):{};if(o.serialize){if(t&&f===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in a){if(!a.hasOwnProperty(g)||Wn[n].omit.indexOf(g)>=0)continue;const _=a[g];f[g]=Wn[n].shallow.indexOf(g)>=0?_:io(_,t)}a instanceof Error&&(f.message=a.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(f.$name=n),f}function Sc(a){if(wc(a))return a;if(Array.isArray(a))return a.map(Sc);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=Lr(a)||"Object";if(!Wn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:n}=Wn[t];if(!n)throw new Error(`can't deserialize unregistered class ${t}`);if(n.deserialize)return n.deserialize(a);const o=Object.create(n.prototype);for(const f of Object.keys(a)){if(f==="$name")continue;const g=a[f];o[f]=Wn[t].shallow.indexOf(f)>=0?g:Sc(g)}return o}class Eu{constructor(){this.first=!0}update(t,n){const o=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=n):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=n),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=o,!0))}}const Gt={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Hangul Syllables":a=>a>=44032&&a<=55215,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Sl(a){for(const t of a)if(Th(t.charCodeAt(0)))return!0;return!1}function Tl(a){for(const t of a)if(!no(t.charCodeAt(0)))return!1;return!0}function ro(a){const t=a.map(n=>{try{return new RegExp(`\\p{sc=${n}}`,"u").source}catch{return null}}).filter(n=>n);return new RegExp(t.join("|"),"u")}const Au=ro(["Arab","Dupl","Mong","Ougr","Syrc"]);function no(a){return!Au.test(String.fromCodePoint(a))}const ao=ro(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Th(a){return!(a!==746&&a!==747&&(a<4352||!(Gt["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Gt["CJK Compatibility"](a)||Gt["CJK Strokes"](a)||!(!Gt["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Gt["Enclosed CJK Letters and Months"](a)||Gt["Ideographic Description Characters"](a)||Gt.Kanbun(a)||Gt.Katakana(a)&&a!==12540||!(!Gt["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Gt["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Gt["Vertical Forms"](a)||Gt["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||ao.test(String.fromCodePoint(a)))))}function zu(a){return!(Th(a)||function(t){return!!(Gt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Gt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Gt["Letterlike Symbols"](t)||Gt["Number Forms"](t)||Gt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Gt["Control Pictures"](t)&&t!==9251||Gt["Optical Character Recognition"](t)||Gt["Enclosed Alphanumerics"](t)||Gt["Geometric Shapes"](t)||Gt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Gt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Gt["CJK Symbols and Punctuation"](t)||Gt.Katakana(t)||Gt["Private Use Area"](t)||Gt["CJK Compatibility Forms"](t)||Gt["Small Form Variants"](t)||Gt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}const md=ro(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Pu(a){return md.test(String.fromCodePoint(a))}function so(a,t){return!(!t&&Pu(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Gt.Khmer(a))}function Ru(a){for(const t of a)if(Pu(t.charCodeAt(0)))return!0;return!1}const Xa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(Xa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,t){return u(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const n=a.pluginURL,o=new Promise(g=>{this.loadScriptResolve=g});t(n);const f=new Promise(g=>setTimeout(()=>g(),this.TIMEOUT));if(yield Promise.race([o,f]),this.isParsed()){const g={pluginStatus:"loaded",pluginURL:n};return this.setState(g),g}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)})}};class Ki{constructor(t,n){this.zoom=t,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.zoomHistory=n.zoomHistory,this.transition=n.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Eu,this.transition={})}isSupportedScript(t){return function(n,o){for(const f of n)if(!so(f.charCodeAt(0),o))return!1;return!0}(t,Xa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,n=t-Math.floor(t),o=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:n+(1-n)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*n}}}class Ea{constructor(t,n){this.property=t,this.value=n,this.expression=function(o,f){if(mc(o))return new Rs(o,f);if(_c(o)){const g=da(o,f);if(g.result==="error")throw new Error(g.value.map(_=>`${_.key}: ${_.message}`).join(", "));return g.value}{let g=o;return f.type==="color"&&typeof o=="string"?g=pi.parse(o):f.type!=="padding"||typeof o!="number"&&!Array.isArray(o)?f.type==="variableAnchorOffsetCollection"&&Array.isArray(o)?g=Nr.parse(o):f.type==="projectionDefinition"&&typeof o=="string"&&(g=Hn.parse(o)):g=on.parse(o),{kind:"constant",evaluate:()=>g}}}(n===void 0?t.specification.default:n,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,n,o){return this.property.possiblyEvaluate(this,t,n,o)}}class ci{constructor(t){this.property=t,this.value=new Ea(t,void 0)}transitioned(t,n){return new Er(this.property,this.value,n,Xt({},t.transition,this.transition),t.now)}untransitioned(){return new Er(this.property,this.value,null,{},0)}}class Ri{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return vi(this._values[t].value.value)}setValue(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ci(this._values[t].property)),this._values[t].value=new Ea(this._values[t].property,n===null?void 0:vi(n))}getTransition(t){return vi(this._values[t].transition)}setTransition(t,n){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ci(this._values[t].property)),this._values[t].transition=vi(n)||void 0}serialize(){const t={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(t[n]=o);const f=this.getTransition(n);f!==void 0&&(t[`${n}-transition`]=f)}return t}transitioned(t,n){const o=new oo(this._properties);for(const f of Object.keys(this._values))o._values[f]=this._values[f].transitioned(t,n._values[f]);return o}untransitioned(){const t=new oo(this._properties);for(const n of Object.keys(this._values))t._values[n]=this._values[n].untransitioned();return t}}class Er{constructor(t,n,o,f,g){this.property=t,this.value=n,this.begin=g+f.delay||0,this.end=this.begin+f.duration||0,t.specification.transition&&(f.delay||f.duration)&&(this.prior=o)}possiblyEvaluate(t,n,o){const f=t.now||0,g=this.value.possiblyEvaluate(t,n,o),_=this.prior;if(_){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return _.possiblyEvaluate(t,n,o);{const x=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,n,o),g,ve(x))}}return g}}class oo{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,n,o){const f=new jo(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(t,n,o);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ml{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return vi(this._values[t].value)}setValue(t,n){this._values[t]=new Ea(this._values[t].property,n===null?void 0:vi(n))}serialize(){const t={};for(const n of Object.keys(this._values)){const o=this.getValue(n);o!==void 0&&(t[n]=o)}return t}possiblyEvaluate(t,n,o){const f=new jo(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(t,n,o);return f}}class ln{constructor(t,n,o){this.property=t,this.value=n,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,n,o,f){return this.property.evaluate(this.value,this.parameters,t,n,o,f)}}class jo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class It{constructor(t){this.specification=t}possiblyEvaluate(t,n){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(n)}interpolate(t,n,o){const f=ua[this.specification.type];return f?f(t,n,o):t}}class Ft{constructor(t,n){this.specification=t,this.overrides=n}possiblyEvaluate(t,n,o,f){return new ln(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(n,null,{},o,f)}:t.expression,n)}interpolate(t,n,o){if(t.value.kind!=="constant"||n.value.kind!=="constant")return t;if(t.value.value===void 0||n.value.value===void 0)return new ln(this,{kind:"constant",value:void 0},t.parameters);const f=ua[this.specification.type];if(f){const g=f(t.value.value,n.value.value,o);return new ln(this,{kind:"constant",value:g},t.parameters)}return t}evaluate(t,n,o,f,g,_){return t.kind==="constant"?t.value:t.evaluate(n,o,f,g,_)}}class Tc extends Ft{possiblyEvaluate(t,n,o,f){if(t.value===void 0)return new ln(this,{kind:"constant",value:void 0},n);if(t.expression.kind==="constant"){const g=t.expression.evaluate(n,null,{},o,f),_=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,x=this._calculate(_,_,_,n);return new ln(this,{kind:"constant",value:x},n)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:n.zoom-1}),t.expression.evaluate({zoom:n.zoom}),t.expression.evaluate({zoom:n.zoom+1}),n);return new ln(this,{kind:"constant",value:g},n)}return new ln(this,t.expression,n)}evaluate(t,n,o,f,g,_){if(t.kind==="source"){const x=t.evaluate(n,o,f,g,_);return this._calculate(x,x,x,n)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(n.zoom)-1},o,f),t.evaluate({zoom:Math.floor(n.zoom)},o,f),t.evaluate({zoom:Math.floor(n.zoom)+1},o,f),n):t.value}_calculate(t,n,o,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:o,to:n}}interpolate(t){return t}}class sr{constructor(t){this.specification=t}possiblyEvaluate(t,n,o,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(n,null,{},o,f);return this._calculate(g,g,g,n)}return this._calculate(t.expression.evaluate(new Ki(Math.floor(n.zoom-1),n)),t.expression.evaluate(new Ki(Math.floor(n.zoom),n)),t.expression.evaluate(new Ki(Math.floor(n.zoom+1),n)),n)}}_calculate(t,n,o,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:n}:{from:o,to:n}}interpolate(t){return t}}class Mc{constructor(t){this.specification=t}possiblyEvaluate(t,n,o,f){return!!t.expression.evaluate(n,null,{},o,f)}interpolate(){return!1}}class Pn{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const n in t){const o=t[n];o.specification.overridable&&this.overridableProperties.push(n);const f=this.defaultPropertyValues[n]=new Ea(o,void 0),g=this.defaultTransitionablePropertyValues[n]=new ci(o);this.defaultTransitioningPropertyValues[n]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[n]=f.possiblyEvaluate({})}}}bt("DataDrivenProperty",Ft),bt("DataConstantProperty",It),bt("CrossFadedDataDrivenProperty",Tc),bt("CrossFadedProperty",sr),bt("ColorRampProperty",Mc);const Mh="-transition";class Ya extends Ae{constructor(t,n){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),n.layout&&(this._unevaluatedLayout=new Ml(n.layout)),n.paint)){this._transitionablePaint=new Ri(n.paint);for(const o in t.paint)this.setPaintProperty(o,t.paint[o],{validate:!1});for(const o in t.layout)this.setLayoutProperty(o,t.layout[o],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new jo(n.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,n,o={}){n!=null&&this._validate(Ma,`layers.${this.id}.layout.${t}`,t,n,o)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,n):this.visibility=n)}getPaintProperty(t){return t.endsWith(Mh)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,n,o={}){if(n!=null&&this._validate(bc,`layers.${this.id}.paint.${t}`,t,n,o))return!1;if(t.endsWith(Mh))return this._transitionablePaint.setTransition(t.slice(0,-11),n||void 0),!1;{const f=this._transitionablePaint._values[t],g=f.property.specification["property-type"]==="cross-faded-data-driven",_=f.value.isDataDriven(),x=f.value;this._transitionablePaint.setValue(t,n),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||_||g||this._handleOverridablePaintPropertyUpdate(t,x,T)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,n,o){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,n){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,n)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),hi(t,(n,o)=>!(n===void 0||o==="layout"&&!Object.keys(n).length||o==="paint"&&!Object.keys(n).length))}_validate(t,n,o,f,g={}){return(!g||g.validate!==!1)&&ma(this,t.call(Ls,{key:n,layerType:this.type,objectKey:o,value:f,styleSpec:L,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const n=this.paint.get(t);if(n instanceof ln&&gl(n.property.specification)&&(n.value.kind==="source"||n.value.kind==="composite")&&n.value.isStateDependent)return!0}return!1}}const gd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Aa{constructor(t,n){this._structArray=t,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Qi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,n){return t._trim(),n&&(t.isTransferred=!0,n.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const n=Object.create(this.prototype);return n.arrayBuffer=t.arrayBuffer,n.length=t.length,n.capacity=t.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pr(a,t=1){let n=0,o=0;return{members:a.map(f=>{const g=gd[f.type].BYTES_PER_ELEMENT,_=n=Vn(n,Math.max(t,g)),x=f.components||1;return o=Math.max(o,g),n+=g*x,{name:f.name,type:f.type,components:x,offset:_}}),size:Vn(n,Math.max(o,t)),alignment:t}}function Vn(a,t){return Math.ceil(a/t)*t}class Ji extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const f=2*t;return this.int16[f+0]=n,this.int16[f+1]=o,t}}Ji.prototype.bytesPerElement=4,bt("StructArrayLayout2i4",Ji);class No extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,o)}emplace(t,n,o,f){const g=3*t;return this.int16[g+0]=n,this.int16[g+1]=o,this.int16[g+2]=f,t}}No.prototype.bytesPerElement=6,bt("StructArrayLayout3i6",No);class Uo extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,n,o,f)}emplace(t,n,o,f,g){const _=4*t;return this.int16[_+0]=n,this.int16[_+1]=o,this.int16[_+2]=f,this.int16[_+3]=g,t}}Uo.prototype.bytesPerElement=8,bt("StructArrayLayout4i8",Uo);class za extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,f,g,_)}emplace(t,n,o,f,g,_,x){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=o,this.int16[T+2]=f,this.int16[T+3]=g,this.int16[T+4]=_,this.int16[T+5]=x,t}}za.prototype.bytesPerElement=12,bt("StructArrayLayout2i4i12",za);class Cl extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,f,g,_)}emplace(t,n,o,f,g,_,x){const T=4*t,E=8*t;return this.int16[T+0]=n,this.int16[T+1]=o,this.uint8[E+4]=f,this.uint8[E+5]=g,this.uint8[E+6]=_,this.uint8[E+7]=x,t}}Cl.prototype.bytesPerElement=8,bt("StructArrayLayout2i4ub8",Cl);class Zn extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const f=2*t;return this.float32[f+0]=n,this.float32[f+1]=o,t}}Zn.prototype.bytesPerElement=8,bt("StructArrayLayout2f8",Zn);class Vo extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_,x,T,E,D){const I=this.length;return this.resize(I+1),this.emplace(I,t,n,o,f,g,_,x,T,E,D)}emplace(t,n,o,f,g,_,x,T,E,D,I){const j=10*t;return this.uint16[j+0]=n,this.uint16[j+1]=o,this.uint16[j+2]=f,this.uint16[j+3]=g,this.uint16[j+4]=_,this.uint16[j+5]=x,this.uint16[j+6]=T,this.uint16[j+7]=E,this.uint16[j+8]=D,this.uint16[j+9]=I,t}}Vo.prototype.bytesPerElement=20,bt("StructArrayLayout10ui20",Vo);class Zo extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_,x,T,E,D,I,j){const N=this.length;return this.resize(N+1),this.emplace(N,t,n,o,f,g,_,x,T,E,D,I,j)}emplace(t,n,o,f,g,_,x,T,E,D,I,j,N){const Z=12*t;return this.int16[Z+0]=n,this.int16[Z+1]=o,this.int16[Z+2]=f,this.int16[Z+3]=g,this.uint16[Z+4]=_,this.uint16[Z+5]=x,this.uint16[Z+6]=T,this.uint16[Z+7]=E,this.int16[Z+8]=D,this.int16[Z+9]=I,this.int16[Z+10]=j,this.int16[Z+11]=N,t}}Zo.prototype.bytesPerElement=24,bt("StructArrayLayout4i4ui4i24",Zo);class Cc extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,o)}emplace(t,n,o,f){const g=3*t;return this.float32[g+0]=n,this.float32[g+1]=o,this.float32[g+2]=f,t}}Cc.prototype.bytesPerElement=12,bt("StructArrayLayout3f12",Cc);class Go extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint32[1*t+0]=n,t}}Go.prototype.bytesPerElement=4,bt("StructArrayLayout1ul4",Go);class lo extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_,x,T,E){const D=this.length;return this.resize(D+1),this.emplace(D,t,n,o,f,g,_,x,T,E)}emplace(t,n,o,f,g,_,x,T,E,D){const I=10*t,j=5*t;return this.int16[I+0]=n,this.int16[I+1]=o,this.int16[I+2]=f,this.int16[I+3]=g,this.int16[I+4]=_,this.int16[I+5]=x,this.uint32[j+3]=T,this.uint16[I+8]=E,this.uint16[I+9]=D,t}}lo.prototype.bytesPerElement=20,bt("StructArrayLayout6i1ul2ui20",lo);class Du extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,f,g,_)}emplace(t,n,o,f,g,_,x){const T=6*t;return this.int16[T+0]=n,this.int16[T+1]=o,this.int16[T+2]=f,this.int16[T+3]=g,this.int16[T+4]=_,this.int16[T+5]=x,t}}Du.prototype.bytesPerElement=12,bt("StructArrayLayout2i2i2i12",Du);class Ec extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g){const _=this.length;return this.resize(_+1),this.emplace(_,t,n,o,f,g)}emplace(t,n,o,f,g,_){const x=4*t,T=8*t;return this.float32[x+0]=n,this.float32[x+1]=o,this.float32[x+2]=f,this.int16[T+6]=g,this.int16[T+7]=_,t}}Ec.prototype.bytesPerElement=16,bt("StructArrayLayout2f1f2i16",Ec);class co extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_){const x=this.length;return this.resize(x+1),this.emplace(x,t,n,o,f,g,_)}emplace(t,n,o,f,g,_,x){const T=16*t,E=4*t,D=8*t;return this.uint8[T+0]=n,this.uint8[T+1]=o,this.float32[E+1]=f,this.float32[E+2]=g,this.int16[D+6]=_,this.int16[D+7]=x,t}}co.prototype.bytesPerElement=16,bt("StructArrayLayout2ub2f2i16",co);class Ac extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,o)}emplace(t,n,o,f){const g=3*t;return this.uint16[g+0]=n,this.uint16[g+1]=o,this.uint16[g+2]=f,t}}Ac.prototype.bytesPerElement=6,bt("StructArrayLayout3ui6",Ac);class zc extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re){const _e=this.length;return this.resize(_e+1),this.emplace(_e,t,n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re)}emplace(t,n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re,_e){const le=24*t,U=12*t,Y=48*t;return this.int16[le+0]=n,this.int16[le+1]=o,this.uint16[le+2]=f,this.uint16[le+3]=g,this.uint32[U+2]=_,this.uint32[U+3]=x,this.uint32[U+4]=T,this.uint16[le+10]=E,this.uint16[le+11]=D,this.uint16[le+12]=I,this.float32[U+7]=j,this.float32[U+8]=N,this.uint8[Y+36]=Z,this.uint8[Y+37]=H,this.uint8[Y+38]=W,this.uint32[U+10]=re,this.int16[le+22]=_e,t}}zc.prototype.bytesPerElement=48,bt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",zc);class Pc extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re,_e,le,U,Y,ue,ke,tt,je,Ve,ot,nt){const ct=this.length;return this.resize(ct+1),this.emplace(ct,t,n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re,_e,le,U,Y,ue,ke,tt,je,Ve,ot,nt)}emplace(t,n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re,_e,le,U,Y,ue,ke,tt,je,Ve,ot,nt,ct){const He=32*t,Ct=16*t;return this.int16[He+0]=n,this.int16[He+1]=o,this.int16[He+2]=f,this.int16[He+3]=g,this.int16[He+4]=_,this.int16[He+5]=x,this.int16[He+6]=T,this.int16[He+7]=E,this.uint16[He+8]=D,this.uint16[He+9]=I,this.uint16[He+10]=j,this.uint16[He+11]=N,this.uint16[He+12]=Z,this.uint16[He+13]=H,this.uint16[He+14]=W,this.uint16[He+15]=re,this.uint16[He+16]=_e,this.uint16[He+17]=le,this.uint16[He+18]=U,this.uint16[He+19]=Y,this.uint16[He+20]=ue,this.uint16[He+21]=ke,this.uint16[He+22]=tt,this.uint32[Ct+12]=je,this.float32[Ct+13]=Ve,this.float32[Ct+14]=ot,this.uint16[He+30]=nt,this.uint16[He+31]=ct,t}}Pc.prototype.bytesPerElement=64,bt("StructArrayLayout8i15ui1ul2f2ui64",Pc);class Iu extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.float32[1*t+0]=n,t}}Iu.prototype.bytesPerElement=4,bt("StructArrayLayout1f4",Iu);class d extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,o)}emplace(t,n,o,f){const g=3*t;return this.uint16[6*t+0]=n,this.float32[g+1]=o,this.float32[g+2]=f,t}}d.prototype.bytesPerElement=12,bt("StructArrayLayout1ui2f12",d);class e extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n,o){const f=this.length;return this.resize(f+1),this.emplace(f,t,n,o)}emplace(t,n,o,f){const g=4*t;return this.uint32[2*t+0]=n,this.uint16[g+2]=o,this.uint16[g+3]=f,t}}e.prototype.bytesPerElement=8,bt("StructArrayLayout1ul2ui8",e);class r extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,n){const o=this.length;return this.resize(o+1),this.emplace(o,t,n)}emplace(t,n,o){const f=2*t;return this.uint16[f+0]=n,this.uint16[f+1]=o,t}}r.prototype.bytesPerElement=4,bt("StructArrayLayout2ui4",r);class l extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const n=this.length;return this.resize(n+1),this.emplace(n,t)}emplace(t,n){return this.uint16[1*t+0]=n,t}}l.prototype.bytesPerElement=2,bt("StructArrayLayout1ui2",l);class h extends Qi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,n,o,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,n,o,f)}emplace(t,n,o,f,g){const _=4*t;return this.float32[_+0]=n,this.float32[_+1]=o,this.float32[_+2]=f,this.float32[_+3]=g,t}}h.prototype.bytesPerElement=16,bt("StructArrayLayout4f16",h);class m extends Aa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new we(this.anchorPointX,this.anchorPointY)}}m.prototype.size=20;class v extends lo{get(t){return new m(this,t)}}bt("CollisionBoxArray",v);class w extends Aa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}w.prototype.size=48;class M extends zc{get(t){return new w(this,t)}}bt("PlacedSymbolArray",M);class A extends Aa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}A.prototype.size=64;class k extends Pc{get(t){return new A(this,t)}}bt("SymbolInstanceArray",k);class O extends Iu{getoffsetX(t){return this.float32[1*t+0]}}bt("GlyphOffsetArray",O);class F extends No{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}bt("SymbolLineVertexArray",F);class $ extends Aa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$.prototype.size=12;class q extends d{get(t){return new $(this,t)}}bt("TextAnchorOffsetArray",q);class te extends Aa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}te.prototype.size=8;class ee extends e{get(t){return new te(this,t)}}bt("FeatureIndexArray",ee);class ie extends Ji{}class se extends Ji{}class fe extends Ji{}class de extends za{}class pe extends Cl{}class ye extends Zn{}class ge extends Vo{}class Ie extends Zo{}class Be extends Cc{}class $e extends Go{}class qe extends Du{}class Ze extends co{}class mt extends Ac{}class ft extends r{}const et=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Rt}=et;class Ot{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,n,o,f){const g=this.segments[this.segments.length-1];return t>Ot.MAX_VERTEX_ARRAY_LENGTH&&Ai(`Max vertices per segment is ${Ot.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Ot.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!g||g.vertexLength+t>Ot.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f?this.createNewSegment(n,o,f):g}createNewSegment(t,n,o){const f={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(f.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(f),f}getOrCreateLatestSegment(t,n,o){return this.prepareSegment(0,t,n,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const n in t.vaos)t.vaos[n].destroy()}static simpleSegment(t,n,o,f){return new Ot([{vertexOffset:t,primitiveOffset:n,vertexLength:o,primitiveLength:f,vaos:{},sortKey:0}])}}function Mi(a,t){return 256*(a=Lt(Math.floor(a),0,255))+Lt(Math.floor(t),0,255)}Ot.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bt("SegmentVector",Ot);const Vi=pr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Di,Li,Fi,bi={exports:{}},Ii={exports:{}},Jr={exports:{}},Zi=function(){if(Fi)return bi.exports;Fi=1;var a=(Di||(Di=1,Ii.exports=function(n,o){var f,g,_,x,T,E,D,I;for(g=n.length-(f=3&n.length),_=o,T=3432918353,E=461845907,I=0;I<g;)D=255&n.charCodeAt(I)|(255&n.charCodeAt(++I))<<8|(255&n.charCodeAt(++I))<<16|(255&n.charCodeAt(++I))<<24,++I,_=27492+(65535&(x=5*(65535&(_=(_^=D=(65535&(D=(D=(65535&D)*T+(((D>>>16)*T&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(D=0,f){case 3:D^=(255&n.charCodeAt(I+2))<<16;case 2:D^=(255&n.charCodeAt(I+1))<<8;case 1:_^=D=(65535&(D=(D=(65535&(D^=255&n.charCodeAt(I)))*T+(((D>>>16)*T&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295}return _^=n.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Ii.exports),t=(Li||(Li=1,Jr.exports=function(n,o){for(var f,g=n.length,_=o^g,x=0;g>=4;)f=1540483477*(65535&(f=255&n.charCodeAt(x)|(255&n.charCodeAt(++x))<<8|(255&n.charCodeAt(++x))<<16|(255&n.charCodeAt(++x))<<24))+((1540483477*(f>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),g-=4,++x;switch(g){case 3:_^=(255&n.charCodeAt(x+2))<<16;case 2:_^=(255&n.charCodeAt(x+1))<<8;case 1:_=1540483477*(65535&(_^=255&n.charCodeAt(x)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),Jr.exports);return bi.exports=a,bi.exports.murmur3=a,bi.exports.murmur2=t,bi.exports}(),er=ce(Zi);class or{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,n,o,f){this.ids.push(Jn(t)),this.positions.push(n,o,f)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const n=Jn(t);let o=0,f=this.ids.length-1;for(;o<f;){const _=o+f>>1;this.ids[_]>=n?f=_:o=_+1}const g=[];for(;this.ids[o]===n;)g.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return g}static serialize(t,n){const o=new Float64Array(t.ids),f=new Uint32Array(t.positions);return Ka(o,f,0,o.length-1),n&&n.push(o.buffer,f.buffer),{ids:o,positions:f}}static deserialize(t){const n=new or;return n.ids=t.ids,n.positions=t.positions,n.indexed=!0,n}}function Jn(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:er(String(a))}function Ka(a,t,n,o){for(;n<o;){const f=a[n+o>>1];let g=n-1,_=o+1;for(;;){do g++;while(a[g]<f);do _--;while(a[_]>f);if(g>=_)break;Pa(a,g,_),Pa(t,3*g,3*_),Pa(t,3*g+1,3*_+1),Pa(t,3*g+2,3*_+2)}_-n<o-_?(Ka(a,t,n,_),n=_+1):(Ka(a,t,_+1,o),o=_)}}function Pa(a,t,n){const o=a[t];a[t]=a[n],a[n]=o}bt("FeaturePositionMap",or);class ga{constructor(t,n){this.gl=t.gl,this.location=n}}class uo extends ga{constructor(t,n){super(t,n),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Wa extends ga{constructor(t,n){super(t,n),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class ms extends ga{constructor(t,n){super(t,n),this.current=pi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const _a=new Float32Array(16);function Qa(a){return[Mi(255*a.r,255*a.g),Mi(255*a.b,255*a.a)]}class Ra{constructor(t,n,o){this.value=t,this.uniformNames=n.map(f=>`u_${f}`),this.type=o}setUniform(t,n,o){t.set(o.constantOr(this.value))}getBinding(t,n,o){return this.type==="color"?new ms(t,n):new uo(t,n)}}class ya{constructor(t,n){this.uniformNames=n.map(o=>`u_${o}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,n){this.pixelRatioFrom=n.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=n.tlbr,this.patternTo=t.tlbr}setUniform(t,n,o,f){const g=f==="u_pattern_to"?this.patternTo:f==="u_pattern_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,n,o){return o.substr(0,9)==="u_pattern"?new Wa(t,n):new uo(t,n)}}class ji{constructor(t,n,o,f){this.expression=t,this.type=o,this.maxValue=0,this.paintVertexAttributes=n.map(g=>({name:`a_${g}`,type:"Float32",components:o==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,n,o,f,g){const _=this.paintVertexArray.length,x=this.expression.evaluate(new Ki(0),n,{},f,[],g);this.paintVertexArray.resize(t),this._setPaintValue(_,t,x)}updatePaintArray(t,n,o,f){const g=this.expression.evaluate({zoom:0},o,f);this._setPaintValue(t,n,g)}_setPaintValue(t,n,o){if(this.type==="color"){const f=Qa(o);for(let g=t;g<n;g++)this.paintVertexArray.emplace(g,f[0],f[1])}else{for(let f=t;f<n;f++)this.paintVertexArray.emplace(f,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ki{constructor(t,n,o,f,g,_){this.expression=t,this.uniformNames=n.map(x=>`u_${x}_t`),this.type=o,this.useIntegerZoom=f,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=n.map(x=>({name:`a_${x}`,type:"Float32",components:o==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,n,o,f,g){const _=this.expression.evaluate(new Ki(this.zoom),n,{},f,[],g),x=this.expression.evaluate(new Ki(this.zoom+1),n,{},f,[],g),T=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(T,t,_,x)}updatePaintArray(t,n,o,f){const g=this.expression.evaluate({zoom:this.zoom},o,f),_=this.expression.evaluate({zoom:this.zoom+1},o,f);this._setPaintValue(t,n,g,_)}_setPaintValue(t,n,o,f){if(this.type==="color"){const g=Qa(o),_=Qa(f);for(let x=t;x<n;x++)this.paintVertexArray.emplace(x,g[0],g[1],_[0],_[1])}else{for(let g=t;g<n;g++)this.paintVertexArray.emplace(g,o,f);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,n){const o=this.useIntegerZoom?Math.floor(n.zoom):n.zoom,f=Lt(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,n,o){return new uo(t,n)}}class Vr{constructor(t,n,o,f,g,_){this.expression=t,this.type=n,this.useIntegerZoom=o,this.zoom=f,this.layerId=_,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,n,o){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,n.patterns&&n.patterns[this.layerId],o)}updatePaintArray(t,n,o,f,g){this._setPaintValues(t,n,o.patterns&&o.patterns[this.layerId],g)}_setPaintValues(t,n,o,f){if(!f||!o)return;const{min:g,mid:_,max:x}=o,T=f[g],E=f[_],D=f[x];if(T&&E&&D)for(let I=t;I<n;I++)this.zoomInPaintVertexArray.emplace(I,E.tl[0],E.tl[1],E.br[0],E.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],E.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(I,E.tl[0],E.tl[1],E.br[0],E.br[1],D.tl[0],D.tl[1],D.br[0],D.br[1],E.pixelRatio,D.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Vi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Vi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Zr{constructor(t,n,o){this.binders={},this._buffers=[];const f=[];for(const g in t.paint._values){if(!o(g))continue;const _=t.paint.get(g);if(!(_ instanceof ln&&gl(_.property.specification)))continue;const x=xf(g,t.type),T=_.value,E=_.property.specification.type,D=_.property.useIntegerZoom,I=_.property.specification["property-type"],j=I==="cross-faded"||I==="cross-faded-data-driven";if(T.kind==="constant")this.binders[g]=j?new ya(T.value,x):new Ra(T.value,x,E),f.push(`/u_${g}`);else if(T.kind==="source"||j){const N=en(g,E,"source");this.binders[g]=j?new Vr(T,E,D,n,N,t.id):new ji(T,x,E,N),f.push(`/a_${g}`)}else{const N=en(g,E,"composite");this.binders[g]=new ki(T,x,E,D,n,N),f.push(`/z_${g}`)}}this.cacheKey=f.sort().join("")}getMaxValue(t){const n=this.binders[t];return n instanceof ji||n instanceof ki?n.maxValue:0}populatePaintArrays(t,n,o,f,g){for(const _ in this.binders){const x=this.binders[_];(x instanceof ji||x instanceof ki||x instanceof Vr)&&x.populatePaintArray(t,n,o,f,g)}}setConstantPatternPositions(t,n){for(const o in this.binders){const f=this.binders[o];f instanceof ya&&f.setConstantPatternPositions(t,n)}}updatePaintArrays(t,n,o,f,g){let _=!1;for(const x in t){const T=n.getPositions(x);for(const E of T){const D=o.feature(E.index);for(const I in this.binders){const j=this.binders[I];if((j instanceof ji||j instanceof ki||j instanceof Vr)&&j.expression.isStateDependent===!0){const N=f.paint.get(I);j.expression=N.value,j.updatePaintArray(E.start,E.end,D,t[x],g),_=!0}}}}return _}defines(){const t=[];for(const n in this.binders){const o=this.binders[n];(o instanceof Ra||o instanceof ya)&&t.push(...o.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof ji||o instanceof ki)for(let f=0;f<o.paintVertexAttributes.length;f++)t.push(o.paintVertexAttributes[f].name);else if(o instanceof Vr)for(let f=0;f<Vi.members.length;f++)t.push(Vi.members[f].name)}return t}getBinderUniforms(){const t=[];for(const n in this.binders){const o=this.binders[n];if(o instanceof Ra||o instanceof ya||o instanceof ki)for(const f of o.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,n){const o=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof Ra||g instanceof ya||g instanceof ki){for(const _ of g.uniformNames)if(n[_]){const x=g.getBinding(t,n[_],_);o.push({name:_,property:f,binding:x})}}}return o}setUniforms(t,n,o,f){for(const{name:g,property:_,binding:x}of n)this.binders[_].setUniform(x,f,o.get(_),g)}updatePaintBuffers(t){this._buffers=[];for(const n in this.binders){const o=this.binders[n];if(t&&o instanceof Vr){const f=t.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(o instanceof ji||o instanceof ki)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const n in this.binders){const o=this.binders[n];(o instanceof ji||o instanceof ki||o instanceof Vr)&&o.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const n=this.binders[t];(n instanceof ji||n instanceof ki||n instanceof Vr)&&n.destroy()}}}class $o{constructor(t,n,o=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new Zr(f,n,o);this.needsUpload=!1,this._featureMap=new or,this._bufferOffset=0}populatePaintArrays(t,n,o,f,g,_){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,n,f,g,_);n.id!==void 0&&this._featureMap.add(n.id,o,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,n,o,f){for(const g of o)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,n,g,f)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function xf(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function en(a,t,n){const o={color:{source:Zn,composite:h},number:{source:Iu,composite:Zn}},f=function(g){return{"line-pattern":{source:ge,composite:ge},"fill-pattern":{source:ge,composite:ge},"fill-extrusion-pattern":{source:ge,composite:ge}}[g]}(a);return f&&f[n]||o[t][n]}bt("ConstantBinder",Ra),bt("CrossFadedConstantBinder",ya),bt("SourceExpressionBinder",ji),bt("CrossFadedCompositeBinder",Vr),bt("CompositeExpressionBinder",ki),bt("ProgramConfiguration",Zr,{omit:["_buffers"]}),bt("ProgramConfigurationSet",$o);const tn=Math.pow(2,14)-1,Ch=-tn-1;function ho(a){const t=Je/a.extent,n=a.loadGeometry();for(let o=0;o<n.length;o++){const f=n[o];for(let g=0;g<f.length;g++){const _=f[g],x=Math.round(_.x*t),T=Math.round(_.y*t);_.x=Lt(x,Ch,tn),_.y=Lt(T,Ch,tn),(x<_.x||x>_.x+1||T<_.y||T>_.y+1)&&Ai("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function ea(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?ho(a):[]}}const ku=-32768;function Eh(a,t,n,o,f){a.emplaceBack(ku+8*t+o,ku+8*n+f)}class fo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new se,this.indexArray=new mt,this.segments=new Ot,this.programConfigurations=new $o(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){const f=this.layers[0],g=[];let _=null,x=!1,T=f.type==="heatmap";if(f.type==="circle"){const D=f;_=D.layout.get("circle-sort-key"),x=!_.isConstant(),T=T||D.paint.get("circle-pitch-alignment")==="map"}const E=T?n.subdivisionGranularity.circle:1;for(const{feature:D,id:I,index:j,sourceLayerIndex:N}of t){const Z=this.layers[0]._featureFilter.needGeometry,H=ea(D,Z);if(!this.layers[0]._featureFilter.filter(new Ki(this.zoom),H,o))continue;const W=x?_.evaluate(H,{},o):void 0,re={id:I,properties:D.properties,type:D.type,sourceLayerIndex:N,index:j,geometry:Z?H.geometry:ho(D),patterns:{},sortKey:W};g.push(re)}x&&g.sort((D,I)=>D.sortKey-I.sortKey);for(const D of g){const{geometry:I,index:j,sourceLayerIndex:N}=D,Z=t[j].feature;this.addFeature(D,I,j,o,E),n.featureIndex.insert(Z,I,j,N,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Rt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,n,o,f,g=1){let _;switch(g){case 1:_=[0,7];break;case 3:_=[0,2,5,7];break;case 5:_=[0,1,3,4,6,7];break;case 7:_=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${g}; valid values are 1, 3, 5, 7.`)}const x=_.length;for(const T of n)for(const E of T){const D=E.x,I=E.y;if(D<0||D>=Je||I<0||I>=Je)continue;const j=this.segments.prepareSegment(x*x,this.layoutVertexArray,this.indexArray,t.sortKey),N=j.vertexLength;for(let Z=0;Z<x;Z++)for(let H=0;H<x;H++)Eh(this.layoutVertexArray,D,I,_[H],_[Z]);for(let Z=0;Z<x-1;Z++)for(let H=0;H<x-1;H++){const W=N+Z*x+H,re=N+(Z+1)*x+H;this.indexArray.emplaceBack(W,re+1,W+1),this.indexArray.emplaceBack(W,re,re+1)}j.vertexLength+=x*x,j.primitiveLength+=(x-1)*(x-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,{},f)}}function El(a,t){for(let n=0;n<a.length;n++)if(Al(t,a[n]))return!0;for(let n=0;n<t.length;n++)if(Al(a,t[n]))return!0;return!!zh(a,t)}function Ah(a,t,n){return!!Al(a,t)||!!Ph(t,a,n)}function Rc(a,t){if(a.length===1)return bf(t,a[0]);for(let n=0;n<t.length;n++){const o=t[n];for(let f=0;f<o.length;f++)if(Al(a,o[f]))return!0}for(let n=0;n<a.length;n++)if(bf(t,a[n]))return!0;for(let n=0;n<t.length;n++)if(zh(a,t[n]))return!0;return!1}function zp(a,t,n){if(a.length>1){if(zh(a,t))return!0;for(let o=0;o<t.length;o++)if(Ph(t[o],a,n))return!0}for(let o=0;o<a.length;o++)if(Ph(a[o],t,n))return!0;return!1}function zh(a,t){if(a.length===0||t.length===0)return!1;for(let n=0;n<a.length-1;n++){const o=a[n],f=a[n+1];for(let g=0;g<t.length-1;g++)if(_d(o,f,t[g],t[g+1]))return!0}return!1}function _d(a,t,n,o){return Bi(a,n,o)!==Bi(t,n,o)&&Bi(a,t,n)!==Bi(a,t,o)}function Ph(a,t,n){const o=n*n;if(t.length===1)return a.distSqr(t[0])<o;for(let f=1;f<t.length;f++)if(yd(a,t[f-1],t[f])<o)return!0;return!1}function yd(a,t,n){const o=t.distSqr(n);if(o===0)return a.distSqr(t);const f=((a.x-t.x)*(n.x-t.x)+(a.y-t.y)*(n.y-t.y))/o;return a.distSqr(f<0?t:f>1?n:n.sub(t)._mult(f)._add(t))}function bf(a,t){let n,o,f,g=!1;for(let _=0;_<a.length;_++){n=a[_];for(let x=0,T=n.length-1;x<n.length;T=x++)o=n[x],f=n[T],o.y>t.y!=f.y>t.y&&t.x<(f.x-o.x)*(t.y-o.y)/(f.y-o.y)+o.x&&(g=!g)}return g}function Al(a,t){let n=!1;for(let o=0,f=a.length-1;o<a.length;f=o++){const g=a[o],_=a[f];g.y>t.y!=_.y>t.y&&t.x<(_.x-g.x)*(t.y-g.y)/(_.y-g.y)+g.x&&(n=!n)}return n}function vd(a,t,n){const o=n[0],f=n[2];if(a.x<o.x&&t.x<o.x||a.x>f.x&&t.x>f.x||a.y<o.y&&t.y<o.y||a.y>f.y&&t.y>f.y)return!1;const g=Bi(a,t,n[0]);return g!==Bi(a,t,n[1])||g!==Bi(a,t,n[2])||g!==Bi(a,t,n[3])}function Lu(a,t,n){const o=t.paint.get(a).value;return o.kind==="constant"?o.value:n.programConfigurations.get(t.id).getMaxValue(a)}function Bu(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Rh(a,t,n,o,f){if(!t[0]&&!t[1])return a;const g=we.convert(t)._mult(f);n==="viewport"&&g._rotate(-o);const _=[];for(let x=0;x<a.length;x++)_.push(a[x].sub(g));return _}let po,wf;bt("CircleBucket",fo,{omit:["layers"]});var Dm={get paint(){return wf=wf||new Pn({"circle-radius":new Ft(L.paint_circle["circle-radius"]),"circle-color":new Ft(L.paint_circle["circle-color"]),"circle-blur":new Ft(L.paint_circle["circle-blur"]),"circle-opacity":new Ft(L.paint_circle["circle-opacity"]),"circle-translate":new It(L.paint_circle["circle-translate"]),"circle-translate-anchor":new It(L.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new It(L.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new It(L.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ft(L.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ft(L.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ft(L.paint_circle["circle-stroke-opacity"])})},get layout(){return po=po||new Pn({"circle-sort-key":new Ft(L.layout_circle["circle-sort-key"])})}};class Pp extends Ya{constructor(t){super(t,Dm)}createBucket(t){return new fo(t)}queryRadius(t){const n=t;return Lu("circle-radius",this,n)+Lu("circle-stroke-width",this,n)+Bu(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:f,transform:g,pixelsToTileUnits:_,pixelPosMatrix:x}){const T=Rh(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-g.bearingInRadians,_),E=this.paint.get("circle-radius").evaluate(n,o)+this.paint.get("circle-stroke-width").evaluate(n,o),D=this.paint.get("circle-pitch-alignment")==="map",I=D?T:function(N,Z){return N.map(H=>Sf(H,Z))}(T,x),j=D?E*_:E;for(const N of f)for(const Z of N){const H=D?Z:Sf(Z,x);let W=j;const re=Et([],[Z.x,Z.y,0,1],x);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?W*=re[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(W*=g.cameraToCenterDistance/re[3]),Ah(I,H,W))return!0}return!1}}function Sf(a,t){const n=Et([],[a.x,a.y,0,1],t);return new we(n[0]/n[3],n[1]/n[3])}class zl extends fo{}let mo;bt("HeatmapBucket",zl,{omit:["layers"]});var Pl={get paint(){return mo=mo||new Pn({"heatmap-radius":new Ft(L.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ft(L.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new It(L.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mc(L.paint_heatmap["heatmap-color"]),"heatmap-opacity":new It(L.paint_heatmap["heatmap-opacity"])})}};function Bs(a,{width:t,height:n},o,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*n*o)throw new RangeError(`mismatched image size. expected: ${f.length} but got: ${t*n*o}`)}else f=new Uint8Array(t*n*o);return a.width=t,a.height=n,a.data=f,a}function Tf(a,{width:t,height:n},o){if(t===a.width&&n===a.height)return;const f=Bs({},{width:t,height:n},o);Dh(a,f,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,n)},o),a.width=t,a.height=n,a.data=f.data}function Dh(a,t,n,o,f,g){if(f.width===0||f.height===0)return t;if(f.width>a.width||f.height>a.height||n.x>a.width-f.width||n.y>a.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||o.x>t.width-f.width||o.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const _=a.data,x=t.data;if(_===x)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<f.height;T++){const E=((n.y+T)*a.width+n.x)*g,D=((o.y+T)*t.width+o.x)*g;for(let I=0;I<f.width*g;I++)x[D+I]=_[E+I]}return t}class qo{constructor(t,n){Bs(this,t,1,n)}resize(t){Tf(this,t,1)}clone(){return new qo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,o,f,g){Dh(t,n,o,f,g,1)}}class ta{constructor(t,n){Bs(this,t,4,n)}resize(t){Tf(this,t,4)}replace(t,n){n?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,n,o,f,g){Dh(t,n,o,f,g,4)}}function Rl(a){const t={},n=a.resolution||256,o=a.clips?a.clips.length:1,f=a.image||new ta({width:n,height:o});if(Math.log(n)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${n}`);const g=(_,x,T)=>{t[a.evaluationKey]=T;const E=a.expression.evaluate(t);f.data[_+x+0]=Math.floor(255*E.r/E.a),f.data[_+x+1]=Math.floor(255*E.g/E.a),f.data[_+x+2]=Math.floor(255*E.b/E.a),f.data[_+x+3]=Math.floor(255*E.a)};if(a.clips)for(let _=0,x=0;_<o;++_,x+=4*n)for(let T=0,E=0;T<n;T++,E+=4){const D=T/(n-1),{start:I,end:j}=a.clips[_];g(x,E,I*(1-D)+j*D)}else for(let _=0,x=0;_<n;_++,x+=4)g(0,x,_/(n-1));return f}bt("AlphaImage",qo),bt("RGBAImage",ta);const Rn="big-fb";class Mf extends Ya{createBucket(t){return new zl(t)}constructor(t){super(t,Pl),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Rl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Rn)&&this.heatmapFbos.delete(Rn)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let xd;var Dl={get paint(){return xd=xd||new Pn({"hillshade-illumination-direction":new It(L.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new It(L.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new It(L.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new It(L.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new It(L.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new It(L.paint_hillshade["hillshade-accent-color"])})}};class bd extends Ya{constructor(t){super(t,Dl)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const wd=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Il}=wd;function go(a,t,n){const o=n.patternDependencies;let f=!1;for(const g of t){const _=g.paint.get(`${a}-pattern`);_.isConstant()||(f=!0);const x=_.constantOr(null);x&&(f=!0,o[x.to]=!0,o[x.from]=!0)}return f}function Dc(a,t,n,o,f){const g=f.patternDependencies;for(const _ of t){const x=_.paint.get(`${a}-pattern`).value;if(x.kind!=="constant"){let T=x.evaluate({zoom:o-1},n,{},f.availableImages),E=x.evaluate({zoom:o},n,{},f.availableImages),D=x.evaluate({zoom:o+1},n,{},f.availableImages);T=T&&T.name?T.name:T,E=E&&E.name?E.name:E,D=D&&D.name?D.name:D,g[T]=!0,g[E]=!0,g[D]=!0,n.patterns[_.id]={min:T,mid:E,max:D}}}return n}function Cf(a,t,n,o,f){let g;if(f===function(_,x,T,E){let D=0;for(let I=x,j=T-E;I<T;I+=E)D+=(_[j]-_[I])*(_[I+1]+_[j+1]),j=I;return D}(a,t,n,o)>0)for(let _=t;_<n;_+=o)g=Cn(_/o|0,a[_],a[_+1],g);else for(let _=n-o;_>=t;_-=o)g=Cn(_/o|0,a[_],a[_+1],g);return g&&Ll(g,g.next)&&(Fu(g),g=g.next),g}function Ho(a,t){if(!a)return a;t||(t=a);let n,o=a;do if(n=!1,o.steiner||!Ll(o,o.next)&&mr(o.prev,o,o.next)!==0)o=o.next;else{if(Fu(o),o=t=o.prev,o===o.next)break;n=!0}while(n||o!==t);return t}function Xo(a,t,n,o,f,g,_){if(!a)return;!_&&g&&function(T,E,D,I){let j=T;do j.z===0&&(j.z=Yo(j.x,j.y,E,D,I)),j.prevZ=j.prev,j.nextZ=j.next,j=j.next;while(j!==T);j.prevZ.nextZ=null,j.prevZ=null,function(N){let Z,H=1;do{let W,re=N;N=null;let _e=null;for(Z=0;re;){Z++;let le=re,U=0;for(let ue=0;ue<H&&(U++,le=le.nextZ,le);ue++);let Y=H;for(;U>0||Y>0&&le;)U!==0&&(Y===0||!le||re.z<=le.z)?(W=re,re=re.nextZ,U--):(W=le,le=le.nextZ,Y--),_e?_e.nextZ=W:N=W,W.prevZ=_e,_e=W;re=le}_e.nextZ=null,H*=2}while(Z>1)}(j)}(a,o,f,g);let x=a;for(;a.prev!==a.next;){const T=a.prev,E=a.next;if(g?Rp(a,o,f,g):Ih(a))t.push(T.i,a.i,E.i),Fu(a),a=E.next,x=E.next;else if((a=E)===x){_?_===1?Xo(a=Dp(Ho(a),t),t,n,o,f,g,2):_===2&&kh(a,t,n,o,f,g):Xo(Ho(a),t,n,o,f,g,1);break}}}function Ih(a){const t=a.prev,n=a,o=a.next;if(mr(t,n,o)>=0)return!1;const f=t.x,g=n.x,_=o.x,x=t.y,T=n.y,E=o.y,D=Math.min(f,g,_),I=Math.min(x,T,E),j=Math.max(f,g,_),N=Math.max(x,T,E);let Z=o.next;for(;Z!==t;){if(Z.x>=D&&Z.x<=j&&Z.y>=I&&Z.y<=N&&Ou(f,x,g,T,_,E,Z.x,Z.y)&&mr(Z.prev,Z,Z.next)>=0)return!1;Z=Z.next}return!0}function Rp(a,t,n,o){const f=a.prev,g=a,_=a.next;if(mr(f,g,_)>=0)return!1;const x=f.x,T=g.x,E=_.x,D=f.y,I=g.y,j=_.y,N=Math.min(x,T,E),Z=Math.min(D,I,j),H=Math.max(x,T,E),W=Math.max(D,I,j),re=Yo(N,Z,t,n,o),_e=Yo(H,W,t,n,o);let le=a.prevZ,U=a.nextZ;for(;le&&le.z>=re&&U&&U.z<=_e;){if(le.x>=N&&le.x<=H&&le.y>=Z&&le.y<=W&&le!==f&&le!==_&&Ou(x,D,T,I,E,j,le.x,le.y)&&mr(le.prev,le,le.next)>=0||(le=le.prevZ,U.x>=N&&U.x<=H&&U.y>=Z&&U.y<=W&&U!==f&&U!==_&&Ou(x,D,T,I,E,j,U.x,U.y)&&mr(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;le&&le.z>=re;){if(le.x>=N&&le.x<=H&&le.y>=Z&&le.y<=W&&le!==f&&le!==_&&Ou(x,D,T,I,E,j,le.x,le.y)&&mr(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;U&&U.z<=_e;){if(U.x>=N&&U.x<=H&&U.y>=Z&&U.y<=W&&U!==f&&U!==_&&Ou(x,D,T,I,E,j,U.x,U.y)&&mr(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function Dp(a,t){let n=a;do{const o=n.prev,f=n.next.next;!Ll(o,f)&&Lh(o,n,n.next,f)&&Ic(o,f)&&Ic(f,o)&&(t.push(o.i,n.i,f.i),Fu(n),Fu(n.next),n=a=f),n=n.next}while(n!==a);return Ho(n)}function kh(a,t,n,o,f,g){let _=a;do{let x=_.next.next;for(;x!==_.prev;){if(_.i!==x.i&&Lp(_,x)){let T=Td(_,x);return _=Ho(_,_.next),T=Ho(T,T.next),Xo(_,t,n,o,f,g,0),void Xo(T,t,n,o,f,g,0)}x=x.next}_=_.next}while(_!==a)}function kl(a,t){let n=a.x-t.x;return n===0&&(n=a.y-t.y,n===0)&&(n=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),n}function Ip(a,t){const n=function(f,g){let _=g;const x=f.x,T=f.y;let E,D=-1/0;if(Ll(f,_))return _;do{if(Ll(f,_.next))return _.next;if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){const H=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(H<=x&&H>D&&(D=H,E=_.x<_.next.x?_:_.next,H===x))return E}_=_.next}while(_!==g);if(!E)return null;const I=E,j=E.x,N=E.y;let Z=1/0;_=E;do{if(x>=_.x&&_.x>=j&&x!==_.x&&Sd(T<N?x:D,T,j,N,T<N?D:x,T,_.x,_.y)){const H=Math.abs(T-_.y)/(x-_.x);Ic(_,f)&&(H<Z||H===Z&&(_.x>E.x||_.x===E.x&&kp(E,_)))&&(E=_,Z=H)}_=_.next}while(_!==I);return E}(a,t);if(!n)return t;const o=Td(n,a);return Ho(o,o.next),Ho(n,n.next)}function kp(a,t){return mr(a.prev,a,t.prev)<0&&mr(t.next,a,a.next)<0}function Yo(a,t,n,o,f){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-n)*f|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-o)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ja(a){let t=a,n=a;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==a);return n}function Sd(a,t,n,o,f,g,_,x){return(f-_)*(t-x)>=(a-_)*(g-x)&&(a-_)*(o-x)>=(n-_)*(t-x)&&(n-_)*(g-x)>=(f-_)*(o-x)}function Ou(a,t,n,o,f,g,_,x){return!(a===_&&t===x)&&Sd(a,t,n,o,f,g,_,x)}function Lp(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(n,o){let f=n;do{if(f.i!==n.i&&f.next.i!==n.i&&f.i!==o.i&&f.next.i!==o.i&&Lh(f,f.next,n,o))return!0;f=f.next}while(f!==n);return!1}(a,t)&&(Ic(a,t)&&Ic(t,a)&&function(n,o){let f=n,g=!1;const _=(n.x+o.x)/2,x=(n.y+o.y)/2;do f.y>x!=f.next.y>x&&f.next.y!==f.y&&_<(f.next.x-f.x)*(x-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==n);return g}(a,t)&&(mr(a.prev,a,t.prev)||mr(a,t.prev,t))||Ll(a,t)&&mr(a.prev,a,a.next)>0&&mr(t.prev,t,t.next)>0)}function mr(a,t,n){return(t.y-a.y)*(n.x-t.x)-(t.x-a.x)*(n.y-t.y)}function Ll(a,t){return a.x===t.x&&a.y===t.y}function Lh(a,t,n,o){const f=gr(mr(a,t,n)),g=gr(mr(a,t,o)),_=gr(mr(n,o,a)),x=gr(mr(n,o,t));return f!==g&&_!==x||!(f!==0||!gs(a,n,t))||!(g!==0||!gs(a,o,t))||!(_!==0||!gs(n,a,o))||!(x!==0||!gs(n,t,o))}function gs(a,t,n){return t.x<=Math.max(a.x,n.x)&&t.x>=Math.min(a.x,n.x)&&t.y<=Math.max(a.y,n.y)&&t.y>=Math.min(a.y,n.y)}function gr(a){return a>0?1:a<0?-1:0}function Ic(a,t){return mr(a.prev,a,a.next)<0?mr(a,t,a.next)>=0&&mr(a,a.prev,t)>=0:mr(a,t,a.prev)<0||mr(a,a.next,t)<0}function Td(a,t){const n=Md(a.i,a.x,a.y),o=Md(t.i,t.x,t.y),f=a.next,g=t.prev;return a.next=t,t.prev=a,n.next=f,f.prev=n,o.next=n,n.prev=o,g.next=o,o.prev=g,o}function Cn(a,t,n,o){const f=Md(a,t,n);return o?(f.next=o.next,f.prev=o,o.next.prev=f,o.next=f):(f.prev=f,f.next=f),f}function Fu(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Md(a,t,n){return{i:a,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class kc{constructor(t,n){if(n>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=n}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Bh{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Bh.noSubdivision=new Bh({fill:new kc(0,0),line:new kc(0,0),tile:new kc(0,0),stencil:new kc(0,0),circle:1}),bt("SubdivisionGranularityExpression",kc),bt("SubdivisionGranularitySetting",Bh);const _r=-32768,Gn=32767;class Ko{constructor(t,n){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Je/t,this._canonical=n}_getKey(t,n){return(t+=32768)<<16|(n+=32768)<<0}_vertexToIndex(t,n){if(t<-32768||n<-32768||t>32767||n>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(t),f=0|Math.round(n),g=this._getKey(o,f);if(this._vertexDictionary.has(g))return this._vertexDictionary.get(g);const _=this._vertexBuffer.length/2;return this._vertexDictionary.set(g,_),this._vertexBuffer.push(o,f),_}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(f,g){const _=[];for(let x=0;x<g.length;x+=3){const T=g[x],E=g[x+1],D=g[x+2],I=f[2*T],j=f[2*T+1];(f[2*E]-I)*(f[2*D+1]-j)-(f[2*E+1]-j)*(f[2*D]-I)>0?(_.push(T),_.push(D),_.push(E)):(_.push(T),_.push(E),_.push(D))}return _}(this._vertexBuffer,t);const n=[],o=t.length;for(let f=0;f<o;f+=3){const g=[t[f+0],t[f+1],t[f+2]],_=[this._vertexBuffer[2*t[f+0]+0],this._vertexBuffer[2*t[f+0]+1],this._vertexBuffer[2*t[f+1]+0],this._vertexBuffer[2*t[f+1]+1],this._vertexBuffer[2*t[f+2]+0],this._vertexBuffer[2*t[f+2]+1]];let x=1/0,T=1/0,E=-1/0,D=-1/0;for(let H=0;H<3;H++){const W=_[2*H],re=_[2*H+1];x=Math.min(x,W),E=Math.max(E,W),T=Math.min(T,re),D=Math.max(D,re)}if(x===E||T===D)continue;const I=Math.floor(x/this._granularityCellSize),j=Math.ceil(E/this._granularityCellSize),N=Math.floor(T/this._granularityCellSize),Z=Math.ceil(D/this._granularityCellSize);if(I!==j||N!==Z)for(let H=N;H<Z;H++){const W=this._scanlineGenerateVertexRingForCellRow(H,_,g);Im(this._vertexBuffer,W,n)}else n.push(...g)}return n}_scanlineGenerateVertexRingForCellRow(t,n,o){const f=t*this._granularityCellSize,g=f+this._granularityCellSize,_=[];for(let x=0;x<3;x++){const T=n[2*x],E=n[2*x+1],D=n[2*(x+1)%6],I=n[(2*(x+1)+1)%6],j=n[2*(x+2)%6],N=n[(2*(x+2)+1)%6],Z=D-T,H=I-E,W=Z===0,re=H===0,_e=(f-E)/H,le=(g-E)/H,U=Math.min(_e,le),Y=Math.max(_e,le);if(!re&&(U>=1||Y<=0)||re&&(E<f||E>g)){I>=f&&I<=g&&_.push(o[(x+1)%3]);continue}!re&&U>0&&_.push(this._vertexToIndex(T+Z*U,E+H*U));const ue=T+Z*Math.max(U,0),ke=T+Z*Math.min(Y,1);W||this._generateIntraEdgeVertices(_,T,E,D,I,ue,ke),!re&&Y<1&&_.push(this._vertexToIndex(T+Z*Y,E+H*Y)),(re||I>=f&&I<=g)&&_.push(o[(x+1)%3]),!re&&(I<=f||I>=g)&&this._generateInterEdgeVertices(_,T,E,D,I,j,N,ke,f,g)}return _}_generateIntraEdgeVertices(t,n,o,f,g,_,x){const T=f-n,E=g-o,D=E===0,I=D?Math.min(n,f):Math.min(_,x),j=D?Math.max(n,f):Math.max(_,x),N=Math.floor(I/this._granularityCellSize)+1,Z=Math.ceil(j/this._granularityCellSize)-1;if(D?n<f:_<x)for(let H=N;H<=Z;H++){const W=H*this._granularityCellSize;t.push(this._vertexToIndex(W,o+E*(W-n)/T))}else for(let H=Z;H>=N;H--){const W=H*this._granularityCellSize;t.push(this._vertexToIndex(W,o+E*(W-n)/T))}}_generateInterEdgeVertices(t,n,o,f,g,_,x,T,E,D){const I=g-o,j=_-f,N=x-g,Z=(E-g)/N,H=(D-g)/N,W=Math.min(Z,H),re=Math.max(Z,H),_e=f+j*W;let le=Math.floor(Math.min(_e,T)/this._granularityCellSize)+1,U=Math.ceil(Math.max(_e,T)/this._granularityCellSize)-1,Y=T<_e;const ue=N===0;if(ue&&(x===E||x===D))return;if(ue||W>=1||re<=0){const tt=o-x,je=_+(n-_)*Math.min((E-x)/tt,(D-x)/tt);le=Math.floor(Math.min(je,T)/this._granularityCellSize)+1,U=Math.ceil(Math.max(je,T)/this._granularityCellSize)-1,Y=T<je}const ke=I>0?D:E;if(Y)for(let tt=le;tt<=U;tt++)t.push(this._vertexToIndex(tt*this._granularityCellSize,ke));else for(let tt=U;tt>=le;tt--)t.push(this._vertexToIndex(tt*this._granularityCellSize,ke))}_generateOutline(t){const n=[];for(const o of t){const f=Bl(o,this._granularity,!0),g=this._pointArrayToIndices(f),_=[];for(let x=1;x<g.length;x++)_.push(g[x-1]),_.push(g[x]);n.push(_)}return n}_handlePoles(t){let n=!1,o=!1;this._canonical&&(this._canonical.y===0&&(n=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(n||o)&&this._fillPoles(t,n,o)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let n=0;n<t.length;n+=2){const o=t[n+1];o===_r&&(t[n+1]=-32767),o===Gn&&(t[n+1]=32766)}}_generatePoleQuad(t,n,o,f,g,_){f>g!=(_===_r)?(t.push(n),t.push(o),t.push(this._vertexToIndex(f,_)),t.push(o),t.push(this._vertexToIndex(g,_)),t.push(this._vertexToIndex(f,_))):(t.push(o),t.push(n),t.push(this._vertexToIndex(f,_)),t.push(this._vertexToIndex(g,_)),t.push(o),t.push(this._vertexToIndex(f,_)))}_fillPoles(t,n,o){const f=this._vertexBuffer,g=Je,_=t.length;for(let x=2;x<_;x+=3){const T=t[x-2],E=t[x-1],D=t[x],I=f[2*T],j=f[2*T+1],N=f[2*E],Z=f[2*E+1],H=f[2*D],W=f[2*D+1];n&&(j===0&&Z===0&&this._generatePoleQuad(t,T,E,I,N,_r),Z===0&&W===0&&this._generatePoleQuad(t,E,D,N,H,_r),W===0&&j===0&&this._generatePoleQuad(t,D,T,H,I,_r)),o&&(j===g&&Z===g&&this._generatePoleQuad(t,T,E,I,N,Gn),Z===g&&W===g&&this._generatePoleQuad(t,E,D,N,H,Gn),W===g&&j===g&&this._generatePoleQuad(t,D,T,H,I,Gn))}}_initializeVertices(t){for(let n=0;n<t.length;n+=2)this._vertexToIndex(t[n],t[n+1])}subdividePolygonInternal(t,n){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:f}=function(x){const T=[],E=[];for(const D of x)if(D.length!==0){D!==x[0]&&T.push(E.length/2);for(let I=0;I<D.length;I++)E.push(D[I].x),E.push(D[I].y)}return{flattened:E,holeIndices:T}}(t);let g;this._initializeVertices(o);try{const x=function(E,D,I=2){const j=D&&D.length,N=j?D[0]*I:E.length;let Z=Cf(E,0,N,I,!0);const H=[];if(!Z||Z.next===Z.prev)return H;let W,re,_e;if(j&&(Z=function(le,U,Y,ue){const ke=[];for(let tt=0,je=U.length;tt<je;tt++){const Ve=Cf(le,U[tt]*ue,tt<je-1?U[tt+1]*ue:le.length,ue,!1);Ve===Ve.next&&(Ve.steiner=!0),ke.push(Ja(Ve))}ke.sort(kl);for(let tt=0;tt<ke.length;tt++)Y=Ip(ke[tt],Y);return Y}(E,D,Z,I)),E.length>80*I){W=1/0,re=1/0;let le=-1/0,U=-1/0;for(let Y=I;Y<N;Y+=I){const ue=E[Y],ke=E[Y+1];ue<W&&(W=ue),ke<re&&(re=ke),ue>le&&(le=ue),ke>U&&(U=ke)}_e=Math.max(le-W,U-re),_e=_e!==0?32767/_e:0}return Xo(Z,H,I,W,re,_e,0),H}(o,f),T=this._convertIndices(o,x);g=this._subdivideTrianglesScanline(T)}catch(x){console.error(x)}let _=[];return n&&(_=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(g),{verticesFlattened:this._vertexBuffer,indicesTriangles:g,indicesLineList:_}}_convertIndices(t,n){const o=[];for(let f=0;f<n.length;f++)o.push(this._vertexToIndex(t[2*n[f]],t[2*n[f]+1]));return o}_pointArrayToIndices(t){const n=[];for(let o=0;o<t.length;o++){const f=t[o];n.push(this._vertexToIndex(f.x,f.y))}return n}}function Cd(a,t,n,o=!0){return new Ko(n,t).subdividePolygonInternal(a,o)}function Bl(a,t,n=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const o=a[0],f=a[a.length-1],g=n&&(o.x!==f.x||o.y!==f.y);if(t<2)return g?[...a,a[0]]:[...a];const _=Math.floor(Je/t),x=[];x.push(new we(a[0].x,a[0].y));const T=a.length,E=g?T:T-1;for(let D=0;D<E;D++){const I=a[D],j=D<T-1?a[D+1]:a[0],N=I.x,Z=I.y,H=j.x,W=j.y,re=N!==H,_e=Z!==W;if(!re&&!_e)continue;const le=H-N,U=W-Z,Y=Math.abs(le),ue=Math.abs(U);let ke=N,tt=Z;for(;;){const Ve=le>0?(Math.floor(ke/_)+1)*_:(Math.ceil(ke/_)-1)*_,ot=U>0?(Math.floor(tt/_)+1)*_:(Math.ceil(tt/_)-1)*_,nt=Math.abs(ke-Ve),ct=Math.abs(tt-ot),He=Math.abs(ke-H),Ct=Math.abs(tt-W),Ut=re?nt/Y:Number.POSITIVE_INFINITY,jt=_e?ct/ue:Number.POSITIVE_INFINITY;if((He<=nt||!re)&&(Ct<=ct||!_e))break;if(Ut<jt&&re||!_e){ke=Ve,tt+=U*Ut;const Pt=new we(ke,Math.round(tt));x[x.length-1].x===Pt.x&&x[x.length-1].y===Pt.y||x.push(Pt)}else{ke+=le*jt,tt=ot;const Pt=new we(Math.round(ke),tt);x[x.length-1].x===Pt.x&&x[x.length-1].y===Pt.y||x.push(Pt)}}const je=new we(H,W);x[x.length-1].x===je.x&&x[x.length-1].y===je.y||x.push(je)}return x}function Im(a,t,n){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,f=a[2*t[0]];for(let T=1;T<t.length;T++){const E=a[2*t[T]];E<f&&(f=E,o=T)}const g=t.length;let _=o,x=(_+1)%g;for(;;){const T=_-1>=0?_-1:g-1,E=(x+1)%g,D=a[2*t[T]],I=a[2*t[E]],j=a[2*t[_]],N=a[2*t[_]+1],Z=a[2*t[x]+1];let H=!1;if(D<I)H=!0;else if(D>I)H=!1;else{const W=Z-N,re=-(a[2*t[x]]-j),_e=N<Z?1:-1;((D-j)*W+(a[2*t[T]+1]-N)*re)*_e>((I-j)*W+(a[2*t[E]+1]-N)*re)*_e&&(H=!0)}if(H){const W=t[T],re=t[_],_e=t[x];W!==re&&W!==_e&&re!==_e&&n.push(_e,re,W),_--,_<0&&(_=g-1)}else{const W=t[E],re=t[_],_e=t[x];W!==re&&W!==_e&&re!==_e&&n.push(_e,re,W),x++,x>=g&&(x=0)}if(T===E)break}}function Ef(a,t,n,o,f,g,_,x,T){const E=f.length/2,D=_&&x&&T;if(E<Ot.MAX_VERTEX_ARRAY_LENGTH){const I=t.prepareSegment(E,n,o),j=I.vertexLength;for(let H=0;H<g.length;H+=3)o.emplaceBack(j+g[H],j+g[H+1],j+g[H+2]);let N,Z;I.vertexLength+=E,I.primitiveLength+=g.length/3,D&&(Z=_.prepareSegment(E,n,x),N=Z.vertexLength,Z.vertexLength+=E);for(let H=0;H<f.length;H+=2)a(f[H],f[H+1]);if(D)for(let H=0;H<T.length;H++){const W=T[H];for(let re=1;re<W.length;re+=2)x.emplaceBack(N+W[re-1],N+W[re]);Z.primitiveLength+=W.length/2}}else(function(I,j,N,Z,H,W){const re=[];for(let ue=0;ue<Z.length/2;ue++)re.push(-1);const _e={count:0};let le=0,U=I.getOrCreateLatestSegment(j,N),Y=U.vertexLength;for(let ue=2;ue<H.length;ue+=3){const ke=H[ue-2],tt=H[ue-1],je=H[ue];let Ve=re[ke]<le,ot=re[tt]<le,nt=re[je]<le;U.vertexLength+((Ve?1:0)+(ot?1:0)+(nt?1:0))>Ot.MAX_VERTEX_ARRAY_LENGTH&&(U=I.createNewSegment(j,N),le=_e.count,Ve=!0,ot=!0,nt=!0,Y=0);const ct=ia(re,Z,W,_e,ke,Ve,U),He=ia(re,Z,W,_e,tt,ot,U),Ct=ia(re,Z,W,_e,je,nt,U);N.emplaceBack(Y+ct-le,Y+He-le,Y+Ct-le),U.primitiveLength++}})(t,n,o,f,g,a),D&&function(I,j,N,Z,H,W){const re=[];for(let ue=0;ue<Z.length/2;ue++)re.push(-1);const _e={count:0};let le=0,U=I.getOrCreateLatestSegment(j,N),Y=U.vertexLength;for(let ue=0;ue<H.length;ue++){const ke=H[ue];for(let tt=1;tt<H[ue].length;tt+=2){const je=ke[tt-1],Ve=ke[tt];let ot=re[je]<le,nt=re[Ve]<le;U.vertexLength+((ot?1:0)+(nt?1:0))>Ot.MAX_VERTEX_ARRAY_LENGTH&&(U=I.createNewSegment(j,N),le=_e.count,ot=!0,nt=!0,Y=0);const ct=ia(re,Z,W,_e,je,ot,U),He=ia(re,Z,W,_e,Ve,nt,U);N.emplaceBack(Y+ct-le,Y+He-le),U.primitiveLength++}}}(_,n,x,f,T,a),t.forceNewSegmentOnNextPrepare(),_==null||_.forceNewSegmentOnNextPrepare()}function ia(a,t,n,o,f,g,_){if(g){const x=o.count;return n(t[2*f],t[2*f+1]),a[f]=o.count,o.count++,_.vertexLength++,x}return a[f]}class es{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fe,this.indexArray=new mt,this.indexArray2=new ft,this.programConfigurations=new $o(t.layers,t.zoom),this.segments=new Ot,this.segments2=new Ot,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){this.hasPattern=go("fill",this.layers,n);const f=this.layers[0].layout.get("fill-sort-key"),g=!f.isConstant(),_=[];for(const{feature:x,id:T,index:E,sourceLayerIndex:D}of t){const I=this.layers[0]._featureFilter.needGeometry,j=ea(x,I);if(!this.layers[0]._featureFilter.filter(new Ki(this.zoom),j,o))continue;const N=g?f.evaluate(j,{},o,n.availableImages):void 0,Z={id:T,properties:x.properties,type:x.type,sourceLayerIndex:D,index:E,geometry:I?j.geometry:ho(x),patterns:{},sortKey:N};_.push(Z)}g&&_.sort((x,T)=>x.sortKey-T.sortKey);for(const x of _){const{geometry:T,index:E,sourceLayerIndex:D}=x;if(this.hasPattern){const I=Dc("fill",this.layers,x,this.zoom,n);this.patternFeatures.push(I)}else this.addFeature(x,T,E,o,{},n.subdivisionGranularity);n.featureIndex.insert(t[E].feature,T,E,D,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}addFeatures(t,n,o){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Il),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,n,o,f,g,_){for(const x of lc(n,500)){const T=Cd(x,f,_.fill.getGranularityForZoomLevel(f.z)),E=this.layoutVertexArray;Ef((D,I)=>{E.emplaceBack(D,I)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,f)}}let Ed,ts;bt("FillBucket",es,{omit:["layers","patternFeatures"]});var Bp={get paint(){return ts=ts||new Pn({"fill-antialias":new It(L.paint_fill["fill-antialias"]),"fill-opacity":new Ft(L.paint_fill["fill-opacity"]),"fill-color":new Ft(L.paint_fill["fill-color"]),"fill-outline-color":new Ft(L.paint_fill["fill-outline-color"]),"fill-translate":new It(L.paint_fill["fill-translate"]),"fill-translate-anchor":new It(L.paint_fill["fill-translate-anchor"]),"fill-pattern":new Tc(L.paint_fill["fill-pattern"])})},get layout(){return Ed=Ed||new Pn({"fill-sort-key":new Ft(L.layout_fill["fill-sort-key"])})}};class Wo extends Ya{constructor(t){super(t,Bp)}recalculate(t,n){super.recalculate(t,n);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new es(t)}queryRadius(){return Bu(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:n,transform:o,pixelsToTileUnits:f}){return Rc(Rh(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,f),n)}isTileClipped(){return!0}}const ju=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Ol=pr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Ad}=ju;var Oh,Qo,Af,Lc,Bc,Nu,Oc,Fh={};function zd(){if(Qo)return Oh;Qo=1;var a=Ee();function t(f,g,_,x,T){this.properties={},this.extent=_,this.type=0,this._pbf=f,this._geometry=-1,this._keys=x,this._values=T,f.readFields(n,this,g)}function n(f,g,_){f==1?g.id=_.readVarint():f==2?function(x,T){for(var E=x.readVarint()+x.pos;x.pos<E;){var D=T._keys[x.readVarint()],I=T._values[x.readVarint()];T.properties[D]=I}}(_,g):f==3?g.type=_.readVarint():f==4&&(g._geometry=_.pos)}function o(f){for(var g,_,x=0,T=0,E=f.length,D=E-1;T<E;D=T++)x+=((_=f[D]).x-(g=f[T]).x)*(g.y+_.y);return x}return Oh=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var g,_=f.readVarint()+f.pos,x=1,T=0,E=0,D=0,I=[];f.pos<_;){if(T<=0){var j=f.readVarint();x=7&j,T=j>>3}if(T--,x===1||x===2)E+=f.readSVarint(),D+=f.readSVarint(),x===1&&(g&&I.push(g),g=[]),g.push(new a(E,D));else{if(x!==7)throw new Error("unknown command "+x);g&&g.push(g[0].clone())}}return g&&I.push(g),I},t.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var g=f.readVarint()+f.pos,_=1,x=0,T=0,E=0,D=1/0,I=-1/0,j=1/0,N=-1/0;f.pos<g;){if(x<=0){var Z=f.readVarint();_=7&Z,x=Z>>3}if(x--,_===1||_===2)(T+=f.readSVarint())<D&&(D=T),T>I&&(I=T),(E+=f.readSVarint())<j&&(j=E),E>N&&(N=E);else if(_!==7)throw new Error("unknown command "+_)}return[D,j,I,N]},t.prototype.toGeoJSON=function(f,g,_){var x,T,E=this.extent*Math.pow(2,_),D=this.extent*f,I=this.extent*g,j=this.loadGeometry(),N=t.types[this.type];function Z(re){for(var _e=0;_e<re.length;_e++){var le=re[_e];re[_e]=[360*(le.x+D)/E-180,360/Math.PI*Math.atan(Math.exp((180-360*(le.y+I)/E)*Math.PI/180))-90]}}switch(this.type){case 1:var H=[];for(x=0;x<j.length;x++)H[x]=j[x][0];Z(j=H);break;case 2:for(x=0;x<j.length;x++)Z(j[x]);break;case 3:for(j=function(re){var _e=re.length;if(_e<=1)return[re];for(var le,U,Y=[],ue=0;ue<_e;ue++){var ke=o(re[ue]);ke!==0&&(U===void 0&&(U=ke<0),U===ke<0?(le&&Y.push(le),le=[re[ue]]):le.push(re[ue]))}return le&&Y.push(le),Y}(j),x=0;x<j.length;x++)for(T=0;T<j[x].length;T++)Z(j[x][T])}j.length===1?j=j[0]:N="Multi"+N;var W={type:"Feature",geometry:{type:N,coordinates:j},properties:this.properties};return"id"in this&&(W.id=this.id),W},Oh}function Uu(){if(Lc)return Af;Lc=1;var a=zd();function t(o,f){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,f),this.length=this._features.length}function n(o,f,g){o===15?f.version=g.readVarint():o===1?f.name=g.readString():o===5?f.extent=g.readVarint():o===2?f._features.push(g.pos):o===3?f._keys.push(g.readString()):o===4&&f._values.push(function(_){for(var x=null,T=_.readVarint()+_.pos;_.pos<T;){var E=_.readVarint()>>3;x=E===1?_.readString():E===2?_.readFloat():E===3?_.readDouble():E===4?_.readVarint64():E===5?_.readVarint():E===6?_.readSVarint():E===7?_.readBoolean():null}return x}(g))}return Af=t,t.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var f=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,f,this.extent,this._keys,this._values)},Af}function Pd(){return Oc||(Oc=1,Fh.VectorTile=function(){if(Nu)return Bc;Nu=1;var a=Uu();function t(n,o,f){if(n===3){var g=new a(f,f.readVarint()+f.pos);g.length&&(o[g.name]=g)}}return Bc=function(n,o){this.layers=n.readFields(t,{},o)},Bc}(),Fh.VectorTileFeature=zd(),Fh.VectorTileLayer=Uu()),Fh}var Fl=ce(Pd());const Op=Fl.VectorTileFeature.types,Rd=Math.pow(2,13);function ra(a,t,n,o,f,g,_,x){a.emplaceBack(t,n,2*Math.floor(o*Rd)+_,f*Rd*2,g*Rd*2,Math.round(x))}class jh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new de,this.centroidVertexArray=new ie,this.indexArray=new mt,this.programConfigurations=new $o(t.layers,t.zoom),this.segments=new Ot,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){this.features=[],this.hasPattern=go("fill-extrusion",this.layers,n);for(const{feature:f,id:g,index:_,sourceLayerIndex:x}of t){const T=this.layers[0]._featureFilter.needGeometry,E=ea(f,T);if(!this.layers[0]._featureFilter.filter(new Ki(this.zoom),E,o))continue;const D={id:g,sourceLayerIndex:x,index:_,geometry:T?E.geometry:ho(f),properties:f.properties,type:f.type,patterns:{}};this.hasPattern?this.features.push(Dc("fill-extrusion",this.layers,D,this.zoom,n)):this.addFeature(D,D.geometry,_,o,{},n.subdivisionGranularity),n.featureIndex.insert(f,D.geometry,_,x,this.index,!0)}}addFeatures(t,n,o){for(const f of this.features){const{geometry:g}=f;this.addFeature(f,g,f.index,n,o,t.subdivisionGranularity)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ad),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Ol.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,n,o,f,g,_){for(const x of lc(n,500)){const T={x:0,y:0,sampleCount:0},E=this.layoutVertexArray.length;this.processPolygon(T,f,t,x,_);const D=this.layoutVertexArray.length-E,I=Math.floor(T.x/T.sampleCount),j=Math.floor(T.y/T.sampleCount);for(let N=0;N<D;N++)this.centroidVertexArray.emplaceBack(I,j)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,f)}processPolygon(t,n,o,f,g){if(f.length<1||Nh(f[0]))return;for(const I of f)I.length!==0&&jl(t,I);const _={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},x=g.fill.getGranularityForZoomLevel(n.z),T=Op[o.type]==="Polygon";for(const I of f){if(I.length===0||Nh(I))continue;const j=Bl(I,x,T);this._generateSideFaces(j,_)}if(!T)return;const E=Cd(f,n,x,!1),D=this.layoutVertexArray;Ef((I,j)=>{ra(D,I,j,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles)}_generateSideFaces(t,n){let o=0;for(let f=1;f<t.length;f++){const g=t[f],_=t[f-1];if(Fp(g,_))continue;n.segment.vertexLength+4>Ot.MAX_VERTEX_ARRAY_LENGTH&&(n.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const x=g.sub(_)._perp()._unit(),T=_.dist(g);o+T>32768&&(o=0),ra(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,o),ra(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,o),o+=T,ra(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,0,o),ra(this.layoutVertexArray,_.x,_.y,x.x,x.y,0,1,o);const E=n.segment.vertexLength;this.indexArray.emplaceBack(E,E+2,E+1),this.indexArray.emplaceBack(E+1,E+2,E+3),n.segment.vertexLength+=4,n.segment.primitiveLength+=2}}}function jl(a,t){for(let n=0;n<t.length;n++){const o=t[n];n===t.length-1&&t[0].x===o.x&&t[0].y===o.y||(a.x+=o.x,a.y+=o.y,a.sampleCount++)}}function Fp(a,t){return a.x===t.x&&(a.x<0||a.x>Je)||a.y===t.y&&(a.y<0||a.y>Je)}function Nh(a){return a.every(t=>t.x<0)||a.every(t=>t.x>Je)||a.every(t=>t.y<0)||a.every(t=>t.y>Je)}let Nl;bt("FillExtrusionBucket",jh,{omit:["layers","features"]});var jp={get paint(){return Nl=Nl||new Pn({"fill-extrusion-opacity":new It(L["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ft(L["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new It(L["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new It(L["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Tc(L["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ft(L["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ft(L["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new It(L["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Dd extends Ya{constructor(t){super(t,jp)}createBucket(t){return new jh(t)}queryRadius(){return Bu(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:f,transform:g,pixelsToTileUnits:_,pixelPosMatrix:x}){const T=Rh(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-g.bearingInRadians,_),E=this.paint.get("fill-extrusion-height").evaluate(n,o),D=this.paint.get("fill-extrusion-base").evaluate(n,o),I=function(N,Z,H){const W=[];for(const re of N){const _e=[re.x,re.y,0,1];Et(_e,_e,Z),W.push(new we(_e[0]/_e[3],_e[1]/_e[3]))}return W}(T,x),j=function(N,Z,H,W){const re=[],_e=[],le=W[8]*Z,U=W[9]*Z,Y=W[10]*Z,ue=W[11]*Z,ke=W[8]*H,tt=W[9]*H,je=W[10]*H,Ve=W[11]*H;for(const ot of N){const nt=[],ct=[];for(const He of ot){const Ct=He.x,Ut=He.y,jt=W[0]*Ct+W[4]*Ut+W[12],Pt=W[1]*Ct+W[5]*Ut+W[13],fi=W[2]*Ct+W[6]*Ut+W[14],cr=W[3]*Ct+W[7]*Ut+W[15],Or=fi+Y,vr=cr+ue,hn=jt+ke,$r=Pt+tt,Fr=fi+je,Ni=cr+Ve,rr=new we((jt+le)/vr,(Pt+U)/vr);rr.z=Or/vr,nt.push(rr);const An=new we(hn/Ni,$r/Ni);An.z=Fr/Ni,ct.push(An)}re.push(nt),_e.push(ct)}return[re,_e]}(f,D,E,x);return function(N,Z,H){let W=1/0;Rc(H,Z)&&(W=_o(H,Z[0]));for(let re=0;re<Z.length;re++){const _e=Z[re],le=N[re];for(let U=0;U<_e.length-1;U++){const Y=_e[U],ue=[Y,_e[U+1],le[U+1],le[U],Y];El(H,ue)&&(W=Math.min(W,_o(H,ue)))}}return W!==1/0&&W}(j[0],j[1],I)}}function Fc(a,t){return a.x*t.x+a.y*t.y}function _o(a,t){if(a.length===1){let n=0;const o=t[n++];let f;for(;!f||o.equals(f);)if(f=t[n++],!f)return 1/0;for(;n<t.length;n++){const g=t[n],_=a[0],x=f.sub(o),T=g.sub(o),E=_.sub(o),D=Fc(x,x),I=Fc(x,T),j=Fc(T,T),N=Fc(E,x),Z=Fc(E,T),H=D*j-I*I,W=(j*N-I*Z)/H,re=(D*Z-I*N)/H,_e=o.z*(1-W-re)+f.z*W+g.z*re;if(isFinite(_e))return _e}return 1/0}{let n=1/0;for(const o of t)n=Math.min(n,o.z);return n}}const Np=pr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:zf}=Np,Uh=pr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Br}=Uh,km=Fl.VectorTileFeature.types,Lm=Math.cos(Math.PI/180*37.5),Id=Math.pow(2,14)/.5;class kd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(n=>n.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new pe,this.layoutVertexArray2=new ye,this.indexArray=new mt,this.programConfigurations=new $o(t.layers,t.zoom),this.segments=new Ot,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(t,n,o){this.hasPattern=go("line",this.layers,n);const f=this.layers[0].layout.get("line-sort-key"),g=!f.isConstant(),_=[];for(const{feature:x,id:T,index:E,sourceLayerIndex:D}of t){const I=this.layers[0]._featureFilter.needGeometry,j=ea(x,I);if(!this.layers[0]._featureFilter.filter(new Ki(this.zoom),j,o))continue;const N=g?f.evaluate(j,{},o):void 0,Z={id:T,properties:x.properties,type:x.type,sourceLayerIndex:D,index:E,geometry:I?j.geometry:ho(x),patterns:{},sortKey:N};_.push(Z)}g&&_.sort((x,T)=>x.sortKey-T.sortKey);for(const x of _){const{geometry:T,index:E,sourceLayerIndex:D}=x;if(this.hasPattern){const I=Dc("line",this.layers,x,this.zoom,n);this.patternFeatures.push(I)}else this.addFeature(x,T,E,o,{},n.subdivisionGranularity);n.featureIndex.insert(t[E].feature,T,E,D,this.index)}}update(t,n,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,n,this.stateDependentLayers,o)}addFeatures(t,n,o){for(const f of this.patternFeatures)this.addFeature(f,f.geometry,f.index,n,o,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Br)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,n,o,f,g,_){const x=this.layers[0].layout,T=x.get("line-join").evaluate(t,{}),E=x.get("line-cap"),D=x.get("line-miter-limit"),I=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const j of n)this.addLine(j,t,T,E,D,I,f,_);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,g,f)}addLine(t,n,o,f,g,_,x,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Bl(t,x?T.line.getGranularityForZoomLevel(x.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=km[n.type]==="Polygon";let D=t.length;for(;D>=2&&t[D-1].equals(t[D-2]);)D--;let I=0;for(;I<D-1&&t[I].equals(t[I+1]);)I++;if(D<(E?3:2))return;o==="bevel"&&(g=1.05);const j=this.overscaling<=16?15*Je/(512*this.overscaling):0,N=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let Z,H,W,re,_e;this.e1=this.e2=-1,E&&(Z=t[D-2],_e=t[I].sub(Z)._unit()._perp());for(let le=I;le<D;le++){if(W=le===D-1?E?t[I+1]:void 0:t[le+1],W&&t[le].equals(W))continue;_e&&(re=_e),Z&&(H=Z),Z=t[le],_e=W?W.sub(Z)._unit()._perp():re,re=re||_e;let U=re.add(_e);U.x===0&&U.y===0||U._unit();const Y=re.x*_e.x+re.y*_e.y,ue=U.x*_e.x+U.y*_e.y,ke=ue!==0?1/ue:1/0,tt=2*Math.sqrt(2-2*ue),je=ue<Lm&&H&&W,Ve=re.x*_e.y-re.y*_e.x>0;if(je&&le>I){const ct=Z.dist(H);if(ct>2*j){const He=Z.sub(Z.sub(H)._mult(j/ct)._round());this.updateDistance(H,He),this.addCurrentVertex(He,re,0,0,N),H=He}}const ot=H&&W;let nt=ot?o:E?"butt":f;if(ot&&nt==="round"&&(ke<_?nt="miter":ke<=2&&(nt="fakeround")),nt==="miter"&&ke>g&&(nt="bevel"),nt==="bevel"&&(ke>2&&(nt="flipbevel"),ke<g&&(nt="miter")),H&&this.updateDistance(H,Z),nt==="miter")U._mult(ke),this.addCurrentVertex(Z,U,0,0,N);else if(nt==="flipbevel"){if(ke>100)U=_e.mult(-1);else{const ct=ke*re.add(_e).mag()/re.sub(_e).mag();U._perp()._mult(ct*(Ve?-1:1))}this.addCurrentVertex(Z,U,0,0,N),this.addCurrentVertex(Z,U.mult(-1),0,0,N)}else if(nt==="bevel"||nt==="fakeround"){const ct=-Math.sqrt(ke*ke-1),He=Ve?ct:0,Ct=Ve?0:ct;if(H&&this.addCurrentVertex(Z,re,He,Ct,N),nt==="fakeround"){const Ut=Math.round(180*tt/Math.PI/20);for(let jt=1;jt<Ut;jt++){let Pt=jt/Ut;if(Pt!==.5){const cr=Pt-.5;Pt+=Pt*cr*(Pt-1)*((1.0904+Y*(Y*(3.55645-1.43519*Y)-3.2452))*cr*cr+(.848013+Y*(.215638*Y-1.06021)))}const fi=_e.sub(re)._mult(Pt)._add(re)._unit()._mult(Ve?-1:1);this.addHalfVertex(Z,fi.x,fi.y,!1,Ve,0,N)}}W&&this.addCurrentVertex(Z,_e,-He,-Ct,N)}else if(nt==="butt")this.addCurrentVertex(Z,U,0,0,N);else if(nt==="square"){const ct=H?1:-1;this.addCurrentVertex(Z,U,ct,ct,N)}else nt==="round"&&(H&&(this.addCurrentVertex(Z,re,0,0,N),this.addCurrentVertex(Z,re,1,1,N,!0)),W&&(this.addCurrentVertex(Z,_e,-1,-1,N,!0),this.addCurrentVertex(Z,_e,0,0,N)));if(je&&le<D-1){const ct=Z.dist(W);if(ct>2*j){const He=Z.add(W.sub(Z)._mult(j/ct)._round());this.updateDistance(Z,He),this.addCurrentVertex(He,_e,0,0,N),Z=He}}}}addCurrentVertex(t,n,o,f,g,_=!1){const x=n.y*f-n.x,T=-n.y-n.x*f;this.addHalfVertex(t,n.x+n.y*o,n.y-n.x*o,_,!1,o,g),this.addHalfVertex(t,x,T,_,!0,-f,g),this.distance>Id/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,n,o,f,g,_))}addHalfVertex({x:t,y:n},o,f,g,_,x,T){const E=.5*(this.lineClips?this.scaledDistance*(Id-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(n<<1)+(_?1:0),Math.round(63*o)+128,Math.round(63*f)+128,1+(x===0?0:x<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),T.primitiveLength++),_?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,n){this.distance+=t.dist(n),this.updateScaledDistance()}}let Up,Ar;bt("LineBucket",kd,{omit:["layers","patternFeatures"]});var tr={get paint(){return Ar=Ar||new Pn({"line-opacity":new Ft(L.paint_line["line-opacity"]),"line-color":new Ft(L.paint_line["line-color"]),"line-translate":new It(L.paint_line["line-translate"]),"line-translate-anchor":new It(L.paint_line["line-translate-anchor"]),"line-width":new Ft(L.paint_line["line-width"]),"line-gap-width":new Ft(L.paint_line["line-gap-width"]),"line-offset":new Ft(L.paint_line["line-offset"]),"line-blur":new Ft(L.paint_line["line-blur"]),"line-dasharray":new sr(L.paint_line["line-dasharray"]),"line-pattern":new Tc(L.paint_line["line-pattern"]),"line-gradient":new Mc(L.paint_line["line-gradient"])})},get layout(){return Up=Up||new Pn({"line-cap":new It(L.layout_line["line-cap"]),"line-join":new Ft(L.layout_line["line-join"]),"line-miter-limit":new It(L.layout_line["line-miter-limit"]),"line-round-limit":new It(L.layout_line["line-round-limit"]),"line-sort-key":new Ft(L.layout_line["line-sort-key"])})}};class wi extends Ft{possiblyEvaluate(t,n){return n=new Ki(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,zoomHistory:n.zoomHistory,transition:n.transition}),super.possiblyEvaluate(t,n)}evaluate(t,n,o,f){return n=Xt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(t,n,o,f)}}let Si;class lr extends Ya{constructor(t){super(t,tr),this.gradientVersion=0,Si||(Si=new wi(tr.paint.properties["line-width"].specification),Si.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const n=this.gradientExpression();this.stepInterpolant=!!function(o){return o._styleExpression!==void 0}(n)&&n._styleExpression.expression instanceof os,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,n){super.recalculate(t,n),this.paint._values["line-floorwidth"]=Si.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new kd(t)}queryRadius(t){const n=t,o=Da(Lu("line-width",this,n),Lu("line-gap-width",this,n)),f=Lu("line-offset",this,n);return o/2+Math.abs(f)+Bu(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:n,featureState:o,geometry:f,transform:g,pixelsToTileUnits:_}){const x=Rh(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-g.bearingInRadians,_),T=_/2*Da(this.paint.get("line-width").evaluate(n,o),this.paint.get("line-gap-width").evaluate(n,o)),E=this.paint.get("line-offset").evaluate(n,o);return E&&(f=function(D,I){const j=[];for(let N=0;N<D.length;N++){const Z=D[N],H=[];for(let W=0;W<Z.length;W++){const re=Z[W-1],_e=Z[W],le=Z[W+1],U=W===0?new we(0,0):_e.sub(re)._unit()._perp(),Y=W===Z.length-1?new we(0,0):le.sub(_e)._unit()._perp(),ue=U._add(Y)._unit(),ke=ue.x*Y.x+ue.y*Y.y;ke!==0&&ue._mult(1/ke),H.push(ue._mult(I)._add(_e))}j.push(H)}return j}(f,E*_)),function(D,I,j){for(let N=0;N<I.length;N++){const Z=I[N];if(D.length>=3){for(let H=0;H<Z.length;H++)if(Al(D,Z[H]))return!0}if(zp(D,Z,j))return!0}return!1}(x,f,T)}isTileClipped(){return!0}}function Da(a,t){return t>0?t+2*a:a}const Jo=pr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Vu=pr([{name:"a_projected_pos",components:3,type:"Float32"}],4);pr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ld=pr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);pr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const yo=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gr=pr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ul(a,t,n){return a.sections.forEach(o=>{o.text=function(f,g,_){const x=g.layout.get("text-transform").evaluate(_,{});return x==="uppercase"?f=f.toLocaleUpperCase():x==="lowercase"&&(f=f.toLocaleLowerCase()),Xa.applyArabicShaping&&(f=Xa.applyArabicShaping(f)),f}(o.text,t,n)}),a}pr([{name:"triangle",components:3,type:"Uint16"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pr([{type:"Float32",name:"offsetX"}]),pr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Os={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Pf,Ia,jc,yr=24,_s={};function Bd(){return Pf||(Pf=1,_s.read=function(a,t,n,o,f){var g,_,x=8*f-o-1,T=(1<<x)-1,E=T>>1,D=-7,I=n?f-1:0,j=n?-1:1,N=a[t+I];for(I+=j,g=N&(1<<-D)-1,N>>=-D,D+=x;D>0;g=256*g+a[t+I],I+=j,D-=8);for(_=g&(1<<-D)-1,g>>=-D,D+=o;D>0;_=256*_+a[t+I],I+=j,D-=8);if(g===0)g=1-E;else{if(g===T)return _?NaN:1/0*(N?-1:1);_+=Math.pow(2,o),g-=E}return(N?-1:1)*_*Math.pow(2,g-o)},_s.write=function(a,t,n,o,f,g){var _,x,T,E=8*g-f-1,D=(1<<E)-1,I=D>>1,j=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=o?0:g-1,Z=o?1:-1,H=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(x=isNaN(t)?1:0,_=D):(_=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-_))<1&&(_--,T*=2),(t+=_+I>=1?j/T:j*Math.pow(2,1-I))*T>=2&&(_++,T/=2),_+I>=D?(x=0,_=D):_+I>=1?(x=(t*T-1)*Math.pow(2,f),_+=I):(x=t*Math.pow(2,I-1)*Math.pow(2,f),_=0));f>=8;a[n+N]=255&x,N+=Z,x/=256,f-=8);for(_=_<<f|x,E+=f;E>0;a[n+N]=255&_,N+=Z,_/=256,E-=8);a[n+N-Z]|=128*H}),_s}function Rf(){if(jc)return Ia;jc=1,Ia=t;var a=Bd();function t(U){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(U)?U:new Uint8Array(U||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var n=4294967296,o=1/n,f=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function g(U){return U.type===t.Bytes?U.readVarint()+U.pos:U.pos+1}function _(U,Y,ue){return ue?4294967296*Y+(U>>>0):4294967296*(Y>>>0)+(U>>>0)}function x(U,Y,ue){var ke=Y<=16383?1:Y<=2097151?2:Y<=268435455?3:Math.floor(Math.log(Y)/(7*Math.LN2));ue.realloc(ke);for(var tt=ue.pos-1;tt>=U;tt--)ue.buf[tt+ke]=ue.buf[tt]}function T(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeVarint(U[ue])}function E(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeSVarint(U[ue])}function D(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeFloat(U[ue])}function I(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeDouble(U[ue])}function j(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeBoolean(U[ue])}function N(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeFixed32(U[ue])}function Z(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeSFixed32(U[ue])}function H(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeFixed64(U[ue])}function W(U,Y){for(var ue=0;ue<U.length;ue++)Y.writeSFixed64(U[ue])}function re(U,Y){return(U[Y]|U[Y+1]<<8|U[Y+2]<<16)+16777216*U[Y+3]}function _e(U,Y,ue){U[ue]=Y,U[ue+1]=Y>>>8,U[ue+2]=Y>>>16,U[ue+3]=Y>>>24}function le(U,Y){return(U[Y]|U[Y+1]<<8|U[Y+2]<<16)+(U[Y+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(U,Y,ue){for(ue=ue||this.length;this.pos<ue;){var ke=this.readVarint(),tt=ke>>3,je=this.pos;this.type=7&ke,U(tt,Y,this),this.pos===je&&this.skip(ke)}return Y},readMessage:function(U,Y){return this.readFields(U,Y,this.readVarint()+this.pos)},readFixed32:function(){var U=re(this.buf,this.pos);return this.pos+=4,U},readSFixed32:function(){var U=le(this.buf,this.pos);return this.pos+=4,U},readFixed64:function(){var U=re(this.buf,this.pos)+re(this.buf,this.pos+4)*n;return this.pos+=8,U},readSFixed64:function(){var U=re(this.buf,this.pos)+le(this.buf,this.pos+4)*n;return this.pos+=8,U},readFloat:function(){var U=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,U},readDouble:function(){var U=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,U},readVarint:function(U){var Y,ue,ke=this.buf;return Y=127&(ue=ke[this.pos++]),ue<128?Y:(Y|=(127&(ue=ke[this.pos++]))<<7,ue<128?Y:(Y|=(127&(ue=ke[this.pos++]))<<14,ue<128?Y:(Y|=(127&(ue=ke[this.pos++]))<<21,ue<128?Y:function(tt,je,Ve){var ot,nt,ct=Ve.buf;if(ot=(112&(nt=ct[Ve.pos++]))>>4,nt<128||(ot|=(127&(nt=ct[Ve.pos++]))<<3,nt<128)||(ot|=(127&(nt=ct[Ve.pos++]))<<10,nt<128)||(ot|=(127&(nt=ct[Ve.pos++]))<<17,nt<128)||(ot|=(127&(nt=ct[Ve.pos++]))<<24,nt<128)||(ot|=(1&(nt=ct[Ve.pos++]))<<31,nt<128))return _(tt,ot,je);throw new Error("Expected varint not more than 10 bytes")}(Y|=(15&(ue=ke[this.pos]))<<28,U,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var U=this.readVarint();return U%2==1?(U+1)/-2:U/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var U=this.readVarint()+this.pos,Y=this.pos;return this.pos=U,U-Y>=12&&f?function(ue,ke,tt){return f.decode(ue.subarray(ke,tt))}(this.buf,Y,U):function(ue,ke,tt){for(var je="",Ve=ke;Ve<tt;){var ot,nt,ct,He=ue[Ve],Ct=null,Ut=He>239?4:He>223?3:He>191?2:1;if(Ve+Ut>tt)break;Ut===1?He<128&&(Ct=He):Ut===2?(192&(ot=ue[Ve+1]))==128&&(Ct=(31&He)<<6|63&ot)<=127&&(Ct=null):Ut===3?(nt=ue[Ve+2],(192&(ot=ue[Ve+1]))==128&&(192&nt)==128&&((Ct=(15&He)<<12|(63&ot)<<6|63&nt)<=2047||Ct>=55296&&Ct<=57343)&&(Ct=null)):Ut===4&&(nt=ue[Ve+2],ct=ue[Ve+3],(192&(ot=ue[Ve+1]))==128&&(192&nt)==128&&(192&ct)==128&&((Ct=(15&He)<<18|(63&ot)<<12|(63&nt)<<6|63&ct)<=65535||Ct>=1114112)&&(Ct=null)),Ct===null?(Ct=65533,Ut=1):Ct>65535&&(Ct-=65536,je+=String.fromCharCode(Ct>>>10&1023|55296),Ct=56320|1023&Ct),je+=String.fromCharCode(Ct),Ve+=Ut}return je}(this.buf,Y,U)},readBytes:function(){var U=this.readVarint()+this.pos,Y=this.buf.subarray(this.pos,U);return this.pos=U,Y},readPackedVarint:function(U,Y){if(this.type!==t.Bytes)return U.push(this.readVarint(Y));var ue=g(this);for(U=U||[];this.pos<ue;)U.push(this.readVarint(Y));return U},readPackedSVarint:function(U){if(this.type!==t.Bytes)return U.push(this.readSVarint());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readSVarint());return U},readPackedBoolean:function(U){if(this.type!==t.Bytes)return U.push(this.readBoolean());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readBoolean());return U},readPackedFloat:function(U){if(this.type!==t.Bytes)return U.push(this.readFloat());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readFloat());return U},readPackedDouble:function(U){if(this.type!==t.Bytes)return U.push(this.readDouble());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readDouble());return U},readPackedFixed32:function(U){if(this.type!==t.Bytes)return U.push(this.readFixed32());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readFixed32());return U},readPackedSFixed32:function(U){if(this.type!==t.Bytes)return U.push(this.readSFixed32());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readSFixed32());return U},readPackedFixed64:function(U){if(this.type!==t.Bytes)return U.push(this.readFixed64());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readFixed64());return U},readPackedSFixed64:function(U){if(this.type!==t.Bytes)return U.push(this.readSFixed64());var Y=g(this);for(U=U||[];this.pos<Y;)U.push(this.readSFixed64());return U},skip:function(U){var Y=7&U;if(Y===t.Varint)for(;this.buf[this.pos++]>127;);else if(Y===t.Bytes)this.pos=this.readVarint()+this.pos;else if(Y===t.Fixed32)this.pos+=4;else{if(Y!==t.Fixed64)throw new Error("Unimplemented type: "+Y);this.pos+=8}},writeTag:function(U,Y){this.writeVarint(U<<3|Y)},realloc:function(U){for(var Y=this.length||16;Y<this.pos+U;)Y*=2;if(Y!==this.length){var ue=new Uint8Array(Y);ue.set(this.buf),this.buf=ue,this.length=Y}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(U){this.realloc(4),_e(this.buf,U,this.pos),this.pos+=4},writeSFixed32:function(U){this.realloc(4),_e(this.buf,U,this.pos),this.pos+=4},writeFixed64:function(U){this.realloc(8),_e(this.buf,-1&U,this.pos),_e(this.buf,Math.floor(U*o),this.pos+4),this.pos+=8},writeSFixed64:function(U){this.realloc(8),_e(this.buf,-1&U,this.pos),_e(this.buf,Math.floor(U*o),this.pos+4),this.pos+=8},writeVarint:function(U){(U=+U||0)>268435455||U<0?function(Y,ue){var ke,tt;if(Y>=0?(ke=Y%4294967296|0,tt=Y/4294967296|0):(tt=~(-Y/4294967296),4294967295^(ke=~(-Y%4294967296))?ke=ke+1|0:(ke=0,tt=tt+1|0)),Y>=18446744073709552e3||Y<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ue.realloc(10),function(je,Ve,ot){ot.buf[ot.pos++]=127&je|128,je>>>=7,ot.buf[ot.pos++]=127&je|128,je>>>=7,ot.buf[ot.pos++]=127&je|128,je>>>=7,ot.buf[ot.pos++]=127&je|128,ot.buf[ot.pos]=127&(je>>>=7)}(ke,0,ue),function(je,Ve){var ot=(7&je)<<4;Ve.buf[Ve.pos++]|=ot|((je>>>=3)?128:0),je&&(Ve.buf[Ve.pos++]=127&je|((je>>>=7)?128:0),je&&(Ve.buf[Ve.pos++]=127&je|((je>>>=7)?128:0),je&&(Ve.buf[Ve.pos++]=127&je|((je>>>=7)?128:0),je&&(Ve.buf[Ve.pos++]=127&je|((je>>>=7)?128:0),je&&(Ve.buf[Ve.pos++]=127&je)))))}(tt,ue)}(U,this):(this.realloc(4),this.buf[this.pos++]=127&U|(U>127?128:0),U<=127||(this.buf[this.pos++]=127&(U>>>=7)|(U>127?128:0),U<=127||(this.buf[this.pos++]=127&(U>>>=7)|(U>127?128:0),U<=127||(this.buf[this.pos++]=U>>>7&127))))},writeSVarint:function(U){this.writeVarint(U<0?2*-U-1:2*U)},writeBoolean:function(U){this.writeVarint(!!U)},writeString:function(U){U=String(U),this.realloc(4*U.length),this.pos++;var Y=this.pos;this.pos=function(ke,tt,je){for(var Ve,ot,nt=0;nt<tt.length;nt++){if((Ve=tt.charCodeAt(nt))>55295&&Ve<57344){if(!ot){Ve>56319||nt+1===tt.length?(ke[je++]=239,ke[je++]=191,ke[je++]=189):ot=Ve;continue}if(Ve<56320){ke[je++]=239,ke[je++]=191,ke[je++]=189,ot=Ve;continue}Ve=ot-55296<<10|Ve-56320|65536,ot=null}else ot&&(ke[je++]=239,ke[je++]=191,ke[je++]=189,ot=null);Ve<128?ke[je++]=Ve:(Ve<2048?ke[je++]=Ve>>6|192:(Ve<65536?ke[je++]=Ve>>12|224:(ke[je++]=Ve>>18|240,ke[je++]=Ve>>12&63|128),ke[je++]=Ve>>6&63|128),ke[je++]=63&Ve|128)}return je}(this.buf,U,this.pos);var ue=this.pos-Y;ue>=128&&x(Y,ue,this),this.pos=Y-1,this.writeVarint(ue),this.pos+=ue},writeFloat:function(U){this.realloc(4),a.write(this.buf,U,this.pos,!0,23,4),this.pos+=4},writeDouble:function(U){this.realloc(8),a.write(this.buf,U,this.pos,!0,52,8),this.pos+=8},writeBytes:function(U){var Y=U.length;this.writeVarint(Y),this.realloc(Y);for(var ue=0;ue<Y;ue++)this.buf[this.pos++]=U[ue]},writeRawMessage:function(U,Y){this.pos++;var ue=this.pos;U(Y,this);var ke=this.pos-ue;ke>=128&&x(ue,ke,this),this.pos=ue-1,this.writeVarint(ke),this.pos+=ke},writeMessage:function(U,Y,ue){this.writeTag(U,t.Bytes),this.writeRawMessage(Y,ue)},writePackedVarint:function(U,Y){Y.length&&this.writeMessage(U,T,Y)},writePackedSVarint:function(U,Y){Y.length&&this.writeMessage(U,E,Y)},writePackedBoolean:function(U,Y){Y.length&&this.writeMessage(U,j,Y)},writePackedFloat:function(U,Y){Y.length&&this.writeMessage(U,D,Y)},writePackedDouble:function(U,Y){Y.length&&this.writeMessage(U,I,Y)},writePackedFixed32:function(U,Y){Y.length&&this.writeMessage(U,N,Y)},writePackedSFixed32:function(U,Y){Y.length&&this.writeMessage(U,Z,Y)},writePackedFixed64:function(U,Y){Y.length&&this.writeMessage(U,H,Y)},writePackedSFixed64:function(U,Y){Y.length&&this.writeMessage(U,W,Y)},writeBytesField:function(U,Y){this.writeTag(U,t.Bytes),this.writeBytes(Y)},writeFixed32Field:function(U,Y){this.writeTag(U,t.Fixed32),this.writeFixed32(Y)},writeSFixed32Field:function(U,Y){this.writeTag(U,t.Fixed32),this.writeSFixed32(Y)},writeFixed64Field:function(U,Y){this.writeTag(U,t.Fixed64),this.writeFixed64(Y)},writeSFixed64Field:function(U,Y){this.writeTag(U,t.Fixed64),this.writeSFixed64(Y)},writeVarintField:function(U,Y){this.writeTag(U,t.Varint),this.writeVarint(Y)},writeSVarintField:function(U,Y){this.writeTag(U,t.Varint),this.writeSVarint(Y)},writeStringField:function(U,Y){this.writeTag(U,t.Bytes),this.writeString(Y)},writeFloatField:function(U,Y){this.writeTag(U,t.Fixed32),this.writeFloat(Y)},writeDoubleField:function(U,Y){this.writeTag(U,t.Fixed64),this.writeDouble(Y)},writeBooleanField:function(U,Y){this.writeVarintField(U,!!Y)}},Ia}var Zu=ce(Rf());const Gu=3;function Vl(a,t,n){a===1&&n.readMessage(Df,t)}function Df(a,t,n){if(a===3){const{id:o,bitmap:f,width:g,height:_,left:x,top:T,advance:E}=n.readMessage(Nc,{});t.push({id:o,bitmap:new qo({width:g+2*Gu,height:_+2*Gu},f),metrics:{width:g,height:_,left:x,top:T,advance:E}})}}function Nc(a,t,n){a===1?t.id=n.readVarint():a===2?t.bitmap=n.readBytes():a===3?t.width=n.readVarint():a===4?t.height=n.readVarint():a===5?t.left=n.readSVarint():a===6?t.top=n.readSVarint():a===7&&(t.advance=n.readVarint())}const Vh=Gu;function If(a){let t=0,n=0;for(const _ of a)t+=_.w*_.h,n=Math.max(n,_.w);a.sort((_,x)=>x.h-_.h);const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let f=0,g=0;for(const _ of a)for(let x=o.length-1;x>=0;x--){const T=o[x];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,g=Math.max(g,_.y+_.h),f=Math.max(f,_.x+_.w),_.w===T.w&&_.h===T.h){const E=o.pop();x<o.length&&(o[x]=E)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(o.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:f,h:g,fill:t/(f*g)||0}}const $n=1;class Uc{constructor(t,{pixelRatio:n,version:o,stretchX:f,stretchY:g,content:_,textFitWidth:x,textFitHeight:T}){this.paddedRect=t,this.pixelRatio=n,this.stretchX=f,this.stretchY=g,this.content=_,this.version=o,this.textFitWidth=x,this.textFitHeight=T}get tl(){return[this.paddedRect.x+$n,this.paddedRect.y+$n]}get br(){return[this.paddedRect.x+this.paddedRect.w-$n,this.paddedRect.y+this.paddedRect.h-$n]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*$n)/this.pixelRatio,(this.paddedRect.h-2*$n)/this.pixelRatio]}}class kf{constructor(t,n){const o={},f={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,o,g),this.addImages(n,f,g);const{w:_,h:x}=If(g),T=new ta({width:_||1,height:x||1});for(const E in t){const D=t[E],I=o[E].paddedRect;ta.copy(D.data,T,{x:0,y:0},{x:I.x+$n,y:I.y+$n},D.data)}for(const E in n){const D=n[E],I=f[E].paddedRect,j=I.x+$n,N=I.y+$n,Z=D.data.width,H=D.data.height;ta.copy(D.data,T,{x:0,y:0},{x:j,y:N},D.data),ta.copy(D.data,T,{x:0,y:H-1},{x:j,y:N-1},{width:Z,height:1}),ta.copy(D.data,T,{x:0,y:0},{x:j,y:N+H},{width:Z,height:1}),ta.copy(D.data,T,{x:Z-1,y:0},{x:j-1,y:N},{width:1,height:H}),ta.copy(D.data,T,{x:0,y:0},{x:j+Z,y:N},{width:1,height:H})}this.image=T,this.iconPositions=o,this.patternPositions=f}addImages(t,n,o){for(const f in t){const g=t[f],_={x:0,y:0,w:g.data.width+2*$n,h:g.data.height+2*$n};o.push(_),n[f]=new Uc(_,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,n){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in t.updatedImages)this.patchUpdatedImage(this.iconPositions[o],t.getImage(o),n),this.patchUpdatedImage(this.patternPositions[o],t.getImage(o),n)}patchUpdatedImage(t,n,o){if(!t||!n||t.version===n.version)return;t.version=n.version;const[f,g]=t.tl;o.update(n.data,void 0,{x:f,y:g})}}var cn;bt("ImagePosition",Uc),bt("ImageAtlas",kf),z.ag=void 0,(cn=z.ag||(z.ag={}))[cn.none=0]="none",cn[cn.horizontal=1]="horizontal",cn[cn.vertical=2]="vertical",cn[cn.horizontalOnly=3]="horizontalOnly";const Zh=-17;class En{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,n,o){const f=new En;return f.scale=t||1,f.fontStack=n,f.verticalAlign=o||"bottom",f}static forImage(t,n){const o=new En;return o.imageName=t,o.verticalAlign=n||"bottom",o}}class Vc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,n){const o=new Vc;for(let f=0;f<t.sections.length;f++){const g=t.sections[f];g.image?o.addImageSection(g):o.addTextSection(g,n)}return o}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let n="";for(let o=0;o<t.length;o++){const f=t.charCodeAt(o+1)||null,g=t.charCodeAt(o-1)||null;n+=f&&zu(f)&&!Os[t[o+1]]||g&&zu(g)&&!Os[t[o-1]]||!Os[t[o]]?t[o]:Os[t[o]]}return n}(this.text)}trim(){let t=0;for(let o=0;o<this.text.length&&Gh[this.text.charCodeAt(o)];o++)t++;let n=this.text.length;for(let o=this.text.length-1;o>=0&&o>=t&&Gh[this.text.charCodeAt(o)];o--)n--;this.text=this.text.substring(t,n),this.sectionIndex=this.sectionIndex.slice(t,n)}substring(t,n){const o=new Vc;return o.text=this.text.substring(t,n),o.sectionIndex=this.sectionIndex.slice(t,n),o.sections=this.sections,o}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,n)=>Math.max(t,this.sections[n].scale),0)}getMaxImageSize(t){let n=0,o=0;for(let f=0;f<this.length();f++){const g=this.getSection(f);if(g.imageName){const _=t[g.imageName];if(!_)continue;const x=_.displaySize;n=Math.max(n,x[0]),o=Math.max(o,x[1])}}return{maxImageWidth:n,maxImageHeight:o}}addTextSection(t,n){this.text+=t.text,this.sections.push(En.forText(t.scale,t.fontStack||n,t.verticalAlign));const o=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(o)}addImageSection(t){const n=t.image?t.image.name:"";if(n.length===0)return void Ai("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push(En.forImage(n,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Ai("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $u(a,t,n,o,f,g,_,x,T,E,D,I,j,N,Z){const H=Vc.fromFeature(a,f);let W;I===z.ag.vertical&&H.verticalizePunctuation();const{processBidirectionalText:re,processStyledBidirectionalText:_e}=Xa;if(re&&H.sections.length===1){W=[];const Y=re(H.toString(),Bf(H,E,g,t,o,N));for(const ue of Y){const ke=new Vc;ke.text=ue,ke.sections=H.sections;for(let tt=0;tt<ue.length;tt++)ke.sectionIndex.push(0);W.push(ke)}}else if(_e){W=[];const Y=_e(H.text,H.sectionIndex,Bf(H,E,g,t,o,N));for(const ue of Y){const ke=new Vc;ke.text=ue[0],ke.sectionIndex=ue[1],ke.sections=H.sections,W.push(ke)}}else W=function(Y,ue){const ke=[],tt=Y.text;let je=0;for(const Ve of ue)ke.push(Y.substring(je,Ve)),je=Ve;return je<tt.length&&ke.push(Y.substring(je,tt.length)),ke}(H,Bf(H,E,g,t,o,N));const le=[],U={positionedLines:le,text:H.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:I,iconsInText:!1,verticalizable:!1};return function(Y,ue,ke,tt,je,Ve,ot,nt,ct,He,Ct,Ut){let jt=0,Pt=0,fi=0,cr=0;const Or=nt==="right"?1:nt==="left"?0:.5,vr=yr/Ut;let hn=0;for(const Ni of je){Ni.trim();const rr=Ni.getMaxScale(),An={positionedGlyphs:[],lineOffset:0};Y.positionedLines[hn]=An;const fn=An.positionedGlyphs;let dn=0;if(!Ni.length()){Pt+=Ve,++hn;continue}const is=jd(tt,Ni,vr);for(let In=0;In<Ni.length();In++){const qr=Ni.getSection(In),pn=Ni.getSectionIndex(In),jr=Ni.getCharCode(In),xr=Om(ct,Ct,jr);let $i;if(qr.imageName){if(Y.iconsInText=!0,qr.scale=qr.scale*vr,$i=Zp(qr,xr,rr,is,tt),!$i)continue;dn=Math.max(dn,$i.imageOffset)}else if($i=Fm(qr,jr,xr,is,ue,ke),!$i)continue;const{rect:va,metrics:Yl,baselineOffset:La}=$i;fn.push({glyph:jr,imageName:qr.imageName,x:jt,y:Pt+La+Zh,vertical:xr,scale:qr.scale,fontStack:qr.fontStack,sectionIndex:pn,metrics:Yl,rect:va}),xr?(Y.verticalizable=!0,jt+=(qr.imageName?Yl.advance:yr)*qr.scale+He):jt+=Yl.advance*qr.scale+He}fn.length!==0&&(fi=Math.max(jt-He,fi),Gp(fn,0,fn.length-1,Or)),jt=0,An.lineOffset=Math.max(dn,(rr-1)*yr);const rn=Ve*rr+dn;Pt+=rn,cr=Math.max(rn,cr),++hn}const{horizontalAlign:$r,verticalAlign:Fr}=qh(ot);(function(Ni,rr,An,fn,dn,is,rn,In,qr){const pn=(rr-An)*dn;let jr=0;jr=is!==rn?-In*fn-Zh:-fn*qr*rn+.5*rn;for(const xr of Ni)for(const $i of xr.positionedGlyphs)$i.x+=pn,$i.y+=jr})(Y.positionedLines,Or,$r,Fr,fi,cr,Ve,Pt,je.length),Y.top+=-Fr*Pt,Y.bottom=Y.top+Pt,Y.left+=-$r*fi,Y.right=Y.left+fi}(U,t,n,o,W,_,x,T,I,E,j,Z),!function(Y){for(const ue of Y)if(ue.positionedGlyphs.length!==0)return!1;return!0}(le)&&U}const Gh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Bm={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},el={40:!0};function $h(a,t,n,o,f,g){if(t.imageName){const _=o[t.imageName];return _?_.displaySize[0]*t.scale*yr/g+f:0}{const _=n[t.fontStack],x=_&&_[a];return x?x.metrics.advance*t.scale+f:0}}function Lf(a,t,n,o){const f=Math.pow(a-t,2);return o?a<t?f/2:2*f:f+Math.abs(n)*n}function qu(a,t,n){let o=0;return a===10&&(o-=1e4),n&&(o+=150),a!==40&&a!==65288||(o+=50),t!==41&&t!==65289||(o+=50),o}function Od(a,t,n,o,f,g){let _=null,x=Lf(t,n,f,g);for(const T of o){const E=Lf(t-T.x,n,f,g)+T.badness;E<=x&&(_=T,x=E)}return{index:a,x:t,priorBreak:_,badness:x}}function Fd(a){return a?Fd(a.priorBreak).concat(a.index):[]}function Bf(a,t,n,o,f,g){if(!a)return[];const _=[],x=function(I,j,N,Z,H,W){let re=0;for(let _e=0;_e<I.length();_e++){const le=I.getSection(_e);re+=$h(I.getCharCode(_e),le,Z,H,j,W)}return re/Math.max(1,Math.ceil(re/N))}(a,t,n,o,f,g),T=a.text.indexOf("​")>=0;let E=0;for(let I=0;I<a.length();I++){const j=a.getSection(I),N=a.getCharCode(I);if(Gh[N]||(E+=$h(N,j,o,f,t,g)),I<a.length()-1){const Z=!((D=N)<11904)&&(!!Gt["CJK Compatibility Forms"](D)||!!Gt["CJK Compatibility"](D)||!!Gt["CJK Strokes"](D)||!!Gt["CJK Symbols and Punctuation"](D)||!!Gt["Enclosed CJK Letters and Months"](D)||!!Gt["Halfwidth and Fullwidth Forms"](D)||!!Gt["Ideographic Description Characters"](D)||!!Gt["Vertical Forms"](D)||ao.test(String.fromCodePoint(D)));(Bm[N]||Z||j.imageName||I!==a.length()-2&&el[a.getCharCode(I+1)])&&_.push(Od(I+1,E,x,_,qu(N,a.getCharCode(I+1),Z&&T),!1))}}var D;return Fd(Od(a.length(),E,x,_,0,!0))}function qh(a){let t=.5,n=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function jd(a,t,n){const o=t.getMaxScale()*yr,{maxImageWidth:f,maxImageHeight:g}=t.getMaxImageSize(a),_=Math.max(o,g*n);return{verticalLineContentWidth:Math.max(o,f*n),horizontalLineContentHeight:_}}function Vp(a){switch(a){case"top":return 0;case"center":return .5;default:return 1}}function Om(a,t,n){return!(a===z.ag.horizontal||!t&&!Th(n)||t&&(Gh[n]||(o=n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function Fm(a,t,n,o,f,g){const _=g[a.fontStack],x=function(E,D,I,j){if(E&&E.rect)return E;const N=D[I.fontStack],Z=N&&N[j];return Z?{rect:null,metrics:Z.metrics}:null}(_&&_[t],f,a,t);if(x===null)return null;let T;if(n)T=o.verticalLineContentWidth-a.scale*yr;else{const E=Vp(a.verticalAlign);T=(o.horizontalLineContentHeight-a.scale*yr)*E}return{rect:x.rect,metrics:x.metrics,baselineOffset:T}}function Zp(a,t,n,o,f){const g=f[a.imageName];if(!g)return null;const _=g.paddedRect,x=g.displaySize,T={width:x[0],height:x[1],left:$n,top:-3,advance:t?x[1]:x[0]};let E;if(t)E=o.verticalLineContentWidth-x[1]*a.scale;else{const D=Vp(a.verticalAlign);E=(o.horizontalLineContentHeight-x[1]*a.scale)*D}return{rect:_,metrics:T,baselineOffset:E,imageOffset:(t?x[0]:x[1])*a.scale-yr*n}}function Gp(a,t,n,o){if(o===0)return;const f=a[n],g=(a[n].x+f.metrics.advance*f.scale)*o;for(let _=t;_<=n;_++)a[_].x-=g}function Hu(a,t,n){const{horizontalAlign:o,verticalAlign:f}=qh(n),g=t[0]-a.displaySize[0]*o,_=t[1]-a.displaySize[1]*f;return{image:a,top:_,bottom:_+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function Hh(a){var t,n;let o=a.left,f=a.top,g=a.right-o,_=a.bottom-f;const x=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",T=(n=a.image.textFitHeight)!==null&&n!==void 0?n:"stretchOrShrink",E=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(T==="proportional"){if(x==="stretchOnly"&&g/_<E||x==="proportional"){const D=Math.ceil(_*E);o*=D/g,g=D}}else if(x==="proportional"&&T==="stretchOnly"&&E!==0&&g/_>E){const D=Math.ceil(g/E);f*=D/_,_=D}return{x1:o,y1:f,x2:o+g,y2:f+_}}function Nd(a,t,n,o,f,g){const _=a.image;let x;if(_.content){const W=_.content,re=_.pixelRatio||1;x=[W[0]/re,W[1]/re,_.displaySize[0]-W[2]/re,_.displaySize[1]-W[3]/re]}const T=t.left*g,E=t.right*g;let D,I,j,N;n==="width"||n==="both"?(N=f[0]+T-o[3],I=f[0]+E+o[1]):(N=f[0]+(T+E-_.displaySize[0])/2,I=N+_.displaySize[0]);const Z=t.top*g,H=t.bottom*g;return n==="height"||n==="both"?(D=f[1]+Z-o[0],j=f[1]+H+o[2]):(D=f[1]+(Z+H-_.displaySize[1])/2,j=D+_.displaySize[1]),{image:_,top:D,right:I,bottom:j,left:N,collisionPadding:x}}const Xu=255,vo=128,tl=Xu*vo;function Zc(a,t){const{expression:n}=t;if(n.kind==="constant")return{kind:"constant",layoutSize:n.evaluate(new Ki(a+1))};if(n.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:f}=n;let g=0;for(;g<o.length&&o[g]<=a;)g++;g=Math.max(0,g-1);let _=g;for(;_<o.length&&o[_]<a+1;)_++;_=Math.min(o.length-1,_);const x=o[g],T=o[_];return n.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:T,interpolationType:f}:{kind:"camera",minZoom:x,maxZoom:T,minSize:n.evaluate(new Ki(x)),maxSize:n.evaluate(new Ki(T)),interpolationType:f}}}function Of(a,t,n){let o="never";const f=a.get(t);return f?o=f:a.get(n)&&(o="always"),o}const ir=Fl.VectorTileFeature.types,Ud=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ff(a,t,n,o,f,g,_,x,T,E,D,I,j){const N=x?Math.min(tl,Math.round(x[0])):0,Z=x?Math.min(tl,Math.round(x[1])):0;a.emplaceBack(t,n,Math.round(32*o),Math.round(32*f),g,_,(N<<1)+(T?1:0),Z,16*E,16*D,256*I,256*j)}function jf(a,t,n){a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n),a.emplaceBack(t.x,t.y,n)}function jm(a){for(const t of a.sections)if(Ru(t.text))return!0;return!1}class Vd{constructor(t){this.layoutVertexArray=new Ie,this.indexArray=new mt,this.programConfigurations=t,this.segments=new Ot,this.dynamicLayoutVertexArray=new Be,this.opacityVertexArray=new $e,this.hasVisibleVertices=!1,this.placedSymbolArray=new M}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,n,o,f){this.isEmpty()||(o&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Jo.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Vu.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Ud,!0),this.opacityVertexBuffer.itemSize=1),(o||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}bt("SymbolBuffers",Vd);class Zd{constructor(t,n,o){this.layoutVertexArray=new t,this.layoutAttributes=n,this.indexArray=new o,this.segments=new Ot,this.collisionVertexArray=new Ze}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Ld.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}bt("CollisionBuffers",Zd);class il{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Zc(this.zoom,n["text-size"]),this.iconSizeData=Zc(this.zoom,n["icon-size"]);const o=this.layers[0].layout,f=o.get("symbol-sort-key"),g=o.get("symbol-z-order");this.canOverlap=Of(o,"text-overlap","text-allow-overlap")!=="never"||Of(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!f.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map(_=>z.ag[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new Vd(new $o(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Vd(new $o(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new O,this.lineVertexArray=new F,this.symbolInstances=new k,this.textAnchorOffsets=new q}calculateGlyphDependencies(t,n,o,f,g){for(let _=0;_<t.length;_++)if(n[t.charCodeAt(_)]=!0,(o||f)&&g){const x=Os[t.charAt(_)];x&&(n[x.charCodeAt(0)]=!0)}}populate(t,n,o){const f=this.layers[0],g=f.layout,_=g.get("text-font"),x=g.get("text-field"),T=g.get("icon-image"),E=(x.value.kind!=="constant"||x.value.value instanceof Mr&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),D=T.value.kind!=="constant"||!!T.value.value||Object.keys(T.parameters).length>0,I=g.get("symbol-sort-key");if(this.features=[],!E&&!D)return;const j=n.iconDependencies,N=n.glyphDependencies,Z=n.availableImages,H=new Ki(this.zoom);for(const{feature:W,id:re,index:_e,sourceLayerIndex:le}of t){const U=f._featureFilter.needGeometry,Y=ea(W,U);if(!f._featureFilter.filter(H,Y,o))continue;let ue,ke;if(U||(Y.geometry=ho(W)),E){const je=f.getValueAndResolveTokens("text-field",Y,o,Z),Ve=Mr.factory(je),ot=this.hasRTLText=this.hasRTLText||jm(Ve);(!ot||Xa.getRTLTextPluginStatus()==="unavailable"||ot&&Xa.isParsed())&&(ue=Ul(Ve,f,Y))}if(D){const je=f.getValueAndResolveTokens("icon-image",Y,o,Z);ke=je instanceof On?je:On.fromString(je)}if(!ue&&!ke)continue;const tt=this.sortFeaturesByKey?I.evaluate(Y,{},o):void 0;if(this.features.push({id:re,text:ue,icon:ke,index:_e,sourceLayerIndex:le,geometry:Y.geometry,properties:W.properties,type:ir[W.type],sortKey:tt}),ke&&(j[ke.name]=!0),ue){const je=_.evaluate(Y,{},o).join(","),Ve=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(z.ag.vertical)>=0;for(const ot of ue.sections)if(ot.image)j[ot.image.name]=!0;else{const nt=Sl(ue.toString()),ct=ot.fontStack||je,He=N[ct]=N[ct]||{};this.calculateGlyphDependencies(ot.text,He,Ve,this.allowVerticalPlacement,nt)}}}g.get("symbol-placement")==="line"&&(this.features=function(W){const re={},_e={},le=[];let U=0;function Y(je){le.push(W[je]),U++}function ue(je,Ve,ot){const nt=_e[je];return delete _e[je],_e[Ve]=nt,le[nt].geometry[0].pop(),le[nt].geometry[0]=le[nt].geometry[0].concat(ot[0]),nt}function ke(je,Ve,ot){const nt=re[Ve];return delete re[Ve],re[je]=nt,le[nt].geometry[0].shift(),le[nt].geometry[0]=ot[0].concat(le[nt].geometry[0]),nt}function tt(je,Ve,ot){const nt=ot?Ve[0][Ve[0].length-1]:Ve[0][0];return`${je}:${nt.x}:${nt.y}`}for(let je=0;je<W.length;je++){const Ve=W[je],ot=Ve.geometry,nt=Ve.text?Ve.text.toString():null;if(!nt){Y(je);continue}const ct=tt(nt,ot),He=tt(nt,ot,!0);if(ct in _e&&He in re&&_e[ct]!==re[He]){const Ct=ke(ct,He,ot),Ut=ue(ct,He,le[Ct].geometry);delete re[ct],delete _e[He],_e[tt(nt,le[Ut].geometry,!0)]=Ut,le[Ct].geometry=null}else ct in _e?ue(ct,He,ot):He in re?ke(ct,He,ot):(Y(je),re[ct]=U-1,_e[He]=U-1)}return le.filter(je=>je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((W,re)=>W.sortKey-re.sortKey)}update(t,n,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,n,this.layers,o),this.icon.programConfigurations.updatePaintArrays(t,n,this.layers,o))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,n){const o=this.lineVertexArray.length;if(t.segment!==void 0){let f=t.dist(n[t.segment+1]),g=t.dist(n[t.segment]);const _={};for(let x=t.segment+1;x<n.length;x++)_[x]={x:n[x].x,y:n[x].y,tileUnitDistanceFromAnchor:f},x<n.length-1&&(f+=n[x+1].dist(n[x]));for(let x=t.segment||0;x>=0;x--)_[x]={x:n[x].x,y:n[x].y,tileUnitDistanceFromAnchor:g},x>0&&(g+=n[x-1].dist(n[x]));for(let x=0;x<n.length;x++){const T=_[x];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(t,n,o,f,g,_,x,T,E,D,I,j){const N=t.indexArray,Z=t.layoutVertexArray,H=t.segments.prepareSegment(4*n.length,Z,N,this.canOverlap?_.sortKey:void 0),W=this.glyphOffsetArray.length,re=H.vertexLength,_e=this.allowVerticalPlacement&&x===z.ag.vertical?Math.PI/2:0,le=_.text&&_.text.sections;for(let U=0;U<n.length;U++){const{tl:Y,tr:ue,bl:ke,br:tt,tex:je,pixelOffsetTL:Ve,pixelOffsetBR:ot,minFontScaleX:nt,minFontScaleY:ct,glyphOffset:He,isSDF:Ct,sectionIndex:Ut}=n[U],jt=H.vertexLength,Pt=He[1];Ff(Z,T.x,T.y,Y.x,Pt+Y.y,je.x,je.y,o,Ct,Ve.x,Ve.y,nt,ct),Ff(Z,T.x,T.y,ue.x,Pt+ue.y,je.x+je.w,je.y,o,Ct,ot.x,Ve.y,nt,ct),Ff(Z,T.x,T.y,ke.x,Pt+ke.y,je.x,je.y+je.h,o,Ct,Ve.x,ot.y,nt,ct),Ff(Z,T.x,T.y,tt.x,Pt+tt.y,je.x+je.w,je.y+je.h,o,Ct,ot.x,ot.y,nt,ct),jf(t.dynamicLayoutVertexArray,T,_e),N.emplaceBack(jt,jt+2,jt+1),N.emplaceBack(jt+1,jt+2,jt+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(He[0]),U!==n.length-1&&Ut===n[U+1].sectionIndex||t.programConfigurations.populatePaintArrays(Z.length,_,_.index,{},j,le&&le[Ut])}t.placedSymbolArray.emplaceBack(T.x,T.y,W,this.glyphOffsetArray.length-W,re,E,D,T.segment,o?o[0]:0,o?o[1]:0,f[0],f[1],x,0,!1,0,I)}_addCollisionDebugVertex(t,n,o,f,g,_){return n.emplaceBack(0,0),t.emplaceBack(o.x,o.y,f,g,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,n,o,f,g,_,x){const T=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),E=T.vertexLength,D=g.layoutVertexArray,I=g.collisionVertexArray,j=x.anchorX,N=x.anchorY;this._addCollisionDebugVertex(D,I,_,j,N,new we(t,n)),this._addCollisionDebugVertex(D,I,_,j,N,new we(o,n)),this._addCollisionDebugVertex(D,I,_,j,N,new we(o,f)),this._addCollisionDebugVertex(D,I,_,j,N,new we(t,f)),T.vertexLength+=4;const Z=g.indexArray;Z.emplaceBack(E,E+1),Z.emplaceBack(E+1,E+2),Z.emplaceBack(E+2,E+3),Z.emplaceBack(E+3,E),T.primitiveLength+=4}addDebugCollisionBoxes(t,n,o,f){for(let g=t;g<n;g++){const _=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,f?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Zd(qe,yo.members,ft),this.iconCollisionBox=new Zd(qe,yo.members,ft);for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.addDebugCollisionBoxes(n.textBoxStartIndex,n.textBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n,!0),this.addDebugCollisionBoxes(n.iconBoxStartIndex,n.iconBoxEndIndex,n,!1),this.addDebugCollisionBoxes(n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex,n,!1)}}_deserializeCollisionBoxesForSymbol(t,n,o,f,g,_,x,T,E){const D={};for(let I=n;I<o;I++){const j=t.get(I);D.textBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},D.textFeatureIndex=j.featureIndex;break}for(let I=f;I<g;I++){const j=t.get(I);D.verticalTextBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},D.verticalTextFeatureIndex=j.featureIndex;break}for(let I=_;I<x;I++){const j=t.get(I);D.iconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},D.iconFeatureIndex=j.featureIndex;break}for(let I=T;I<E;I++){const j=t.get(I);D.verticalIconBox={x1:j.x1,y1:j.y1,x2:j.x2,y2:j.y2,anchorPointX:j.anchorPointX,anchorPointY:j.anchorPointY},D.verticalIconFeatureIndex=j.featureIndex;break}return D}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,n){const o=t.placedSymbolArray.get(n),f=o.vertexStartIndex+4*o.numGlyphs;for(let g=o.vertexStartIndex;g<f;g+=4)t.indexArray.emplaceBack(g,g+2,g+1),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const n=Math.sin(t),o=Math.cos(t),f=[],g=[],_=[];for(let x=0;x<this.symbolInstances.length;++x){_.push(x);const T=this.symbolInstances.get(x);f.push(0|Math.round(n*T.anchorX+o*T.anchorY)),g.push(T.featureIndex)}return _.sort((x,T)=>f[x]-f[T]||g[T]-g[x]),_}addToSortKeyRanges(t,n){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===n?o.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const o=this.symbolInstances.get(n);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach((f,g,_)=>{f>=0&&_.indexOf(f)===g&&this.addIndicesForPlacedSymbol(this.text,f)}),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Gc,Nf;bt("SymbolBucket",il,{omit:["layers","collisionBoxArray","features","compareText"]}),il.MAX_GLYPHS=65535,il.addDynamicAttributes=jf;var Yu={get paint(){return Nf=Nf||new Pn({"icon-opacity":new Ft(L.paint_symbol["icon-opacity"]),"icon-color":new Ft(L.paint_symbol["icon-color"]),"icon-halo-color":new Ft(L.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ft(L.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ft(L.paint_symbol["icon-halo-blur"]),"icon-translate":new It(L.paint_symbol["icon-translate"]),"icon-translate-anchor":new It(L.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ft(L.paint_symbol["text-opacity"]),"text-color":new Ft(L.paint_symbol["text-color"],{runtimeType:li,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Ft(L.paint_symbol["text-halo-color"]),"text-halo-width":new Ft(L.paint_symbol["text-halo-width"]),"text-halo-blur":new Ft(L.paint_symbol["text-halo-blur"]),"text-translate":new It(L.paint_symbol["text-translate"]),"text-translate-anchor":new It(L.paint_symbol["text-translate-anchor"])})},get layout(){return Gc=Gc||new Pn({"symbol-placement":new It(L.layout_symbol["symbol-placement"]),"symbol-spacing":new It(L.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new It(L.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ft(L.layout_symbol["symbol-sort-key"]),"symbol-z-order":new It(L.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new It(L.layout_symbol["icon-allow-overlap"]),"icon-overlap":new It(L.layout_symbol["icon-overlap"]),"icon-ignore-placement":new It(L.layout_symbol["icon-ignore-placement"]),"icon-optional":new It(L.layout_symbol["icon-optional"]),"icon-rotation-alignment":new It(L.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ft(L.layout_symbol["icon-size"]),"icon-text-fit":new It(L.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new It(L.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ft(L.layout_symbol["icon-image"]),"icon-rotate":new Ft(L.layout_symbol["icon-rotate"]),"icon-padding":new Ft(L.layout_symbol["icon-padding"]),"icon-keep-upright":new It(L.layout_symbol["icon-keep-upright"]),"icon-offset":new Ft(L.layout_symbol["icon-offset"]),"icon-anchor":new Ft(L.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new It(L.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new It(L.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new It(L.layout_symbol["text-rotation-alignment"]),"text-field":new Ft(L.layout_symbol["text-field"]),"text-font":new Ft(L.layout_symbol["text-font"]),"text-size":new Ft(L.layout_symbol["text-size"]),"text-max-width":new Ft(L.layout_symbol["text-max-width"]),"text-line-height":new It(L.layout_symbol["text-line-height"]),"text-letter-spacing":new Ft(L.layout_symbol["text-letter-spacing"]),"text-justify":new Ft(L.layout_symbol["text-justify"]),"text-radial-offset":new Ft(L.layout_symbol["text-radial-offset"]),"text-variable-anchor":new It(L.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ft(L.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ft(L.layout_symbol["text-anchor"]),"text-max-angle":new It(L.layout_symbol["text-max-angle"]),"text-writing-mode":new It(L.layout_symbol["text-writing-mode"]),"text-rotate":new Ft(L.layout_symbol["text-rotate"]),"text-padding":new It(L.layout_symbol["text-padding"]),"text-keep-upright":new It(L.layout_symbol["text-keep-upright"]),"text-transform":new Ft(L.layout_symbol["text-transform"]),"text-offset":new Ft(L.layout_symbol["text-offset"]),"text-allow-overlap":new It(L.layout_symbol["text-allow-overlap"]),"text-overlap":new It(L.layout_symbol["text-overlap"]),"text-ignore-placement":new It(L.layout_symbol["text-ignore-placement"]),"text-optional":new It(L.layout_symbol["text-optional"])})}};class Uf{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Ht,this.defaultValue=t}evaluate(t){if(t.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(t.formattedSection))return n.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bt("FormatSectionOverride",Uf,{omit:["defaultValue"]});class xo extends Ya{constructor(t){super(t,Yu)}recalculate(t,n){if(super.recalculate(t,n),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const f=[];for(const g of o)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,n,o,f){const g=this.layout.get(t).evaluate(n,{},o,f),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||_c(_.value)||!g?g:function(x,T){return T.replace(/{([^{}]+)}/g,(E,D)=>x&&D in x?String(x[D]):"")}(n.properties,g)}createBucket(t){return new il(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Yu.paint.overridableProperties){if(!xo.hasPaintOverride(this.layout,t))continue;const n=this.paint.get(t),o=new Uf(n),f=new hs(o,n.property.specification);let g=null;g=n.value.kind==="constant"||n.value.kind==="source"?new Ps("source",f):new xu("composite",f,n.value.zoomStops),this.paint._values[t]=new ln(n.property,g,n.parameters)}}_handleOverridablePaintPropertyUpdate(t,n,o){return!(!this.layout||n.isDataDriven()||o.isDataDriven())&&xo.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,n){const o=t.get("text-field"),f=Yu.paint.properties[n];let g=!1;const _=x=>{for(const T of x)if(f.overrides&&f.overrides.hasOverride(T))return void(g=!0)};if(o.value.kind==="constant"&&o.value.value instanceof Mr)_(o.value.value.sections);else if(o.value.kind==="source"){const x=E=>{g||(E instanceof bn&&Cr(E.value)===Tr?_(E.value.sections):E instanceof Es?_(E.sections):E.eachChild(x))},T=o.value;T._styleExpression&&x(T._styleExpression.expression)}return g}}let Fs;var Xh={get paint(){return Fs=Fs||new Pn({"background-color":new It(L.paint_background["background-color"]),"background-pattern":new sr(L.paint_background["background-pattern"]),"background-opacity":new It(L.paint_background["background-opacity"])})}};class Nm extends Ya{constructor(t){super(t,Xh)}}let Gd;var $p={get paint(){return Gd=Gd||new Pn({"raster-opacity":new It(L.paint_raster["raster-opacity"]),"raster-hue-rotate":new It(L.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new It(L.paint_raster["raster-brightness-min"]),"raster-brightness-max":new It(L.paint_raster["raster-brightness-max"]),"raster-saturation":new It(L.paint_raster["raster-saturation"]),"raster-contrast":new It(L.paint_raster["raster-contrast"]),"raster-resampling":new It(L.paint_raster["raster-resampling"]),"raster-fade-duration":new It(L.paint_raster["raster-fade-duration"])})}};class qp extends Ya{constructor(t){super(t,$p)}}class Um extends Ya{constructor(t){super(t,{}),this.onAdd=n=>{this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)},this.onRemove=n=>{this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class $d{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Hp={once:!0},Vf=63710088e-1;class Zl{constructor(t,n){if(isNaN(t)||isNaN(n))throw new Error(`Invalid LngLat object: (${t}, ${n})`);if(this.lng=+t,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Zl(wt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const n=Math.PI/180,o=this.lat*n,f=t.lat*n,g=Math.sin(o)*Math.sin(f)+Math.cos(o)*Math.cos(f)*Math.cos((t.lng-this.lng)*n);return Vf*Math.acos(Math.min(g,1))}static convert(t){if(t instanceof Zl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Zl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Zl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Zf=2*Math.PI*Vf;function Gf(a){return Zf*Math.cos(a*Math.PI/180)}function Xp(a){return(180+a)/360}function Yp(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Ku(a,t){return a/Gf(t)}function qd(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Hd(a,t){return a*Gf(qd(t))}class gi{constructor(t,n,o=0){this.x=+t,this.y=+n,this.z=+o}static fromLngLat(t,n=0){const o=Zl.convert(t);return new gi(Xp(o.lng),Yp(o.lat),Ku(n,o.lat))}toLngLat(){return new Zl(360*this.x-180,qd(this.y))}toAltitude(){return Hd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Zf*(t=qd(this.y),1/Math.cos(t*Math.PI/180));var t}}function $f(a,t,n){var o=2*Math.PI*6378137/256/Math.pow(2,n);return[a*o-2*Math.PI*6378137/2,t*o-2*Math.PI*6378137/2]}class Wu{constructor(t,n,o){if(!function(f,g,_){return!(f<0||f>25||_<0||_>=Math.pow(2,f)||g<0||g>=Math.pow(2,f))}(t,n,o))throw new Error(`x=${n}, y=${o}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=n,this.y=o,this.key=Gl(0,t,t,n,o)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,n,o){const f=(_=this.y,x=this.z,T=$f(256*(g=this.x),256*(_=Math.pow(2,x)-_-1),x),E=$f(256*(g+1),256*(_+1),x),T[0]+","+T[1]+","+E[0]+","+E[1]);var g,_,x,T,E;const D=function(I,j,N){let Z,H="";for(let W=I;W>0;W--)Z=1<<W-1,H+=(j&Z?1:0)+(N&Z?2:0);return H}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,n>1?"@2x":"").replace(/{quadkey}/g,D).replace(/{bbox-epsg-3857}/g,f)}isChildOf(t){const n=this.z-t.z;return n>0&&t.x===this.x>>n&&t.y===this.y>>n}getTilePoint(t){const n=Math.pow(2,this.z);return new we((t.x*n-this.x)*Je,(t.y*n-this.y)*Je)}toString(){return`${this.z}/${this.x}/${this.y}`}}class qf{constructor(t,n){this.wrap=t,this.canonical=n,this.key=Gl(t,n.z,n.z,n.x,n.y)}}class ka{constructor(t,n,o,f,g){if(this.terrainRttPosMatrix32f=null,t<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${o}`);this.overscaledZ=t,this.wrap=n,this.canonical=new Wu(o,+f,+g),this.key=Gl(n,t,o,f,g)}clone(){return new ka(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const n=this.canonical.z-t;return t>this.canonical.z?new ka(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ka(t,this.wrap,t,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(t,n){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?Gl(this.wrap*+n,t,this.canonical.z,this.canonical.x,this.canonical.y):Gl(this.wrap*+n,t,t,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const n=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>n&&t.canonical.y===this.canonical.y>>n}children(t){if(this.overscaledZ>=t)return[new ka(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,o=2*this.canonical.x,f=2*this.canonical.y;return[new ka(n,this.wrap,n,o,f),new ka(n,this.wrap,n,o+1,f),new ka(n,this.wrap,n,o,f+1),new ka(n,this.wrap,n,o+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ka(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ka(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new qf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new gi(t.x-this.wrap,t.y))}}function Gl(a,t,n,o,f){(a*=2)<0&&(a=-1*a-1);const g=1<<n;return(g*g*a+g*f+o).toString(36)+n.toString(36)+t.toString(36)}bt("CanonicalTileID",Wu),bt("OverscaledTileID",ka,{omit:["terrainRttPosMatrix32f"]});class Qu{constructor(t,n,o,f=1,g=1,_=1,x=0){if(this.uid=t,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void Ai(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=n.height;const T=this.dim=n.height-2;switch(this.data=new Uint32Array(n.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=f,this.greenFactor=g,this.blueFactor=_,this.baseShift=x;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let E=0;E<T;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(T,E)]=this.data[this._idx(T-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,T)]=this.data[this._idx(E,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let E=0;E<T;E++)for(let D=0;D<T;D++){const I=this.get(E,D);I>this.max&&(this.max=I),I<this.min&&(this.min=I)}}get(t,n){const o=new Uint8Array(this.data.buffer),f=4*this._idx(t,n);return this.unpack(o[f],o[f+1],o[f+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,n){if(t<-1||t>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(t+1)}unpack(t,n,o){return t*this.redFactor+n*this.greenFactor+o*this.blueFactor-this.baseShift}getPixels(){return new ta({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,n,o){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=n*this.dim,g=n*this.dim+this.dim,_=o*this.dim,x=o*this.dim+this.dim;switch(n){case-1:f=g-1;break;case 1:g=f+1}switch(o){case-1:_=x-1;break;case 1:x=_+1}const T=-n*this.dim,E=-o*this.dim;for(let D=_;D<x;D++)for(let I=f;I<g;I++)this.data[this._idx(I,D)]=t.data[this._idx(I+T,D+E)]}}bt("DEMData",Qu);class Yh{constructor(t){this._stringToNumber={},this._numberToString=[];for(let n=0;n<t.length;n++){const o=t[n];this._stringToNumber[o]=n,this._numberToString[n]=o}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class $c{constructor(t,n,o,f,g){this.type="Feature",this._vectorTileFeature=t,t._z=n,t._x=o,t._y=f,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const n in this)n!=="_geometry"&&n!=="_vectorTileFeature"&&(t[n]=this[n]);return t}}class Xd{constructor(t,n){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ca(Je,16,0),this.grid3D=new Ca(Je,16,0),this.featureIndexArray=new ee,this.promoteId=n}insert(t,n,o,f,g,_){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,f,g);const T=_?this.grid3D:this.grid;for(let E=0;E<n.length;E++){const D=n[E],I=[1/0,1/0,-1/0,-1/0];for(let j=0;j<D.length;j++){const N=D[j];I[0]=Math.min(I[0],N.x),I[1]=Math.min(I[1],N.y),I[2]=Math.max(I[2],N.x),I[3]=Math.max(I[3],N.y)}I[0]<Je&&I[1]<Je&&I[2]>=0&&I[3]>=0&&T.insert(x,I[0],I[1],I[2],I[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fl.VectorTile(new Zu(this.rawTileData)).layers,this.sourceLayerCoder=new Yh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,n,o,f){this.loadVTLayers();const g=t.params,_=Je/t.tileSize/t.scale,x=Nn(g.filter),T=t.queryGeometry,E=t.queryPadding*_,D=Wp(T),I=this.grid.query(D.minX-E,D.minY-E,D.maxX+E,D.maxY+E),j=Wp(t.cameraQueryGeometry),N=this.grid3D.query(j.minX-E,j.minY-E,j.maxX+E,j.maxY+E,(W,re,_e,le)=>function(U,Y,ue,ke,tt){for(const Ve of U)if(Y<=Ve.x&&ue<=Ve.y&&ke>=Ve.x&&tt>=Ve.y)return!0;const je=[new we(Y,ue),new we(Y,tt),new we(ke,tt),new we(ke,ue)];if(U.length>2){for(const Ve of je)if(Al(U,Ve))return!0}for(let Ve=0;Ve<U.length-1;Ve++)if(vd(U[Ve],U[Ve+1],je))return!0;return!1}(t.cameraQueryGeometry,W-E,re-E,_e+E,le+E));for(const W of N)I.push(W);I.sort(Qp);const Z={};let H;for(let W=0;W<I.length;W++){const re=I[W];if(re===H)continue;H=re;const _e=this.featureIndexArray.get(re);let le=null;this.loadMatchingFeature(Z,_e.bucketIndex,_e.sourceLayerIndex,_e.featureIndex,x,g.layers,g.availableImages,n,o,f,(U,Y,ue)=>(le||(le=ho(U)),Y.queryIntersectsFeature({queryGeometry:T,feature:U,featureState:ue,geometry:le,zoom:this.z,transform:t.transform,pixelsToTileUnits:_,pixelPosMatrix:t.pixelPosMatrix})))}return Z}loadMatchingFeature(t,n,o,f,g,_,x,T,E,D,I){const j=this.bucketLayerIDs[n];if(_&&!j.some(W=>_.has(W)))return;const N=this.sourceLayerCoder.decode(o),Z=this.vtLayers[N].feature(f);if(g.needGeometry){const W=ea(Z,!0);if(!g.filter(new Ki(this.tileID.overscaledZ),W,this.tileID.canonical))return}else if(!g.filter(new Ki(this.tileID.overscaledZ),Z))return;const H=this.getId(Z,N);for(let W=0;W<j.length;W++){const re=j[W];if(_&&!_.has(re))continue;const _e=T[re];if(!_e)continue;let le={};H&&D&&(le=D.getState(_e.sourceLayer||"_geojsonTileLayer",H));const U=Xt({},E[re]);U.paint=Kp(U.paint,_e.paint,Z,le,x),U.layout=Kp(U.layout,_e.layout,Z,le,x);const Y=!I||I(Z,_e,le);if(!Y)continue;const ue=new $c(Z,this.z,this.x,this.y,H);ue.layer=U;let ke=t[re];ke===void 0&&(ke=t[re]=[]),ke.push({featureIndex:f,feature:ue,intersectionZ:Y})}}lookupSymbolFeatures(t,n,o,f,g,_,x,T){const E={};this.loadVTLayers();const D=Nn(g);for(const I of t)this.loadMatchingFeature(E,o,f,I,D,_,x,T,n);return E}hasLayer(t){for(const n of this.bucketLayerIDs)for(const o of n)if(t===o)return!0;return!1}getId(t,n){var o;let f=t.id;return this.promoteId&&(f=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[n]],typeof f=="boolean"&&(f=Number(f)),f===void 0&&(!((o=t.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(f=Number(t.properties.cluster_id))),f}}function Kp(a,t,n,o,f){return Xi(a,(g,_)=>{const x=t instanceof jo?t.get(_):null;return x&&x.evaluate?x.evaluate(n,o,f):x})}function Wp(a){let t=1/0,n=1/0,o=-1/0,f=-1/0;for(const g of a)t=Math.min(t,g.x),n=Math.min(n,g.y),o=Math.max(o,g.x),f=Math.max(f,g.y);return{minX:t,minY:n,maxX:o,maxY:f}}function Qp(a,t){return t-a}function Yd(a,t,n,o,f){const g=[];for(let _=0;_<a.length;_++){const x=a[_];let T;for(let E=0;E<x.length-1;E++){let D=x[E],I=x[E+1];D.x<t&&I.x<t||(D.x<t?D=new we(t,D.y+(t-D.x)/(I.x-D.x)*(I.y-D.y))._round():I.x<t&&(I=new we(t,D.y+(t-D.x)/(I.x-D.x)*(I.y-D.y))._round()),D.y<n&&I.y<n||(D.y<n?D=new we(D.x+(n-D.y)/(I.y-D.y)*(I.x-D.x),n)._round():I.y<n&&(I=new we(D.x+(n-D.y)/(I.y-D.y)*(I.x-D.x),n)._round()),D.x>=o&&I.x>=o||(D.x>=o?D=new we(o,D.y+(o-D.x)/(I.x-D.x)*(I.y-D.y))._round():I.x>=o&&(I=new we(o,D.y+(o-D.x)/(I.x-D.x)*(I.y-D.y))._round()),D.y>=f&&I.y>=f||(D.y>=f?D=new we(D.x+(f-D.y)/(I.y-D.y)*(I.x-D.x),f)._round():I.y>=f&&(I=new we(D.x+(f-D.y)/(I.y-D.y)*(I.x-D.x),f)._round()),T&&D.equals(T[T.length-1])||(T=[D],g.push(T)),T.push(I)))))}}return g}bt("FeatureIndex",Xd,{omit:["rawTileData","sourceLayerCoder"]});class js extends we{constructor(t,n,o,f){super(t,n),this.angle=o,f!==void 0&&(this.segment=f)}clone(){return new js(this.x,this.y,this.angle,this.segment)}}function Gi(a,t,n,o,f){if(t.segment===void 0||n===0)return!0;let g=t,_=t.segment+1,x=0;for(;x>-n/2;){if(_--,_<0)return!1;x-=a[_].dist(g),g=a[_]}x+=a[_].dist(a[_+1]),_++;const T=[];let E=0;for(;x<n/2;){const D=a[_],I=a[_+1];if(!I)return!1;let j=a[_-1].angleTo(D)-D.angleTo(I);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:x,angleDelta:j}),E+=j;x-T[0].distance>o;)E-=T.shift().angleDelta;if(E>f)return!1;_++,x+=D.dist(I)}return!0}function Hf(a){let t=0;for(let n=0;n<a.length-1;n++)t+=a[n].dist(a[n+1]);return t}function Dn(a,t,n){return a?.6*t*n:0}function Jp(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function Kd(a,t,n,o,f,g){const _=Dn(n,f,g),x=Jp(n,o)*g;let T=0;const E=Hf(a)/2;for(let D=0;D<a.length-1;D++){const I=a[D],j=a[D+1],N=I.dist(j);if(T+N>E){const Z=(E-T)/N,H=ua.number(I.x,j.x,Z),W=ua.number(I.y,j.y,Z),re=new js(H,W,j.angleTo(I),D);return re._round(),!_||Gi(a,re,x,_,t)?re:void 0}T+=N}}function Wd(a,t,n,o,f,g,_,x,T){const E=Dn(o,g,_),D=Jp(o,f),I=D*_,j=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return t-I<t/4&&(t=I+t/4),Kh(a,j?t/2*x%t:(D/2+2*g)*_*x%t,t,E,n,I,j,!1,T)}function Kh(a,t,n,o,f,g,_,x,T){const E=g/2,D=Hf(a);let I=0,j=t-n,N=[];for(let Z=0;Z<a.length-1;Z++){const H=a[Z],W=a[Z+1],re=H.dist(W),_e=W.angleTo(H);for(;j+n<I+re;){j+=n;const le=(j-I)/re,U=ua.number(H.x,W.x,le),Y=ua.number(H.y,W.y,le);if(U>=0&&U<T&&Y>=0&&Y<T&&j-E>=0&&j+E<=D){const ue=new js(U,Y,_e,Z);ue._round(),o&&!Gi(a,ue,g,o,f)||N.push(ue)}}I+=re}return x||N.length||_||(N=Kh(a,I/2,n,o,f,g,_,!0,T)),N}bt("Anchor",js);const Ju=$n;function Qd(a,t,n,o){const f=[],g=a.image,_=g.pixelRatio,x=g.paddedRect.w-2*Ju,T=g.paddedRect.h-2*Ju;let E={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const D=g.stretchX||[[0,x]],I=g.stretchY||[[0,T]],j=(He,Ct)=>He+Ct[1]-Ct[0],N=D.reduce(j,0),Z=I.reduce(j,0),H=x-N,W=T-Z;let re=0,_e=N,le=0,U=Z,Y=0,ue=H,ke=0,tt=W;if(g.content&&o){const He=g.content,Ct=He[2]-He[0],Ut=He[3]-He[1];(g.textFitWidth||g.textFitHeight)&&(E=Hh(a)),re=eh(D,0,He[0]),le=eh(I,0,He[1]),_e=eh(D,He[0],He[2]),U=eh(I,He[1],He[3]),Y=He[0]-re,ke=He[1]-le,ue=Ct-_e,tt=Ut-U}const je=E.x1,Ve=E.y1,ot=E.x2-je,nt=E.y2-Ve,ct=(He,Ct,Ut,jt)=>{const Pt=Yf(He.stretch-re,_e,ot,je),fi=Wh(He.fixed-Y,ue,He.stretch,N),cr=Yf(Ct.stretch-le,U,nt,Ve),Or=Wh(Ct.fixed-ke,tt,Ct.stretch,Z),vr=Yf(Ut.stretch-re,_e,ot,je),hn=Wh(Ut.fixed-Y,ue,Ut.stretch,N),$r=Yf(jt.stretch-le,U,nt,Ve),Fr=Wh(jt.fixed-ke,tt,jt.stretch,Z),Ni=new we(Pt,cr),rr=new we(vr,cr),An=new we(vr,$r),fn=new we(Pt,$r),dn=new we(fi/_,Or/_),is=new we(hn/_,Fr/_),rn=t*Math.PI/180;if(rn){const pn=Math.sin(rn),jr=Math.cos(rn),xr=[jr,-pn,pn,jr];Ni._matMult(xr),rr._matMult(xr),fn._matMult(xr),An._matMult(xr)}const In=He.stretch+He.fixed,qr=Ct.stretch+Ct.fixed;return{tl:Ni,tr:rr,bl:fn,br:An,tex:{x:g.paddedRect.x+Ju+In,y:g.paddedRect.y+Ju+qr,w:Ut.stretch+Ut.fixed-In,h:jt.stretch+jt.fixed-qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:dn,pixelOffsetBR:is,minFontScaleX:ue/_/ot,minFontScaleY:tt/_/nt,isSDF:n}};if(o&&(g.stretchX||g.stretchY)){const He=Xf(D,H,N),Ct=Xf(I,W,Z);for(let Ut=0;Ut<He.length-1;Ut++){const jt=He[Ut],Pt=He[Ut+1];for(let fi=0;fi<Ct.length-1;fi++)f.push(ct(jt,Ct[fi],Pt,Ct[fi+1]))}}else f.push(ct({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:T+1}));return f}function eh(a,t,n){let o=0;for(const f of a)o+=Math.max(t,Math.min(n,f[1]))-Math.max(t,Math.min(n,f[0]));return o}function Xf(a,t,n){const o=[{fixed:-1,stretch:0}];for(const[f,g]of a){const _=o[o.length-1];o.push({fixed:f-_.stretch,stretch:_.stretch}),o.push({fixed:f-_.stretch,stretch:_.stretch+(g-f)})}return o.push({fixed:t+Ju,stretch:n}),o}function Yf(a,t,n,o){return a/t*n+o}function Wh(a,t,n,o){return a-t*n/o}class Kf{constructor(t,n,o,f,g,_,x,T,E,D){var I;if(this.boxStartIndex=t.length,E){let j=_.top,N=_.bottom;const Z=_.collisionPadding;Z&&(j-=Z[1],N+=Z[3]);let H=N-j;H>0&&(H=Math.max(10,H),this.circleDiameter=H)}else{const j=!((I=_.image)===null||I===void 0)&&I.content&&(_.image.textFitWidth||_.image.textFitHeight)?Hh(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};j.y1=j.y1*x-T[0],j.y2=j.y2*x+T[2],j.x1=j.x1*x-T[3],j.x2=j.x2*x+T[1];const N=_.collisionPadding;if(N&&(j.x1-=N[0]*x,j.y1-=N[1]*x,j.x2+=N[2]*x,j.y2+=N[3]*x),D){const Z=new we(j.x1,j.y1),H=new we(j.x2,j.y1),W=new we(j.x1,j.y2),re=new we(j.x2,j.y2),_e=D*Math.PI/180;Z._rotate(_e),H._rotate(_e),W._rotate(_e),re._rotate(_e),j.x1=Math.min(Z.x,H.x,W.x,re.x),j.x2=Math.max(Z.x,H.x,W.x,re.x),j.y1=Math.min(Z.y,H.y,W.y,re.y),j.y2=Math.max(Z.y,H.y,W.y,re.y)}t.emplaceBack(n.x,n.y,j.x1,j.y1,j.x2,j.y2,o,f,g)}this.boxEndIndex=t.length}}class em{constructor(t=[],n=(o,f)=>o<f?-1:o>f?1:0){if(this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:n,compare:o}=this,f=n[t];for(;t>0;){const g=t-1>>1,_=n[g];if(o(f,_)>=0)break;n[t]=_,t=g}n[t]=f}_down(t){const{data:n,compare:o}=this,f=this.length>>1,g=n[t];for(;t<f;){let _=1+(t<<1);const x=_+1;if(x<this.length&&o(n[x],n[_])<0&&(_=x),o(n[_],g)>=0)break;n[t]=n[_],t=_}n[t]=g}}function Vm(a,t=1,n=!1){let o=1/0,f=1/0,g=-1/0,_=-1/0;const x=a[0];for(let N=0;N<x.length;N++){const Z=x[N];(!N||Z.x<o)&&(o=Z.x),(!N||Z.y<f)&&(f=Z.y),(!N||Z.x>g)&&(g=Z.x),(!N||Z.y>_)&&(_=Z.y)}const T=Math.min(g-o,_-f);let E=T/2;const D=new em([],Zm);if(T===0)return new we(o,f);for(let N=o;N<g;N+=T)for(let Z=f;Z<_;Z+=T)D.push(new $l(N+E,Z+E,E,a));let I=function(N){let Z=0,H=0,W=0;const re=N[0];for(let _e=0,le=re.length,U=le-1;_e<le;U=_e++){const Y=re[_e],ue=re[U],ke=Y.x*ue.y-ue.x*Y.y;H+=(Y.x+ue.x)*ke,W+=(Y.y+ue.y)*ke,Z+=3*ke}return new $l(H/Z,W/Z,0,N)}(a),j=D.length;for(;D.length;){const N=D.pop();(N.d>I.d||!I.d)&&(I=N,n&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,j)),N.max-I.d<=t||(E=N.h/2,D.push(new $l(N.p.x-E,N.p.y-E,E,a)),D.push(new $l(N.p.x+E,N.p.y-E,E,a)),D.push(new $l(N.p.x-E,N.p.y+E,E,a)),D.push(new $l(N.p.x+E,N.p.y+E,E,a)),j+=4)}return n&&(console.log(`num probes: ${j}`),console.log(`best distance: ${I.d}`)),I.p}function Zm(a,t){return t.max-a.max}function $l(a,t,n,o){this.p=new we(a,t),this.h=n,this.d=function(f,g){let _=!1,x=1/0;for(let T=0;T<g.length;T++){const E=g[T];for(let D=0,I=E.length,j=I-1;D<I;j=D++){const N=E[D],Z=E[j];N.y>f.y!=Z.y>f.y&&f.x<(Z.x-N.x)*(f.y-N.y)/(Z.y-N.y)+N.x&&(_=!_),x=Math.min(x,yd(f,N,Z))}}return(_?1:-1)*Math.sqrt(x)}(this.p,o),this.max=this.d+this.h*Math.SQRT2}var un;z.ax=void 0,(un=z.ax||(z.ax={}))[un.center=1]="center",un[un.left=2]="left",un[un.right=3]="right",un[un.top=4]="top",un[un.bottom=5]="bottom",un[un["top-left"]=6]="top-left",un[un["top-right"]=7]="top-right",un[un["bottom-left"]=8]="bottom-left",un[un["bottom-right"]=9]="bottom-right";const ql=7,Jd=Number.POSITIVE_INFINITY;function ys(a,t){return t[1]!==Jd?function(n,o,f){let g=0,_=0;switch(o=Math.abs(o),f=Math.abs(f),n){case"top-right":case"top-left":case"top":_=f-ql;break;case"bottom-right":case"bottom-left":case"bottom":_=-f+ql}switch(n){case"top-right":case"bottom-right":case"right":g=-o;break;case"top-left":case"bottom-left":case"left":g=o}return[g,_]}(a,t[0],t[1]):function(n,o){let f=0,g=0;o<0&&(o=0);const _=o/Math.SQRT2;switch(n){case"top-right":case"top-left":g=_-ql;break;case"bottom-right":case"bottom-left":g=-_+ql;break;case"bottom":g=-o+ql;break;case"top":g=o-ql}switch(n){case"top-right":case"bottom-right":f=-_;break;case"top-left":case"bottom-left":f=_;break;case"left":f=o;break;case"right":f=-o}return[f,g]}(a,t[0])}function ep(a,t,n){var o;const f=a.layout,g=(o=f.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(t,{},n);if(g){const x=g.values,T=[];for(let E=0;E<x.length;E+=2){const D=T[E]=x[E],I=x[E+1].map(j=>j*yr);D.startsWith("top")?I[1]-=ql:D.startsWith("bottom")&&(I[1]+=ql),T[E+1]=I}return new Nr(T)}const _=f.get("text-variable-anchor");if(_){let x;x=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[f.get("text-radial-offset").evaluate(t,{},n)*yr,Jd]:f.get("text-offset").evaluate(t,{},n).map(E=>E*yr);const T=[];for(const E of _)T.push(E,ys(E,x));return new Nr(T)}return null}function Wf(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vs(a,t,n,o,f,g,_,x,T,E,D,I){let j=g.textMaxSize.evaluate(t,{});j===void 0&&(j=_);const N=a.layers[0].layout,Z=N.get("icon-offset").evaluate(t,{},D),H=Qh(n.horizontal),W=_/24,re=a.tilePixelRatio*W,_e=a.tilePixelRatio*j/24,le=a.tilePixelRatio*x,U=a.tilePixelRatio*N.get("symbol-spacing"),Y=N.get("text-padding")*a.tilePixelRatio,ue=function(Ut,jt,Pt,fi=1){const cr=Ut.get("icon-padding").evaluate(jt,{},Pt),Or=cr&&cr.values;return[Or[0]*fi,Or[1]*fi,Or[2]*fi,Or[3]*fi]}(N,t,D,a.tilePixelRatio),ke=N.get("text-max-angle")/180*Math.PI,tt=N.get("text-rotation-alignment")!=="viewport"&&N.get("symbol-placement")!=="point",je=N.get("icon-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",Ve=N.get("symbol-placement"),ot=U/2,nt=N.get("icon-text-fit");let ct;o&&nt!=="none"&&(a.allowVerticalPlacement&&n.vertical&&(ct=Nd(o,n.vertical,nt,N.get("icon-text-fit-padding"),Z,W)),H&&(o=Nd(o,H,nt,N.get("icon-text-fit-padding"),Z,W)));const He=D?I.line.getGranularityForZoomLevel(D.z):1,Ct=(Ut,jt)=>{jt.x<0||jt.x>=Je||jt.y<0||jt.y>=Je||function(Pt,fi,cr,Or,vr,hn,$r,Fr,Ni,rr,An,fn,dn,is,rn,In,qr,pn,jr,xr,$i,va,Yl,La,rm){const th=Pt.addToLineVertexArray(fi,cr);let bo,i,s,c,p=0,b=0,C=0,V=0,K=-1,he=-1;const Te={};let Qe=er("");if(Pt.allowVerticalPlacement&&Or.vertical){const si=Fr.layout.get("text-rotate").evaluate($i,{},La)+90;s=new Kf(Ni,fi,rr,An,fn,Or.vertical,dn,is,rn,si),$r&&(c=new Kf(Ni,fi,rr,An,fn,$r,qr,pn,rn,si))}if(vr){const si=Fr.layout.get("icon-rotate").evaluate($i,{}),mn=Fr.layout.get("icon-text-fit")!=="none",qc=Qd(vr,si,Yl,mn),nl=$r?Qd($r,si,Yl,mn):void 0;i=new Kf(Ni,fi,rr,An,fn,vr,qr,pn,!1,si),p=4*qc.length;const rf=Pt.iconSizeData;let Kl=null;rf.kind==="source"?(Kl=[vo*Fr.layout.get("icon-size").evaluate($i,{})],Kl[0]>tl&&Ai(`${Pt.layerIds[0]}: Value for "icon-size" is >= ${Xu}. Reduce your "icon-size".`)):rf.kind==="composite"&&(Kl=[vo*va.compositeIconSizes[0].evaluate($i,{},La),vo*va.compositeIconSizes[1].evaluate($i,{},La)],(Kl[0]>tl||Kl[1]>tl)&&Ai(`${Pt.layerIds[0]}: Value for "icon-size" is >= ${Xu}. Reduce your "icon-size".`)),Pt.addSymbols(Pt.icon,qc,Kl,xr,jr,$i,z.ag.none,fi,th.lineStartIndex,th.lineLength,-1,La),K=Pt.icon.placedSymbolArray.length-1,nl&&(b=4*nl.length,Pt.addSymbols(Pt.icon,nl,Kl,xr,jr,$i,z.ag.vertical,fi,th.lineStartIndex,th.lineLength,-1,La),he=Pt.icon.placedSymbolArray.length-1)}const ht=Object.keys(Or.horizontal);for(const si of ht){const mn=Or.horizontal[si];if(!bo){Qe=er(mn.text);const nl=Fr.layout.get("text-rotate").evaluate($i,{},La);bo=new Kf(Ni,fi,rr,An,fn,mn,dn,is,rn,nl)}const qc=mn.positionedLines.length===1;if(C+=tp(Pt,fi,mn,hn,Fr,rn,$i,In,th,Or.vertical?z.ag.horizontal:z.ag.horizontalOnly,qc?ht:[si],Te,K,va,La),qc)break}Or.vertical&&(V+=tp(Pt,fi,Or.vertical,hn,Fr,rn,$i,In,th,z.ag.vertical,["vertical"],Te,he,va,La));const Ue=bo?bo.boxStartIndex:Pt.collisionBoxArray.length,Ye=bo?bo.boxEndIndex:Pt.collisionBoxArray.length,qt=s?s.boxStartIndex:Pt.collisionBoxArray.length,ui=s?s.boxEndIndex:Pt.collisionBoxArray.length,Hr=i?i.boxStartIndex:Pt.collisionBoxArray.length,De=i?i.boxEndIndex:Pt.collisionBoxArray.length,Me=c?c.boxStartIndex:Pt.collisionBoxArray.length,Fe=c?c.boxEndIndex:Pt.collisionBoxArray.length;let it=-1;const Bt=(si,mn)=>si&&si.circleDiameter?Math.max(si.circleDiameter,mn):mn;it=Bt(bo,it),it=Bt(s,it),it=Bt(i,it),it=Bt(c,it);const _i=it>-1?1:0;_i&&(it*=rm/yr),Pt.glyphOffsetArray.length>=il.MAX_GLYPHS&&Ai("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),$i.sortKey!==void 0&&Pt.addToSortKeyRanges(Pt.symbolInstances.length,$i.sortKey);const Kt=ep(Fr,$i,La),[ri,kn]=function(si,mn){const qc=si.length,nl=mn==null?void 0:mn.values;if((nl==null?void 0:nl.length)>0)for(let rf=0;rf<nl.length;rf+=2){const Kl=nl[rf+1];si.emplaceBack(z.ax[nl[rf]],Kl[0],Kl[1])}return[qc,si.length]}(Pt.textAnchorOffsets,Kt);Pt.symbolInstances.emplaceBack(fi.x,fi.y,Te.right>=0?Te.right:-1,Te.center>=0?Te.center:-1,Te.left>=0?Te.left:-1,Te.vertical||-1,K,he,Qe,Ue,Ye,qt,ui,Hr,De,Me,Fe,rr,C,V,p,b,_i,0,dn,it,ri,kn)}(a,jt,Ut,n,o,f,ct,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,re,[Y,Y,Y,Y],tt,T,le,ue,je,Z,t,g,E,D,_)};if(Ve==="line")for(const Ut of Yd(t.geometry,0,0,Je,Je)){const jt=Bl(Ut,He),Pt=Wd(jt,U,ke,n.vertical||H,o,24,_e,a.overscaling,Je);for(const fi of Pt)H&&rl(a,H.text,ot,fi)||Ct(jt,fi)}else if(Ve==="line-center"){for(const Ut of t.geometry)if(Ut.length>1){const jt=Bl(Ut,He),Pt=Kd(jt,ke,n.vertical||H,o,24,_e);Pt&&Ct(jt,Pt)}}else if(t.type==="Polygon")for(const Ut of lc(t.geometry,0)){const jt=Vm(Ut,16);Ct(Bl(Ut[0],He,!0),new js(jt.x,jt.y,0))}else if(t.type==="LineString")for(const Ut of t.geometry){const jt=Bl(Ut,He);Ct(jt,new js(jt[0].x,jt[0].y,0))}else if(t.type==="Point")for(const Ut of t.geometry)for(const jt of Ut)Ct([jt],new js(jt.x,jt.y,0))}function tp(a,t,n,o,f,g,_,x,T,E,D,I,j,N,Z){const H=function(_e,le,U,Y,ue,ke,tt,je){const Ve=Y.layout.get("text-rotate").evaluate(ke,{})*Math.PI/180,ot=[];for(const nt of le.positionedLines)for(const ct of nt.positionedGlyphs){if(!ct.rect)continue;const He=ct.rect||{};let Ct=Vh+1,Ut=!0,jt=1,Pt=0;const fi=(ue||je)&&ct.vertical,cr=ct.metrics.advance*ct.scale/2;if(je&&le.verticalizable&&(Pt=nt.lineOffset/2-(ct.imageName?-(yr-ct.metrics.width*ct.scale)/2:(ct.scale-1)*yr)),ct.imageName){const pn=tt[ct.imageName];Ut=pn.sdf,jt=pn.pixelRatio,Ct=$n/jt}const Or=ue?[ct.x+cr,ct.y]:[0,0];let vr=ue?[0,0]:[ct.x+cr+U[0],ct.y+U[1]-Pt],hn=[0,0];fi&&(hn=vr,vr=[0,0]);const $r=ct.metrics.isDoubleResolution?2:1,Fr=(ct.metrics.left-Ct)*ct.scale-cr+vr[0],Ni=(-ct.metrics.top-Ct)*ct.scale+vr[1],rr=Fr+He.w/$r*ct.scale/jt,An=Ni+He.h/$r*ct.scale/jt,fn=new we(Fr,Ni),dn=new we(rr,Ni),is=new we(Fr,An),rn=new we(rr,An);if(fi){const pn=new we(-cr,cr-Zh),jr=-Math.PI/2,xr=yr/2-cr,$i=new we(5-Zh-xr,-(ct.imageName?xr:0)),va=new we(...hn);fn._rotateAround(jr,pn)._add($i)._add(va),dn._rotateAround(jr,pn)._add($i)._add(va),is._rotateAround(jr,pn)._add($i)._add(va),rn._rotateAround(jr,pn)._add($i)._add(va)}if(Ve){const pn=Math.sin(Ve),jr=Math.cos(Ve),xr=[jr,-pn,pn,jr];fn._matMult(xr),dn._matMult(xr),is._matMult(xr),rn._matMult(xr)}const In=new we(0,0),qr=new we(0,0);ot.push({tl:fn,tr:dn,bl:is,br:rn,tex:He,writingMode:le.writingMode,glyphOffset:Or,sectionIndex:ct.sectionIndex,isSDF:Ut,pixelOffsetTL:In,pixelOffsetBR:qr,minFontScaleX:0,minFontScaleY:0})}return ot}(0,n,x,f,g,_,o,a.allowVerticalPlacement),W=a.textSizeData;let re=null;W.kind==="source"?(re=[vo*f.layout.get("text-size").evaluate(_,{})],re[0]>tl&&Ai(`${a.layerIds[0]}: Value for "text-size" is >= ${Xu}. Reduce your "text-size".`)):W.kind==="composite"&&(re=[vo*N.compositeTextSizes[0].evaluate(_,{},Z),vo*N.compositeTextSizes[1].evaluate(_,{},Z)],(re[0]>tl||re[1]>tl)&&Ai(`${a.layerIds[0]}: Value for "text-size" is >= ${Xu}. Reduce your "text-size".`)),a.addSymbols(a.text,H,re,x,g,_,E,t,T.lineStartIndex,T.lineLength,j,Z);for(const _e of D)I[_e]=a.text.placedSymbolArray.length-1;return 4*H.length}function Qh(a){for(const t in a)return a[t];return null}function rl(a,t,n,o){const f=a.compareText;if(t in f){const g=f[t];for(let _=g.length-1;_>=0;_--)if(o.dist(g[_])<n)return!0}else f[t]=[];return f[t].push(o),!1}const tm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ip{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,o]=new Uint8Array(t,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=o>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const g=tm[15&o];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[x]=new Uint32Array(t,4,1);return new ip(x,_,g,t)}constructor(t,n=64,o=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const g=tm.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,x=t*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-x%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${o}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+T,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+x+T),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+x+T,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=t)}add(t,n){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=n,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Hl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,n,o,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:x}=this,T=[0,g.length-1,0],E=[];for(;T.length;){const D=T.pop()||0,I=T.pop()||0,j=T.pop()||0;if(I-j<=x){for(let W=j;W<=I;W++){const re=_[2*W],_e=_[2*W+1];re>=t&&re<=o&&_e>=n&&_e<=f&&E.push(g[W])}continue}const N=j+I>>1,Z=_[2*N],H=_[2*N+1];Z>=t&&Z<=o&&H>=n&&H<=f&&E.push(g[N]),(D===0?t<=Z:n<=H)&&(T.push(j),T.push(N-1),T.push(1-D)),(D===0?o>=Z:f>=H)&&(T.push(N+1),T.push(I),T.push(1-D))}return E}within(t,n,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:_}=this,x=[0,f.length-1,0],T=[],E=o*o;for(;x.length;){const D=x.pop()||0,I=x.pop()||0,j=x.pop()||0;if(I-j<=_){for(let W=j;W<=I;W++)im(g[2*W],g[2*W+1],t,n)<=E&&T.push(f[W]);continue}const N=j+I>>1,Z=g[2*N],H=g[2*N+1];im(Z,H,t,n)<=E&&T.push(f[N]),(D===0?t-o<=Z:n-o<=H)&&(x.push(j),x.push(N-1),x.push(1-D)),(D===0?t+o>=Z:n+o>=H)&&(x.push(N+1),x.push(I),x.push(1-D))}return T}}function Hl(a,t,n,o,f,g){if(f-o<=n)return;const _=o+f>>1;rp(a,t,_,o,f,g),Hl(a,t,n,o,_-1,1-g),Hl(a,t,n,_+1,f,1-g)}function rp(a,t,n,o,f,g){for(;f>o;){if(f-o>600){const E=f-o+1,D=n-o+1,I=Math.log(E),j=.5*Math.exp(2*I/3),N=.5*Math.sqrt(I*j*(E-j)/E)*(D-E/2<0?-1:1);rp(a,t,n,Math.max(o,Math.floor(n-D*j/E+N)),Math.min(f,Math.floor(n+(E-D)*j/E+N)),g)}const _=t[2*n+g];let x=o,T=f;for(Jh(a,t,o,n),t[2*f+g]>_&&Jh(a,t,o,f);x<T;){for(Jh(a,t,x,T),x++,T--;t[2*x+g]<_;)x++;for(;t[2*T+g]>_;)T--}t[2*o+g]===_?Jh(a,t,o,T):(T++,Jh(a,t,T,f)),T<=n&&(o=T+1),n<=T&&(f=T-1)}}function Jh(a,t,n,o){np(a,n,o),np(t,2*n,2*o),np(t,2*n+1,2*o+1)}function np(a,t,n){const o=a[t];a[t]=a[n],a[n]=o}function im(a,t,n,o){const f=a-n,g=t-o;return f*f+g*g}var ap;z.cg=void 0,(ap=z.cg||(z.cg={})).create="create",ap.load="load",ap.fullLoad="fullLoad";let Qf=null,ef=[];const sp=1e3/60,Jf="loadTime",Xl="fullLoadTime",tf={mark(a){performance.mark(a)},frame(a){const t=a;Qf!=null&&ef.push(t-Qf),Qf=t},clearMetrics(){Qf=null,ef=[],performance.clearMeasures(Jf),performance.clearMeasures(Xl);for(const a in z.cg)performance.clearMarks(z.cg[a])},getPerformanceMetrics(){performance.measure(Jf,z.cg.create,z.cg.load),performance.measure(Xl,z.cg.create,z.cg.fullLoad);const a=performance.getEntriesByName(Jf)[0].duration,t=performance.getEntriesByName(Xl)[0].duration,n=ef.length,o=1/(ef.reduce((g,_)=>g+_,0)/n/1e3),f=ef.filter(g=>g>sp).reduce((g,_)=>g+(_-sp)/sp,0);return{loadTime:a,fullLoadTime:t,fps:o,percentDroppedFrames:f/(n+f)*100,totalFrames:n}}};z.$=gi,z.A=yt,z.B=ua,z.C=Ki,z.D=It,z.E=Ae,z.F=Cu,z.G=function(a){if(Ei==null){const t=a.navigator?a.navigator.userAgent:null;Ei=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ei},z.H=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new $d(()=>this.process()),this.subscription=Pr(this.target,"message",n=>this.receive(n),!1),this.globalScope=zr(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise((n,o)=>{const f=Math.round(1e18*Math.random()).toString(36).substring(0,10),g=t?Pr(t.signal,"abort",()=>{g==null||g.unsubscribe(),delete this.resolveRejects[f];const T={id:f,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},Hp):null;this.resolveRejects[f]={resolve:T=>{g==null||g.unsubscribe(),n(T)},reject:T=>{g==null||g.unsubscribe(),o(T)}};const _=[],x=Object.assign(Object.assign({},a),{id:f,sourceMapId:this.mapId,origin:location.origin,data:io(a.data,_)});this.target.postMessage(x,{transfer:_})})}receive(a){const t=a.data,n=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[n];const o=this.abortControllers[n];return delete this.abortControllers[n],void(o&&o.abort())}if(zr(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return u(this,void 0,void 0,function*(){if(t.type==="<response>"){const f=this.resolveRejects[a];return delete this.resolveRejects[a],f?void(t.error?f.reject(Sc(t.error)):f.resolve(Sc(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const n=Sc(t.data),o=new AbortController;this.abortControllers[a]=o;try{const f=yield this.messageHandlers[t.type](t.sourceMapId,n,o);this.completeTask(a,null,f)}catch(f){this.completeTask(a,f)}})}completeTask(a,t,n){const o=[];delete this.abortControllers[a];const f={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?io(t):null,data:io(n,o)};this.target.postMessage(f,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},z.I=Uc,z.J=Fa,z.K=function(){var a=new yt(16);return yt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},z.L=function(a,t,n){var o,f,g,_,x,T,E,D,I,j,N,Z,H=n[0],W=n[1],re=n[2];return t===a?(a[12]=t[0]*H+t[4]*W+t[8]*re+t[12],a[13]=t[1]*H+t[5]*W+t[9]*re+t[13],a[14]=t[2]*H+t[6]*W+t[10]*re+t[14],a[15]=t[3]*H+t[7]*W+t[11]*re+t[15]):(f=t[1],g=t[2],_=t[3],x=t[4],T=t[5],E=t[6],D=t[7],I=t[8],j=t[9],N=t[10],Z=t[11],a[0]=o=t[0],a[1]=f,a[2]=g,a[3]=_,a[4]=x,a[5]=T,a[6]=E,a[7]=D,a[8]=I,a[9]=j,a[10]=N,a[11]=Z,a[12]=o*H+x*W+I*re+t[12],a[13]=f*H+T*W+j*re+t[13],a[14]=g*H+E*W+N*re+t[14],a[15]=_*H+D*W+Z*re+t[15]),a},z.M=function(a,t,n){var o=n[0],f=n[1],g=n[2];return a[0]=t[0]*o,a[1]=t[1]*o,a[2]=t[2]*o,a[3]=t[3]*o,a[4]=t[4]*f,a[5]=t[5]*f,a[6]=t[6]*f,a[7]=t[7]*f,a[8]=t[8]*g,a[9]=t[9]*g,a[10]=t[10]*g,a[11]=t[11]*g,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},z.N=function(a,t,n){var o=t[0],f=t[1],g=t[2],_=t[3],x=t[4],T=t[5],E=t[6],D=t[7],I=t[8],j=t[9],N=t[10],Z=t[11],H=t[12],W=t[13],re=t[14],_e=t[15],le=n[0],U=n[1],Y=n[2],ue=n[3];return a[0]=le*o+U*x+Y*I+ue*H,a[1]=le*f+U*T+Y*j+ue*W,a[2]=le*g+U*E+Y*N+ue*re,a[3]=le*_+U*D+Y*Z+ue*_e,a[4]=(le=n[4])*o+(U=n[5])*x+(Y=n[6])*I+(ue=n[7])*H,a[5]=le*f+U*T+Y*j+ue*W,a[6]=le*g+U*E+Y*N+ue*re,a[7]=le*_+U*D+Y*Z+ue*_e,a[8]=(le=n[8])*o+(U=n[9])*x+(Y=n[10])*I+(ue=n[11])*H,a[9]=le*f+U*T+Y*j+ue*W,a[10]=le*g+U*E+Y*N+ue*re,a[11]=le*_+U*D+Y*Z+ue*_e,a[12]=(le=n[12])*o+(U=n[13])*x+(Y=n[14])*I+(ue=n[15])*H,a[13]=le*f+U*T+Y*j+ue*W,a[14]=le*g+U*E+Y*N+ue*re,a[15]=le*_+U*D+Y*Z+ue*_e,a},z.O=function(a,t){const n={};for(let o=0;o<t.length;o++){const f=t[o];f in a&&(n[f]=a[f])}return n},z.P=we,z.Q=Zl,z.R=ta,z.S=Yp,z.T=Ri,z.U=Xp,z.V=vt,z.W=at,z.X=Sr,z.Y=ka,z.Z=Je,z._=u,z.a=Yr,z.a$=function(){const a=new Float32Array(16);return lt(a),a},z.a0=Wu,z.a1=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const o of a){const f=window.document.createElement("source");fr(o)||(t.crossOrigin="Anonymous"),f.src=o,t.appendChild(f)}})},z.a2=Re,z.a3=function(){return Yt++},z.a4=v,z.a5=il,z.a6=Nn,z.a7=ea,z.a8=$c,z.a9=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,o,f,g)=>{const _=f||g;return t[o]=!_||_.toLowerCase(),""}),t["max-age"]){const n=parseInt(t["max-age"],10);isNaN(n)?delete t["max-age"]:t["max-age"]=n}return t},z.aA=qh,z.aB=ip,z.aC=pr,z.aD=Bh,z.aE=ie,z.aF=Ot,z.aG=mt,z.aH=function(a){return Math.pow(2,a)},z.aI=85.051129,z.aJ=Ku,z.aK=wt,z.aL=vn,z.aM=Hd,z.aN=function(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a[2]=t[2]*n,a},z.aO=function(a,t,n){return a[0]=t[0]+n[0],a[1]=t[1]+n[1],a[2]=t[2]+n[2],a},z.aP=function(a){var t=new yt(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},z.aQ=function(a,t,n){return a[0]=t[0]*n[0],a[1]=t[1]*n[1],a[2]=t[2]*n[2],a[3]=t[3]*n[3],a},z.aR=function(a,t,n){return a[0]=t[0]-n[0],a[1]=t[1]-n[1],a[2]=t[2]-n[2],a},z.aS=function(a,t){var n=t[0],o=t[1],f=t[2],g=n*n+o*o+f*f;return g>0&&(g=1/Math.sqrt(g)),a[0]=t[0]*g,a[1]=t[1]*g,a[2]=t[2]*g,a},z.aT=function(a,t,n){var o=t[0],f=t[1],g=t[2],_=n[0],x=n[1],T=n[2];return a[0]=f*T-g*x,a[1]=g*_-o*T,a[2]=o*x-f*_,a},z.aU=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},z.aV=qf,z.aW=Gl,z.aX=function(a,t,n,o,f){var g,_=1/Math.tan(t/2);return a[0]=_/n,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=_,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,f!=null&&f!==1/0?(a[10]=(f+o)*(g=1/(o-f)),a[14]=2*f*o*g):(a[10]=-1,a[14]=-2*o),a},z.aY=function(a){var t=new yt(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},z.aZ=function(a,t,n){var o=Math.sin(n),f=Math.cos(n),g=t[0],_=t[1],x=t[2],T=t[3],E=t[4],D=t[5],I=t[6],j=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=g*f+E*o,a[1]=_*f+D*o,a[2]=x*f+I*o,a[3]=T*f+j*o,a[4]=E*f-g*o,a[5]=D*f-_*o,a[6]=I*f-x*o,a[7]=j*f-T*o,a},z.a_=function(a,t,n){var o=Math.sin(n),f=Math.cos(n),g=t[4],_=t[5],x=t[6],T=t[7],E=t[8],D=t[9],I=t[10],j=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=g*f+E*o,a[5]=_*f+D*o,a[6]=x*f+I*o,a[7]=T*f+j*o,a[8]=E*f-g*o,a[9]=D*f-_*o,a[10]=I*f-x*o,a[11]=j*f-T*o,a},z.aa=function(a){return Math.log(a)/Math.LN2},z.ab=function(a){var t=a[0],n=a[1];return t*t+n*n},z.ac=function(a){return a*Math.PI/180},z.ad=Lt,z.ae=function(a,t){const n=[];for(const o in a)o in t||n.push(o);return n},z.af=function(a,t){let n=0,o=0;if(a.kind==="constant")o=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:f,minZoom:g,maxZoom:_}=a,x=f?Lt(Sn.interpolationFactor(f,t,g,_),0,1):0;a.kind==="camera"?o=ua.number(a.minSize,a.maxSize,x):n=x}return{uSizeT:n,uSize:o}},z.ah=function(a,{uSize:t,uSizeT:n},{lowerSize:o,upperSize:f}){return a.kind==="source"?o/vo:a.kind==="composite"?ua.number(o/vo,f/vo,n):t},z.ai=function(a,t){var n=t[0],o=t[1],f=t[2],g=t[3],_=t[4],x=t[5],T=t[6],E=t[7],D=t[8],I=t[9],j=t[10],N=t[11],Z=t[12],H=t[13],W=t[14],re=t[15],_e=n*x-o*_,le=n*T-f*_,U=n*E-g*_,Y=o*T-f*x,ue=o*E-g*x,ke=f*E-g*T,tt=D*H-I*Z,je=D*W-j*Z,Ve=D*re-N*Z,ot=I*W-j*H,nt=I*re-N*H,ct=j*re-N*W,He=_e*ct-le*nt+U*ot+Y*Ve-ue*je+ke*tt;return He?(a[0]=(x*ct-T*nt+E*ot)*(He=1/He),a[1]=(f*nt-o*ct-g*ot)*He,a[2]=(H*ke-W*ue+re*Y)*He,a[3]=(j*ue-I*ke-N*Y)*He,a[4]=(T*Ve-_*ct-E*je)*He,a[5]=(n*ct-f*Ve+g*je)*He,a[6]=(W*U-Z*ke-re*le)*He,a[7]=(D*ke-j*U+N*le)*He,a[8]=(_*nt-x*Ve+E*tt)*He,a[9]=(o*Ve-n*nt-g*tt)*He,a[10]=(Z*ue-H*U+re*_e)*He,a[11]=(I*U-D*ue-N*_e)*He,a[12]=(x*je-_*ot-T*tt)*He,a[13]=(n*ot-o*je+f*tt)*He,a[14]=(H*le-Z*Y-W*_e)*He,a[15]=(D*Y-I*le+j*_e)*He,a):null},z.aj=ei,z.ak=function(a){return Math.hypot(a[0],a[1])},z.al=function(a){return a[0]=0,a[1]=0,a},z.am=function(a,t,n){return a[0]=t[0]*n,a[1]=t[1]*n,a},z.an=jf,z.ao=Et,z.ap=function(a,t,n,o){const f=t.y-a.y,g=t.x-a.x,_=o.y-n.y,x=o.x-n.x,T=_*g-x*f;if(T===0)return null;const E=(x*(a.y-n.y)-_*(a.x-n.x))/T;return new we(a.x+E*g,a.y+E*f)},z.aq=Yd,z.ar=El,z.as=lt,z.at=function(a){let t=1/0,n=1/0,o=-1/0,f=-1/0;for(const g of a)t=Math.min(t,g.x),n=Math.min(n,g.y),o=Math.max(o,g.x),f=Math.max(f,g.y);return[t,n,o,f]},z.au=yr,z.av=Zt,z.aw=function(a,t,n,o,f=!1){if(!n[0]&&!n[1])return[0,0];const g=f?o==="map"?-a.bearingInRadians:0:o==="viewport"?a.bearingInRadians:0;if(g){const _=Math.sin(g),x=Math.cos(g);n=[n[0]*x-n[1]*_,n[0]*_+n[1]*x]}return[f?n[0]:Zt(t,n[0],a.zoom),f?n[1]:Zt(t,n[1],a.zoom)]},z.ay=Of,z.az=Wf,z.b=qn,z.b$=a=>a.type==="circle",z.b0=function(){const a=new Float64Array(16);return lt(a),a},z.b1=function(){return new Float64Array(16)},z.b2=function(a,t,n){const o=new Float64Array(4);return function(f,g,_,x){var T=.5*Math.PI/180;g*=T,_*=T,x*=T;var E=Math.sin(g),D=Math.cos(g),I=Math.sin(_),j=Math.cos(_),N=Math.sin(x),Z=Math.cos(x);f[0]=E*j*Z-D*I*N,f[1]=D*I*Z+E*j*N,f[2]=D*j*N-E*I*Z,f[3]=D*j*Z+E*I*N}(o,a,t-90,n),o},z.b3=function(a,t,n,o){var f,g,_,x,T,E=t[0],D=t[1],I=t[2],j=t[3],N=n[0],Z=n[1],H=n[2],W=n[3];return(g=E*N+D*Z+I*H+j*W)<0&&(g=-g,N=-N,Z=-Z,H=-H,W=-W),1-g>ut?(f=Math.acos(g),_=Math.sin(f),x=Math.sin((1-o)*f)/_,T=Math.sin(o*f)/_):(x=1-o,T=o),a[0]=x*E+T*N,a[1]=x*D+T*Z,a[2]=x*I+T*H,a[3]=x*j+T*W,a},z.b4=function(a){const t=new Float64Array(9);var n,o,f,g,_,x,T,E,D,I,j,N,Z,H,W,re,_e,le;I=(f=(o=a)[0])*(T=f+f),j=(g=o[1])*T,Z=(_=o[2])*T,H=_*(E=g+g),re=(x=o[3])*T,_e=x*E,le=x*(D=_+_),(n=t)[0]=1-(N=g*E)-(W=_*D),n[3]=j-le,n[6]=Z+_e,n[1]=j+le,n[4]=1-I-W,n[7]=H-re,n[2]=Z-_e,n[5]=H+re,n[8]=1-I-N;const U=vn(-Math.asin(Lt(t[2],-1,1)));let Y,ue;return Math.hypot(t[5],t[8])<.001?(Y=0,ue=-vn(Math.atan2(t[3],t[4]))):(Y=vn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ue=vn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Y,pitch:U+90,bearing:ue}},z.b5=function(a,t){return a.roll==t.roll&&a.pitch==t.pitch&&a.bearing==t.bearing},z.b6=pi,z.b7=uo,z.b8=_r,z.b9=Gn,z.bA=function(a){const t=[],n=a.id;return n===void 0&&t.push({message:`layers.${n}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${n}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),t},z.bB=function a(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let o=0;o<t.length;o++)if(!a(t[o],n[o]))return!1;return!0}if(typeof t=="object"&&t!==null&&n!==null){if(typeof n!="object"||Object.keys(t).length!==Object.keys(n).length)return!1;for(const o in t)if(!a(t[o],n[o]))return!1;return!0}return t===n},z.bC=Xi,z.bD=hi,z.bE=class extends ga{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},z.bF=ms,z.bG=class extends ga{constructor(a,t){super(a,t),this.current=_a}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},z.bH=Wa,z.bI=class extends ga{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},z.bJ=class extends ga{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},z.bK=xt,z.bL=function(a,t){var n=Math.sin(t),o=Math.cos(t);return a[0]=o,a[1]=n,a[2]=0,a[3]=-n,a[4]=o,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},z.bM=function(a,t,n){var o=t[0],f=t[1],g=t[2];return a[0]=o*n[0]+f*n[3]+g*n[6],a[1]=o*n[1]+f*n[4]+g*n[7],a[2]=o*n[2]+f*n[5]+g*n[8],a},z.bN=function(a,t,n,o,f,g,_){var x=1/(t-n),T=1/(o-f),E=1/(g-_);return a[0]=-2*x,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*E,a[11]=0,a[12]=(t+n)*x,a[13]=(f+o)*T,a[14]=(_+g)*E,a[15]=1,a},z.bO=class extends Ec{},z.bP=Gr,z.bQ=class extends Ac{},z.bR=Rn,z.bS=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},z.bT=Rl,z.bU=function(a,t,n){var o=t[0],f=t[1],g=t[2],_=n[3]*o+n[7]*f+n[11]*g+n[15];return a[0]=(n[0]*o+n[4]*f+n[8]*g+n[12])/(_=_||1),a[1]=(n[1]*o+n[5]*f+n[9]*g+n[13])/_,a[2]=(n[2]*o+n[6]*f+n[10]*g+n[14])/_,a},z.bV=class extends Uo{},z.bW=class extends l{},z.bX=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},z.bY=function(a,t){var n=a[0],o=a[1],f=a[2],g=a[3],_=a[4],x=a[5],T=a[6],E=a[7],D=a[8],I=a[9],j=a[10],N=a[11],Z=a[12],H=a[13],W=a[14],re=a[15],_e=t[0],le=t[1],U=t[2],Y=t[3],ue=t[4],ke=t[5],tt=t[6],je=t[7],Ve=t[8],ot=t[9],nt=t[10],ct=t[11],He=t[12],Ct=t[13],Ut=t[14],jt=t[15];return Math.abs(n-_e)<=ut*Math.max(1,Math.abs(n),Math.abs(_e))&&Math.abs(o-le)<=ut*Math.max(1,Math.abs(o),Math.abs(le))&&Math.abs(f-U)<=ut*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(g-Y)<=ut*Math.max(1,Math.abs(g),Math.abs(Y))&&Math.abs(_-ue)<=ut*Math.max(1,Math.abs(_),Math.abs(ue))&&Math.abs(x-ke)<=ut*Math.max(1,Math.abs(x),Math.abs(ke))&&Math.abs(T-tt)<=ut*Math.max(1,Math.abs(T),Math.abs(tt))&&Math.abs(E-je)<=ut*Math.max(1,Math.abs(E),Math.abs(je))&&Math.abs(D-Ve)<=ut*Math.max(1,Math.abs(D),Math.abs(Ve))&&Math.abs(I-ot)<=ut*Math.max(1,Math.abs(I),Math.abs(ot))&&Math.abs(j-nt)<=ut*Math.max(1,Math.abs(j),Math.abs(nt))&&Math.abs(N-ct)<=ut*Math.max(1,Math.abs(N),Math.abs(ct))&&Math.abs(Z-He)<=ut*Math.max(1,Math.abs(Z),Math.abs(He))&&Math.abs(H-Ct)<=ut*Math.max(1,Math.abs(H),Math.abs(Ct))&&Math.abs(W-Ut)<=ut*Math.max(1,Math.abs(W),Math.abs(Ut))&&Math.abs(re-jt)<=ut*Math.max(1,Math.abs(re),Math.abs(jt))},z.bZ=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},z.b_=a=>a.type==="symbol",z.ba=kc,z.bb=Wt,z.bc=ve,z.bd=Hn,z.be=function(a,t,n,o,f){return Wt(o,f,Lt((a-t)/(n-t),0,1))},z.bf=kt,z.bg=function(){return new Float64Array(4)},z.bh=function(){return new Float64Array(3)},z.bi=function(a,t,n,o){var f=[],g=[];return f[0]=t[0]-n[0],f[1]=t[1]-n[1],f[2]=t[2]-n[2],g[0]=f[0]*Math.cos(o)-f[1]*Math.sin(o),g[1]=f[0]*Math.sin(o)+f[1]*Math.cos(o),g[2]=f[2],a[0]=g[0]+n[0],a[1]=g[1]+n[1],a[2]=g[2]+n[2],a},z.bj=function(a,t,n,o){var f=[],g=[];return f[0]=t[0]-n[0],f[1]=t[1]-n[1],f[2]=t[2]-n[2],g[0]=f[0],g[1]=f[1]*Math.cos(o)-f[2]*Math.sin(o),g[2]=f[1]*Math.sin(o)+f[2]*Math.cos(o),a[0]=g[0]+n[0],a[1]=g[1]+n[1],a[2]=g[2]+n[2],a},z.bk=function(a,t,n,o){var f=[],g=[];return f[0]=t[0]-n[0],f[1]=t[1]-n[1],f[2]=t[2]-n[2],g[0]=f[2]*Math.sin(o)+f[0]*Math.cos(o),g[1]=f[1],g[2]=f[2]*Math.cos(o)-f[0]*Math.sin(o),a[0]=g[0]+n[0],a[1]=g[1]+n[1],a[2]=g[2]+n[2],a},z.bl=function(a,t,n){var o=Math.sin(n),f=Math.cos(n),g=t[0],_=t[1],x=t[2],T=t[3],E=t[8],D=t[9],I=t[10],j=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=g*f-E*o,a[1]=_*f-D*o,a[2]=x*f-I*o,a[3]=T*f-j*o,a[8]=g*o+E*f,a[9]=_*o+D*f,a[10]=x*o+I*f,a[11]=T*o+j*f,a},z.bm=function(a,t){const n=kt(a,360),o=kt(t,360),f=o-n,g=o>n?f-360:f+360;return Math.abs(f)<Math.abs(g)?f:g},z.bn=function(a){return a[0]=0,a[1]=0,a[2]=0,a},z.bo=function(a,t,n,o){const f=Math.sqrt(a*a+t*t),g=Math.sqrt(n*n+o*o);a/=f,t/=f,n/=g,o/=g;const _=Math.acos(a*n+t*o);return-t*n+a*o>0?_:-_},z.bp=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]},z.bq=Vf,z.br=function(a,t){const n=kt(a,2*Math.PI),o=kt(t,2*Math.PI);return Math.min(Math.abs(n-o),Math.abs(n-o+2*Math.PI),Math.abs(n-o-2*Math.PI))},z.bs=function(a){return Math.hypot(a[0],a[1],a[2])},z.bt=function(){const a={},t=L.$version;for(const n in L.$root){const o=L.$root[n];if(o.required){let f=null;f=n==="version"?t:o.type==="array"?[]:{},f!=null&&(a[n]=f)}}return a},z.bu=Eu,z.bv=Oi,z.bw=function(a){a=a.slice();const t=Object.create(null);for(let n=0;n<a.length;n++)t[a[n].id]=a[n];for(let n=0;n<a.length;n++)"ref"in a[n]&&(a[n]=J(a[n],t[a[n].ref]));return a},z.bx=function(a){if(a.type==="custom")return new Um(a);switch(a.type){case"background":return new Nm(a);case"circle":return new Pp(a);case"fill":return new Wo(a);case"fill-extrusion":return new Dd(a);case"heatmap":return new Mf(a);case"hillshade":return new bd(a);case"line":return new lr(a);case"raster":return new qp(a);case"symbol":return new xo(a)}},z.by=vi,z.bz=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let n=[];try{if(!ne(a.version,t.version))return[{command:"setStyle",args:[t]}];ne(a.center,t.center)||n.push({command:"setCenter",args:[t.center]}),ne(a.centerAltitude,t.centerAltitude)||n.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ne(a.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),ne(a.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),ne(a.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),ne(a.roll,t.roll)||n.push({command:"setRoll",args:[t.roll]}),ne(a.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),ne(a.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),ne(a.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),ne(a.light,t.light)||n.push({command:"setLight",args:[t.light]}),ne(a.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),ne(a.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),ne(a.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const o={},f=[];(function(_,x,T,E){let D;for(D in x=x||{},_=_||{})Object.prototype.hasOwnProperty.call(_,D)&&(Object.prototype.hasOwnProperty.call(x,D)||Le(D,T,E));for(D in x)Object.prototype.hasOwnProperty.call(x,D)&&(Object.prototype.hasOwnProperty.call(_,D)?ne(_[D],x[D])||(_[D].type==="geojson"&&x[D].type==="geojson"&&Ge(_,x,D)?me(T,{command:"setGeoJSONSourceData",args:[D,x[D].data]}):xe(D,x,T,E)):Se(D,x,T))})(a.sources,t.sources,f,o);const g=[];a.layers&&a.layers.forEach(_=>{"source"in _&&o[_.source]?n.push({command:"removeLayer",args:[_.id]}):g.push(_)}),n=n.concat(f),function(_,x,T){x=x||[];const E=(_=_||[]).map(Pe),D=x.map(Pe),I=_.reduce(We,{}),j=x.reduce(We,{}),N=E.slice(),Z=Object.create(null);let H,W,re,_e,le;for(let U=0,Y=0;U<E.length;U++)H=E[U],Object.prototype.hasOwnProperty.call(j,H)?Y++:(me(T,{command:"removeLayer",args:[H]}),N.splice(N.indexOf(H,Y),1));for(let U=0,Y=0;U<D.length;U++)H=D[D.length-1-U],N[N.length-1-U]!==H&&(Object.prototype.hasOwnProperty.call(I,H)?(me(T,{command:"removeLayer",args:[H]}),N.splice(N.lastIndexOf(H,N.length-Y),1)):Y++,_e=N[N.length-U],me(T,{command:"addLayer",args:[j[H],_e]}),N.splice(N.length-U,0,H),Z[H]=!0);for(let U=0;U<D.length;U++)if(H=D[U],W=I[H],re=j[H],!Z[H]&&!ne(W,re))if(ne(W.source,re.source)&&ne(W["source-layer"],re["source-layer"])&&ne(W.type,re.type)){for(le in Ne(W.layout,re.layout,T,H,null,"setLayoutProperty"),Ne(W.paint,re.paint,T,H,null,"setPaintProperty"),ne(W.filter,re.filter)||me(T,{command:"setFilter",args:[H,re.filter]}),ne(W.minzoom,re.minzoom)&&ne(W.maxzoom,re.maxzoom)||me(T,{command:"setLayerZoomRange",args:[H,re.minzoom,re.maxzoom]}),W)Object.prototype.hasOwnProperty.call(W,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?Ne(W[le],re[le],T,H,le.slice(6),"setPaintProperty"):ne(W[le],re[le])||me(T,{command:"setLayerProperty",args:[H,le,re[le]]}));for(le in re)Object.prototype.hasOwnProperty.call(re,le)&&!Object.prototype.hasOwnProperty.call(W,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?Ne(W[le],re[le],T,H,le.slice(6),"setPaintProperty"):ne(W[le],re[le])||me(T,{command:"setLayerProperty",args:[H,le,re[le]]}))}else me(T,{command:"removeLayer",args:[H]}),_e=N[N.lastIndexOf(H)+1],me(T,{command:"addLayer",args:[re,_e]})}(g,t.layers,n)}catch(o){console.warn("Unable to compute style diff:",o),n=[{command:"setStyle",args:[t]}]}return n},z.c=rs,z.c0=a=>a.type==="heatmap",z.c1=a=>a.type==="line",z.c2=a=>a.type==="fill",z.c3=a=>a.type==="fill-extrusion",z.c4=a=>a.type==="hillshade",z.c5=a=>a.type==="raster",z.c6=a=>a.type==="background",z.c7=a=>a.type==="custom",z.c8=rt,z.c9=function(a,t,n){const o=di(t.x-n.x,t.y-n.y),f=di(a.x-n.x,a.y-n.y);var g,_;return vn(Math.atan2(o[0]*f[1]-o[1]*f[0],(g=o)[0]*(_=f)[0]+g[1]*_[1]))},z.cA=Ee,z.cB=Pd,z.cC=Rf,z.cD=fs,z.cE=Xa,z.ca=At,z.cb=function(a,t,n){var o=t[0],f=t[1];return a[0]=n[0]*o+n[4]*f+n[12],a[1]=n[1]*o+n[5]*f+n[13],a},z.cc=function(a,t){const{x:n,y:o}=gi.fromLngLat(t);return!(a<0||a>25||o<0||o>=1||n<0||n>=1)},z.cd=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},z.ce=class extends No{},z.cf=tf,z.ch=function(a){return a.message===ti},z.ci=na,z.cj=function(a,t){Yr.REGISTERED_PROTOCOLS[a]=t},z.ck=function(a){delete Yr.REGISTERED_PROTOCOLS[a]},z.cl=function(a,t){const n={};for(let f=0;f<a.length;f++){const g=t&&t[a[f].id]||Tn(a[f]);t&&(t[a[f].id]=g);let _=n[g];_||(_=n[g]=[]),_.push(a[f])}const o=[];for(const f in n)o.push(n[f]);return o},z.cm=bt,z.cn=Yh,z.co=Xd,z.cp=kf,z.cq=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Je/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],n=t.layout,o=t._unevaluatedLayout._values,f={layoutIconSize:o["icon-size"].possiblyEvaluate(new Ki(a.bucket.zoom+1),a.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new Ki(a.bucket.zoom+1),a.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new Ki(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:E,maxZoom:D}=a.bucket.textSizeData;f.compositeTextSizes=[o["text-size"].possiblyEvaluate(new Ki(E),a.canonical),o["text-size"].possiblyEvaluate(new Ki(D),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:E,maxZoom:D}=a.bucket.iconSizeData;f.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new Ki(E),a.canonical),o["icon-size"].possiblyEvaluate(new Ki(D),a.canonical)]}const g=n.get("text-line-height")*yr,_=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",x=n.get("text-keep-upright"),T=n.get("text-size");for(const E of a.bucket.features){const D=n.get("text-font").evaluate(E,{},a.canonical).join(","),I=T.evaluate(E,{},a.canonical),j=f.layoutTextSize.evaluate(E,{},a.canonical),N=f.layoutIconSize.evaluate(E,{},a.canonical),Z={horizontal:{},vertical:void 0},H=E.text;let W,re=[0,0];if(H){const U=H.toString(),Y=n.get("text-letter-spacing").evaluate(E,{},a.canonical)*yr,ue=Tl(U)?Y:0,ke=n.get("text-anchor").evaluate(E,{},a.canonical),tt=ep(t,E,a.canonical);if(!tt){const nt=n.get("text-radial-offset").evaluate(E,{},a.canonical);re=nt?ys(ke,[nt*yr,Jd]):n.get("text-offset").evaluate(E,{},a.canonical).map(ct=>ct*yr)}let je=_?"center":n.get("text-justify").evaluate(E,{},a.canonical);const Ve=n.get("symbol-placement")==="point"?n.get("text-max-width").evaluate(E,{},a.canonical)*yr:1/0,ot=()=>{a.bucket.allowVerticalPlacement&&Sl(U)&&(Z.vertical=$u(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Ve,g,ke,"left",ue,re,z.ag.vertical,!0,j,I))};if(!_&&tt){const nt=new Set;if(je==="auto")for(let He=0;He<tt.values.length;He+=2)nt.add(Wf(tt.values[He]));else nt.add(je);let ct=!1;for(const He of nt)if(!Z.horizontal[He])if(ct)Z.horizontal[He]=Z.horizontal[0];else{const Ct=$u(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Ve,g,"center",He,ue,re,z.ag.horizontal,!1,j,I);Ct&&(Z.horizontal[He]=Ct,ct=Ct.positionedLines.length===1)}ot()}else{je==="auto"&&(je=Wf(ke));const nt=$u(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Ve,g,ke,je,ue,re,z.ag.horizontal,!1,j,I);nt&&(Z.horizontal[je]=nt),ot(),Sl(U)&&_&&x&&(Z.vertical=$u(H,a.glyphMap,a.glyphPositions,a.imagePositions,D,Ve,g,ke,je,ue,re,z.ag.vertical,!1,j,I))}}let _e=!1;if(E.icon&&E.icon.name){const U=a.imageMap[E.icon.name];U&&(W=Hu(a.imagePositions[E.icon.name],n.get("icon-offset").evaluate(E,{},a.canonical),n.get("icon-anchor").evaluate(E,{},a.canonical)),_e=!!U.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=_e:a.bucket.sdfIcons!==_e&&Ai("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(U.pixelRatio!==a.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const le=Qh(Z.horizontal)||Z.vertical;a.bucket.iconsInText=!!le&&le.iconsInText,(le||W)&&vs(a.bucket,E,Z,W,a.imageMap,f,j,N,re,_e,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},z.cr=kd,z.cs=es,z.ct=jh,z.cu=Fl,z.cv=Zu,z.cw=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},z.cx=function(a,t,n,o,f){return u(this,void 0,void 0,function*(){if(at())try{return yield Sr(a,t,n,o,f)}catch{}return function(g,_,x,T,E){const D=g.width,I=g.height;zi&&nn||(zi=new OffscreenCanvas(D,I),nn=zi.getContext("2d",{willReadFrequently:!0})),zi.width=D,zi.height=I,nn.drawImage(g,0,0,D,I);const j=nn.getImageData(_,x,T,E);return nn.clearRect(0,0,D,I),j.data}(a,t,n,o,f)})},z.cy=Qu,z.cz=ce,z.d=fr,z.e=Xt,z.f=a=>u(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(n){throw new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),z.g=bs,z.h=a=>new Promise((t,n)=>{const o=new Image;o.onload=()=>{t(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame(()=>{o.src=yn})},o.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const f=new Blob([new Uint8Array(a)],{type:"image/png"});o.src=a.byteLength?URL.createObjectURL(f):yn}),z.i=zr,z.j=(a,t)=>hr(Xt(a,{type:"json"}),t),z.k=Rr,z.l=Kr,z.m=hr,z.n=(a,t)=>hr(Xt(a,{type:"arrayBuffer"}),t),z.o=function(a){return new Zu(a).readFields(Vl,[])},z.p=If,z.q=qo,z.r=Pn,z.s=Pr,z.t=wl,z.u=Gt,z.v=L,z.w=Ai,z.x=ma,z.y=Ls,z.z=function([a,t,n]){return t+=90,t*=Math.PI/180,n*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(n),y:a*Math.sin(t)*Math.sin(n),z:a*Math.cos(n)}}}),B("worker",["./shared"],function(z){class u{constructor(L){this.keyCache={},L&&this.replace(L)}replace(L){this._layerConfigs={},this._layers={},this.update(L,[])}update(L,X){for(const ne of L){this._layerConfigs[ne.id]=ne;const me=this._layers[ne.id]=z.bx(ne);me._featureFilter=z.a6(me.filter),this.keyCache[ne.id]&&delete this.keyCache[ne.id]}for(const ne of X)delete this.keyCache[ne],delete this._layerConfigs[ne],delete this._layers[ne];this.familiesBySource={};const J=z.cl(Object.values(this._layerConfigs),this.keyCache);for(const ne of J){const me=ne.map(Pe=>this._layers[Pe.id]),Se=me[0];if(Se.visibility==="none")continue;const Le=Se.source||"";let xe=this.familiesBySource[Le];xe||(xe=this.familiesBySource[Le]={});const Ge=Se.sourceLayer||"_geojsonTileLayer";let Ne=xe[Ge];Ne||(Ne=xe[Ge]=[]),Ne.push(me)}}}class ce{constructor(L){const X={},J=[];for(const Le in L){const xe=L[Le],Ge=X[Le]={};for(const Ne in xe){const Pe=xe[+Ne];if(!Pe||Pe.bitmap.width===0||Pe.bitmap.height===0)continue;const We={x:0,y:0,w:Pe.bitmap.width+2,h:Pe.bitmap.height+2};J.push(We),Ge[Ne]={rect:We,metrics:Pe.metrics}}}const{w:ne,h:me}=z.p(J),Se=new z.q({width:ne||1,height:me||1});for(const Le in L){const xe=L[Le];for(const Ge in xe){const Ne=xe[+Ge];if(!Ne||Ne.bitmap.width===0||Ne.bitmap.height===0)continue;const Pe=X[Le][Ge].rect;z.q.copy(Ne.bitmap,Se,{x:0,y:0},{x:Pe.x+1,y:Pe.y+1},Ne.bitmap)}}this.image=Se,this.positions=X}}z.cm("GlyphAtlas",ce);class ae{constructor(L){this.tileID=new z.Y(L.tileID.overscaledZ,L.tileID.wrap,L.tileID.canonical.z,L.tileID.canonical.x,L.tileID.canonical.y),this.uid=L.uid,this.zoom=L.zoom,this.pixelRatio=L.pixelRatio,this.tileSize=L.tileSize,this.source=L.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=L.showCollisionBoxes,this.collectResourceTiming=!!L.collectResourceTiming,this.returnDependencies=!!L.returnDependencies,this.promoteId=L.promoteId,this.inFlightDependencies=[]}parse(L,X,J,ne,me){return z._(this,void 0,void 0,function*(){this.status="parsing",this.data=L,this.collisionBoxArray=new z.a4;const Se=new z.cn(Object.keys(L.layers).sort()),Le=new z.co(this.tileID,this.promoteId);Le.bucketLayerIDs=[];const xe={},Ge={featureIndex:Le,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:J,subdivisionGranularity:me},Ne=X.familiesBySource[this.source];for(const Nt in Ne){const $t=L.layers[Nt];if(!$t)continue;$t.version===1&&z.w(`Vector tile source "${this.source}" layer "${Nt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Mt=Se.encode(Nt),ba=[];for(let Tr=0;Tr<$t.length;Tr++){const Wr=$t.feature(Tr),Yi=Le.getId(Wr,Nt);ba.push({feature:Wr,id:Yi,index:Tr,sourceLayerIndex:Mt})}for(const Tr of Ne[Nt]){const Wr=Tr[0];Wr.source!==this.source&&z.w(`layer.source = ${Wr.source} does not equal this.source = ${this.source}`),Wr.minzoom&&this.zoom<Math.floor(Wr.minzoom)||Wr.maxzoom&&this.zoom>=Wr.maxzoom||Wr.visibility!=="none"&&(Ce(Tr,this.zoom,J),(xe[Wr.id]=Wr.createBucket({index:Le.bucketLayerIDs.length,layers:Tr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Mt,sourceID:this.source})).populate(ba,Ge,this.tileID.canonical),Le.bucketLayerIDs.push(Tr.map(Yi=>Yi.id)))}}const Pe=z.bC(Ge.glyphDependencies,Nt=>Object.keys(Nt).map(Number));this.inFlightDependencies.forEach(Nt=>Nt==null?void 0:Nt.abort()),this.inFlightDependencies=[];let We=Promise.resolve({});if(Object.keys(Pe).length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),We=ne.sendAsync({type:"GG",data:{stacks:Pe,source:this.source,tileID:this.tileID,type:"glyphs"}},Nt)}const Re=Object.keys(Ge.iconDependencies);let _t=Promise.resolve({});if(Re.length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),_t=ne.sendAsync({type:"GI",data:{icons:Re,source:this.source,tileID:this.tileID,type:"icons"}},Nt)}const Dt=Object.keys(Ge.patternDependencies);let ii=Promise.resolve({});if(Dt.length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),ii=ne.sendAsync({type:"GI",data:{icons:Dt,source:this.source,tileID:this.tileID,type:"patterns"}},Nt)}const[Ht,Xe,zt]=yield Promise.all([We,_t,ii]),Tt=new ce(Ht),li=new z.cp(Xe,zt);for(const Nt in xe){const $t=xe[Nt];$t instanceof z.a5?(Ce($t.layers,this.zoom,J),z.cq({bucket:$t,glyphMap:Ht,glyphPositions:Tt.positions,imageMap:Xe,imagePositions:li.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ge.subdivisionGranularity})):$t.hasPattern&&($t instanceof z.cr||$t instanceof z.cs||$t instanceof z.ct)&&(Ce($t.layers,this.zoom,J),$t.addFeatures(Ge,this.tileID.canonical,li.patternPositions))}return this.status="done",{buckets:Object.values(xe).filter(Nt=>!Nt.isEmpty()),featureIndex:Le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tt.image,imageAtlas:li,glyphMap:this.returnDependencies?Ht:null,iconMap:this.returnDependencies?Xe:null,glyphPositions:this.returnDependencies?Tt.positions:null}})}}function Ce(Ae,L,X){const J=new z.C(L);for(const ne of Ae)ne.recalculate(J,X)}class Ee{constructor(L,X,J){this.actor=L,this.layerIndex=X,this.availableImages=J,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(L,X){return z._(this,void 0,void 0,function*(){const J=yield z.n(L.request,X);try{return{vectorTile:new z.cu.VectorTile(new z.cv(J.data)),rawData:J.data,cacheControl:J.cacheControl,expires:J.expires}}catch(ne){const me=new Uint8Array(J.data);let Se=`Unable to parse the tile at ${L.request.url}, `;throw Se+=me[0]===31&&me[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ne.message}`,new Error(Se)}})}loadTile(L){return z._(this,void 0,void 0,function*(){const X=L.uid,J=!!(L&&L.request&&L.request.collectResourceTiming)&&new z.cw(L.request),ne=new ae(L);this.loading[X]=ne;const me=new AbortController;ne.abort=me;try{const Se=yield this.loadVectorTile(L,me);if(delete this.loading[X],!Se)return null;const Le=Se.rawData,xe={};Se.expires&&(xe.expires=Se.expires),Se.cacheControl&&(xe.cacheControl=Se.cacheControl);const Ge={};if(J){const Pe=J.finish();Pe&&(Ge.resourceTiming=JSON.parse(JSON.stringify(Pe)))}ne.vectorTile=Se.vectorTile;const Ne=ne.parse(Se.vectorTile,this.layerIndex,this.availableImages,this.actor,L.subdivisionGranularity);this.loaded[X]=ne,this.fetching[X]={rawTileData:Le,cacheControl:xe,resourceTiming:Ge};try{const Pe=yield Ne;return z.e({rawTileData:Le.slice(0)},Pe,xe,Ge)}finally{delete this.fetching[X]}}catch(Se){throw delete this.loading[X],ne.status="done",this.loaded[X]=ne,Se}})}reloadTile(L){return z._(this,void 0,void 0,function*(){const X=L.uid;if(!this.loaded||!this.loaded[X])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const J=this.loaded[X];if(J.showCollisionBoxes=L.showCollisionBoxes,J.status==="parsing"){const ne=yield J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,L.subdivisionGranularity);let me;if(this.fetching[X]){const{rawTileData:Se,cacheControl:Le,resourceTiming:xe}=this.fetching[X];delete this.fetching[X],me=z.e({rawTileData:Se.slice(0)},ne,Le,xe)}else me=ne;return me}if(J.status==="done"&&J.vectorTile)return J.parse(J.vectorTile,this.layerIndex,this.availableImages,this.actor,L.subdivisionGranularity)})}abortTile(L){return z._(this,void 0,void 0,function*(){const X=this.loading,J=L.uid;X&&X[J]&&X[J].abort&&(X[J].abort.abort(),delete X[J])})}removeTile(L){return z._(this,void 0,void 0,function*(){this.loaded&&this.loaded[L.uid]&&delete this.loaded[L.uid]})}}class be{constructor(){this.loaded={}}loadTile(L){return z._(this,void 0,void 0,function*(){const{uid:X,encoding:J,rawImageData:ne,redFactor:me,greenFactor:Se,blueFactor:Le,baseShift:xe}=L,Ge=ne.width+2,Ne=ne.height+2,Pe=z.b(ne)?new z.R({width:Ge,height:Ne},yield z.cx(ne,-1,-1,Ge,Ne)):ne,We=new z.cy(X,Pe,J,me,Se,Le,xe);return this.loaded=this.loaded||{},this.loaded[X]=We,We})}removeTile(L){const X=this.loaded,J=L.uid;X&&X[J]&&delete X[J]}}var oe,we,ze=function(){if(we)return oe;function Ae(X,J){if(X.length!==0){L(X[0],J);for(var ne=1;ne<X.length;ne++)L(X[ne],!J)}}function L(X,J){for(var ne=0,me=0,Se=0,Le=X.length,xe=Le-1;Se<Le;xe=Se++){var Ge=(X[Se][0]-X[xe][0])*(X[xe][1]+X[Se][1]),Ne=ne+Ge;me+=Math.abs(ne)>=Math.abs(Ge)?ne-Ne+Ge:Ge-Ne+ne,ne=Ne}ne+me>=0!=!!J&&X.reverse()}return we=1,oe=function X(J,ne){var me,Se=J&&J.type;if(Se==="FeatureCollection")for(me=0;me<J.features.length;me++)X(J.features[me],ne);else if(Se==="GeometryCollection")for(me=0;me<J.geometries.length;me++)X(J.geometries[me],ne);else if(Se==="Feature")X(J.geometry,ne);else if(Se==="Polygon")Ae(J.coordinates,ne);else if(Se==="MultiPolygon")for(me=0;me<J.coordinates.length;me++)Ae(J.coordinates[me],ne);return J}}(),dt=z.cz(ze);const gt=z.cu.VectorTileFeature.prototype.toGeoJSON;class St{constructor(L){this._feature=L,this.extent=z.Z,this.type=L.type,this.properties=L.tags,"id"in L&&!isNaN(L.id)&&(this.id=parseInt(L.id,10))}loadGeometry(){if(this._feature.type===1){const L=[];for(const X of this._feature.geometry)L.push([new z.P(X[0],X[1])]);return L}{const L=[];for(const X of this._feature.geometry){const J=[];for(const ne of X)J.push(new z.P(ne[0],ne[1]));L.push(J)}return L}}toGeoJSON(L,X,J){return gt.call(this,L,X,J)}}class vt{constructor(L){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=z.Z,this.length=L.length,this._features=L}feature(L){return new St(this._features[L])}}var at,Oe,ut,yt={exports:{}},xt=function(){if(ut)return yt.exports;ut=1;var Ae=z.cC(),L=function(){if(Oe)return at;Oe=1;var Ne=z.cA(),Pe=z.cB().VectorTileFeature;function We(_t,Dt){this.options=Dt||{},this.features=_t,this.length=_t.length}function Re(_t,Dt){this.id=typeof _t.id=="number"?_t.id:void 0,this.type=_t.type,this.rawGeometry=_t.type===1?[_t.geometry]:_t.geometry,this.properties=_t.tags,this.extent=Dt||4096}return at=We,We.prototype.feature=function(_t){return new Re(this.features[_t],this.options.extent)},Re.prototype.loadGeometry=function(){var _t=this.rawGeometry;this.geometry=[];for(var Dt=0;Dt<_t.length;Dt++){for(var ii=_t[Dt],Ht=[],Xe=0;Xe<ii.length;Xe++)Ht.push(new Ne(ii[Xe][0],ii[Xe][1]));this.geometry.push(Ht)}return this.geometry},Re.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var _t=this.geometry,Dt=1/0,ii=-1/0,Ht=1/0,Xe=-1/0,zt=0;zt<_t.length;zt++)for(var Tt=_t[zt],li=0;li<Tt.length;li++){var Nt=Tt[li];Dt=Math.min(Dt,Nt.x),ii=Math.max(ii,Nt.x),Ht=Math.min(Ht,Nt.y),Xe=Math.max(Xe,Nt.y)}return[Dt,Ht,ii,Xe]},Re.prototype.toGeoJSON=Pe.prototype.toGeoJSON,at}();function X(Ne){var Pe=new Ae;return function(We,Re){for(var _t in We.layers)Re.writeMessage(3,J,We.layers[_t])}(Ne,Pe),Pe.finish()}function J(Ne,Pe){var We;Pe.writeVarintField(15,Ne.version||1),Pe.writeStringField(1,Ne.name||""),Pe.writeVarintField(5,Ne.extent||4096);var Re={keys:[],values:[],keycache:{},valuecache:{}};for(We=0;We<Ne.length;We++)Re.feature=Ne.feature(We),Pe.writeMessage(2,ne,Re);var _t=Re.keys;for(We=0;We<_t.length;We++)Pe.writeStringField(3,_t[We]);var Dt=Re.values;for(We=0;We<Dt.length;We++)Pe.writeMessage(4,Ge,Dt[We])}function ne(Ne,Pe){var We=Ne.feature;We.id!==void 0&&Pe.writeVarintField(1,We.id),Pe.writeMessage(2,me,Ne),Pe.writeVarintField(3,We.type),Pe.writeMessage(4,xe,We)}function me(Ne,Pe){var We=Ne.feature,Re=Ne.keys,_t=Ne.values,Dt=Ne.keycache,ii=Ne.valuecache;for(var Ht in We.properties){var Xe=We.properties[Ht],zt=Dt[Ht];if(Xe!==null){zt===void 0&&(Re.push(Ht),Dt[Ht]=zt=Re.length-1),Pe.writeVarint(zt);var Tt=typeof Xe;Tt!=="string"&&Tt!=="boolean"&&Tt!=="number"&&(Xe=JSON.stringify(Xe));var li=Tt+":"+Xe,Nt=ii[li];Nt===void 0&&(_t.push(Xe),ii[li]=Nt=_t.length-1),Pe.writeVarint(Nt)}}}function Se(Ne,Pe){return(Pe<<3)+(7&Ne)}function Le(Ne){return Ne<<1^Ne>>31}function xe(Ne,Pe){for(var We=Ne.loadGeometry(),Re=Ne.type,_t=0,Dt=0,ii=We.length,Ht=0;Ht<ii;Ht++){var Xe=We[Ht],zt=1;Re===1&&(zt=Xe.length),Pe.writeVarint(Se(1,zt));for(var Tt=Re===3?Xe.length-1:Xe.length,li=0;li<Tt;li++){li===1&&Re!==1&&Pe.writeVarint(Se(2,Tt-1));var Nt=Xe[li].x-_t,$t=Xe[li].y-Dt;Pe.writeVarint(Le(Nt)),Pe.writeVarint(Le($t)),_t+=Nt,Dt+=$t}Re===3&&Pe.writeVarint(Se(7,1))}}function Ge(Ne,Pe){var We=typeof Ne;We==="string"?Pe.writeStringField(1,Ne):We==="boolean"?Pe.writeBooleanField(7,Ne):We==="number"&&(Ne%1!=0?Pe.writeDoubleField(3,Ne):Ne<0?Pe.writeSVarintField(6,Ne):Pe.writeVarintField(5,Ne))}return yt.exports=X,yt.exports.fromVectorTileJs=X,yt.exports.fromGeojsonVt=function(Ne,Pe){Pe=Pe||{};var We={};for(var Re in Ne)We[Re]=new L(Ne[Re].features,Pe),We[Re].name=Re,We[Re].version=Pe.version,We[Re].extent=Pe.extent;return X({layers:We})},yt.exports.GeoJSONWrapper=L,yt.exports}(),lt=z.cz(xt);const Q={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ae=>Ae},st=Math.fround||(Et=new Float32Array(1),Ae=>(Et[0]=+Ae,Et[0]));var Et;const Vt=3,ei=5,di=6;class Je{constructor(L){this.options=Object.assign(Object.create(Q),L),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(L){const{log:X,minZoom:J,maxZoom:ne}=this.options;X&&console.time("total time");const me=`prepare ${L.length} points`;X&&console.time(me),this.points=L;const Se=[];for(let xe=0;xe<L.length;xe++){const Ge=L[xe];if(!Ge.geometry)continue;const[Ne,Pe]=Ge.geometry.coordinates,We=st(Wt(Ne)),Re=st(ve(Pe));Se.push(We,Re,1/0,xe,-1,1),this.options.reduce&&Se.push(0)}let Le=this.trees[ne+1]=this._createTree(Se);X&&console.timeEnd(me);for(let xe=ne;xe>=J;xe--){const Ge=+Date.now();Le=this.trees[xe]=this._createTree(this._cluster(Le,xe)),X&&console.log("z%d: %d clusters in %dms",xe,Le.numItems,+Date.now()-Ge)}return X&&console.timeEnd("total time"),this}getClusters(L,X){let J=((L[0]+180)%360+360)%360-180;const ne=Math.max(-90,Math.min(90,L[1]));let me=L[2]===180?180:((L[2]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,L[3]));if(L[2]-L[0]>=360)J=-180,me=180;else if(J>me){const Pe=this.getClusters([J,ne,180,Se],X),We=this.getClusters([-180,ne,me,Se],X);return Pe.concat(We)}const Le=this.trees[this._limitZoom(X)],xe=Le.range(Wt(J),ve(Se),Wt(me),ve(ne)),Ge=Le.data,Ne=[];for(const Pe of xe){const We=this.stride*Pe;Ne.push(Ge[We+ei]>1?Zt(Ge,We,this.clusterProps):this.points[Ge[We+Vt]])}return Ne}getChildren(L){const X=this._getOriginId(L),J=this._getOriginZoom(L),ne="No cluster with the specified id.",me=this.trees[J];if(!me)throw new Error(ne);const Se=me.data;if(X*this.stride>=Se.length)throw new Error(ne);const Le=this.options.radius/(this.options.extent*Math.pow(2,J-1)),xe=me.within(Se[X*this.stride],Se[X*this.stride+1],Le),Ge=[];for(const Ne of xe){const Pe=Ne*this.stride;Se[Pe+4]===L&&Ge.push(Se[Pe+ei]>1?Zt(Se,Pe,this.clusterProps):this.points[Se[Pe+Vt]])}if(Ge.length===0)throw new Error(ne);return Ge}getLeaves(L,X,J){const ne=[];return this._appendLeaves(ne,L,X=X||10,J=J||0,0),ne}getTile(L,X,J){const ne=this.trees[this._limitZoom(L)],me=Math.pow(2,L),{extent:Se,radius:Le}=this.options,xe=Le/Se,Ge=(J-xe)/me,Ne=(J+1+xe)/me,Pe={features:[]};return this._addTileFeatures(ne.range((X-xe)/me,Ge,(X+1+xe)/me,Ne),ne.data,X,J,me,Pe),X===0&&this._addTileFeatures(ne.range(1-xe/me,Ge,1,Ne),ne.data,me,J,me,Pe),X===me-1&&this._addTileFeatures(ne.range(0,Ge,xe/me,Ne),ne.data,-1,J,me,Pe),Pe.features.length?Pe:null}getClusterExpansionZoom(L){let X=this._getOriginZoom(L)-1;for(;X<=this.options.maxZoom;){const J=this.getChildren(L);if(X++,J.length!==1)break;L=J[0].properties.cluster_id}return X}_appendLeaves(L,X,J,ne,me){const Se=this.getChildren(X);for(const Le of Se){const xe=Le.properties;if(xe&&xe.cluster?me+xe.point_count<=ne?me+=xe.point_count:me=this._appendLeaves(L,xe.cluster_id,J,ne,me):me<ne?me++:L.push(Le),L.length===J)break}return me}_createTree(L){const X=new z.aB(L.length/this.stride|0,this.options.nodeSize,Float32Array);for(let J=0;J<L.length;J+=this.stride)X.add(L[J],L[J+1]);return X.finish(),X.data=L,X}_addTileFeatures(L,X,J,ne,me,Se){for(const Le of L){const xe=Le*this.stride,Ge=X[xe+ei]>1;let Ne,Pe,We;if(Ge)Ne=kt(X,xe,this.clusterProps),Pe=X[xe],We=X[xe+1];else{const Dt=this.points[X[xe+Vt]];Ne=Dt.properties;const[ii,Ht]=Dt.geometry.coordinates;Pe=Wt(ii),We=ve(Ht)}const Re={type:1,geometry:[[Math.round(this.options.extent*(Pe*me-J)),Math.round(this.options.extent*(We*me-ne))]],tags:Ne};let _t;_t=Ge||this.options.generateId?X[xe+Vt]:this.points[X[xe+Vt]].id,_t!==void 0&&(Re.id=_t),Se.features.push(Re)}}_limitZoom(L){return Math.max(this.options.minZoom,Math.min(Math.floor(+L),this.options.maxZoom+1))}_cluster(L,X){const{radius:J,extent:ne,reduce:me,minPoints:Se}=this.options,Le=J/(ne*Math.pow(2,X)),xe=L.data,Ge=[],Ne=this.stride;for(let Pe=0;Pe<xe.length;Pe+=Ne){if(xe[Pe+2]<=X)continue;xe[Pe+2]=X;const We=xe[Pe],Re=xe[Pe+1],_t=L.within(xe[Pe],xe[Pe+1],Le),Dt=xe[Pe+ei];let ii=Dt;for(const Ht of _t){const Xe=Ht*Ne;xe[Xe+2]>X&&(ii+=xe[Xe+ei])}if(ii>Dt&&ii>=Se){let Ht,Xe=We*Dt,zt=Re*Dt,Tt=-1;const li=((Pe/Ne|0)<<5)+(X+1)+this.points.length;for(const Nt of _t){const $t=Nt*Ne;if(xe[$t+2]<=X)continue;xe[$t+2]=X;const Mt=xe[$t+ei];Xe+=xe[$t]*Mt,zt+=xe[$t+1]*Mt,xe[$t+4]=li,me&&(Ht||(Ht=this._map(xe,Pe,!0),Tt=this.clusterProps.length,this.clusterProps.push(Ht)),me(Ht,this._map(xe,$t)))}xe[Pe+4]=li,Ge.push(Xe/ii,zt/ii,1/0,li,-1,ii),me&&Ge.push(Tt)}else{for(let Ht=0;Ht<Ne;Ht++)Ge.push(xe[Pe+Ht]);if(ii>1)for(const Ht of _t){const Xe=Ht*Ne;if(!(xe[Xe+2]<=X)){xe[Xe+2]=X;for(let zt=0;zt<Ne;zt++)Ge.push(xe[Xe+zt])}}}}return Ge}_getOriginId(L){return L-this.points.length>>5}_getOriginZoom(L){return(L-this.points.length)%32}_map(L,X,J){if(L[X+ei]>1){const Se=this.clusterProps[L[X+di]];return J?Object.assign({},Se):Se}const ne=this.points[L[X+Vt]].properties,me=this.options.map(ne);return J&&me===ne?Object.assign({},me):me}}function Zt(Ae,L,X){return{type:"Feature",id:Ae[L+Vt],properties:kt(Ae,L,X),geometry:{type:"Point",coordinates:[(J=Ae[L],360*(J-.5)),rt(Ae[L+1])]}};var J}function kt(Ae,L,X){const J=Ae[L+ei],ne=J>=1e4?`${Math.round(J/1e3)}k`:J>=1e3?Math.round(J/100)/10+"k":J,me=Ae[L+di],Se=me===-1?{}:Object.assign({},X[me]);return Object.assign(Se,{cluster:!0,cluster_id:Ae[L+Vt],point_count:J,point_count_abbreviated:ne})}function Wt(Ae){return Ae/360+.5}function ve(Ae){const L=Math.sin(Ae*Math.PI/180),X=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return X<0?0:X>1?1:X}function rt(Ae){const L=(180-360*Ae)*Math.PI/180;return 360*Math.atan(Math.exp(L))/Math.PI-90}function At(Ae,L,X,J){let ne=J;const me=L+(X-L>>1);let Se,Le=X-L;const xe=Ae[L],Ge=Ae[L+1],Ne=Ae[X],Pe=Ae[X+1];for(let We=L+3;We<X;We+=3){const Re=Lt(Ae[We],Ae[We+1],xe,Ge,Ne,Pe);if(Re>ne)Se=We,ne=Re;else if(Re===ne){const _t=Math.abs(We-me);_t<Le&&(Se=We,Le=_t)}}ne>J&&(Se-L>3&&At(Ae,L,Se,J),Ae[Se+2]=ne,X-Se>3&&At(Ae,Se,X,J))}function Lt(Ae,L,X,J,ne,me){let Se=ne-X,Le=me-J;if(Se!==0||Le!==0){const xe=((Ae-X)*Se+(L-J)*Le)/(Se*Se+Le*Le);xe>1?(X=ne,J=me):xe>0&&(X+=Se*xe,J+=Le*xe)}return Se=Ae-X,Le=L-J,Se*Se+Le*Le}function wt(Ae,L,X,J){const ne={id:Ae??null,type:L,geometry:X,tags:J,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(L==="Point"||L==="MultiPoint"||L==="LineString")Xt(ne,X);else if(L==="Polygon")Xt(ne,X[0]);else if(L==="MultiLineString")for(const me of X)Xt(ne,me);else if(L==="MultiPolygon")for(const me of X)Xt(ne,me[0]);return ne}function Xt(Ae,L){for(let X=0;X<L.length;X+=3)Ae.minX=Math.min(Ae.minX,L[X]),Ae.minY=Math.min(Ae.minY,L[X+1]),Ae.maxX=Math.max(Ae.maxX,L[X]),Ae.maxY=Math.max(Ae.maxY,L[X+1])}function Yt(Ae,L,X,J){if(!L.geometry)return;const ne=L.geometry.coordinates;if(ne&&ne.length===0)return;const me=L.geometry.type,Se=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2);let Le=[],xe=L.id;if(X.promoteId?xe=L.properties[X.promoteId]:X.generateId&&(xe=J||0),me==="Point")Xi(ne,Le);else if(me==="MultiPoint")for(const Ge of ne)Xi(Ge,Le);else if(me==="LineString")hi(ne,Le,Se,!1);else if(me==="MultiLineString"){if(X.lineMetrics){for(const Ge of ne)Le=[],hi(Ge,Le,Se,!1),Ae.push(wt(xe,"LineString",Le,L.properties));return}vi(ne,Le,Se,!1)}else if(me==="Polygon")vi(ne,Le,Se,!0);else{if(me!=="MultiPolygon"){if(me==="GeometryCollection"){for(const Ge of L.geometry.geometries)Yt(Ae,{id:xe,geometry:Ge,properties:L.properties},X,J);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ge of ne){const Ne=[];vi(Ge,Ne,Se,!0),Le.push(Ne)}}Ae.push(wt(xe,me,Le,L.properties))}function Xi(Ae,L){L.push(Ci(Ae[0]),Ai(Ae[1]),0)}function hi(Ae,L,X,J){let ne,me,Se=0;for(let xe=0;xe<Ae.length;xe++){const Ge=Ci(Ae[xe][0]),Ne=Ai(Ae[xe][1]);L.push(Ge,Ne,0),xe>0&&(Se+=J?(ne*Ne-Ge*me)/2:Math.sqrt(Math.pow(Ge-ne,2)+Math.pow(Ne-me,2))),ne=Ge,me=Ne}const Le=L.length-3;L[2]=1,At(L,0,Le,X),L[Le+2]=1,L.size=Math.abs(Se),L.start=0,L.end=L.size}function vi(Ae,L,X,J){for(let ne=0;ne<Ae.length;ne++){const me=[];hi(Ae[ne],me,X,J),L.push(me)}}function Ci(Ae){return Ae/360+.5}function Ai(Ae){const L=Math.sin(Ae*Math.PI/180),X=.5-.25*Math.log((1+L)/(1-L))/Math.PI;return X<0?0:X>1?1:X}function Bi(Ae,L,X,J,ne,me,Se,Le){if(J/=L,me>=(X/=L)&&Se<J)return Ae;if(Se<X||me>=J)return null;const xe=[];for(const Ge of Ae){const Ne=Ge.geometry;let Pe=Ge.type;const We=ne===0?Ge.minX:Ge.minY,Re=ne===0?Ge.maxX:Ge.maxY;if(We>=X&&Re<J){xe.push(Ge);continue}if(Re<X||We>=J)continue;let _t=[];if(Pe==="Point"||Pe==="MultiPoint")zr(Ne,_t,X,J,ne);else if(Pe==="LineString")Ei(Ne,_t,X,J,ne,!1,Le.lineMetrics);else if(Pe==="MultiLineString")yn(Ne,_t,X,J,ne,!1);else if(Pe==="Polygon")yn(Ne,_t,X,J,ne,!0);else if(Pe==="MultiPolygon")for(const Dt of Ne){const ii=[];yn(Dt,ii,X,J,ne,!0),ii.length&&_t.push(ii)}if(_t.length){if(Le.lineMetrics&&Pe==="LineString"){for(const Dt of _t)xe.push(wt(Ge.id,Pe,Dt,Ge.tags));continue}Pe!=="LineString"&&Pe!=="MultiLineString"||(_t.length===1?(Pe="LineString",_t=_t[0]):Pe="MultiLineString"),Pe!=="Point"&&Pe!=="MultiPoint"||(Pe=_t.length===3?"Point":"MultiPoint"),xe.push(wt(Ge.id,Pe,_t,Ge.tags))}}return xe.length?xe:null}function zr(Ae,L,X,J,ne){for(let me=0;me<Ae.length;me+=3){const Se=Ae[me+ne];Se>=X&&Se<=J&&Sr(L,Ae[me],Ae[me+1],Ae[me+2])}}function Ei(Ae,L,X,J,ne,me,Se){let Le=qn(Ae);const xe=ne===0?zi:nn;let Ge,Ne,Pe=Ae.start;for(let ii=0;ii<Ae.length-3;ii+=3){const Ht=Ae[ii],Xe=Ae[ii+1],zt=Ae[ii+2],Tt=Ae[ii+3],li=Ae[ii+4],Nt=ne===0?Ht:Xe,$t=ne===0?Tt:li;let Mt=!1;Se&&(Ge=Math.sqrt(Math.pow(Ht-Tt,2)+Math.pow(Xe-li,2))),Nt<X?$t>X&&(Ne=xe(Le,Ht,Xe,Tt,li,X),Se&&(Le.start=Pe+Ge*Ne)):Nt>J?$t<J&&(Ne=xe(Le,Ht,Xe,Tt,li,J),Se&&(Le.start=Pe+Ge*Ne)):Sr(Le,Ht,Xe,zt),$t<X&&Nt>=X&&(Ne=xe(Le,Ht,Xe,Tt,li,X),Mt=!0),$t>J&&Nt<=J&&(Ne=xe(Le,Ht,Xe,Tt,li,J),Mt=!0),!me&&Mt&&(Se&&(Le.end=Pe+Ge*Ne),L.push(Le),Le=qn(Ae)),Se&&(Pe+=Ge)}let We=Ae.length-3;const Re=Ae[We],_t=Ae[We+1],Dt=ne===0?Re:_t;Dt>=X&&Dt<=J&&Sr(Le,Re,_t,Ae[We+2]),We=Le.length-3,me&&We>=3&&(Le[We]!==Le[0]||Le[We+1]!==Le[1])&&Sr(Le,Le[0],Le[1],Le[2]),Le.length&&L.push(Le)}function qn(Ae){const L=[];return L.size=Ae.size,L.start=Ae.start,L.end=Ae.end,L}function yn(Ae,L,X,J,ne,me){for(const Se of Ae)Ei(Se,L,X,J,ne,me,!1)}function Sr(Ae,L,X,J){Ae.push(L,X,J)}function zi(Ae,L,X,J,ne,me){const Se=(me-L)/(J-L);return Sr(Ae,me,X+(ne-X)*Se,1),Se}function nn(Ae,L,X,J,ne,me){const Se=(me-X)/(ne-X);return Sr(Ae,L+(J-L)*Se,me,1),Se}function Pr(Ae,L){const X=[];for(let J=0;J<Ae.length;J++){const ne=Ae[J],me=ne.type;let Se;if(me==="Point"||me==="MultiPoint"||me==="LineString")Se=vn(ne.geometry,L);else if(me==="MultiLineString"||me==="Polygon"){Se=[];for(const Le of ne.geometry)Se.push(vn(Le,L))}else if(me==="MultiPolygon"){Se=[];for(const Le of ne.geometry){const xe=[];for(const Ge of Le)xe.push(vn(Ge,L));Se.push(xe)}}X.push(wt(ne.id,me,Se,ne.tags))}return X}function vn(Ae,L){const X=[];X.size=Ae.size,Ae.start!==void 0&&(X.start=Ae.start,X.end=Ae.end);for(let J=0;J<Ae.length;J+=3)X.push(Ae[J]+L,Ae[J+1],Ae[J+2]);return X}function ti(Ae,L){if(Ae.transformed)return Ae;const X=1<<Ae.z,J=Ae.x,ne=Ae.y;for(const me of Ae.features){const Se=me.geometry,Le=me.type;if(me.geometry=[],Le===1)for(let xe=0;xe<Se.length;xe+=2)me.geometry.push(rs(Se[xe],Se[xe+1],L,X,J,ne));else for(let xe=0;xe<Se.length;xe++){const Ge=[];for(let Ne=0;Ne<Se[xe].length;Ne+=2)Ge.push(rs(Se[xe][Ne],Se[xe][Ne+1],L,X,J,ne));me.geometry.push(Ge)}}return Ae.transformed=!0,Ae}function rs(Ae,L,X,J,ne,me){return[Math.round(X*(Ae*J-ne)),Math.round(X*(L*J-me))]}function Yr(Ae,L,X,J,ne){const me=L===ne.maxZoom?0:ne.tolerance/((1<<L)*ne.extent),Se={features:[],numPoints:0,numSimplified:0,numFeatures:Ae.length,source:null,x:X,y:J,z:L,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Le of Ae)bs(Se,Le,me,ne);return Se}function bs(Ae,L,X,J){const ne=L.geometry,me=L.type,Se=[];if(Ae.minX=Math.min(Ae.minX,L.minX),Ae.minY=Math.min(Ae.minY,L.minY),Ae.maxX=Math.max(Ae.maxX,L.maxX),Ae.maxY=Math.max(Ae.maxY,L.maxY),me==="Point"||me==="MultiPoint")for(let Le=0;Le<ne.length;Le+=3)Se.push(ne[Le],ne[Le+1]),Ae.numPoints++,Ae.numSimplified++;else if(me==="LineString")Fa(Se,ne,Ae,X,!1,!1);else if(me==="MultiLineString"||me==="Polygon")for(let Le=0;Le<ne.length;Le++)Fa(Se,ne[Le],Ae,X,me==="Polygon",Le===0);else if(me==="MultiPolygon")for(let Le=0;Le<ne.length;Le++){const xe=ne[Le];for(let Ge=0;Ge<xe.length;Ge++)Fa(Se,xe[Ge],Ae,X,!0,Ge===0)}if(Se.length){let Le=L.tags||null;if(me==="LineString"&&J.lineMetrics){Le={};for(const Ge in L.tags)Le[Ge]=L.tags[Ge];Le.mapbox_clip_start=ne.start/ne.size,Le.mapbox_clip_end=ne.end/ne.size}const xe={geometry:Se,type:me==="Polygon"||me==="MultiPolygon"?3:me==="LineString"||me==="MultiLineString"?2:1,tags:Le};L.id!==null&&(xe.id=L.id),Ae.features.push(xe)}}function Fa(Ae,L,X,J,ne,me){const Se=J*J;if(J>0&&L.size<(ne?Se:J))return void(X.numPoints+=L.length/3);const Le=[];for(let xe=0;xe<L.length;xe+=3)(J===0||L[xe+2]>Se)&&(X.numSimplified++,Le.push(L[xe],L[xe+1])),X.numPoints++;ne&&function(xe,Ge){let Ne=0;for(let Pe=0,We=xe.length,Re=We-2;Pe<We;Re=Pe,Pe+=2)Ne+=(xe[Pe]-xe[Re])*(xe[Pe+1]+xe[Re+1]);if(Ne>0===Ge)for(let Pe=0,We=xe.length;Pe<We/2;Pe+=2){const Re=xe[Pe],_t=xe[Pe+1];xe[Pe]=xe[We-2-Pe],xe[Pe+1]=xe[We-1-Pe],xe[We-2-Pe]=Re,xe[We-1-Pe]=_t}}(Le,me),Ae.push(Le)}const na={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Oi{constructor(L,X){const J=(X=this.options=function(me,Se){for(const Le in Se)me[Le]=Se[Le];return me}(Object.create(na),X)).debug;if(J&&console.time("preprocess data"),X.maxZoom<0||X.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(X.promoteId&&X.generateId)throw new Error("promoteId and generateId cannot be used together.");let ne=function(me,Se){const Le=[];if(me.type==="FeatureCollection")for(let xe=0;xe<me.features.length;xe++)Yt(Le,me.features[xe],Se,xe);else Yt(Le,me.type==="Feature"?me:{geometry:me},Se);return Le}(L,X);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",X.indexMaxZoom,X.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(me,Se){const Le=Se.buffer/Se.extent;let xe=me;const Ge=Bi(me,1,-1-Le,Le,0,-1,2,Se),Ne=Bi(me,1,1-Le,2+Le,0,-1,2,Se);return(Ge||Ne)&&(xe=Bi(me,1,-Le,1+Le,0,-1,2,Se)||[],Ge&&(xe=Pr(Ge,1).concat(xe)),Ne&&(xe=xe.concat(Pr(Ne,-1)))),xe}(ne,X),ne.length&&this.splitTile(ne,0,0,0),J&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(L,X,J,ne,me,Se,Le){const xe=[L,X,J,ne],Ge=this.options,Ne=Ge.debug;for(;xe.length;){ne=xe.pop(),J=xe.pop(),X=xe.pop(),L=xe.pop();const Pe=1<<X,We=hr(X,J,ne);let Re=this.tiles[We];if(!Re&&(Ne>1&&console.time("creation"),Re=this.tiles[We]=Yr(L,X,J,ne,Ge),this.tileCoords.push({z:X,x:J,y:ne}),Ne)){Ne>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",X,J,ne,Re.numFeatures,Re.numPoints,Re.numSimplified),console.timeEnd("creation"));const Mt=`z${X}`;this.stats[Mt]=(this.stats[Mt]||0)+1,this.total++}if(Re.source=L,me==null){if(X===Ge.indexMaxZoom||Re.numPoints<=Ge.indexMaxPoints)continue}else{if(X===Ge.maxZoom||X===me)continue;if(me!=null){const Mt=me-X;if(J!==Se>>Mt||ne!==Le>>Mt)continue}}if(Re.source=null,L.length===0)continue;Ne>1&&console.time("clipping");const _t=.5*Ge.buffer/Ge.extent,Dt=.5-_t,ii=.5+_t,Ht=1+_t;let Xe=null,zt=null,Tt=null,li=null,Nt=Bi(L,Pe,J-_t,J+ii,0,Re.minX,Re.maxX,Ge),$t=Bi(L,Pe,J+Dt,J+Ht,0,Re.minX,Re.maxX,Ge);L=null,Nt&&(Xe=Bi(Nt,Pe,ne-_t,ne+ii,1,Re.minY,Re.maxY,Ge),zt=Bi(Nt,Pe,ne+Dt,ne+Ht,1,Re.minY,Re.maxY,Ge),Nt=null),$t&&(Tt=Bi($t,Pe,ne-_t,ne+ii,1,Re.minY,Re.maxY,Ge),li=Bi($t,Pe,ne+Dt,ne+Ht,1,Re.minY,Re.maxY,Ge),$t=null),Ne>1&&console.timeEnd("clipping"),xe.push(Xe||[],X+1,2*J,2*ne),xe.push(zt||[],X+1,2*J,2*ne+1),xe.push(Tt||[],X+1,2*J+1,2*ne),xe.push(li||[],X+1,2*J+1,2*ne+1)}}getTile(L,X,J){L=+L,X=+X,J=+J;const ne=this.options,{extent:me,debug:Se}=ne;if(L<0||L>24)return null;const Le=1<<L,xe=hr(L,X=X+Le&Le-1,J);if(this.tiles[xe])return ti(this.tiles[xe],me);Se>1&&console.log("drilling down to z%d-%d-%d",L,X,J);let Ge,Ne=L,Pe=X,We=J;for(;!Ge&&Ne>0;)Ne--,Pe>>=1,We>>=1,Ge=this.tiles[hr(Ne,Pe,We)];return Ge&&Ge.source?(Se>1&&(console.log("found parent tile z%d-%d-%d",Ne,Pe,We),console.time("drilling down")),this.splitTile(Ge.source,Ne,Pe,We,L,X,J),Se>1&&console.timeEnd("drilling down"),this.tiles[xe]?ti(this.tiles[xe],me):null):null}}function hr(Ae,L,X){return 32*((1<<Ae)*X+L)+Ae}function fr(Ae,L){return L?Ae.properties[L]:Ae.id}function ja(Ae,L){if(Ae==null)return!0;if(Ae.type==="Feature")return fr(Ae,L)!=null;if(Ae.type==="FeatureCollection"){const X=new Set;for(const J of Ae.features){const ne=fr(J,L);if(ne==null||X.has(ne))return!1;X.add(ne)}return!0}return!1}function an(Ae,L){const X=new Map;if(Ae!=null)if(Ae.type==="Feature")X.set(fr(Ae,L),Ae);else for(const J of Ae.features)X.set(fr(J,L),J);return X}class Kr extends Ee{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(L,X){return z._(this,void 0,void 0,function*(){const J=L.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ne=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!ne)return null;const me=new vt(ne.features);let Se=lt(me);return Se.byteOffset===0&&Se.byteLength===Se.buffer.byteLength||(Se=new Uint8Array(Se)),{vectorTile:me,rawData:Se.buffer}})}loadData(L){return z._(this,void 0,void 0,function*(){var X;(X=this._pendingRequest)===null||X===void 0||X.abort();const J=!!(L&&L.request&&L.request.collectResourceTiming)&&new z.cw(L.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(L,this._pendingRequest),this._geoJSONIndex=L.cluster?new Je(function({superclusterOptions:Se,clusterProperties:Le}){if(!Le||!Se)return Se;const xe={},Ge={},Ne={accumulated:null,zoom:0},Pe={properties:null},We=Object.keys(Le);for(const Re of We){const[_t,Dt]=Le[Re],ii=z.cD(Dt),Ht=z.cD(typeof _t=="string"?[_t,["accumulated"],["get",Re]]:_t);xe[Re]=ii.value,Ge[Re]=Ht.value}return Se.map=Re=>{Pe.properties=Re;const _t={};for(const Dt of We)_t[Dt]=xe[Dt].evaluate(Ne,Pe);return _t},Se.reduce=(Re,_t)=>{Pe.properties=_t;for(const Dt of We)Ne.accumulated=Re[Dt],Re[Dt]=Ge[Dt].evaluate(Ne,Pe)},Se}(L)).load((yield this._pendingData).features):(ne=yield this._pendingData,new Oi(ne,L.geojsonVtOptions)),this.loaded={};const me={};if(J){const Se=J.finish();Se&&(me.resourceTiming={},me.resourceTiming[L.source]=JSON.parse(JSON.stringify(Se)))}return me}catch(me){if(delete this._pendingRequest,z.ch(me))return{abandoned:!0};throw me}var ne})}getData(){return z._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(L){const X=this.loaded;return X&&X[L.uid]?super.reloadTile(L):this.loadTile(L)}loadAndProcessGeoJSON(L,X){return z._(this,void 0,void 0,function*(){let J=yield this.loadGeoJSON(L,X);if(delete this._pendingRequest,typeof J!="object")throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(dt(J,!0),L.filter){const ne=z.cD(L.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(Se=>`${Se.key}: ${Se.message}`).join(", "));J={type:"FeatureCollection",features:J.features.filter(Se=>ne.value.evaluate({zoom:0},Se))}}return J})}loadGeoJSON(L,X){return z._(this,void 0,void 0,function*(){const{promoteId:J}=L;if(L.request){const ne=yield z.j(L.request,X);return this._dataUpdateable=ja(ne.data,J)?an(ne.data,J):void 0,ne.data}if(typeof L.data=="string")try{const ne=JSON.parse(L.data);return this._dataUpdateable=ja(ne,J)?an(ne,J):void 0,ne}catch{throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`)}if(!L.dataDiff)throw new Error(`Input data given to '${L.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${L.source}`);return function(ne,me,Se){var Le,xe,Ge,Ne;if(me.removeAll&&ne.clear(),me.remove)for(const Pe of me.remove)ne.delete(Pe);if(me.add)for(const Pe of me.add){const We=fr(Pe,Se);We!=null&&ne.set(We,Pe)}if(me.update)for(const Pe of me.update){let We=ne.get(Pe.id);if(We==null)continue;const Re=!Pe.removeAllProperties&&(((Le=Pe.removeProperties)===null||Le===void 0?void 0:Le.length)>0||((xe=Pe.addOrUpdateProperties)===null||xe===void 0?void 0:xe.length)>0);if((Pe.newGeometry||Pe.removeAllProperties||Re)&&(We=Object.assign({},We),ne.set(Pe.id,We),Re&&(We.properties=Object.assign({},We.properties))),Pe.newGeometry&&(We.geometry=Pe.newGeometry),Pe.removeAllProperties)We.properties={};else if(((Ge=Pe.removeProperties)===null||Ge===void 0?void 0:Ge.length)>0)for(const _t of Pe.removeProperties)Object.prototype.hasOwnProperty.call(We.properties,_t)&&delete We.properties[_t];if(((Ne=Pe.addOrUpdateProperties)===null||Ne===void 0?void 0:Ne.length)>0)for(const{key:_t,value:Dt}of Pe.addOrUpdateProperties)We.properties[_t]=Dt}}(this._dataUpdateable,L.dataDiff,J),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(L){return z._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(L){return this._geoJSONIndex.getClusterExpansionZoom(L.clusterId)}getClusterChildren(L){return this._geoJSONIndex.getChildren(L.clusterId)}getClusterLeaves(L){return this._geoJSONIndex.getLeaves(L.clusterId,L.limit,L.offset)}}class Rr{constructor(L){this.self=L,this.actor=new z.H(L),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(X,J)=>{if(this.externalWorkerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.externalWorkerSourceTypes[X]=J},this.self.addProtocol=z.cj,this.self.removeProtocol=z.ck,this.self.registerRTLTextPlugin=X=>{z.cE.setMethods(X)},this.actor.registerMessageHandler("LDT",(X,J)=>this._getDEMWorkerSource(X,J.source).loadTile(J)),this.actor.registerMessageHandler("RDT",(X,J)=>z._(this,void 0,void 0,function*(){this._getDEMWorkerSource(X,J.source).removeTile(J)})),this.actor.registerMessageHandler("GCEZ",(X,J)=>z._(this,void 0,void 0,function*(){return this._getWorkerSource(X,J.type,J.source).getClusterExpansionZoom(J)})),this.actor.registerMessageHandler("GCC",(X,J)=>z._(this,void 0,void 0,function*(){return this._getWorkerSource(X,J.type,J.source).getClusterChildren(J)})),this.actor.registerMessageHandler("GCL",(X,J)=>z._(this,void 0,void 0,function*(){return this._getWorkerSource(X,J.type,J.source).getClusterLeaves(J)})),this.actor.registerMessageHandler("LD",(X,J)=>this._getWorkerSource(X,J.type,J.source).loadData(J)),this.actor.registerMessageHandler("GD",(X,J)=>this._getWorkerSource(X,J.type,J.source).getData()),this.actor.registerMessageHandler("LT",(X,J)=>this._getWorkerSource(X,J.type,J.source).loadTile(J)),this.actor.registerMessageHandler("RT",(X,J)=>this._getWorkerSource(X,J.type,J.source).reloadTile(J)),this.actor.registerMessageHandler("AT",(X,J)=>this._getWorkerSource(X,J.type,J.source).abortTile(J)),this.actor.registerMessageHandler("RMT",(X,J)=>this._getWorkerSource(X,J.type,J.source).removeTile(J)),this.actor.registerMessageHandler("RS",(X,J)=>z._(this,void 0,void 0,function*(){if(!this.workerSources[X]||!this.workerSources[X][J.type]||!this.workerSources[X][J.type][J.source])return;const ne=this.workerSources[X][J.type][J.source];delete this.workerSources[X][J.type][J.source],ne.removeSource!==void 0&&ne.removeSource(J)})),this.actor.registerMessageHandler("RM",X=>z._(this,void 0,void 0,function*(){delete this.layerIndexes[X],delete this.availableImages[X],delete this.workerSources[X],delete this.demWorkerSources[X]})),this.actor.registerMessageHandler("SR",(X,J)=>z._(this,void 0,void 0,function*(){this.referrer=J})),this.actor.registerMessageHandler("SRPS",(X,J)=>this._syncRTLPluginState(X,J)),this.actor.registerMessageHandler("IS",(X,J)=>z._(this,void 0,void 0,function*(){this.self.importScripts(J)})),this.actor.registerMessageHandler("SI",(X,J)=>this._setImages(X,J)),this.actor.registerMessageHandler("UL",(X,J)=>z._(this,void 0,void 0,function*(){this._getLayerIndex(X).update(J.layers,J.removedIds)})),this.actor.registerMessageHandler("SL",(X,J)=>z._(this,void 0,void 0,function*(){this._getLayerIndex(X).replace(J)}))}_setImages(L,X){return z._(this,void 0,void 0,function*(){this.availableImages[L]=X;for(const J in this.workerSources[L]){const ne=this.workerSources[L][J];for(const me in ne)ne[me].availableImages=X}})}_syncRTLPluginState(L,X){return z._(this,void 0,void 0,function*(){return yield z.cE.syncState(X,this.self.importScripts)})}_getAvailableImages(L){let X=this.availableImages[L];return X||(X=[]),X}_getLayerIndex(L){let X=this.layerIndexes[L];return X||(X=this.layerIndexes[L]=new u),X}_getWorkerSource(L,X,J){if(this.workerSources[L]||(this.workerSources[L]={}),this.workerSources[L][X]||(this.workerSources[L][X]={}),!this.workerSources[L][X][J]){const ne={sendAsync:(me,Se)=>(me.targetMapId=L,this.actor.sendAsync(me,Se))};switch(X){case"vector":this.workerSources[L][X][J]=new Ee(ne,this._getLayerIndex(L),this._getAvailableImages(L));break;case"geojson":this.workerSources[L][X][J]=new Kr(ne,this._getLayerIndex(L),this._getAvailableImages(L));break;default:this.workerSources[L][X][J]=new this.externalWorkerSourceTypes[X](ne,this._getLayerIndex(L),this._getAvailableImages(L))}}return this.workerSources[L][X][J]}_getDEMWorkerSource(L,X){return this.demWorkerSources[L]||(this.demWorkerSources[L]={}),this.demWorkerSources[L][X]||(this.demWorkerSources[L][X]=new be),this.demWorkerSources[L][X]}}return z.i(self)&&(self.worker=new Rr(self)),Rr}),B("index",["exports","./shared"],function(z,u){var ce="5.2.0";function ae(){var d=new u.A(4);return u.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}let Ce,Ee;const be={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(d,e,r){const l=requestAnimationFrame(m=>{h(),e(m)}),{unsubscribe:h}=u.s(d.signal,"abort",()=>{h(),cancelAnimationFrame(l),r(u.c())},!1)},frameAsync(d){return new Promise((e,r)=>{this.frame(d,e,r)})},getImageData(d,e=0){return this.getImageCanvasContext(d).getImageData(-e,-e,d.width+2*e,d.height+2*e)},getImageCanvasContext(d){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=d.width,e.height=d.height,r.drawImage(d,0,0,d.width,d.height),r},resolveURL:d=>(Ce||(Ce=document.createElement("a")),Ce.href=d,Ce.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ee==null&&(Ee=matchMedia("(prefers-reduced-motion: reduce)")),Ee.matches)}};class oe{static testProp(e){if(!oe.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in oe.docStyle)return e[r];return e[0]}static create(e,r,l){const h=window.document.createElement(e);return r!==void 0&&(h.className=r),l&&l.appendChild(h),h}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){oe.docStyle&&oe.selectProp&&(oe.userSelect=oe.docStyle[oe.selectProp],oe.docStyle[oe.selectProp]="none")}static enableDrag(){oe.docStyle&&oe.selectProp&&(oe.docStyle[oe.selectProp]=oe.userSelect)}static setTransform(e,r){e.style[oe.transformProp]=r}static addEventListener(e,r,l,h={}){e.addEventListener(r,l,"passive"in h?h:h.capture)}static removeEventListener(e,r,l,h={}){e.removeEventListener(r,l,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",oe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",oe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",oe.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,l){const h=r.boundingClientRect;return new u.P((l.clientX-h.left)/r.x-e.clientLeft,(l.clientY-h.top)/r.y-e.clientTop)}static mousePos(e,r){const l=oe.getScale(e);return oe.getPoint(e,l,r)}static touchPos(e,r){const l=[],h=oe.getScale(e);for(let m=0;m<r.length;m++)l.push(oe.getPoint(e,h,r[m]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=r.querySelectorAll("script");for(const h of l)h.remove();return oe.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const l=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const l of r)oe.removeAttributes(l),oe.clean(l)}static removeAttributes(e){for(const{name:r,value:l}of e.attributes)oe.isPossiblyDangerous(r,l)&&e.removeAttribute(r)}}oe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,oe.selectProp=oe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),oe.transformProp=oe.testProp(["transform","WebkitTransform"]);const we={supported:!1,testSupport:function(d){!gt&&dt&&(St?vt(d):ze=d)}};let ze,dt,gt=!1,St=!1;function vt(d){const e=d.createTexture();d.bindTexture(d.TEXTURE_2D,e);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,dt),d.isContextLost())return;we.supported=!0}catch{}d.deleteTexture(e),gt=!0}var at;typeof document<"u"&&(dt=document.createElement("img"),dt.onload=()=>{ze&&vt(ze),ze=null,St=!0},dt.onerror=()=>{gt=!0,ze=null},dt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(d){let e,r,l,h;d.resetRequestQueue=()=>{e=[],r=0,l=0,h={}},d.addThrottleControl=M=>{const A=l++;return h[A]=M,A},d.removeThrottleControl=M=>{delete h[M],v()},d.getImage=(M,A,k=!0)=>new Promise((O,F)=>{we.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),u.e(M,{type:"image"}),e.push({abortController:A,requestParameters:M,supportImageRefresh:k,state:"queued",onError:$=>{F($)},onSuccess:$=>{O($)}}),v()});const m=M=>u._(this,void 0,void 0,function*(){M.state="running";const{requestParameters:A,supportImageRefresh:k,onError:O,onSuccess:F,abortController:$}=M,q=k===!1&&!u.i(self)&&!u.g(A.url)&&(!A.headers||Object.keys(A.headers).reduce((ie,se)=>ie&&se==="accept",!0));r++;const te=q?w(A,$):u.m(A,$);try{const ie=yield te;delete M.abortController,M.state="completed",ie.data instanceof HTMLImageElement||u.b(ie.data)?F(ie):ie.data&&F({data:yield(ee=ie.data,typeof createImageBitmap=="function"?u.f(ee):u.h(ee)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete M.abortController,O(ie)}finally{r--,v()}var ee}),v=()=>{const M=(()=>{for(const A of Object.keys(h))if(h[A]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let A=r;A<M&&e.length>0;A++){const k=e.shift();k.abortController.signal.aborted?A--:m(k)}},w=(M,A)=>new Promise((k,O)=>{const F=new Image,$=M.url,q=M.credentials;q&&q==="include"?F.crossOrigin="use-credentials":(q&&q==="same-origin"||!u.d($))&&(F.crossOrigin="anonymous"),A.signal.addEventListener("abort",()=>{F.src="",O(u.c())}),F.fetchPriority="high",F.onload=()=>{F.onerror=F.onload=null,k({data:F})},F.onerror=()=>{F.onerror=F.onload=null,A.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},F.src=$})}(at||(at={})),at.resetRequestQueue();class Oe{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ut(d){const e=[];if(typeof d=="string")e.push({id:"default",url:d});else if(d&&d.length>0){const r=[];for(const{id:l,url:h}of d){const m=`${l}${h}`;r.indexOf(m)===-1&&(r.push(m),e.push({id:l,url:h}))}}return e}function yt(d,e,r){try{const l=new URL(d);return l.pathname+=`${e}${r}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${d}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class xt{constructor(e,r,l,h){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(r,h)}update(e,r,l){const{width:h,height:m}=e,v=!(this.size&&this.size[0]===h&&this.size[1]===m||l),{context:w}=this,{gl:M}=w;if(this.useMipmap=!!(r&&r.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!r||r.premultiply!==!1)),v)this.size=[h,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,e):M.texImage2D(M.TEXTURE_2D,0,this.format,h,m,0,this.format,M.UNSIGNED_BYTE,e.data);else{const{x:A,y:k}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||u.b(e)?M.texSubImage2D(M.TEXTURE_2D,0,A,k,M.RGBA,M.UNSIGNED_BYTE,e):M.texSubImage2D(M.TEXTURE_2D,0,A,k,h,m,M.RGBA,M.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(e,r,l){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),l!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,l||e),this.filter=e),r!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function lt(d){const{userImage:e}=d;return!!(e&&e.render&&e.render())&&(d.data.replace(new Uint8Array(e.data.buffer)),!0)}class Q extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:l}of this.requestors)l(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const l=r.spriteData;r.data=new u.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let l=!0;const h=r.data||r.spriteData;return this._validateStretch(r.stretchX,h&&h.width)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,h&&h.height)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new u.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,r){if(!e)return!0;let l=0;for(const h of e){if(h[0]<l||h[1]<h[0]||r<h[1])return!1;l=h[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const l=r.spriteData,h=l&&l.width||r.data.width,m=l&&l.height||r.data.height;return!(e[0]<0||h<e[0]||e[1]<0||m<e[1]||e[2]<0||h<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,l=!0){const h=this.getImage(e);if(l&&(h.data.width!==r.data.width||h.data.height!==r.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=h.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,l)=>{let h=!0;if(!this.isLoaded())for(const m of e)this.images[m]||(h=!1);this.isLoaded()||h?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const l of e){let h=this.getImage(l);h||(this.fire(new u.l("styleimagemissing",{id:l})),h=this.getImage(l)),h?r[l]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:u.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],l=this.getImage(e);if(!l)return null;if(r&&r.position.version===l.version)return r.position;if(r)r.position.version=l.version;else{const h={w:l.data.width+2,h:l.data.height+2,x:0,y:0},m=new u.I(h,l);this.patterns[e]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new xt(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const m in this.patterns)e.push(this.patterns[m].bin);const{w:r,h:l}=u.p(e),h=this.atlasImage;h.resize({width:r||1,height:l||1});for(const m in this.patterns){const{bin:v}=this.patterns[m],w=v.x+1,M=v.y+1,A=this.getImage(m).data,k=A.width,O=A.height;u.R.copy(A,h,{x:0,y:0},{x:w,y:M},{width:k,height:O}),u.R.copy(A,h,{x:0,y:O-1},{x:w,y:M-1},{width:k,height:1}),u.R.copy(A,h,{x:0,y:0},{x:w,y:M+O},{width:k,height:1}),u.R.copy(A,h,{x:k-1,y:0},{x:w-1,y:M},{width:1,height:O}),u.R.copy(A,h,{x:0,y:0},{x:w+k,y:M},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const l=this.getImage(r);l||u.w(`Image with ID: "${r}" was not found`),lt(l)&&this.updateImage(r,l)}}}const st=1e20;function Et(d,e,r,l,h,m,v,w,M){for(let A=e;A<e+l;A++)Vt(d,r*m+A,m,h,v,w,M);for(let A=r;A<r+h;A++)Vt(d,A*m+e,1,l,v,w,M)}function Vt(d,e,r,l,h,m,v){m[0]=0,v[0]=-1e20,v[1]=st,h[0]=d[e];for(let w=1,M=0,A=0;w<l;w++){h[w]=d[e+w*r];const k=w*w;do{const O=m[M];A=(h[w]-h[O]+k-O*O)/(w-O)/2}while(A<=v[M]&&--M>-1);M++,m[M]=w,v[M]=A,v[M+1]=st}for(let w=0,M=0;w<l;w++){for(;v[M+1]<w;)M++;const A=m[M],k=w-A;d[e+w*r]=h[A]+k*k}}class ei{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return u._(this,void 0,void 0,function*(){const r=[];for(const m in e)for(const v of e[m])r.push(this._getAndCacheGlyphsPromise(m,v));const l=yield Promise.all(r),h={};for(const{stack:m,id:v,glyph:w}of l)h[m]||(h[m]={}),h[m][v]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return h})}_getAndCacheGlyphsPromise(e,r){return u._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=l.glyphs[r];if(h!==void 0)return{stack:e,id:r,glyph:h};if(h=this._tinySDF(l,e,r),h)return l.glyphs[r]=h,{stack:e,id:r,glyph:h};const m=Math.floor(r/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[m])return{stack:e,id:r,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[m]){const w=ei.loadGlyphRange(e,m,this.url,this.requestManager);l.requests[m]=w}const v=yield l.requests[m];for(const w in v)this._doesCharSupportLocalGlyph(+w)||(l.glyphs[+w]=v[+w]);return l.ranges[m]=!0,{stack:e,id:r,glyph:v[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||u.u["CJK Unified Ideographs"](e)||u.u["Hangul Syllables"](e)||u.u.Hiragana(e)||u.u.Katakana(e)||u.u["CJK Symbols and Punctuation"](e)||u.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,l){const h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(l))return;let m=e.tinySDF;if(!m){let w="400";/bold/i.test(r)?w="900":/medium/i.test(r)?w="500":/light/i.test(r)&&(w="200"),m=e.tinySDF=new ei.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:w})}const v=m.draw(String.fromCharCode(l));return{id:l,bitmap:new u.q({width:v.width||60,height:v.height||60},v.data),metrics:{width:v.glyphWidth/2||24,height:v.glyphHeight/2||24,left:v.glyphLeft/2+.5||0,top:v.glyphTop/2-27.5||-8,advance:v.glyphAdvance/2||24,isDoubleResolution:!0}}}}ei.loadGlyphRange=function(d,e,r,l){return u._(this,void 0,void 0,function*(){const h=256*e,m=h+255,v=l.transformRequest(r.replace("{fontstack}",d).replace("{range}",`${h}-${m}`),"Glyphs"),w=yield u.n(v,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${m}`);const M={};for(const A of u.o(w.data))M[A.id]=A;return M})},ei.TinySDF=class{constructor({fontSize:d=24,buffer:e=3,radius:r=8,cutoff:l=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=r;const w=this.size=d+4*e,M=this._createCanvas(w),A=this.ctx=M.getContext("2d",{willReadFrequently:!0});A.font=`${v} ${m} ${d}px ${h}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(d){const e=document.createElement("canvas");return e.width=e.height=d,e}draw(d){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(d),v=Math.ceil(r),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),M=Math.min(this.size-this.buffer,v+Math.ceil(l)),A=w+2*this.buffer,k=M+2*this.buffer,O=Math.max(A*k,0),F=new Uint8ClampedArray(O),$={data:F,width:A,height:k,glyphWidth:w,glyphHeight:M,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(w===0||M===0)return $;const{ctx:q,buffer:te,gridInner:ee,gridOuter:ie}=this;q.clearRect(te,te,w,M),q.fillText(d,te,te+v);const se=q.getImageData(te,te,w,M);ie.fill(st,0,O),ee.fill(0,0,O);for(let fe=0;fe<M;fe++)for(let de=0;de<w;de++){const pe=se.data[4*(fe*w+de)+3]/255;if(pe===0)continue;const ye=(fe+te)*A+de+te;if(pe===1)ie[ye]=0,ee[ye]=st;else{const ge=.5-pe;ie[ye]=ge>0?ge*ge:0,ee[ye]=ge<0?ge*ge:0}}Et(ie,0,0,A,k,A,this.f,this.v,this.z),Et(ee,te,te,w,M,A,this.f,this.v,this.z);for(let fe=0;fe<O;fe++){const de=Math.sqrt(ie[fe])-Math.sqrt(ee[fe]);F[fe]=Math.round(255-255*(de/this.radius+this.cutoff))}return $}};class di{constructor(){this.specification=u.v.light.position}possiblyEvaluate(e,r){return u.z(e.expression.evaluate(r))}interpolate(e,r,l){return{x:u.B.number(e.x,r.x,l),y:u.B.number(e.y,r.y,l),z:u.B.number(e.z,r.z,l)}}}let Je;class Zt extends u.E{constructor(e){super(),Je=Je||new u.r({anchor:new u.D(u.v.light.anchor),position:new di,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(Je),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(u.t,e,r))for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l){return(!l||l.validate!==!1)&&u.x(this,e.call(u.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const kt=new u.r({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class Wt extends u.E{constructor(e){super(),this._transitionable=new u.T(kt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.C(0))}setSky(e,r={}){if(!this._validate(u.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const h=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l={}){return(l==null?void 0:l.validate)!==!1&&u.x(this,e.call(u.y,u.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class ve{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const l=e.join(",")+String(r);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,r)),this.dashEntry[l]}getDashRanges(e,r,l){const h=[];let m=e.length%2==1?-e[e.length-1]*l:0,v=e[0]*l,w=!0;h.push({left:m,right:v,isDash:w,zeroLength:e[0]===0});let M=e[0];for(let A=1;A<e.length;A++){w=!w;const k=e[A];m=M*l,M+=k,v=M*l,h.push({left:m,right:v,isDash:w,zeroLength:k===0})}return h}addRoundDash(e,r,l){const h=r/2;for(let m=-l;m<=l;m++){const v=this.width*(this.nextRow+l+m);let w=0,M=e[w];for(let A=0;A<this.width;A++){A/M.right>1&&(M=e[++w]);const k=Math.abs(A-M.left),O=Math.abs(A-M.right),F=Math.min(k,O);let $;const q=m/l*(h+1);if(M.isDash){const te=h-Math.abs(q);$=Math.sqrt(F*F+te*te)}else $=h-Math.sqrt(F*F+q*q);this.data[v+A]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const M=e[w],A=e[w+1];M.zeroLength?e.splice(w,1):A&&A.isDash===M.isDash&&(A.left=M.left,e.splice(w,1))}const r=e[0],l=e[e.length-1];r.isDash===l.isDash&&(r.left=l.left-this.width,l.right=r.right+this.width);const h=this.width*this.nextRow;let m=0,v=e[m];for(let w=0;w<this.width;w++){w/v.right>1&&(v=e[++m]);const M=Math.abs(w-v.left),A=Math.abs(w-v.right),k=Math.min(M,A);this.data[h+w]=Math.max(0,Math.min(255,(v.isDash?k:-k)+128))}}addDash(e,r){const l=r?7:0,h=2*l+1;if(this.nextRow+h>this.height)return u.w("LineAtlas out of space"),null;let m=0;for(let w=0;w<e.length;w++)m+=e[w];if(m!==0){const w=this.width/m,M=this.getDashRanges(e,this.width,w);r?this.addRoundDash(M,w,l):this.addRegularDash(M)}const v={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:m};return this.nextRow+=h,this.dirty=!0,v}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const rt="maplibre_preloaded_worker_pool";class At{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[rt]}numActive(){return Object.keys(this.active).length}}const Lt=Math.floor(be.hardwareConcurrency/2);let wt,Xt;function Yt(){return wt||(wt=new At),wt}At.workerCount=u.G(globalThis)?Math.max(Math.min(Lt,3),1):1;class Xi{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const l=this.workerPool.acquire(r);for(let h=0;h<l.length;h++){const m=new u.H(l[h],r);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const l=[];for(const h of this.actors)l.push(h.sendAsync({type:e,data:r}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const l of this.actors)l.registerMessageHandler(e,r)}}function hi(){return Xt||(Xt=new Xi(Yt(),u.J),Xt.registerMessageHandler("GR",(d,e,r)=>u.m(e,r))),Xt}function vi(d,e){const r=u.K();return u.L(r,r,[1,1,0]),u.M(r,r,[.5*d.width,.5*d.height,1]),d.calculatePosMatrix?u.N(r,r,d.calculatePosMatrix(e.toUnwrapped())):r}function Ci(d,e,r,l,h,m){var v;const w=function(O,F,$){if(O)for(const q of O){const te=F[q];if(te&&te.source===$&&te.type==="fill-extrusion")return!0}else for(const q in F){const te=F[q];if(te.source===$&&te.type==="fill-extrusion")return!0}return!1}((v=h==null?void 0:h.layers)!==null&&v!==void 0?v:null,e,d.id),M=m.maxPitchScaleFactor(),A=d.tilesIn(l,M,w);A.sort(Ai);const k=[];for(const O of A)k.push({wrappedTileID:O.tileID.wrapped().key,queryResults:O.tile.queryRenderedFeatures(e,r,d._state,O.queryGeometry,O.cameraQueryGeometry,O.scale,h,m,M,vi(d.transform,O.tileID))});return function(O,F){for(const $ in O)for(const q of O[$])Bi(q,F);return O}(function(O){const F={},$={};for(const q of O){const te=q.queryResults,ee=q.wrappedTileID,ie=$[ee]=$[ee]||{};for(const se in te){const fe=te[se],de=ie[se]=ie[se]||{},pe=F[se]=F[se]||[];for(const ye of fe)de[ye.featureIndex]||(de[ye.featureIndex]=!0,pe.push(ye))}}return F}(k),d)}function Ai(d,e){const r=d.tileID,l=e.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}function Bi(d,e){const r=d.feature,l=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=l}function zr(d,e,r){return u._(this,void 0,void 0,function*(){let l=d;if(d.url?l=(yield u.j(e.transformRequest(d.url,"Source"),r)).data:yield be.frameAsync(r),!l)return null;const h=u.O(u.e(l,d),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(h.vectorLayerIds=l.vector_layers.map(m=>m.id)),h})}class Ei{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof u.Q?new u.Q(e.lng,e.lat):u.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof u.Q?new u.Q(e.lng,e.lat):u.Q.convert(e),this}extend(e){const r=this._sw,l=this._ne;let h,m;if(e instanceof u.Q)h=e,m=e;else{if(!(e instanceof Ei))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ei.convert(e)):this.extend(u.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(u.Q.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return r||l?(r.lng=Math.min(h.lng,r.lng),r.lat=Math.min(h.lat,r.lat),l.lng=Math.max(m.lng,l.lng),l.lat=Math.max(m.lat,l.lat)):(this._sw=new u.Q(h.lng,h.lat),this._ne=new u.Q(m.lng,m.lat)),this}getCenter(){return new u.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.Q(this.getWest(),this.getNorth())}getSouthEast(){return new u.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=u.Q.convert(e);let h=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&h}static convert(e){return e instanceof Ei?e:e&&new Ei(e)}static fromLngLat(e,r=0){const l=360*r/40075017,h=l/Math.cos(Math.PI/180*e.lat);return new Ei(new u.Q(e.lng-h,e.lat-l),new u.Q(e.lng+h,e.lat+l))}adjustAntiMeridian(){const e=new u.Q(this._sw.lng,this._sw.lat),r=new u.Q(this._ne.lng,this._ne.lat);return new Ei(e,e.lng>r.lng?new u.Q(r.lng+360,r.lat):r)}}class qn{constructor(e,r,l){this.bounds=Ei.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),l=Math.floor(u.U(this.bounds.getWest())*r),h=Math.floor(u.S(this.bounds.getNorth())*r),m=Math.ceil(u.U(this.bounds.getEast())*r),v=Math.ceil(u.S(this.bounds.getSouth())*r);return e.x>=l&&e.x<m&&e.y>=h&&e.y<v}}class yn extends u.E{constructor(e,r,l,h){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.O(r,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield zr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(u.e(this,e),e.bounds&&(this.tileBounds=new qn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new u.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,v)=>{e.reloadPromise={resolve:m,reject:v}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{const m=yield e.actor.sendAsync({type:h,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Sr extends u.E{constructor(e,r,l,h){super(),this.id=e,this.dispatcher=l,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},r),u.e(this,u.O(r,["url","scheme","tileSize"]))}load(){return u._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield zr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(u.e(this,r),r.bounds&&(this.tileBounds=new qn(r.bounds,this.minzoom,this.maxzoom)),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new u.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return u.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield at.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const h=this.map.painter.context,m=h.gl,v=l.data;e.texture=this.map.painter.getTileTexture(v.width),e.texture?e.texture.update(v,{useMipmap:!0}):(e.texture=new xt(h,v,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class zi extends Sr{constructor(e,r,l,h){super(e,r,l,h),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const h=yield at.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){const m=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const v=u.b(m)&&u.V()?m:yield this.readImageNow(m),w={type:this.type,uid:e.uid,source:this.id,rawImageData:v,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const M=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=M,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.W()){const r=e.width+2,l=e.height+2;try{return new u.R({width:r,height:l},yield u.X(e,-1,-1,r,l))}catch{}}return be.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,l=Math.pow(2,r.z),h=(r.x-1+l)%l,m=r.x===0?e.wrap-1:e.wrap,v=(r.x+1+l)%l,w=r.x+1===l?e.wrap+1:e.wrap,M={};return M[new u.Y(e.overscaledZ,m,r.z,h,r.y).key]={backfilled:!1},M[new u.Y(e.overscaledZ,w,r.z,v,r.y).key]={backfilled:!1},r.y>0&&(M[new u.Y(e.overscaledZ,m,r.z,h,r.y-1).key]={backfilled:!1},M[new u.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},M[new u.Y(e.overscaledZ,w,r.z,v,r.y-1).key]={backfilled:!1}),r.y+1<l&&(M[new u.Y(e.overscaledZ,m,r.z,h,r.y+1).key]={backfilled:!1},M[new u.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},M[new u.Y(e.overscaledZ,w,r.z,v,r.y+1).key]={backfilled:!1}),M}unloadTile(e){return u._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class nn extends u.E{constructor(e,r,l,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(h),this._data=r.data,this._options=u.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:u.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:u.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(u.Z/this.tileSize)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return u._(this,void 0,void 0,function*(){const e=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:l}})}_updateWorkerData(e){return u._(this,void 0,void 0,function*(){const r=u.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(be.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new u.l("dataabort",{dataType:"source"}));let h=null;l.resourceTiming&&l.resourceTiming[this.id]&&(h=l.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&u.e(m,{resourceTiming:h}),this.fire(new u.l("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new u.l("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new u.l("dataabort",{dataType:"source"}));this.fire(new u.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return u._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const h=yield this.actor.sendAsync({type:r,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,r==="RT")})}abortTile(e){return u._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return u._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Pr extends u.E{constructor(e,r,l,h){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=r}load(e){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield at.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new u.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(u.$.fromLngLat);var l;return this.tileID=function(h){let m=1/0,v=1/0,w=-1/0,M=-1/0;for(const F of h)m=Math.min(m,F.x),v=Math.min(v,F.y),w=Math.max(w,F.x),M=Math.max(M,F.y);const A=Math.max(w-m,M-v),k=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),O=Math.pow(2,k);return new u.a0(k,Math.floor((m+w)/2*O),Math.floor((v+M)/2*O))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(h=>this.tileID.getTilePoint(h)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new u.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new xt(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class vn extends Pr{constructor(e,r,l,h){super(e,r,l,h),this.roundZoom=!0,this.type="video",this.options=r}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield u.a1(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new u.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new u.k(new u.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new xt(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const h in this.tiles){const m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,l=!0)}l&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class ti extends Pr{constructor(e,r,l,h){super(e,r,l,h),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(v=>typeof v!="number"))||this.fire(new u.k(new u.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.k(new u.a2(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new u.k(new u.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new u.k(new u.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.k(new u.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xt(r,this.canvas,l.RGBA,{premultiply:!0});let h=!1;for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,h=!0)}h&&this.fire(new u.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const rs={},Yr=d=>{switch(d){case"geojson":return nn;case"image":return Pr;case"raster":return Sr;case"raster-dem":return zi;case"vector":return yn;case"video":return vn;case"canvas":return ti}return rs[d]},bs="RTLPluginLoaded";class Fa extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=hi()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return u._(this,arguments,void 0,function*(r,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=be.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.l(bs))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let na=null;function Oi(){return na||(na=new Fa),na}class hr{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=u.a3(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const v={};if(!m)return v;for(const w of h){const M=w.layerIds.map(A=>m.getLayer(A)).filter(Boolean);if(M.length!==0){w.layers=M,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(A=>M.filter(k=>k.id===A)[0]));for(const A of M)v[A.id]=w}}return v}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a5){if(this.hasSymbolBuckets=!0,!l)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof u.a5&&m.hasRTLText){this.hasRTLText=!0,Oi().lazyLoad();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new u.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const h=this.buckets[l];h.uploadPending()&&h.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xt(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xt(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,l,h,m,v,w,M,A,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:v,tileSize:this.tileSize,pixelPosMatrix:k,transform:M,params:w,queryPadding:this.queryPadding*A},e,r,l):{}}querySourceFeatures(e,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const h=l.loadVTLayers(),m=r&&r.sourceLayer?r.sourceLayer:"",v=h._geojsonTileLayer||h[m];if(!v)return;const w=u.a6(r&&r.filter),{z:M,x:A,y:k}=this.tileID.canonical,O={z:M,x:A,y:k};for(let F=0;F<v.length;F++){const $=v.feature(F);if(w.needGeometry){const ee=u.a7($,!0);if(!w.filter(new u.C(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!w.filter(new u.C(this.tileID.overscaledZ),$))continue;const q=l.getId($,m),te=new u.a8($,M,A,k,q);te.tile=O,e.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const l=u.a9(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let h=!1;if(this.expirationTime>l)h=!1;else if(r)if(this.expirationTime<r)h=!0;else{const m=this.expirationTime-r;m?this.expirationTime=l+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const h in this.buckets){if(!r.style.hasLayer(h))continue;const m=this.buckets[h],v=m.layers[0].sourceLayer||"_geojsonTileLayer",w=l[v],M=e[v];if(!w||!M||Object.keys(M).length===0)continue;m.update(M,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const A=r&&r.style&&r.style.getLayer(h);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<be.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=be.now()+e}setDependencies(e,r){const l={};for(const h of r)l[h]=!0;this.dependencies[e]=l}hasDependency(e,r){for(const l of e){const h=this.dependencies[l];if(h){for(const m of r)if(h[m])return!0}}return!1}}class fr{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,l){const h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);const m={value:r,timeout:void 0};if(l!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},l)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const l=e.wrapped().key,h=r===void 0?0:this.data[l].indexOf(r),m=this.data[l][h];return this.data[l].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(m.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const l in this.data)for(const h of this.data[l])e(h.value)||r.push(h);for(const l of r)this.remove(l.value.tileID,l)}}class ja{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,l){const h=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},u.e(this.stateChanges[e][h],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(const m in this.state[e][h])l[m]||(this.deletedStates[e][h][m]=null)}else for(const m in l)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,r,l){if(this.deletedStates[e]===null)return;const h=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&r!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][l]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(l in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][l]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,r){const l=String(r),h=u.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const m=this.deletedStates[e][r];if(m===null)return{};for(const v in m)delete h[v]}return h}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const l={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const v in this.stateChanges[h])this.state[h][v]||(this.state[h][v]={}),u.e(this.state[h][v],this.stateChanges[h][v]),m[v]=this.state[h][v];l[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(this.deletedStates[h]===null)for(const v in this.state[h])m[v]={},this.state[h][v]={};else for(const v in this.deletedStates[h]){if(this.deletedStates[h][v]===null)this.state[h][v]={};else for(const w of Object.keys(this.deletedStates[h][v]))delete this.state[h][v][w];m[v]=this.state[h][v]}l[h]=l[h]||{},u.e(l[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const h in e)e[h].setFeatureState(l,r)}}function an(d,e,r){const l=e.intersectsFrustum(d);if(!r)return l;const h=e.intersectsPlane(r);return l===0||h===0?0:l===2&&h===2?2:1}function Kr(d,e,r,l,h){let m=d;const v=Math.atan(e/r),w=Math.hypot(e,r);return m=d+u.aa(l/w/Math.max(.5,Math.cos(u.ac(h/2)))),m+=1*u.aa(Math.cos(v))/2,m+=u.ad(d-m,-0,0),m}function Rr(d,e){const r=(e.roundZoom?Math.round:Math.floor)(d.zoom+u.aa(d.tileSize/e.tileSize));return Math.max(0,r)}function Ae(d,e){const r=d.getCameraFrustum(),l=d.getClippingPlane(),h=d.screenPointToMercatorCoordinate(d.getCameraPoint()),m=u.$.fromLngLat(d.center,d.elevation);h.z=m.z+Math.cos(d.pitchInRadians)*d.cameraToCenterDistance/d.worldSize;const v=d.getCoveringTilesDetailsProvider(),w=v.allowVariableZoom(d,e),M=Rr(d,e),A=e.minzoom||0,k=e.maxzoom!==void 0?e.maxzoom:d.maxZoom,O=Math.min(Math.max(0,M),k),F=Math.pow(2,O),$=[F*h.x,F*h.y,0],q=[F*m.x,F*m.y,0],te=Math.hypot(m.x-h.x,m.y-h.y),ee=Math.abs(m.z-h.z),ie=Math.hypot(te,ee),se=pe=>({zoom:0,x:0,y:0,wrap:pe,fullyVisible:!1}),fe=[],de=[];if(d.renderWorldCopies&&v.allowWorldCopies())for(let pe=1;pe<=3;pe++)fe.push(se(-pe)),fe.push(se(pe));for(fe.push(se(0));fe.length>0;){const pe=fe.pop(),ye=pe.x,ge=pe.y;let Ie=pe.fullyVisible;const Be={x:ye,y:ge,z:pe.zoom},$e=v.getTileAABB(Be,pe.wrap,d.elevation,e);if(!Ie){const ft=an(r,$e,l);if(ft===0)continue;Ie=ft===2}const qe=v.distanceToTile2d(h.x,h.y,Be,$e);let Ze=M;w&&(Ze=(e.calculateTileZoom||Kr)(d.zoom+u.aa(d.tileSize/e.tileSize),qe,ee,ie,d.fov)),Ze=(e.roundZoom?Math.round:Math.floor)(Ze),Ze=Math.max(0,Ze);const mt=Math.min(Ze,k);if(pe.wrap=v.getWrap(m,Be,pe.wrap),pe.zoom>=mt){if(pe.zoom<A)continue;const ft=O-pe.zoom,et=$[0]-.5-(ye<<ft),Rt=$[1]-.5-(ge<<ft),Ot=e.reparseOverscaled?Math.max(pe.zoom,Ze):pe.zoom;de.push({tileID:new u.Y(pe.zoom===k?Ot:pe.zoom,pe.wrap,pe.zoom,ye,ge),distanceSq:u.ab([q[0]-.5-ye,q[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(et*et+Rt*Rt)})}else for(let ft=0;ft<4;ft++)fe.push({zoom:pe.zoom+1,x:(ye<<1)+ft%2,y:(ge<<1)+(ft>>1),wrap:pe.wrap,fullyVisible:Ie})}return de.sort((pe,ye)=>pe.distanceSq-ye.distanceSq).map(pe=>pe.tileID)}class L extends u.E{constructor(e,r,l){super(),this.id=e,this.dispatcher=l,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,m,v,w)=>{const M=new(Yr(m.type))(h,m,v,w);if(M.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${M.id}`);return M})(e,r,l,this),this._tiles={},this._cache=new fr(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ja,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,l){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,l)}catch(h){e.state="errored",h.status!==404?this._source.fire(new u.k(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new u.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(X).map(e=>e.key)}getRenderableIds(e){const r=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&r.push(this._tiles[l]);return e?r.sort((l,h)=>{const m=l.tileID,v=h.tileID,w=new u.P(m.canonical.x,m.canonical.y)._rotate(-this.transform.bearingInRadians),M=new u.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians);return m.overscaledZ-v.overscaledZ||M.y-w.y||M.x-w.x}).map(l=>l.tileID.key):r.map(l=>l.tileID).sort(X).map(l=>l.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(e||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return u._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=r),yield this._loadTile(l,e,r))})}_tileLoaded(e,r,l){e.timeAdded=be.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new u.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let h=0;h<r.length;h++){const m=r[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const v=this.getTileByID(m);l(e,v),l(v,e)}}function l(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let v=m.tileID.canonical.x-h.tileID.canonical.x;const w=m.tileID.canonical.y-h.tileID.canonical.y,M=Math.pow(2,h.tileID.canonical.z),A=m.tileID.key;v===0&&w===0||Math.abs(w)>1||(Math.abs(v)>1&&(Math.abs(v+M)===1?v+=M:Math.abs(v-M)===1&&(v-=M)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,v,w),h.neighboringTiles&&h.neighboringTiles[A]&&(h.neighboringTiles[A].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,l,h){for(const m in this._tiles){let v=this._tiles[m];if(h[m]||!v.hasData()||v.tileID.overscaledZ<=r||v.tileID.overscaledZ>l)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>r+1;){const A=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[A.key],v&&v.hasData()&&(w=A)}let M=w;for(;M.overscaledZ>r;)if(M=M.scaledTo(M.overscaledZ-1),e[M.key]||e[M.canonical.key]){h[w.key]=w;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=e.overscaledZ-1;l>=r;l--){const h=e.scaledTo(l),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(r*l*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const l={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+r),l[m.tileID.key]=m}this._tiles=l;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,r,l,h,m,v){const w={},M={},A=Object.keys(e),k=be.now();for(const O of A){const F=e[O],$=this._tiles[O];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=k)continue;const q=this.findLoadedParent(F,r),te=this.findLoadedSibling(F),ee=q||te||null;ee&&(this._addTile(ee.tileID),w[ee.tileID.key]=ee.tileID),M[O]=F}this._retainLoadedChildren(M,h,l,e);for(const O in w)e[O]||(this._coveredTiles[O]=!0,e[O]=w[O]);if(v){const O={},F={};for(const $ of m)this._tiles[$.key].hasData()?O[$.key]=$:F[$.key]=$;for(const $ in F){const q=F[$].children(this._source.maxzoom);this._tiles[q[0].key]&&this._tiles[q[1].key]&&this._tiles[q[2].key]&&this._tiles[q[3].key]&&(O[q[0].key]=e[q[0].key]=q[0],O[q[1].key]=e[q[1].key]=q[1],O[q[2].key]=e[q[2].key]=q[2],O[q[3].key]=e[q[3].key]=q[3],delete F[$])}for(const $ in F){const q=F[$],te=this.findLoadedParent(q,this._source.minzoom),ee=this.findLoadedSibling(q),ie=te||ee||null;if(ie){O[ie.tileID.key]=e[ie.tileID.key]=ie.tileID;for(const se in O)O[se].isChildOf(ie.tileID)&&delete O[se]}}for(const $ in this._tiles)O[$]||(this._coveredTiles[$]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(k=>new u.Y(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y)):(l=Ae(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(k=>this._source.hasTile(k)))):l=[];const h=Rr(e,this._source),m=Math.max(h-L.maxOverzooming,this._source.minzoom),v=Math.max(h+L.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const k={};for(const O of l)if(O.canonical.z>this._source.minzoom){const F=O.scaledTo(O.canonical.z-1);k[F.key]=F;const $=O.scaledTo(Math.max(this._source.minzoom,Math.min(O.canonical.z,5)));k[$.key]=$}l=l.concat(Object.values(k))}const w=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new u.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const M=this._updateRetainedTiles(l,h);J(this._source.type)&&this._updateCoveredAndRetainedTiles(M,m,v,h,l,r);for(const k in M)this._tiles[k].clearFadeHold();const A=u.ae(this._tiles,M);for(const k of A){const O=this._tiles[k];O.hasSymbolBuckets&&!O.holdingForFade()?O.setHoldDuration(this.map._fadeDuration):O.hasSymbolBuckets&&!O.symbolFadeFinished()||this._removeTile(k)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var l;const h={},m={},v=Math.max(r-L.maxOverzooming,this._source.minzoom),w=Math.max(r+L.maxUnderzooming,this._source.minzoom),M={};for(const A of e){const k=this._addTile(A);h[A.key]=A,k.hasData()||r<this._source.maxzoom&&(M[A.key]=A)}this._retainLoadedChildren(M,r,w,h);for(const A of e){let k=this._tiles[A.key];if(k.hasData())continue;if(r+1>this._source.maxzoom){const F=A.children(this._source.maxzoom)[0],$=this.getTile(F);if($&&$.hasData()){h[F.key]=F;continue}}else{const F=A.children(this._source.maxzoom);if(h[F[0].key]&&h[F[1].key]&&h[F[2].key]&&h[F[3].key])continue}let O=k.wasRequested();for(let F=A.overscaledZ-1;F>=v;--F){const $=A.scaledTo(F);if(m[$.key])break;if(m[$.key]=!0,k=this.getTile($),!k&&O&&(k=this._addTile($)),k){const q=k.hasData();if((q||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||O)&&(h[$.key]=$),O=k.wasRequested(),q)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let l,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){l=this._loadedParentTiles[h.key];break}r.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(l=this._getLoadedTile(m),l)break;h=m}for(const m of r)this._loadedParentTiles[m]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,l=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=l}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const l=r;return r||(r=new hr(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,l||this._source.fire(new u.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=r.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,l){const h=[],m=this.transform;if(!m)return h;const v=l?m.getCameraQueryGeometry(e):e,w=e.map(q=>m.screenPointToMercatorCoordinate(q,this.terrain)),M=v.map(q=>m.screenPointToMercatorCoordinate(q,this.terrain)),A=this.getIds();let k=1/0,O=1/0,F=-1/0,$=-1/0;for(const q of M)k=Math.min(k,q.x),O=Math.min(O,q.y),F=Math.max(F,q.x),$=Math.max($,q.y);for(let q=0;q<A.length;q++){const te=this._tiles[A[q]];if(te.holdingForFade())continue;const ee=te.tileID,ie=Math.pow(2,m.zoom-te.tileID.overscaledZ),se=r*te.queryPadding*u.Z/te.tileSize/ie,fe=[ee.getTilePoint(new u.$(k,O)),ee.getTilePoint(new u.$(F,$))];if(fe[0].x-se<u.Z&&fe[0].y-se<u.Z&&fe[1].x+se>=0&&fe[1].y+se>=0){const de=w.map(ye=>ee.getTilePoint(ye)),pe=M.map(ye=>ee.getTilePoint(ye));h.push({tile:te,tileID:ee,queryGeometry:de,cameraQueryGeometry:pe,scale:ie})}}return h}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(J(this._source.type)){const e=be.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,l){this._state.updateState(e=e||"_geojsonTileLayer",r,l)}removeFeatureState(e,r,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,l)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,l){const h=this._tiles[e];h&&h.setDependencies(r,l)}reloadTilesForDependencies(e,r){for(const l in this._tiles)this._tiles[l].hasDependency(e,r)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,r))}}function X(d,e){const r=Math.abs(2*d.wrap)-+(d.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return d.overscaledZ-e.overscaledZ||l-r||e.canonical.y-d.canonical.y||e.canonical.x-d.canonical.x}function J(d){return d==="raster"||d==="image"||d==="video"}L.maxOverzooming=10,L.maxUnderzooming=3;class ne{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=u.ad(e,0,1);let r=1,l=this._distances[r];const h=e*this.paddedLength+this.padding;for(;l<h&&r<this._distances.length;)l=this._distances[++r];const m=r-1,v=this._distances[m],w=l-v,M=w>0?(h-v)/w:0;return this.points[m].mult(1-M).add(this.points[r].mult(M))}}function me(d,e){let r=!0;return d==="always"||d!=="never"&&e!=="never"||(r=!1),r}class Se{constructor(e,r,l){const h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let v=0;v<this.xCellCount*this.yCellCount;v++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,l,h,m){this._forEachCell(r,l,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(e,r,l,h){this._forEachCell(r-h,l-h,r+h,l+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(l),this.circles.push(h)}_insertBoxCell(e,r,l,h,m,v){this.boxCells[m].push(v)}_insertCircleCell(e,r,l,h,m,v){this.circleCells[m].push(v)}_query(e,r,l,h,m,v,w){if(l<0||e>this.width||h<0||r>this.height)return[];const M=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=h){if(m)return[{key:null,x1:e,y1:r,x2:l,y2:h}];for(let A=0;A<this.boxKeys.length;A++)M.push({key:this.boxKeys[A],x1:this.bboxes[4*A],y1:this.bboxes[4*A+1],x2:this.bboxes[4*A+2],y2:this.bboxes[4*A+3]});for(let A=0;A<this.circleKeys.length;A++){const k=this.circles[3*A],O=this.circles[3*A+1],F=this.circles[3*A+2];M.push({key:this.circleKeys[A],x1:k-F,y1:O-F,x2:k+F,y2:O+F})}}else this._forEachCell(e,r,l,h,this._queryCell,M,{hitTest:m,overlapMode:v,seenUids:{box:{},circle:{}}},w);return M}query(e,r,l,h){return this._query(e,r,l,h,!1,null)}hitTest(e,r,l,h,m,v){return this._query(e,r,l,h,!0,m,v).length>0}hitTestCircle(e,r,l,h,m){const v=e-l,w=e+l,M=r-l,A=r+l;if(w<0||v>this.width||A<0||M>this.height)return!1;const k=[];return this._forEachCell(v,M,w,A,this._queryCellCircle,k,{hitTest:!0,overlapMode:h,circle:{x:e,y:r,radius:l},seenUids:{box:{},circle:{}}},m),k.length>0}_queryCell(e,r,l,h,m,v,w,M){const{seenUids:A,hitTest:k,overlapMode:O}=w,F=this.boxCells[m];if(F!==null){const q=this.bboxes;for(const te of F)if(!A.box[te]){A.box[te]=!0;const ee=4*te,ie=this.boxKeys[te];if(e<=q[ee+2]&&r<=q[ee+3]&&l>=q[ee+0]&&h>=q[ee+1]&&(!M||M(ie))&&(!k||!me(O,ie.overlapMode))&&(v.push({key:ie,x1:q[ee],y1:q[ee+1],x2:q[ee+2],y2:q[ee+3]}),k))return!0}}const $=this.circleCells[m];if($!==null){const q=this.circles;for(const te of $)if(!A.circle[te]){A.circle[te]=!0;const ee=3*te,ie=this.circleKeys[te];if(this._circleAndRectCollide(q[ee],q[ee+1],q[ee+2],e,r,l,h)&&(!M||M(ie))&&(!k||!me(O,ie.overlapMode))){const se=q[ee],fe=q[ee+1],de=q[ee+2];if(v.push({key:ie,x1:se-de,y1:fe-de,x2:se+de,y2:fe+de}),k)return!0}}}return!1}_queryCellCircle(e,r,l,h,m,v,w,M){const{circle:A,seenUids:k,overlapMode:O}=w,F=this.boxCells[m];if(F!==null){const q=this.bboxes;for(const te of F)if(!k.box[te]){k.box[te]=!0;const ee=4*te,ie=this.boxKeys[te];if(this._circleAndRectCollide(A.x,A.y,A.radius,q[ee+0],q[ee+1],q[ee+2],q[ee+3])&&(!M||M(ie))&&!me(O,ie.overlapMode))return v.push(!0),!0}}const $=this.circleCells[m];if($!==null){const q=this.circles;for(const te of $)if(!k.circle[te]){k.circle[te]=!0;const ee=3*te,ie=this.circleKeys[te];if(this._circlesCollide(q[ee],q[ee+1],q[ee+2],A.x,A.y,A.radius)&&(!M||M(ie))&&!me(O,ie.overlapMode))return v.push(!0),!0}}}_forEachCell(e,r,l,h,m,v,w,M){const A=this._convertToXCellCoord(e),k=this._convertToYCellCoord(r),O=this._convertToXCellCoord(l),F=this._convertToYCellCoord(h);for(let $=A;$<=O;$++)for(let q=k;q<=F;q++)if(m.call(this,e,r,l,h,this.xCellCount*q+$,v,w,M))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,l,h,m,v){const w=h-e,M=m-r,A=l+v;return A*A>w*w+M*M}_circleAndRectCollide(e,r,l,h,m,v,w){const M=(v-h)/2,A=Math.abs(e-(h+M));if(A>M+l)return!1;const k=(w-m)/2,O=Math.abs(r-(m+k));if(O>k+l)return!1;if(A<=M||O<=k)return!0;const F=A-M,$=O-k;return F*F+$*$<=l*l}}function Le(d,e,r){const l=u.K();if(!d){const{vecSouth:O,vecEast:F}=Ge(e),$=ae();$[0]=F[0],$[1]=F[1],$[2]=O[0],$[3]=O[1],h=$,(k=(v=(m=$)[0])*(A=m[3])-(M=m[2])*(w=m[1]))&&(h[0]=A*(k=1/k),h[1]=-w*k,h[2]=-M*k,h[3]=v*k),l[0]=$[0],l[1]=$[1],l[4]=$[2],l[5]=$[3]}var h,m,v,w,M,A,k;return u.M(l,l,[1/r,1/r,1]),l}function xe(d,e,r,l){if(d){const h=u.K();if(!e){const{vecSouth:m,vecEast:v}=Ge(r);h[0]=v[0],h[1]=v[1],h[4]=m[0],h[5]=m[1]}return u.M(h,h,[l,l,1]),h}return r.pixelsToClipSpaceMatrix}function Ge(d){const e=Math.cos(d.rollInRadians),r=Math.sin(d.rollInRadians),l=Math.cos(d.pitchInRadians),h=Math.cos(d.bearingInRadians),m=Math.sin(d.bearingInRadians),v=u.aj();v[0]=-h*l*r-m*e,v[1]=-m*l*r+h*e;const w=u.ak(v);w<1e-9?u.al(v):u.am(v,v,1/w);const M=u.aj();M[0]=h*l*e-m*r,M[1]=m*l*e+h*r;const A=u.ak(M);return A<1e-9?u.al(M):u.am(M,M,1/A),{vecEast:M,vecSouth:v}}function Ne(d,e,r,l){let h;l?(h=[d,e,l(d,e),1],u.ao(h,h,r)):(h=[d,e,0,1],Wr(h,h,r));const m=h[3];return{point:new u.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function Pe(d,e){return .5+d/e*.5}function We(d,e){return d.x>=-e[0]&&d.x<=e[0]&&d.y>=-e[1]&&d.y<=e[1]}function Re(d,e,r,l,h,m,v,w,M,A,k,O,F){const $=r?d.textSizeData:d.iconSizeData,q=u.af($,e.transform.zoom),te=[256/e.width*2+1,256/e.height*2+1],ee=r?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;ee.clear();const ie=d.lineVertexArray,se=r?d.text.placedSymbolArray:d.icon.placedSymbolArray,fe=e.transform.width/e.transform.height;let de=!1;for(let pe=0;pe<se.length;pe++){const ye=se.get(pe);if(ye.hidden||ye.writingMode===u.ag.vertical&&!de){Tr(ye.numGlyphs,ee);continue}de=!1;const ge=new u.P(ye.anchorX,ye.anchorY),Ie={getElevation:F,pitchedLabelPlaneMatrix:l,lineVertexArray:ie,pitchWithMap:m,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:ge,unwrappedTileID:M,width:A,height:k,translation:O},Be=li(ye.anchorX,ye.anchorY,Ie);if(!We(Be.point,te)){Tr(ye.numGlyphs,ee);continue}const $e=Pe(e.transform.cameraToCenterDistance,Be.signedDistanceFromCamera),qe=u.ah($,q,ye),Ze=m?qe*e.transform.getPitchedTextCorrection(ye.anchorX,ye.anchorY,M)/$e:qe*$e,mt=ii({projectionContext:Ie,pitchedLabelPlaneMatrixInverse:h,symbol:ye,fontSize:Ze,flip:!1,keepUpright:v,glyphOffsetArray:d.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:fe,rotateToLine:w});de=mt.useVertical,(mt.notEnoughRoom||de||mt.needsFlipping&&ii({projectionContext:Ie,pitchedLabelPlaneMatrixInverse:h,symbol:ye,fontSize:Ze,flip:!0,keepUpright:v,glyphOffsetArray:d.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:fe,rotateToLine:w}).notEnoughRoom)&&Tr(ye.numGlyphs,ee)}r?d.text.dynamicLayoutVertexBuffer.updateData(ee):d.icon.dynamicLayoutVertexBuffer.updateData(ee)}function _t(d,e,r,l,h,m,v,w){const M=m.glyphStartIndex+m.numGlyphs,A=m.lineStartIndex,k=m.lineStartIndex+m.lineLength,O=e.getoffsetX(m.glyphStartIndex),F=e.getoffsetX(M-1),$=Mt(d*O,r,l,h,m.segment,A,k,w,v);if(!$)return null;const q=Mt(d*F,r,l,h,m.segment,A,k,w,v);return q?w.projectionCache.anyProjectionOccluded?null:{first:$,last:q}:null}function Dt(d,e,r,l){return d===u.ag.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*l?{useVertical:!0}:(d===u.ag.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function ii(d){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:l,fontSize:h,flip:m,keepUpright:v,glyphOffsetArray:w,dynamicLayoutVertexArray:M,aspectRatio:A,rotateToLine:k}=d,O=h/24,F=l.lineOffsetX*O,$=l.lineOffsetY*O;let q;if(l.numGlyphs>1){const te=l.glyphStartIndex+l.numGlyphs,ee=l.lineStartIndex,ie=l.lineStartIndex+l.lineLength,se=_t(O,w,F,$,m,l,k,e);if(!se)return{notEnoughRoom:!0};const fe=Tt(se.first.point.x,se.first.point.y,e,r),de=Tt(se.last.point.x,se.last.point.y,e,r);if(v&&!m){const pe=Dt(l.writingMode,fe,de,A);if(pe)return pe}q=[se.first];for(let pe=l.glyphStartIndex+1;pe<te-1;pe++)q.push(Mt(O*w.getoffsetX(pe),F,$,m,l.segment,ee,ie,e,k));q.push(se.last)}else{if(v&&!m){const ee=zt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ie=l.lineStartIndex+l.segment+1,se=new u.P(e.lineVertexArray.getx(ie),e.lineVertexArray.gety(ie)),fe=zt(se.x,se.y,e),de=fe.signedDistanceFromCamera>0?fe.point:Ht(e.tileAnchorPoint,se,ee,1,e),pe=Tt(ee.x,ee.y,e,r),ye=Tt(de.x,de.y,e,r),ge=Dt(l.writingMode,pe,ye,A);if(ge)return ge}const te=Mt(O*w.getoffsetX(l.glyphStartIndex),F,$,m,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,k);if(!te||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};q=[te]}for(const te of q)u.an(M,te.point,te.angle);return{}}function Ht(d,e,r,l,h){const m=d.add(d.sub(e)._unit()),v=zt(m.x,m.y,h).point,w=r.sub(v);return r.add(w._mult(l/w.mag()))}function Xe(d,e,r){const l=e.projectionCache;if(l.projections[d])return l.projections[d];const h=new u.P(e.lineVertexArray.getx(d),e.lineVertexArray.gety(d)),m=zt(h.x,h.y,e);if(m.signedDistanceFromCamera>0)return l.projections[d]=m.point,l.anyProjectionOccluded=l.anyProjectionOccluded||m.isOccluded,m.point;const v=d-r.direction;return Ht(r.distanceFromAnchor===0?e.tileAnchorPoint:new u.P(e.lineVertexArray.getx(v),e.lineVertexArray.gety(v)),h,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function zt(d,e,r){const l=d+r.translation[0],h=e+r.translation[1];let m;return r.pitchWithMap?(m=Ne(l,h,r.pitchedLabelPlaneMatrix,r.getElevation),m.isOccluded=!1):(m=r.transform.projectTileCoordinates(l,h,r.unwrappedTileID,r.getElevation),m.point.x=(.5*m.point.x+.5)*r.width,m.point.y=(.5*-m.point.y+.5)*r.height),m}function Tt(d,e,r,l){if(r.pitchWithMap){const h=[d,e,0,1];return u.ao(h,h,l),r.transform.projectTileCoordinates(h[0]/h[3],h[1]/h[3],r.unwrappedTileID,r.getElevation).point}return{x:d/r.width*2-1,y:e/r.height*2-1}}function li(d,e,r){return r.transform.projectTileCoordinates(d,e,r.unwrappedTileID,r.getElevation)}function Nt(d,e,r){return d._unit()._perp()._mult(e*r)}function $t(d,e,r,l,h,m,v,w,M){if(w.projectionCache.offsets[d])return w.projectionCache.offsets[d];const A=r.add(e);if(d+M.direction<l||d+M.direction>=h)return w.projectionCache.offsets[d]=A,A;const k=Xe(d+M.direction,w,M),O=Nt(k.sub(r),v,M.direction),F=r.add(O),$=k.add(O);return w.projectionCache.offsets[d]=u.ap(m,A,F,$)||A,w.projectionCache.offsets[d]}function Mt(d,e,r,l,h,m,v,w,M){const A=l?d-e:d+e;let k=A>0?1:-1,O=0;l&&(k*=-1,O=Math.PI),k<0&&(O+=Math.PI);let F,$=k>0?m+h:m+h+1;w.projectionCache.cachedAnchorPoint?F=w.projectionCache.cachedAnchorPoint:(F=zt(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=F);let q,te,ee=F,ie=F,se=0,fe=0;const de=Math.abs(A),pe=[];let ye;for(;se+fe<=de;){if($+=k,$<m||$>=v)return null;se+=fe,ie=ee,te=q;const Be={absOffsetX:de,direction:k,distanceFromAnchor:se,previousVertex:ie};if(ee=Xe($,w,Be),r===0)pe.push(ie),ye=ee.sub(ie);else{let $e;const qe=ee.sub(ie);$e=qe.mag()===0?Nt(Xe($+k,w,Be).sub(ee),r,k):Nt(qe,r,k),te||(te=ie.add($e)),q=$t($,$e,ee,m,v,te,r,w,Be),pe.push(te),ye=q.sub(te)}fe=ye.mag()}const ge=ye._mult((de-se)/fe)._add(te||ie),Ie=O+Math.atan2(ee.y-ie.y,ee.x-ie.x);return pe.push(ge),{point:ge,angle:M?Ie:0,path:pe}}const ba=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Tr(d,e){for(let r=0;r<d;r++){const l=e.length;e.resize(l+4),e.float32.set(ba,3*l)}}function Wr(d,e,r){const l=e[0],h=e[1];return d[0]=r[0]*l+r[4]*h+r[12],d[1]=r[1]*l+r[5]*h+r[13],d[3]=r[3]*l+r[7]*h+r[15],d}const Yi=100;class ic{constructor(e,r=new Se(e.width+200,e.height+200,25),l=new Se(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Yi,this.screenBottomBoundary=e.height+Yi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,l,h,m,v,w,M,A,k,O,F){const $=this.projectAndGetPerspectiveRatio(e.anchorPointX+M[0],e.anchorPointY+M[1],m,k,F),q=l*$.perspectiveRatio;let te;if(v||w)te=this._projectCollisionBox(e,q,h,m,v,w,M,$,k,O,F);else{const ye=$.x+(O?O.x*q:0),ge=$.y+(O?O.y*q:0);te={allPointsOccluded:!1,box:[ye+e.x1*q,ge+e.y1*q,ye+e.x2*q,ge+e.y2*q]}}const[ee,ie,se,fe]=te.box,de=v?te.allPointsOccluded:$.isOccluded;let pe=de;return pe||(pe=$.perspectiveRatio<this.perspectiveRatioCutoff),pe||(pe=!this.isInsideGrid(ee,ie,se,fe)),pe||r!=="always"&&this.grid.hitTest(ee,ie,se,fe,r,A)?{box:[ee,ie,se,fe],placeable:!1,offscreen:!1,occluded:de}:{box:[ee,ie,se,fe],placeable:!0,offscreen:this.isOffscreen(ee,ie,se,fe),occluded:de}}placeCollisionCircles(e,r,l,h,m,v,w,M,A,k,O,F,$,q){const te=[],ee=new u.P(r.anchorX,r.anchorY),ie=this.getPerspectiveRatio(ee.x,ee.y,v,q),se=(A?m*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,v)/ie:m*ie)/u.au,fe={getElevation:q,pitchedLabelPlaneMatrix:w,lineVertexArray:l,pitchWithMap:A,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ee,unwrappedTileID:v,width:this.transform.width,height:this.transform.height,translation:$},de=_t(se,h,r.lineOffsetX*se,r.lineOffsetY*se,!1,r,!1,fe);let pe=!1,ye=!1,ge=!0;if(de){const Ie=.5*O*ie+F,Be=new u.P(-100,-100),$e=new u.P(this.screenRightBoundary,this.screenBottomBoundary),qe=new ne,Ze=de.first,mt=de.last;let ft=[];for(let Ot=Ze.path.length-1;Ot>=1;Ot--)ft.push(Ze.path[Ot]);for(let Ot=1;Ot<mt.path.length;Ot++)ft.push(mt.path[Ot]);const et=2.5*Ie;if(A){const Ot=this.projectPathToScreenSpace(ft,fe);ft=Ot.some(Mi=>Mi.signedDistanceFromCamera<=0)?[]:Ot.map(Mi=>Mi.point)}let Rt=[];if(ft.length>0){const Ot=ft[0].clone(),Mi=ft[0].clone();for(let Vi=1;Vi<ft.length;Vi++)Ot.x=Math.min(Ot.x,ft[Vi].x),Ot.y=Math.min(Ot.y,ft[Vi].y),Mi.x=Math.max(Mi.x,ft[Vi].x),Mi.y=Math.max(Mi.y,ft[Vi].y);Rt=Ot.x>=Be.x&&Mi.x<=$e.x&&Ot.y>=Be.y&&Mi.y<=$e.y?[ft]:Mi.x<Be.x||Ot.x>$e.x||Mi.y<Be.y||Ot.y>$e.y?[]:u.aq([ft],Be.x,Be.y,$e.x,$e.y)}for(const Ot of Rt){qe.reset(Ot,.25*Ie);let Mi=0;Mi=qe.length<=.5*Ie?1:Math.ceil(qe.paddedLength/et)+1;for(let Vi=0;Vi<Mi;Vi++){const Di=Vi/Math.max(Mi-1,1),Li=qe.lerp(Di),Fi=Li.x+Yi,bi=Li.y+Yi;te.push(Fi,bi,Ie,0);const Ii=Fi-Ie,Jr=bi-Ie,Zi=Fi+Ie,er=bi+Ie;if(ge=ge&&this.isOffscreen(Ii,Jr,Zi,er),ye=ye||this.isInsideGrid(Ii,Jr,Zi,er),e!=="always"&&this.grid.hitTestCircle(Fi,bi,Ie,e,k)&&(pe=!0,!M))return{circles:[],offscreen:!1,collisionDetected:pe}}}}return{circles:!M&&pe||!ye||ie<this.perspectiveRatioCutoff?[]:te,offscreen:ge,collisionDetected:pe}}projectPathToScreenSpace(e,r){const l=function(h,m){const v=u.K();return u.ai(v,m.pitchedLabelPlaneMatrix),h.map(w=>{const M=Ne(w.x,w.y,v,m.getElevation),A=m.transform.projectTileCoordinates(M.point.x,M.point.y,m.unwrappedTileID,m.getElevation);return A.point.x=(.5*A.point.x+.5)*m.width,A.point.y=(.5*-A.point.y+.5)*m.height,A})}(e,r);return function(h){let m=0,v=0,w=0,M=0;for(let A=0;A<h.length;A++)h[A].isOccluded?(w=A+1,M=0):(M++,M>v&&(v=M,m=w));return h.slice(m,m+v)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,h=1/0,m=-1/0,v=-1/0;for(const k of e){const O=new u.P(k.x+Yi,k.y+Yi);l=Math.min(l,O.x),h=Math.min(h,O.y),m=Math.max(m,O.x),v=Math.max(v,O.y),r.push(O)}const w=this.grid.query(l,h,m,v).concat(this.ignoredGrid.query(l,h,m,v)),M={},A={};for(const k of w){const O=k.key;if(M[O.bucketInstanceId]===void 0&&(M[O.bucketInstanceId]={}),M[O.bucketInstanceId][O.featureIndex])continue;const F=[new u.P(k.x1,k.y1),new u.P(k.x2,k.y1),new u.P(k.x2,k.y2),new u.P(k.x1,k.y2)];u.ar(r,F)&&(M[O.bucketInstanceId][O.featureIndex]=!0,A[O.bucketInstanceId]===void 0&&(A[O.bucketInstanceId]=[]),A[O.bucketInstanceId].push(O.featureIndex))}return A}insertCollisionBox(e,r,l,h,m,v){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:v,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,l,h,m,v){const w=l?this.ignoredGrid:this.grid,M={bucketInstanceId:h,featureIndex:m,collisionGroupID:v,overlapMode:r};for(let A=0;A<e.length;A+=4)w.insertCircle(M,e[A],e[A+1],e[A+2])}projectAndGetPerspectiveRatio(e,r,l,h,m){if(m){let v;h?(v=[e,r,h(e,r),1],u.ao(v,v,m)):(v=[e,r,0,1],Wr(v,v,m));const w=v[3];return{x:(v[0]/w+1)/2*this.transform.width+Yi,y:(-v[1]/w+1)/2*this.transform.height+Yi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const v=this.transform.projectTileCoordinates(e,r,l,h);return{x:(v.point.x+1)/2*this.transform.width+Yi,y:(1-v.point.y)/2*this.transform.height+Yi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5,isOccluded:v.isOccluded,signedDistanceFromCamera:v.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,l,h){const m=this.transform.projectTileCoordinates(e,r,l,h);return .5+this.transform.cameraToCenterDistance/m.signedDistanceFromCamera*.5}isOffscreen(e,r,l,h){return l<Yi||e>=this.screenRightBoundary||h<Yi||r>this.screenBottomBoundary}isInsideGrid(e,r,l,h){return l>=0&&e<this.gridRightBoundary&&h>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=u.as([]);return u.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,l,h,m,v,w,M,A,k,O){let F=1,$=0,q=0,te=1;const ee=e.anchorPointX+w[0],ie=e.anchorPointY+w[1];if(v&&!m){const ft=this.projectAndGetPerspectiveRatio(ee+1,ie,h,A,O),et=ft.x-M.x,Rt=Math.atan((ft.y-M.y)/et)+(et<0?Math.PI:0),Ot=Math.sin(Rt),Mi=Math.cos(Rt);F=Mi,$=Ot,q=-Ot,te=Mi}else if(!v&&m){const ft=Ge(this.transform);F=ft.vecEast[0],$=ft.vecEast[1],q=ft.vecSouth[0],te=ft.vecSouth[1]}let se=M.x,fe=M.y,de=r;m&&(se=ee,fe=ie,de=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),de*=this.transform.getPitchedTextCorrection(ee,ie,h),k||(de*=u.ad(.5+M.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),k&&(se+=F*k.x*de+q*k.y*de,fe+=$*k.x*de+te*k.y*de);const pe=e.x1*de,ye=e.x2*de,ge=(pe+ye)/2,Ie=e.y1*de,Be=e.y2*de,$e=(Ie+Be)/2,qe=[{offsetX:pe,offsetY:Ie},{offsetX:ge,offsetY:Ie},{offsetX:ye,offsetY:Ie},{offsetX:ye,offsetY:$e},{offsetX:ye,offsetY:Be},{offsetX:ge,offsetY:Be},{offsetX:pe,offsetY:Be},{offsetX:pe,offsetY:$e}];let Ze=[];for(const{offsetX:ft,offsetY:et}of qe)Ze.push(new u.P(se+F*ft+q*et,fe+$*ft+te*et));let mt=!1;if(m){const ft=Ze.map(et=>this.projectAndGetPerspectiveRatio(et.x,et.y,h,A,O));mt=ft.some(et=>!et.isOccluded),Ze=ft.map(et=>new u.P(et.x,et.y))}else mt=!0;return{box:u.at(Ze),allPointsOccluded:!mt}}}class sn{constructor(e,r,l,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):h&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Pi{constructor(e,r,l,h,m){this.text=new sn(e?e.text:null,r,l,m),this.icon=new sn(e?e.icon:null,r,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Gs{constructor(e,r,l){this.text=e,this.icon=r,this.skipFade=l}}class ns{constructor(e,r,l,h,m){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=h,this.tileID=m}}class Co{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[e]}}function aa(d,e,r,l,h){const{horizontalAlign:m,verticalAlign:v}=u.aA(d);return new u.P(-(m-.5)*e+l[0]*h,-(v-.5)*r+l[1]*h)}class dr{constructor(e,r,l,h,m){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new ic(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Co(h),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=m,m&&(m.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(l,h)=>r.getElevation(e,l,h):null}getBucketParts(e,r,l,h){const m=l.getBucket(r),v=l.latestFeatureIndex;if(!m||!v||r.id!==m.layerIds[0])return;const w=l.collisionBoxArray,M=m.layers[0].layout,A=m.layers[0].paint,k=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),O=l.tileSize/u.Z,F=l.tileID.toUnwrapped(),$=M.get("text-rotation-alignment")==="map",q=u.av(l,1,this.transform.zoom),te=u.aw(this.collisionIndex.transform,l,A.get("text-translate"),A.get("text-translate-anchor")),ee=u.aw(this.collisionIndex.transform,l,A.get("icon-translate"),A.get("icon-translate-anchor")),ie=Le($,this.transform,q);this.retainedQueryData[m.bucketInstanceId]=new ns(m.bucketInstanceId,v,m.sourceLayerIndex,m.index,l.tileID);const se={bucket:m,layout:M,translationText:te,translationIcon:ee,unwrappedTileID:F,pitchedLabelPlaneMatrix:ie,scale:k,textPixelRatio:O,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:u.af(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(const fe of m.sortKeyRanges){const{sortKey:de,symbolInstanceStart:pe,symbolInstanceEnd:ye}=fe;e.push({sortKey:de,symbolInstanceStart:pe,symbolInstanceEnd:ye,parameters:se})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:se})}attemptAnchorPlacement(e,r,l,h,m,v,w,M,A,k,O,F,$,q,te,ee,ie,se,fe,de){const pe=u.ax[e.textAnchor],ye=[e.textOffset0,e.textOffset1],ge=aa(pe,l,h,ye,m),Ie=this.collisionIndex.placeCollisionBox(r,F,M,A,k,w,v,ee,O.predicate,fe,ge,de);if((!se||this.collisionIndex.placeCollisionBox(se,F,M,A,k,w,v,ie,O.predicate,fe,ge,de).placeable)&&Ie.placeable){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:ye,width:l,height:h,anchor:pe,textBoxScale:m,prevAnchor:Be},this.markUsedJustification(q,pe,$,te),q.allowVerticalPlacement&&(this.markUsedOrientation(q,te,$),this.placedOrientations[$.crossTileID]=te),{shift:ge,placedGlyphBoxes:Ie}}}placeLayerBucketPart(e,r,l){const{bucket:h,layout:m,translationText:v,translationIcon:w,unwrappedTileID:M,pitchedLabelPlaneMatrix:A,textPixelRatio:k,holdingForFade:O,collisionBoxArray:F,partiallyEvaluatedTextSize:$,collisionGroup:q}=e.parameters,te=m.get("text-optional"),ee=m.get("icon-optional"),ie=u.ay(m,"text-overlap","text-allow-overlap"),se=ie==="always",fe=u.ay(m,"icon-overlap","icon-allow-overlap"),de=fe==="always",pe=m.get("text-rotation-alignment")==="map",ye=m.get("text-pitch-alignment")==="map",ge=m.get("icon-text-fit")!=="none",Ie=m.get("symbol-z-order")==="viewport-y",Be=se&&(de||!h.hasIconData()||ee),$e=de&&(se||!h.hasTextData()||te);!h.collisionArrays&&F&&h.deserializeCollisionBoxes(F);const qe=this.retainedQueryData[h.bucketInstanceId].tileID,Ze=this._getTerrainElevationFunc(qe),mt=this.transform.getFastPathSimpleProjectionMatrix(qe),ft=(et,Rt,Ot)=>{var Mi,Vi;if(r[et.crossTileID])return;if(O)return void(this.placements[et.crossTileID]=new Gs(!1,!1,!1));let Di=!1,Li=!1,Fi=!0,bi=null,Ii={box:null,placeable:!1,offscreen:null,occluded:!1},Jr={placeable:!1},Zi=null,er=null,or=null,Jn=0,Ka=0,Pa=0;Rt.textFeatureIndex?Jn=Rt.textFeatureIndex:et.useRuntimeCollisionCircles&&(Jn=et.featureIndex),Rt.verticalTextFeatureIndex&&(Ka=Rt.verticalTextFeatureIndex);const ga=Rt.textBox;if(ga){const _a=ji=>{let ki=u.ag.horizontal;if(h.allowVerticalPlacement&&!ji&&this.prevPlacement){const Vr=this.prevPlacement.placedOrientations[et.crossTileID];Vr&&(this.placedOrientations[et.crossTileID]=Vr,ki=Vr,this.markUsedOrientation(h,ki,et))}return ki},Qa=(ji,ki)=>{if(h.allowVerticalPlacement&&et.numVerticalGlyphVertices>0&&Rt.verticalTextBox){for(const Vr of h.writingModes)if(Vr===u.ag.vertical?(Ii=ki(),Jr=Ii):Ii=ji(),Ii&&Ii.placeable)break}else Ii=ji()},Ra=et.textAnchorOffsetStartIndex,ya=et.textAnchorOffsetEndIndex;if(ya===Ra){const ji=(ki,Vr)=>{const Zr=this.collisionIndex.placeCollisionBox(ki,ie,k,qe,M,ye,pe,v,q.predicate,Ze,void 0,mt);return Zr&&Zr.placeable&&(this.markUsedOrientation(h,Vr,et),this.placedOrientations[et.crossTileID]=Vr),Zr};Qa(()=>ji(ga,u.ag.horizontal),()=>{const ki=Rt.verticalTextBox;return h.allowVerticalPlacement&&et.numVerticalGlyphVertices>0&&ki?ji(ki,u.ag.vertical):{box:null,offscreen:null}}),_a(Ii&&Ii.placeable)}else{let ji=u.ax[(Vi=(Mi=this.prevPlacement)===null||Mi===void 0?void 0:Mi.variableOffsets[et.crossTileID])===null||Vi===void 0?void 0:Vi.anchor];const ki=(Zr,$o,xf)=>{const en=Zr.x2-Zr.x1,tn=Zr.y2-Zr.y1,Ch=et.textBoxScale,ho=ge&&fe==="never"?$o:null;let ea=null,ku=ie==="never"?1:2,Eh="never";ji&&ku++;for(let fo=0;fo<ku;fo++){for(let El=Ra;El<ya;El++){const Ah=h.textAnchorOffsets.get(El);if(ji&&Ah.textAnchor!==ji)continue;const Rc=this.attemptAnchorPlacement(Ah,Zr,en,tn,Ch,pe,ye,k,qe,M,q,Eh,et,h,xf,v,w,ho,Ze);if(Rc&&(ea=Rc.placedGlyphBoxes,ea&&ea.placeable))return Di=!0,bi=Rc.shift,ea}ji?ji=null:Eh=ie}return l&&!ea&&(ea={box:this.collisionIndex.placeCollisionBox(ga,"always",k,qe,M,ye,pe,v,q.predicate,Ze,void 0,mt).box,offscreen:!1,placeable:!1,occluded:!1}),ea};Qa(()=>ki(ga,Rt.iconBox,u.ag.horizontal),()=>{const Zr=Rt.verticalTextBox;return h.allowVerticalPlacement&&(!Ii||!Ii.placeable)&&et.numVerticalGlyphVertices>0&&Zr?ki(Zr,Rt.verticalIconBox,u.ag.vertical):{box:null,occluded:!0,offscreen:null}}),Ii&&(Di=Ii.placeable,Fi=Ii.offscreen);const Vr=_a(Ii&&Ii.placeable);if(!Di&&this.prevPlacement){const Zr=this.prevPlacement.variableOffsets[et.crossTileID];Zr&&(this.variableOffsets[et.crossTileID]=Zr,this.markUsedJustification(h,Zr.anchor,et,Vr))}}}if(Zi=Ii,Di=Zi&&Zi.placeable,Fi=Zi&&Zi.offscreen,et.useRuntimeCollisionCircles){const _a=h.text.placedSymbolArray.get(et.centerJustifiedTextSymbolIndex),Qa=u.ah(h.textSizeData,$,_a),Ra=m.get("text-padding");er=this.collisionIndex.placeCollisionCircles(ie,_a,h.lineVertexArray,h.glyphOffsetArray,Qa,M,A,l,ye,q.predicate,et.collisionCircleDiameter,Ra,v,Ze),er.circles.length&&er.collisionDetected&&!l&&u.w("Collisions detected, but collision boxes are not shown"),Di=se||er.circles.length>0&&!er.collisionDetected,Fi=Fi&&er.offscreen}if(Rt.iconFeatureIndex&&(Pa=Rt.iconFeatureIndex),Rt.iconBox){const _a=Qa=>this.collisionIndex.placeCollisionBox(Qa,fe,k,qe,M,ye,pe,w,q.predicate,Ze,ge&&bi?bi:void 0,mt);Jr&&Jr.placeable&&Rt.verticalIconBox?(or=_a(Rt.verticalIconBox),Li=or.placeable):(or=_a(Rt.iconBox),Li=or.placeable),Fi=Fi&&or.offscreen}const uo=te||et.numHorizontalGlyphVertices===0&&et.numVerticalGlyphVertices===0,Wa=ee||et.numIconVertices===0;uo||Wa?Wa?uo||(Li=Li&&Di):Di=Li&&Di:Li=Di=Li&&Di;const ms=Li&&or.placeable;if(Di&&Zi.placeable&&this.collisionIndex.insertCollisionBox(Zi.box,ie,m.get("text-ignore-placement"),h.bucketInstanceId,Jr&&Jr.placeable&&Ka?Ka:Jn,q.ID),ms&&this.collisionIndex.insertCollisionBox(or.box,fe,m.get("icon-ignore-placement"),h.bucketInstanceId,Pa,q.ID),er&&Di&&this.collisionIndex.insertCollisionCircles(er.circles,ie,m.get("text-ignore-placement"),h.bucketInstanceId,Jn,q.ID),l&&this.storeCollisionData(h.bucketInstanceId,Ot,Rt,Zi,or,er),et.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[et.crossTileID]=new Gs((Di||Be)&&!(Zi!=null&&Zi.occluded),(Li||$e)&&!(or!=null&&or.occluded),Fi||h.justReloaded),r[et.crossTileID]=!0};if(Ie){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const et=h.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Rt=et.length-1;Rt>=0;--Rt){const Ot=et[Rt];ft(h.symbolInstances.get(Ot),h.collisionArrays[Ot],Ot)}}else for(let et=e.symbolInstanceStart;et<e.symbolInstanceEnd;et++)ft(h.symbolInstances.get(et),h.collisionArrays[et],et);h.justReloaded=!1}storeCollisionData(e,r,l,h,m,v){if(l.textBox||l.iconBox){let w,M;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(r)?M=w.get(r):(M={text:null,icon:null},w.set(r,M)),l.textBox&&(M.text=h.box),l.iconBox&&(M.icon=m.box)}if(v){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=[]);for(let M=0;M<v.circles.length;M+=4)w.push(v.circles[M+0]-Yi),w.push(v.circles[M+1]-Yi),w.push(v.circles[M+2]),w.push(v.collisionDetected?1:0)}}markUsedJustification(e,r,l,h){let m;m=h===u.ag.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[u.az(r)];const v=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of v)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=m>=0&&w!==m?0:l.crossTileID)}markUsedOrientation(e,r,l){const h=r===u.ag.horizontal||r===u.ag.horizontalOnly?r:0,m=r===u.ag.vertical?r:0,v=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of v)e.text.placedSymbolArray.get(w).placedOrientation=h;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const h=r?r.symbolFadeChange(e):1,m=r?r.opacities:{},v=r?r.variableOffsets:{},w=r?r.placedOrientations:{};for(const M in this.placements){const A=this.placements[M],k=m[M];k?(this.opacities[M]=new Pi(k,h,A.text,A.icon),l=l||A.text!==k.text.placed||A.icon!==k.icon.placed):(this.opacities[M]=new Pi(null,h,A.text,A.icon,A.skipFade),l=l||A.text||A.icon)}for(const M in m){const A=m[M];if(!this.opacities[M]){const k=new Pi(A,h,!1,!1);k.isHidden()||(this.opacities[M]=k,l=l||A.text.placed||A.icon.placed)}}for(const M in v)this.variableOffsets[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.variableOffsets[M]=v[M]);for(const M in w)this.placedOrientations[M]||!this.opacities[M]||this.opacities[M].isHidden()||(this.placedOrientations[M]=w[M]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const l={};for(const h of r){const m=h.getBucket(e);m&&h.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,l,h.collisionBoxArray)}}updateBucketOpacities(e,r,l,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const m=e.layers[0],v=m.layout,w=new Pi(null,0,!1,!1,!0),M=v.get("text-allow-overlap"),A=v.get("icon-allow-overlap"),k=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=v.get("text-rotation-alignment")==="map",F=v.get("text-pitch-alignment")==="map",$=v.get("icon-text-fit")!=="none",q=new Pi(null,0,M&&(A||!e.hasIconData()||v.get("icon-optional")),A&&(M||!e.hasTextData()||v.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);const te=(ie,se,fe)=>{for(let de=0;de<se/4;de++)ie.opacityVertexArray.emplaceBack(fe);ie.hasVisibleVertices=ie.hasVisibleVertices||fe!==ws},ee=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ie=0;ie<e.symbolInstances.length;ie++){const se=e.symbolInstances.get(ie),{numHorizontalGlyphVertices:fe,numVerticalGlyphVertices:de,crossTileID:pe}=se;let ye=this.opacities[pe];l[pe]?ye=w:ye||(ye=q,this.opacities[pe]=ye),l[pe]=!0;const ge=se.numIconVertices>0,Ie=this.placedOrientations[se.crossTileID],Be=Ie===u.ag.vertical,$e=Ie===u.ag.horizontal||Ie===u.ag.horizontalOnly;if(fe>0||de>0){const Ze=lh(ye.text);te(e.text,fe,Be?ws:Ze),te(e.text,de,$e?ws:Ze);const mt=ye.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach(Rt=>{Rt>=0&&(e.text.placedSymbolArray.get(Rt).hidden=mt||Be?1:0)}),se.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=mt||$e?1:0);const ft=this.variableOffsets[se.crossTileID];ft&&this.markUsedJustification(e,ft.anchor,se,Ie);const et=this.placedOrientations[se.crossTileID];et&&(this.markUsedJustification(e,"left",se,et),this.markUsedOrientation(e,et,se))}if(ge){const Ze=lh(ye.icon),mt=!($&&se.verticalPlacedIconSymbolIndex&&Be);se.placedIconSymbolIndex>=0&&(te(e.icon,se.numIconVertices,mt?Ze:ws),e.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=ye.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(te(e.icon,se.numVerticalIconVertices,mt?ws:Ze),e.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=ye.icon.isHidden())}const qe=ee&&ee.has(ie)?ee.get(ie):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Ze=e.collisionArrays[ie];if(Ze){let mt=new u.P(0,0);if(Ze.textBox||Ze.verticalTextBox){let ft=!0;if(k){const et=this.variableOffsets[pe];et?(mt=aa(et.anchor,et.width,et.height,et.textOffset,et.textBoxScale),O&&mt._rotate(F?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ft=!1}if(Ze.textBox||Ze.verticalTextBox){let et;Ze.textBox&&(et=Be),Ze.verticalTextBox&&(et=$e),Wc(e.textCollisionBox.collisionVertexArray,ye.text.placed,!ft||et,qe.text,mt.x,mt.y)}}if(Ze.iconBox||Ze.verticalIconBox){const ft=!!(!$e&&Ze.verticalIconBox);let et;Ze.iconBox&&(et=ft),Ze.verticalIconBox&&(et=!ft),Wc(e.iconCollisionBox.collisionVertexArray,ye.icon.placed,et,qe.icon,$?mt.x:0,$?mt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Wc(d,e,r,l,h,m){l&&l.length!==0||(l=[0,0,0,0]);const v=l[0]-Yi,w=l[1]-Yi,M=l[2]-Yi,A=l[3]-Yi;d.emplaceBack(e?1:0,r?1:0,h||0,m||0,v,w),d.emplaceBack(e?1:0,r?1:0,h||0,m||0,M,w),d.emplaceBack(e?1:0,r?1:0,h||0,m||0,M,A),d.emplaceBack(e?1:0,r?1:0,h||0,m||0,v,A)}const oh=Math.pow(2,25),$s=Math.pow(2,24),Na=Math.pow(2,17),as=Math.pow(2,16),cd=Math.pow(2,9),sf=Math.pow(2,8),of=Math.pow(2,1);function lh(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const e=d.placed?1:0,r=Math.floor(127*d.opacity);return r*oh+e*$s+r*Na+e*as+r*cd+e*sf+r*of+e}const ws=0;class al{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,l,h,m){const v=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(v,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,v.sort((w,M)=>w.sortKey-M.sortKey));this._currentPartIndex<v.length;)if(r.placeLayerBucketPart(v[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,m())return!0;return!1}}class Ua{constructor(e,r,l,h,m,v,w,M){this.placement=new dr(e,r,v,w,M),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,r,l){const h=be.now(),m=()=>!this._forceFullPlacement&&be.now()-h>2;for(;this._currentPlacementIndex>=0;){const v=r[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(v.type==="symbol"&&(!v.minzoom||v.minzoom<=w)&&(!v.maxzoom||v.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new al(v)),this._inProgressLayer.continuePlacement(l[v.source],this.placement,this._showCollisionBoxes,v,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const xn=512/u.Z/2;class Qc{constructor(e,r,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const h=new Map;for(let m=0;m<r.length;m++){const v=r.get(m),w=v.key,M=h.get(w);M?M.push(v):h.set(w,[v])}for(const[m,v]of h){const w={positions:v.map(M=>({x:Math.floor(M.anchorX*xn),y:Math.floor(M.anchorY*xn)})),crossTileIDs:v.map(M=>M.crossTileID)};if(w.positions.length>128){const M=new u.aB(w.positions.length,16,Uint16Array);for(const{x:A,y:k}of w.positions)M.add(A,k);M.finish(),delete w.positions,w.index=M}this._symbolsByKey[m]=w}}getScaledCoordinates(e,r){const{x:l,y:h,z:m}=this.tileID.canonical,{x:v,y:w,z:M}=r.canonical,A=xn/Math.pow(2,M-m),k=(w*u.Z+e.anchorY)*A,O=h*u.Z*xn;return{x:Math.floor((v*u.Z+e.anchorX)*A-l*u.Z*xn),y:Math.floor(k-O)}}findMatches(e,r,l){const h=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let m=0;m<e.length;m++){const v=e.get(m);if(v.crossTileID)continue;const w=this._symbolsByKey[v.key];if(!w)continue;const M=this.getScaledCoordinates(v,r);if(w.index){const A=w.index.range(M.x-h,M.y-h,M.x+h,M.y+h).sort();for(const k of A){const O=w.crossTileIDs[k];if(!l[O]){l[O]=!0,v.crossTileID=O;break}}}else if(w.positions)for(let A=0;A<w.positions.length;A++){const k=w.positions[A],O=w.crossTileIDs[A];if(Math.abs(k.x-M.x)<=h&&Math.abs(k.y-M.y)<=h&&!l[O]){l[O]=!0,v.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class ch{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Eo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const l in this.indexes){const h=this.indexes[l],m={};for(const v in h){const w=h[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+r),m[w.tileID.key]=w}this.indexes[l]=m}this.lng=e}addBucket(e,r,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<r.symbolInstances.length;m++)r.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const h=this.usedCrossTileIDs[e.overscaledZ];for(const m in this.indexes){const v=this.indexes[m];if(Number(m)>e.overscaledZ)for(const w in v){const M=v[w];M.tileID.isChildOf(e)&&M.findMatches(r.symbolInstances,e,h)}else{const w=v[e.scaledTo(Number(m)).key];w&&w.findMatches(r.symbolInstances,e,h)}}for(let m=0;m<r.symbolInstances.length;m++){const v=r.symbolInstances.get(m);v.crossTileID||(v.crossTileID=l.generate(),h[v.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Qc(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const l of r.getCrossTileIDsLists())for(const h of l)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let r=!1;for(const l in this.indexes){const h=this.indexes[l];for(const m in h)e[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,h[m]),delete h[m],r=!0)}return r}}class Jc{constructor(){this.layerIndexes={},this.crossTileIDs=new ch,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,l){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Eo);let m=!1;const v={};h.handleWrapJump(l);for(const w of r){const M=w.getBucket(e);M&&e.id===M.layerIds[0]&&(M.bucketInstanceId||(M.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(w.tileID,M,this.crossTileIDs)&&(m=!0),v[M.bucketInstanceId]=!0)}return h.removeStaleBuckets(v)&&(m=!0),m}pruneUnusedLayers(e){const r={};e.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var ss="void main() {fragColor=vec4(1.0);}";const Va={prelude:ai(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ai("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ai("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ai(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ai(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ai(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ai(ss,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ai(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ai(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ai("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ai("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ai("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ai(ss,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ai(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ai(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ai(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ai(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ai(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ai(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ai(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ai(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ai(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ai(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ai(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ai(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ai(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ai(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ai(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ai(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ai("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ai("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ai("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ai("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ai(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ai("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ai(d,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),h=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=m?m.concat(h):h,w={};return{fragmentSource:d=d.replace(r,(M,A,k,O,F)=>(w[F]=!0,A==="define"?`
#ifndef HAS_UNIFORM_u_${F}
in ${k} ${O} ${F};
#else
uniform ${k} ${O} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${k} ${O} ${F} = u_${F};
#endif
`)),vertexSource:e=e.replace(r,(M,A,k,O,F)=>{const $=O==="float"?"vec2":"vec4",q=F.match(/color/)?"color":$;return w[F]?A==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
in ${k} ${$} a_${F};
out ${k} ${O} ${F};
#else
uniform ${k} ${O} u_${F};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${k} ${O} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${q}(a_${F}, u_${F}_t);
#else
    ${k} ${O} ${F} = u_${F};
#endif
`:A==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
in ${k} ${$} a_${F};
#else
uniform ${k} ${O} u_${F};
#endif
`:q==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${k} ${O} ${F} = a_${F};
#else
    ${k} ${O} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${k} ${O} ${F} = unpack_mix_${q}(a_${F}, u_${F}_t);
#else
    ${k} ${O} ${F} = u_${F};
#endif
`}),staticAttributes:l,staticUniforms:v}}class Bn{constructor(e,r,l){this.vertexBuffer=e,this.indexBuffer=r,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var sa=u.aC([{name:"a_pos",type:"Int16",components:2}]);const pi="#define PROJECTION_MERCATOR",Ss="mercator";class eu{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ss}get shaderDefine(){return pi}get shaderPreludeCode(){return Va.projectionMercator}get vertexShaderPreludeCode(){return Va.projectionMercator.vertexSource}get subdivisionGranularity(){return u.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,l,h,m){if(this._cachedMesh)return this._cachedMesh;const v=new u.aE;v.emplaceBack(0,0),v.emplaceBack(u.Z,0),v.emplaceBack(0,u.Z),v.emplaceBack(u.Z,u.Z);const w=e.createVertexBuffer(v,sa.members),M=u.aF.simpleSegment(0,0,4,2),A=new u.aG;A.emplaceBack(1,0,2),A.emplaceBack(1,2,3);const k=e.createIndexBuffer(A);return this._cachedMesh=new Bn(w,k,M),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function oa(d,e){const r=u.ad(e.lat,-85.051129,u.aI);return new u.P(u.U(e.lng)*d,u.S(r)*d)}function Mr(d,e){return new u.$(e.x/d,e.y/d).toLngLat()}function on(d){return d.cameraToCenterDistance*Math.min(.85*Math.tan(u.ac(90-d.pitch)),Math.tan(u.ac(89.25-d.pitch)))}function nr(d,e){const r=d.canonical,l=e/u.aH(r.z),h=r.x+Math.pow(2,r.z)*d.wrap,m=u.as(new Float64Array(16));return u.L(m,m,[h*l,r.y*l,0]),u.M(m,m,[l/u.Z,l/u.Z,1]),m}function tu(d,e,r,l,h){const m=u.$.fromLngLat(d,e),v=h*u.aJ(1,d.lat),w=v*Math.cos(u.ac(r)),M=Math.sqrt(v*v-w*w),A=M*Math.sin(u.ac(-l)),k=M*Math.cos(u.ac(-l));return new u.$(m.x+A,m.y+k,m.z+w)}class Nr{constructor(e=0,r=0,l=0,h=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=l,this.right=h}interpolate(e,r,l){return r.top!=null&&e.top!=null&&(this.top=u.B.number(e.top,r.top,l)),r.bottom!=null&&e.bottom!=null&&(this.bottom=u.B.number(e.bottom,r.bottom,l)),r.left!=null&&e.left!=null&&(this.left=u.B.number(e.left,r.left,l)),r.right!=null&&e.right!=null&&(this.right=u.B.number(e.right,r.right,l)),this}getCenter(e,r){const l=u.ad((this.left+e-this.right)/2,0,e),h=u.ad((this.top+r-this.bottom)/2,0,r);return new u.P(l,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Nr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function On(d,e){if(!d.renderWorldCopies||d.lngRange)return;const r=e.lng-d.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Hn(d){return Math.max(0,Math.floor(d))}class Ao{constructor(e,r,l,h,m,v){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=v===void 0||!!v,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=h??0,this._maxPitch=m??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new u.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Hn(this._zoom),this._scale=u.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Nr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Hn(this._zoom),this._scale=u.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Nr(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=u.aK(e,-180,180)*Math.PI/180;var l,h,m,v,w,M,A,k,O;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=ae(),l=this._rotationMatrix,m=-this._bearingInRadians,v=(h=this._rotationMatrix)[0],w=h[1],M=h[2],A=h[3],k=Math.sin(m),O=Math.cos(m),l[0]=v*O+M*k,l[1]=w*O+A*k,l[2]=v*-k+M*O,l[3]=w*-k+A*O)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=u.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return u.aL(this._fovInRadians)}setFov(e){e=u.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=u.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=u.aH(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,l){this._unmodified=!1,this._edgeInsets.interpolate(e,r,l),this._constrain(),this._calcMatrices()}resize(e,r,l=!0){this._width=e,this._height=r,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ei([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,u.aI])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{let l=e.x,h=e.y,m=e.x,v=e.y;for(const w of r)l=Math.min(l,w.x),h=Math.min(h,w.y),m=Math.max(m,w.x),v=Math.max(v,w.y);return[new u.P(l,h),new u.P(m,h),new u.P(m,v),new u.P(l,v),new u.P(l,h)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=u.as(new Float64Array(16));u.M(e,e,[this._width/2,-this._height/2,1]),u.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=u.as(new Float64Array(16)),u.M(e,e,[1,-1,1]),u.L(e,e,[-1,-1,0]),u.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,l,h){const m=l!==void 0?l:this.bearing,v=h=h!==void 0?h:this.pitch,w=u.$.fromLngLat(e,r),M=-Math.cos(u.ac(v)),A=Math.sin(u.ac(v)),k=A*Math.sin(u.ac(m)),O=-A*Math.cos(u.ac(m));let F=this.elevation;const $=r-F;let q;M*$>=0||Math.abs(M)<.1?(q=1e4,F=r+q*M):q=-$/M;let te,ee,ie=u.aM(1,w.y),se=0;do{if(se+=1,se>10)break;ee=q/ie,te=new u.$(w.x+k*ee,w.y+O*ee),ie=1/te.meterInMercatorCoordinateUnits()}while(Math.abs(q-ee*ie)>1e-12);return{center:te.toLngLat(),elevation:F,zoom:u.aa(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=u.aJ(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/r,h=u.$.fromLngLat(this.center,this.elevation),m=tu(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const v=this.calculateCenterFromCameraLngLatAlt(m.toLngLat(),u.aM(m.z,h.y),this.bearing,this.pitch);this._elevation=v.elevation,this._center=v.center,this.setZoom(v.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=u.aJ(1,this.center.lat)*this.worldSize;return tu(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/u.Z,1/r/u.Z]}}class la{constructor(e,r){this.min=e,this.max=r,this.center=u.aN([],u.aO([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],l=u.aP(this.min),h=u.aP(this.max);for(let m=0;m<r.length;m++)l[m]=r[m]?this.min[m]:this.center[m],h[m]=r[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new la(l,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let l=0;l<e.planes.length;l++){const h=this.intersectsPlane(e.planes[l]);if(h===0)return 0;h===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],l=e[3];for(let h=0;h<3;h++)e[h]>0?(r+=e[h]*this.min[h],l+=e[h]*this.max[h]):(l+=e[h]*this.min[h],r+=e[h]*this.max[h]);return r>=0?2:l<0?0:1}}class Cr{distanceToTile2d(e,r,l,h){const m=h.distanceX([e,r]),v=h.distanceY([e,r]);return Math.hypot(m,v)}getWrap(e,r,l){return l}getTileAABB(e,r,l,h){var m,v;let w=l,M=l;if(h.terrain){const k=new u.Y(e.z,r,e.z,e.x,e.y),O=h.terrain.getMinMaxElevation(k);w=(m=O.minElevation)!==null&&m!==void 0?m:l,M=(v=O.maxElevation)!==null&&v!==void 0?v:l}const A=1<<e.z;return new la([r+e.x/A,e.y/A,w],[r+(e.x+1)/A,(e.y+1)/A,M])}allowVariableZoom(e,r){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,h=u.ad(78.5-l/2,0,60);return!!r.terrain||e.pitch>h}allowWorldCopies(){return!0}recalculateCache(){}}class ca{constructor(e,r,l){this.points=e,this.planes=r,this.aabb=l}static fromInvProjectionMatrix(e,r=1,l=0){const h=Math.pow(2,l),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const k=1/(A=u.ao([],A,e))[3]/r*h;return u.aQ(A,A,[k,k,1/A[3],k])}),v=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const k=u.aR([],m[A[0]],m[A[1]]),O=u.aR([],m[A[2]],m[A[1]]),F=u.aS([],u.aT([],k,O)),$=-u.aU(F,m[A[1]]);return F.concat($)}),w=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],M=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const A of m)for(let k=0;k<3;k++)w[k]=Math.min(w[k],A[k]),M[k]=Math.max(M[k],A[k]);return new ca(m,v,new la(w,M))}}class bn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,l,h,m){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Ao({calcMatrices:()=>{this._calcMatrices()},getConstrained:(v,w)=>this.getConstrained(v,w)},e,r,l,h,m),this._coveringTilesDetailsProvider=new Cr}clone(){const e=new bn;return e.apply(this),e}apply(e,r,l){this._helper.apply(e,r,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new u.aV(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new u.P(0,0)),h=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,0)),m=this.screenPointToMercatorCoordinate(new u.P(this._helper._width,this._helper._height)),v=this.screenPointToMercatorCoordinate(new u.P(0,this._helper._height)),w=Math.floor(Math.min(l.x,h.x,m.x,v.x)),M=Math.floor(Math.max(l.x,h.x,m.x,v.x)),A=1;for(let k=w-A;k<=M+A;k++)k!==0&&r.push(new u.aV(k,e))}return r}getCameraFrustum(){return ca.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,r){const l=u.aJ(this.elevation,this.center.lat),h=this.screenPointToMercatorCoordinateAtZ(r,l),m=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),v=u.$.fromLngLat(e),w=new u.$(v.x-(h.x-m.x),v.y-(h.y-m.y));this.setCenter(w==null?void 0:w.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(u.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(u.$.fromLngLat(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const l=r||0,h=[e.x,e.y,0,1],m=[e.x,e.y,1,1];u.ao(h,h,this._pixelMatrixInverse),u.ao(m,m,this._pixelMatrixInverse);const v=h[3],w=m[3],M=h[1]/v,A=m[1]/w,k=h[2]/v,O=m[2]/w,F=k===O?0:(l-k)/(O-k);return new u.$(u.B.number(h[0]/v,m[0]/w,F)/this.worldSize,u.B.number(M,A,F)/this.worldSize,l)}coordinatePoint(e,r=0,l=this._pixelMatrix){const h=[e.x*this.worldSize,e.y*this.worldSize,r,1];return u.ao(h,h,l),new u.P(h[0]/h[3],h[1]/h[3])}getBounds(){const e=Math.max(0,this._helper._height/2-on(this));return new Ei().extend(this.screenPointToLocation(new u.P(0,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,e))).extend(this.screenPointToLocation(new u.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new u.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-on(this)}calculatePosMatrix(e,r=!1,l){var h;const m=(h=e.key)!==null&&h!==void 0?h:u.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),v=r?this._alignedPosMatrixCache:this._posMatrixCache;if(v.has(m)){const A=v.get(m);return l?A.f32:A.f64}const w=nr(e,this.worldSize);u.N(w,r?this._alignedProjMatrix:this._viewProjMatrix,w);const M={f64:w,f32:new Float32Array(w)};return v.set(m,M),l?M.f32:M.f64}calculateFogMatrix(e){const r=e.key,l=this._fogMatrixCacheF32;if(l.has(r))return l.get(r);const h=nr(e,this.worldSize);return u.N(h,this._fogMatrix,h),l.set(r,new Float32Array(h)),l.get(r)}getConstrained(e,r){r=u.ad(+r,this.minZoom,this.maxZoom);const l={center:new u.Q(e.lng,e.lat),zoom:r};let h=this._helper._lngRange;this._helper._renderWorldCopies||h!==null||(h=[-179.9999999999,180-1e-10]);const m=this.tileSize*u.aH(l.zoom);let v=0,w=m,M=0,A=m,k=0,O=0;const{x:F,y:$}=this.size;if(this._helper._latRange){const fe=this._helper._latRange;v=u.S(fe[1])*m,w=u.S(fe[0])*m,w-v<$&&(k=$/(w-v))}h&&(M=u.aK(u.U(h[0])*m,0,m),A=u.aK(u.U(h[1])*m,0,m),A<M&&(A+=m),A-M<F&&(O=F/(A-M)));const{x:q,y:te}=oa(m,e);let ee,ie;const se=Math.max(O||0,k||0);if(se){const fe=new u.P(O?(A+M)/2:q,k?(w+v)/2:te);return l.center=Mr(m,fe).wrap(),l.zoom+=u.aa(se),l}if(this._helper._latRange){const fe=$/2;te-fe<v&&(ie=v+fe),te+fe>w&&(ie=w-fe)}if(h){const fe=(M+A)/2;let de=q;this._helper._renderWorldCopies&&(de=u.aK(q,fe-m/2,fe+m/2));const pe=F/2;de-pe<M&&(ee=M+pe),de+pe>A&&(ee=A-pe)}if(ee!==void 0||ie!==void 0){const fe=new u.P(ee??q,ie??te);l.center=Mr(m,fe).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,r,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,h)}_calculateNearFarZIfNeeded(e,r,l){if(!this._helper.autoCalculateNearFarZ)return;const h=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),m=e-h*this._helper._pixelPerMeter/Math.cos(r),v=h<0?m:e,w=Math.PI/2+this.pitchInRadians,M=u.ac(this.fov)*(Math.abs(Math.cos(u.ac(this.roll)))*this.height+Math.abs(Math.sin(u.ac(this.roll)))*this.width)/this.height*(.5+l.y/this.height),A=Math.sin(M)*v/Math.sin(u.ad(Math.PI-w-M,.01,Math.PI-.01)),k=on(this),O=Math.atan(k/this._helper.cameraToCenterDistance),F=u.ac(.75),$=O>F?2*O*(.5+l.y/(2*k)):F,q=Math.sin($)*v/Math.sin(u.ad(Math.PI-w-$,.01,Math.PI-.01)),te=Math.min(A,q);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*te+v),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=oa(this.worldSize,this.center),l=r.x,h=r.y;this._helper._pixelPerMeter=u.aJ(1,this.center.lat)*this.worldSize;const m=u.ac(Math.min(this.pitch,89.25)),v=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(m));let w;this._calculateNearFarZIfNeeded(v,m,e),w=new Float64Array(16),u.aX(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),u.ai(this._invProjMatrix,w),w[8]=2*-e.x/this._helper._width,w[9]=2*e.y/this._helper._height,this._projectionMatrix=u.aY(w),u.M(w,w,[1,-1,1]),u.L(w,w,[0,0,-this._helper.cameraToCenterDistance]),u.aZ(w,w,-this.rollInRadians),u.a_(w,w,this.pitchInRadians),u.aZ(w,w,-this.bearingInRadians),u.L(w,w,[-l,-h,0]),this._mercatorMatrix=u.M([],w,[this.worldSize,this.worldSize,this.worldSize]),u.M(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=u.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),u.L(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=u.ai([],w);const M=[0,0,-1,1];u.ao(M,M,this._invViewProjMatrix),this._cameraPosition=[M[0]/M[3],M[1]/M[3],M[2]/M[3]],this._fogMatrix=new Float64Array(16),u.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,v,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,u.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),u.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),u.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),u.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),u.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),u.L(this._fogMatrix,this._fogMatrix,[-l,-h,0]),u.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),u.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=u.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const A=this._helper._width%2/2,k=this._helper._height%2/2,O=Math.cos(this.bearingInRadians),F=Math.sin(-this.bearingInRadians),$=l-Math.round(l)+O*A+F*k,q=h-Math.round(h)+O*k+F*A,te=new Float64Array(w);if(u.L(te,te,[$>.5?$-1:$,q>.5?q-1:q,0]),this._alignedProjMatrix=te,w=u.ai(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new u.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return u.ao(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=u.aJ(1,this.center.lat)*this.worldSize;return tu(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const l=u.$.fromLngLat(e),h=[l.x*this.worldSize,l.y*this.worldSize,r,1];return u.ao(h,h,this._viewProjMatrix),h[2]/h[3]}getProjectionData(e){const{overscaledTileID:r,aligned:l,applyTerrainMatrix:h}=e,m=this._helper.getMercatorTileCoordinates(r),v=r?this.calculatePosMatrix(r,l,!0):null;let w;return w=r&&r.terrainRttPosMatrix32f&&h?r.terrainRttPosMatrix32f:v||u.a$(),{mainMatrix:w,tileMercatorCoords:m,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,l){return 1}transformLightDirection(e){return u.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,l,h){const m=this.calculatePosMatrix(l);let v;h?(v=[e,r,h(e,r),1],u.ao(v,v,m)):(v=[e,r,0,1],Wr(v,v,m));const w=v[3];return{point:new u.P(v[0]/w,v[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const l=u.$.fromLngLat(e,r),h=l.meterInMercatorCoordinateUnits(),m=u.b0();return u.L(m,m,[l.x,l.y,l.z]),u.aZ(m,m,Math.PI),u.a_(m,m,Math.PI/2),u.M(m,m,[-h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const r=new u.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),h=nr(r,this.worldSize);u.N(h,this._viewProjMatrix,h),l.tileMercatorCoords=[0,0,1,1];const m=[u.Z,u.Z,this.worldSize/this._helper.pixelsPerMeter],v=u.b1();return u.M(v,h,m),l.fallbackMatrix=v,l.mainMatrix=v,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function sl(){u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Xn(d){if(d.useSlerp)if(d.k<1){const e=u.b2(d.startEulerAngles.roll,d.startEulerAngles.pitch,d.startEulerAngles.bearing),r=u.b2(d.endEulerAngles.roll,d.endEulerAngles.pitch,d.endEulerAngles.bearing),l=new Float64Array(4);u.b3(l,e,r,d.k);const h=u.b4(l);d.tr.setRoll(h.roll),d.tr.setPitch(h.pitch),d.tr.setBearing(h.bearing)}else d.tr.setRoll(d.endEulerAngles.roll),d.tr.setPitch(d.endEulerAngles.pitch),d.tr.setBearing(d.endEulerAngles.bearing);else d.tr.setRoll(u.B.number(d.startEulerAngles.roll,d.endEulerAngles.roll,d.k)),d.tr.setPitch(u.B.number(d.startEulerAngles.pitch,d.endEulerAngles.pitch,d.k)),d.tr.setBearing(u.B.number(d.startEulerAngles.bearing,d.endEulerAngles.bearing,d.k))}function iu(d,e,r,l,h){const m=h.padding,v=oa(h.worldSize,r.getNorthWest()),w=oa(h.worldSize,r.getNorthEast()),M=oa(h.worldSize,r.getSouthEast()),A=oa(h.worldSize,r.getSouthWest()),k=u.ac(-l),O=v.rotate(k),F=w.rotate(k),$=M.rotate(k),q=A.rotate(k),te=new u.P(Math.max(O.x,F.x,q.x,$.x),Math.max(O.y,F.y,q.y,$.y)),ee=new u.P(Math.min(O.x,F.x,q.x,$.x),Math.min(O.y,F.y,q.y,$.y)),ie=te.sub(ee),se=(h.width-(m.left+m.right+e.left+e.right))/ie.x,fe=(h.height-(m.top+m.bottom+e.top+e.bottom))/ie.y;if(fe<0||se<0)return void sl();const de=Math.min(u.aa(h.scale*Math.min(se,fe)),d.maxZoom),pe=u.P.convert(d.offset),ye=new u.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(u.ac(l)),ge=pe.add(ye).mult(h.scale/u.aH(de));return{center:Mr(h.worldSize,v.add(M).div(2).sub(ge)),zoom:de,bearing:l}}class Fn{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,l){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,r,l,h,m){return iu(e,r,l,h,m)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(u.Q.convert(r.center))}handleEaseTo(e,r){const l=e.zoom,h=e.padding,m={roll:e.roll,pitch:e.pitch,bearing:e.bearing},v={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},w=r.zoom!==void 0,M=!e.isPaddingEqual(r.padding);let A=!1;const k=w?+r.zoom:e.zoom;let O=e.centerPoint.add(r.offsetAsPoint);const F=e.screenPointToLocation(O),{center:$,zoom:q}=e.getConstrained(u.Q.convert(r.center||F),k??l);On(e,$);const te=oa(e.worldSize,F),ee=oa(e.worldSize,$).sub(te),ie=u.aH(q-l);return A=q!==l,{easeFunc:se=>{if(A&&e.setZoom(u.B.number(l,q,se)),u.b5(m,v)||Xn({startEulerAngles:m,endEulerAngles:v,tr:e,k:se,useSlerp:m.roll!=v.roll}),M&&(e.interpolatePadding(h,r.padding,se),O=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const fe=u.aH(e.zoom-l),de=q>l?Math.min(2,ie):Math.max(.5,ie),pe=Math.pow(de,1-se),ye=Mr(e.worldSize,te.add(ee.mult(se*pe)).mult(fe));e.setLocationAtPoint(e.renderWorldCopies?ye.wrap():ye,O)}},isZooming:A,elevationCenter:$}}handleFlyTo(e,r){const l=r.zoom!==void 0,h=e.zoom,m=e.getConstrained(u.Q.convert(r.center||r.locationAtOffset),l?+r.zoom:h),v=m.center,w=m.zoom;On(e,v);const M=oa(e.worldSize,r.locationAtOffset),A=oa(e.worldSize,v).sub(M),k=A.mag(),O=u.aH(w-h);let F;if(r.minZoom!==void 0){const $=Math.min(+r.minZoom,h,w),q=e.getConstrained(v,$).zoom;F=u.aH(q-h)}return{easeFunc:($,q,te,ee)=>{e.setZoom($===1?w:h+u.aa(q));const ie=$===1?v:Mr(e.worldSize,M.add(A.mult(te)).mult(q));e.setLocationAtPoint(e.renderWorldCopies?ie.wrap():ie,ee)},scaleOfZoom:O,targetCenter:v,scaleOfMinZoom:F,pixelPathLength:k}}}class Ui{constructor(e,r,l){this.blendFunction=e,this.blendColor=r,this.mask=l}}Ui.Replace=[1,0],Ui.disabled=new Ui(Ui.Replace,u.b6.transparent,[!1,!1,!1,!1]),Ui.unblended=new Ui(Ui.Replace,u.b6.transparent,[!0,!0,!0,!0]),Ui.alphaBlended=new Ui([1,771],u.b6.transparent,[!0,!0,!0,!0]);const qs=2305;class oi{constructor(e,r,l){this.enable=e,this.mode=r,this.frontFace=l}}oi.disabled=new oi(!1,1029,qs),oi.backCCW=new oi(!0,1029,qs),oi.frontCCW=new oi(!0,1028,qs);class ni{constructor(e,r,l){this.func=e,this.mask=r,this.range=l}}ni.ReadOnly=!1,ni.ReadWrite=!0,ni.disabled=new ni(519,ni.ReadOnly,[0,1]);const Ts=7680;class mi{constructor(e,r,l,h,m,v){this.test=e,this.ref=r,this.mask=l,this.fail=h,this.depthFail=m,this.pass=v}}mi.disabled=new mi({func:519,mask:0},0,0,Ts,Ts,Ts);const Hs=new WeakMap;function jn(d){var e;if(Hs.has(d))return Hs.get(d);{const r=(e=d.getParameter(d.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Hs.set(d,r),r}}class ol{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,l=r.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const h=new u.aE;h.emplaceBack(-1,-1),h.emplaceBack(2,-1),h.emplaceBack(-1,2);const m=new u.aG;m.emplaceBack(0,1,2),this._fullscreenTriangle=new Bn(r.createVertexBuffer(h,sa.members),r.createIndexBuffer(m),u.aF.simpleSegment(0,0,h.length,m.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(l.TEXTURE1);const v=l.createTexture();l.bindTexture(l.TEXTURE_2D,v),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(v),jn(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const l=this._cachedRenderContext.context,h=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:u.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,h.TRIANGLES,ni.disabled,mi.disabled,Ui.unblended,oi.disabled,((m,v)=>({u_input:m,u_output_expected:v}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&jn(h)){h.bindBuffer(h.PIXEL_PACK_BUFFER,this._pbo),h.readBuffer(h.COLOR_ATTACHMENT0),h.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),h.bindBuffer(h.PIXEL_PACK_BUFFER,null);const m=h.fenceSync(h.SYNC_GPU_COMMANDS_COMPLETE,0);h.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:m}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&jn(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return u.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ol._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const wn=u.Z/128;function Za(d,e){const r=d.granularity!==void 0?Math.max(d.granularity,1):1,l=r+(d.generateBorders?2:0),h=r+(d.extendToNorthPole||d.generateBorders?1:0)+(d.extendToSouthPole||d.generateBorders?1:0),m=l+1,v=h+1,w=d.generateBorders?-1:0,M=d.generateBorders||d.extendToNorthPole?-1:0,A=r+(d.generateBorders?1:0),k=r+(d.generateBorders||d.extendToSouthPole?1:0),O=m*v,F=l*h*6,$=m*v>65536;if($&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const q=$||e==="32bit",te=new Int16Array(2*O);let ee=0;for(let fe=M;fe<=k;fe++)for(let de=w;de<=A;de++){let pe=de/r*u.Z;de===-1&&(pe=-64),de===r+1&&(pe=u.Z+wn);let ye=fe/r*u.Z;fe===-1&&(ye=d.extendToNorthPole?u.b8:-64),fe===r+1&&(ye=d.extendToSouthPole?u.b9:u.Z+wn),te[ee++]=pe,te[ee++]=ye}const ie=q?new Uint32Array(F):new Uint16Array(F);let se=0;for(let fe=0;fe<h;fe++)for(let de=0;de<l;de++){const pe=de+1+fe*m,ye=de+(fe+1)*m,ge=de+1+(fe+1)*m;ie[se++]=de+fe*m,ie[se++]=ye,ie[se++]=pe,ie[se++]=pe,ie[se++]=ye,ie[se++]=ge}return{vertices:te.buffer.slice(0),indices:ie.buffer.slice(0),uses32bitIndices:q}}const Ms=new u.aD({fill:new u.ba(128,2),line:new u.ba(512,0),tile:new u.ba(128,32),stencil:new u.ba(128,1),circle:3});class os{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Va.projectionGlobe}get vertexShaderPreludeCode(){return Va.projectionMercator.vertexSource}get subdivisionGranularity(){return Ms}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new ol(e));const r=u.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,h=this._errorMeasurement.updateErrorLoop(r,l),m=be.now();h!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=h,this._errorMeasurementLastChangeTime=m);const v=Math.min(Math.max((m-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=u.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,u.bc(v))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,l,h,m){const v=(m==="stencil"?Ms.stencil:Ms.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:v,generateBorders:l,extendToNorthPole:r.y===0&&h,extendToSouthPole:r.y===(1<<r.z)-1&&h})}_getMesh(e,r){const l=this._getMeshKey(r);if(l in this._tileMeshCache)return this._tileMeshCache[l];const h=function(m,v){const w=Za(v,"16bit"),M=u.aE.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),A=u.aG.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new Bn(m.createVertexBuffer(M,sa.members),m.createIndexBuffer(A),u.aF.simpleSegment(0,0,M.length,A.length))}(e,r);return this._tileMeshCache[l]=h,h}recalculate(e){}hasTransition(){const e=be.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const ud=new u.r({type:new u.D(u.v.projection.type)});class ll extends u.E{constructor(e){super(),this._transitionable=new u.T(ud),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.C(0)),this._mercatorProjection=new eu,this._verticalPerspectiveProjection=new os}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof u.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,l,h,m){return this.currentProjection.getMeshFromTileID(e,r,l,h,m)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function rc(d){const e=Sn(d.worldSize,d.center.lat);return 2*Math.PI*e}function Cs(d,e,r,l,h){const m=1/(1<<h),v=e/u.Z*m+l*m,w=u.bf((d/u.Z*m+r*m)*Math.PI*2+Math.PI,2*Math.PI),M=2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI,A=Math.cos(M),k=new Float64Array(3);return k[0]=Math.sin(w)*A,k[1]=Math.sin(M),k[2]=Math.cos(w)*A,k}function Qr(d){return function(e,r){const l=Math.cos(r),h=new Float64Array(3);return h[0]=Math.sin(e)*l,h[1]=Math.sin(r),h[2]=Math.cos(e)*l,h}(d.lng*Math.PI/180,d.lat*Math.PI/180)}function Sn(d,e){return d/(2*Math.PI)/Math.cos(e*Math.PI/180)}function ru(d){const e=Math.asin(d[1])/Math.PI*180,r=Math.sqrt(d[0]*d[0]+d[2]*d[2]);if(r>1e-6){const l=d[0]/r,h=Math.acos(d[2]/r),m=(l>0?h:-h)/Math.PI*180;return new u.Q(u.aK(m,-180,180),e)}return new u.Q(0,e)}function ua(d){return Math.cos(d*Math.PI/180)}function Dr(d,e){const r=ua(d),l=ua(e);return u.aa(l/r)}function nc(d,e){const r=d.rotate(e.bearingInRadians),l=e.zoom+Dr(e.center.lat,0),h=u.bb(1/ua(e.center.lat),1/ua(Math.min(Math.abs(e.center.lat),60)),u.be(l,7,3,0,1)),m=360/rc({worldSize:e.worldSize,center:{lat:e.center.lat}});return new u.Q(e.center.lng-r.x*m*h,u.ad(e.center.lat+r.y*m,-85.051129,u.aI))}function nu(d){const e=.5*d,r=Math.sin(e),l=Math.cos(e);return Math.log(r+l)-Math.log(l-r)}function zo(d,e,r,l){const h=d.lat+r*l;if(Math.abs(r)>1){const m=(Math.sign(d.lat+r)!==Math.sign(d.lat)?-Math.abs(d.lat):Math.abs(d.lat))*Math.PI/180,v=Math.abs(d.lat+r)*Math.PI/180,w=nu(m+l*(v-m)),M=nu(m),A=nu(v);return new u.Q(d.lng+e*((w-M)/(A-M)),h)}return new u.Q(d.lng+e*l,h)}class hd{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,r,l,h){const m=`${e.z}_${e.x}_${e.y}`,v=this._cache.get(m);if(v)return v;const w=this._cachePrevious.get(m);if(w)return this._cache.set(m,w),w;const M=this._aabbFactory(e,r,l,h);return this._cache.set(m,M),this._hadAnyChanges=!0,M}}function au(d,e,r){const l=d-e;return l<0?-l:Math.max(0,l-r)}function uh(d,e,r,l,h){const m=d-r;let v;return v=m<0?Math.min(-m,1+m-h):m>1?Math.min(Math.max(m-h,0),1-m):0,Math.max(v,au(e,l,h))}class lf{constructor(){this._aabbCache=new hd(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,r,l,h){const m=1<<l.z,v=1/m,w=l.x/m,M=l.y/m;let A=2;return A=Math.min(A,uh(e,r,w,M,v)),A=Math.min(A,uh(e,r,w+.5,-M-v,v)),A=Math.min(A,uh(e,r,w+.5,2-M-v,v)),A}getWrap(e,r,l){const h=1<<r.z,m=1/h,v=r.x/h,w=au(e.x,v,m),M=au(e.x,v-1,m),A=au(e.x,v+1,m),k=Math.min(w,M,A);return k===A?1:k===M?-1:0}allowVariableZoom(e,r){return Rr(e,r)>4}allowWorldCopies(){return!1}getTileAABB(e,r,l,h){return this._aabbCache.getTileAABB(e,r,l,h)}_computeTileAABB(e,r,l,h){if(e.z<=0)return new la([-1,-1,-1],[1,1,1]);if(e.z===1)return new la([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const m=[Cs(0,0,e.x,e.y,e.z),Cs(u.Z,0,e.x,e.y,e.z),Cs(u.Z,u.Z,e.x,e.y,e.z),Cs(0,u.Z,e.x,e.y,e.z)],v=[1,1,1],w=[-1,-1,-1];for(const M of m)for(let A=0;A<3;A++)v[A]=Math.min(v[A],M[A]),w[A]=Math.max(w[A],M[A]);if(e.y===0||e.y===(1<<e.z)-1){const M=[0,e.y===0?1:-1,0];for(let A=0;A<3;A++)v[A]=Math.min(v[A],M[A]),w[A]=Math.max(w[A],M[A])}return new la(v,w)}}}class su{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=u.bg(),this._projectionMatrix=u.b0(),this._globeViewProjMatrix32f=u.a$(),this._globeViewProjMatrixNoCorrection=u.b0(),this._globeViewProjMatrixNoCorrectionInverted=u.b0(),this._globeProjMatrixInverted=u.b0(),this._cameraPosition=u.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Ao({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new lf}clone(){const e=new su;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=u.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:l}=e,h=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:h,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,l=this.cameraToCenterDistance/e,h=Math.sin(r)*l,m=Math.cos(r)*l+1,v=1/Math.sqrt(h*h+m*m)*1;let w=-h,M=m;const A=Math.sqrt(w*w+M*M);w/=A,M/=A;const k=[0,w,M];return u.bi(k,k,[0,0,0],-this.bearingInRadians),u.bj(k,k,[0,0,0],-1*this.center.lat*Math.PI/180),u.bk(k,k,[0,0,0],this.center.lng*Math.PI/180),u.aN(k,k,.25),[...k,.25*-v]}isLocationOccluded(e){return!this.isSurfacePointVisible(Qr(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,h=Math.cos(l),m=[Math.sin(r)*h,Math.sin(l),Math.cos(r)*h],v=[m[2],0,-m[0]],w=[0,0,0];u.aT(w,v,m),u.aS(v,v),u.aS(w,w);const M=[0,0,0];return u.aS(M,[v[0]*e[0]+w[0]*e[1]+m[0]*e[2],v[1]*e[0]+w[1]*e[1]+m[1]*e[2],v[2]*e[0]+w[2]*e[1]+m[2]*e[2]]),M}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,l){const h=function(w,M,A){const k=1/(1<<A.z);return new u.$(w/u.Z*k+A.x*k,M/u.Z*k+A.y*k)}(e,r,l.canonical),m=(v=h.y,[u.bf(h.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-v*Math.PI*2))-.5*Math.PI]);var v;return this.getCircleRadiusCorrection()/Math.cos(m[1])}projectTileCoordinates(e,r,l,h){const m=l.canonical,v=Cs(e,r,m.x,m.y,m.z),w=1+(h?h(e,r):0)/u.bq,M=[v[0]*w,v[1]*w,v[2]*w,1];u.ao(M,M,this._globeViewProjMatrixNoCorrection);const A=this._cachedClippingPlane,k=A[0]*v[0]+A[1]*v[1]+A[2]*v[2]+A[3]<0;return{point:new u.P(M[0]/M[3],M[1]/M[3]),signedDistanceFromCamera:M[3],isOccluded:k}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Sn(this.worldSize,this.center.lat),r=u.b1(),l=u.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),u.aX(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const h=this.centerOffset;r[8]=2*-h.x/this._helper._width,r[9]=2*h.y/this._helper._height,this._projectionMatrix=u.aY(r),this._globeProjMatrixInverted=u.b1(),u.ai(this._globeProjMatrixInverted,r),u.L(r,r,[0,0,-this.cameraToCenterDistance]),u.aZ(r,r,this.rollInRadians),u.a_(r,r,-this.pitchInRadians),u.aZ(r,r,this.bearingInRadians),u.L(r,r,[0,0,-e]);const m=u.bh();m[0]=e,m[1]=e,m[2]=e,u.a_(l,r,this.center.lat*Math.PI/180),u.bl(l,l,-this.center.lng*Math.PI/180),u.M(l,l,m),this._globeViewProjMatrixNoCorrection=l,u.a_(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),u.bl(r,r,-this.center.lng*Math.PI/180),u.M(r,r,m),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=u.b1(),u.ai(this._globeViewProjMatrixNoCorrectionInverted,l);const v=u.bh();this._cameraPosition=u.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,u.bi(this._cameraPosition,this._cameraPosition,v,-this.rollInRadians),u.bj(this._cameraPosition,this._cameraPosition,v,this.pitchInRadians),u.bi(this._cameraPosition,this._cameraPosition,v,-this.bearingInRadians),u.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),u.bj(this._cameraPosition,this._cameraPosition,v,-this.center.lat*Math.PI/180),u.bk(this._cameraPosition,this._cameraPosition,v,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const w=u.aY(this._globeViewProjMatrixNoCorrectionInverted);u.M(w,w,[1,1,-1]),this._cachedFrustum=ca.fromInvProjectionMatrix(w)}calculateFogMatrix(e){u.w("calculateFogMatrix is not supported on globe projection.");const r=u.b1();return u.as(r),r}getVisibleUnwrappedCoordinates(e){return[new u.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&u.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Qr(e);u.aN(l,l,1+r/u.bq);const h=u.bg();return u.ao(h,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),h[2]/h[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,l=[new u.P(0,0),new u.P(e,0),new u.P(this.width,0),new u.P(this.width,r),new u.P(this.width,this.height),new u.P(e,this.height),new u.P(0,this.height),new u.P(0,r)],h=[];for(const O of l)h.push(this.unprojectScreenPoint(O));let m=0,v=0,w=0,M=0;const A=this.center;for(const O of h){const F=u.bm(A.lng,O.lng),$=u.bm(A.lat,O.lat);F<v&&(v=F),F>m&&(m=F),$<M&&(M=$),$>w&&(w=$)}const k=[A.lng+v,A.lat+M,A.lng+m,A.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(k[3]=90,k[0]=-180,k[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(k[1]=-90,k[0]=-180,k[2]=180),new Ei(k)}getConstrained(e,r){const l=u.ad(e.lat,-85.051129,u.aI),h=u.ad(+r,this.minZoom+Dr(0,l),this.maxZoom);return{center:new u.Q(e.lng,l),zoom:h}}calculateCenterFromCameraLngLatAlt(e,r,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,h)}setLocationAtPoint(e,r){const l=Qr(this.unprojectScreenPoint(r)),h=Qr(e),m=u.bh();u.bn(m);const v=u.bh();u.bk(v,l,m,-this.center.lng*Math.PI/180),u.bj(v,v,m,this.center.lat*Math.PI/180);const w=h[0]*h[0]+h[2]*h[2],M=v[0]*v[0];if(w<M)return;const A=Math.sqrt(w-M),k=-A,O=u.bo(h[0],h[2],v[0],A),F=u.bo(h[0],h[2],v[0],k),$=u.bh();u.bk($,h,m,-O);const q=u.bo($[1],$[2],v[1],v[2]),te=u.bh();u.bk(te,h,m,-F);const ee=u.bo(te[1],te[2],v[1],v[2]),ie=.5*Math.PI,se=q>=-ie&&q<=ie,fe=ee>=-ie&&ee<=ie;let de,pe;if(se&&fe){const Be=this.center.lng*Math.PI/180,$e=this.center.lat*Math.PI/180;u.br(O,Be)+u.br(q,$e)<u.br(F,Be)+u.br(ee,$e)?(de=O,pe=q):(de=F,pe=ee)}else if(se)de=O,pe=q;else{if(!fe)return;de=F,pe=ee}const ye=de/Math.PI*180,ge=pe/Math.PI*180,Ie=this.center.lat;this.setCenter(new u.Q(ye,u.ad(ge,-90,90))),this.setZoom(this.zoom+Dr(Ie,this.center.lat))}locationToScreenPoint(e,r){const l=Qr(e);if(r){const h=r.getElevationForLngLatZoom(e,this._helper._tileZoom);u.aN(l,l,1+h/u.bq)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const r=u.bg();return u.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new u.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l)return l}return u.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,r){const l=this._cameraPosition,h=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,h)}getRayDirectionFromPixel(e){const r=u.bg();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,u.ao(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const l=u.bh();l[0]=r[0]-this._cameraPosition[0],l[1]=r[1]-this._cameraPosition[1],l[2]=r[2]-this._cameraPosition[2];const h=u.bh();return u.aS(h,l),h}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=u.bg();return u.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const l=u.aU(e,r),h=u.bh(),m=u.bh();u.aN(m,r,l),u.aR(h,e,m);const v=1-u.aU(h,h);if(v<0)return null;const w=u.aU(e,e)-1,M=-l+(l<0?1:-1)*Math.sqrt(v),A=w/M,k=M;return{tMin:Math.min(A,k),tMax:Math.max(A,k)}}unprojectScreenPoint(e){const r=this._cameraPosition,l=this.getRayDirectionFromPixel(e),h=this.rayPlanetIntersection(r,l);if(h){const A=u.bh();u.aO(A,r,[l[0]*h.tMin,l[1]*h.tMin,l[2]*h.tMin]);const k=u.bh();return u.aS(k,A),ru(k)}const m=this._cachedClippingPlane[0]*l[0]+this._cachedClippingPlane[1]*l[1]+this._cachedClippingPlane[2]*l[2],v=-u.bp(this._cachedClippingPlane,r)/m,w=u.bh();if(v>0)u.aO(w,r,[l[0]*v,l[1]*v,l[2]*v]);else{const A=u.bh();u.aO(A,r,[2*l[0],2*l[1],2*l[2]]);const k=u.bp(this._cachedClippingPlane,A);u.aR(w,A,[this._cachedClippingPlane[0]*k,this._cachedClippingPlane[1]*k,this._cachedClippingPlane[2]*k])}const M=u.bh();return u.aS(M,w),ru(M)}getMatrixForModel(e,r){const l=u.Q.convert(e),h=1/u.bq,m=u.b0();return u.bl(m,m,l.lng/180*Math.PI),u.a_(m,m,-l.lat/180*Math.PI),u.L(m,m,[0,0,1+r/u.bq]),u.a_(m,m,.5*Math.PI),u.M(m,m,[h,h,h]),m}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new u.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class ou{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Ao({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new bn,this._verticalPerspectiveTransform=new su}clone(){const e=new ou;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:r.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return u.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return u.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,l){const h=this._mercatorTransform.getPitchedTextCorrection(e,r,l),m=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,l);return u.bb(h,m,this._globeness)}projectTileCoordinates(e,r,l,h){return this.currentTransform.projectTileCoordinates(e,r,l,h)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,l,h){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,h)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=r.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Yn{get useGlobeControls(){return!0}handlePanInertia(e,r){const l=nc(e,r);return Math.abs(l.lng-r.center.lng)>180&&(l.lng=r.center.lng+179.5*Math.sign(l.lng-r.center.lng)),{easingCenter:l,easingOffset:new u.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const l=e.around,h=r.screenPointToLocation(l);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const m=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const v=r.zoom-m;if(v===0)return;const w=u.bm(r.center.lng,h.lng),M=w/(Math.abs(w/180)+1),A=u.bm(r.center.lat,h.lat),k=r.getRayDirectionFromPixel(l),O=r.cameraPosition,F=-1*u.aU(O,k),$=u.bh();u.aO($,O,[k[0]*F,k[1]*F,k[2]*F]);const q=u.bs($)-1,te=Math.exp(.5*-Math.max(q-.3,0)),ee=Sn(r.worldSize,r.center.lat)/Math.min(r.width,r.height),ie=u.be(ee,.9,.5,1,.25),se=(1-u.aH(-v))*Math.min(te,ie),fe=r.center.lat,de=r.zoom,pe=new u.Q(r.center.lng+M*se,u.ad(r.center.lat+A*se,-85.051129,u.aI));r.setLocationAtPoint(h,l);const ye=r.center,ge=u.be(Math.abs(w),45,85,0,1),Ie=u.be(ee,.75,.35,0,1),Be=Math.pow(Math.max(ge,Ie),.25),$e=u.bm(ye.lng,pe.lng),qe=u.bm(ye.lat,pe.lat);r.setCenter(new u.Q(ye.lng+$e*Be,ye.lat+qe*Be).wrap()),r.setZoom(de+Dr(fe,r.center.lat))}handleMapControlsPan(e,r,l){if(!e.panDelta)return;const h=r.center.lat,m=r.zoom;r.setCenter(nc(e.panDelta,r).wrap()),r.setZoom(m+Dr(h,r.center.lat))}cameraForBoxAndBearing(e,r,l,h,m){const v=iu(e,r,l,h,m),w=r.left/m.width*2-1,M=(m.width-r.right)/m.width*2-1,A=r.top/m.height*-2+1,k=(m.height-r.bottom)/m.height*-2+1,O=u.bm(l.getWest(),l.getEast())<0,F=O?l.getEast():l.getWest(),$=O?l.getWest():l.getEast(),q=Math.max(l.getNorth(),l.getSouth()),te=Math.min(l.getNorth(),l.getSouth()),ee=F+.5*u.bm(F,$),ie=q+.5*u.bm(q,te),se=m.clone();se.setCenter(v.center),se.setBearing(v.bearing),se.setPitch(0),se.setRoll(0),se.setZoom(v.zoom);const fe=se.modelViewProjectionMatrix,de=[Qr(l.getNorthWest()),Qr(l.getNorthEast()),Qr(l.getSouthWest()),Qr(l.getSouthEast()),Qr(new u.Q($,ie)),Qr(new u.Q(F,ie)),Qr(new u.Q(ee,q)),Qr(new u.Q(ee,te))],pe=Qr(v.center);let ye=Number.POSITIVE_INFINITY;for(const ge of de)w<0&&(ye=Yn.getLesserNonNegativeNonNull(ye,Yn.solveVectorScale(ge,pe,fe,"x",w))),M>0&&(ye=Yn.getLesserNonNegativeNonNull(ye,Yn.solveVectorScale(ge,pe,fe,"x",M))),A>0&&(ye=Yn.getLesserNonNegativeNonNull(ye,Yn.solveVectorScale(ge,pe,fe,"y",A))),k<0&&(ye=Yn.getLesserNonNegativeNonNull(ye,Yn.solveVectorScale(ge,pe,fe,"y",k)));if(Number.isFinite(ye)&&ye!==0)return v.zoom=se.zoom+u.aa(ye),v;sl()}handleJumpToCenterZoom(e,r){const l=e.center.lat,h=e.getConstrained(r.center?u.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(h.wrap());const m=r.zoom!==void 0?+r.zoom:e.zoom+Dr(l,h.lat);e.zoom!==m&&e.setZoom(m)}handleEaseTo(e,r){const l=e.zoom,h=e.center,m=e.padding,v={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},M=r.zoom!==void 0,A=!e.isPaddingEqual(r.padding);let k=!1;const O=r.center?u.Q.convert(r.center):h,F=e.getConstrained(O,l).center;On(e,F);const $=e.clone();$.setCenter(F),$.setZoom(M?+r.zoom:l+Dr(h.lat,O.lat)),$.setBearing(r.bearing);const q=new u.P(u.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),u.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));$.setLocationAtPoint(F,q);const te=(r.offset&&r.offsetAsPoint.mag())>0?$.center:F,ee=M?+r.zoom:l+Dr(h.lat,te.lat),ie=l+Dr(h.lat,0),se=ee+Dr(te.lat,0),fe=u.bm(h.lng,te.lng),de=u.bm(h.lat,te.lat),pe=u.aH(se-ie);return k=ee!==l,{easeFunc:ye=>{if(u.b5(v,w)||Xn({startEulerAngles:v,endEulerAngles:w,tr:e,k:ye,useSlerp:v.roll!=w.roll}),A&&e.interpolatePadding(m,r.padding,ye),r.around)u.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const ge=se>ie?Math.min(2,pe):Math.max(.5,pe),Ie=Math.pow(ge,1-ye),Be=zo(h,fe,de,ye*Ie);e.setCenter(Be.wrap())}if(k){const ge=u.B.number(ie,se,ye)+Dr(0,e.center.lat);e.setZoom(ge)}},isZooming:k,elevationCenter:te}}handleFlyTo(e,r){const l=r.zoom!==void 0,h=e.center,m=e.zoom,v=e.padding,w=!e.isPaddingEqual(r.padding),M=e.getConstrained(u.Q.convert(r.center||r.locationAtOffset),m).center,A=l?+r.zoom:e.zoom+Dr(e.center.lat,M.lat),k=e.clone();k.setCenter(M),k.setZoom(A),k.setBearing(r.bearing);const O=new u.P(u.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),u.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));k.setLocationAtPoint(M,O);const F=k.center;On(e,F);const $=function(de,pe,ye){const ge=Qr(pe),Ie=Qr(ye),Be=u.aU(ge,Ie),$e=Math.acos(Be),qe=rc(de);return $e/(2*Math.PI)*qe}(e,h,F),q=m+Dr(h.lat,0),te=A+Dr(F.lat,0),ee=u.aH(te-q);let ie;if(typeof r.minZoom=="number"){const de=+r.minZoom+Dr(F.lat,0),pe=Math.min(de,q,te)+Dr(0,F.lat),ye=e.getConstrained(F,pe).zoom+Dr(F.lat,0);ie=u.aH(ye-q)}const se=u.bm(h.lng,F.lng),fe=u.bm(h.lat,F.lat);return{easeFunc:(de,pe,ye,ge)=>{const Ie=zo(h,se,fe,ye);w&&e.interpolatePadding(v,r.padding,de);const Be=de===1?F:Ie;e.setCenter(Be.wrap());const $e=q+u.aa(pe);e.setZoom(de===1?A:$e+Dr(0,Be.lat))},scaleOfZoom:ee,targetCenter:F,scaleOfMinZoom:ie,pixelPathLength:$}}static solveVectorScale(e,r,l,h,m){const v=h==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],w=[l[3],l[7],l[11],l[15]],M=e[0]*v[0]+e[1]*v[1]+e[2]*v[2],A=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],k=r[0]*v[0]+r[1]*v[1]+r[2]*v[2],O=r[0]*w[0]+r[1]*w[1]+r[2]*w[2];return k+m*A===M+m*O||w[3]*(M-k)+v[3]*(O-A)+M*O==k*A?null:(k+v[3]-m*O-m*w[3])/(k-M-m*O+m*A)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class lu{constructor(e){this._globe=e,this._mercatorCameraHelper=new Fn,this._verticalPerspectiveCameraHelper=new Yn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,l){this.currentHelper.handleMapControlsPan(e,r,l)}cameraForBoxAndBearing(e,r,l,h,m){return this.currentHelper.cameraForBoxAndBearing(e,r,l,h,m)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const Es=(d,e)=>u.x(d,e&&e.filter(r=>r.identifier!=="source.canvas")),hh=u.bt();class ac extends u.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const h=this.sourceCaches[l].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new Xi(Yt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,h)=>this.getGlyphs(l,h)),this.dispatcher.registerMessageHandler("GI",(l,h)=>this.getImages(l,h)),this.imageManager=new Q,this.imageManager.setEventedParent(this),this.glyphManager=new ei(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new ve(256,512),this.crossTileSymbolIndex=new Jc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.bv()),Oi().on(bs,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const h=this.sourceCaches[l.sourceId];if(!h)return;const m=h.getSource();if(m&&m.vectorLayerIds)for(const v in this._layers){const w=this._layers[v];w.source===m.id&&this._validateLayer(w)}})}loadURL(e,r={},l){this.fire(new u.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;u.j(h,this._loadStyleRequest).then(v=>{this._loadStyleRequest=null,this._load(v.data,r,l)}).catch(v=>{this._loadStyleRequest=null,v&&!m.signal.aborted&&this.fire(new u.k(v))})}loadJSON(e,r={},l){this.fire(new u.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,be.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,l)}).catch(()=>{})}loadEmpty(){this.fire(new u.l("dataloading",{dataType:"style"})),this._load(hh,{validate:!1})}_load(e,r,l){var h,m;const v=r.transformStyle?r.transformStyle(l,e):e;if(!r.validate||!Es(this,u.y(v))){this._loaded=!0,this.stylesheet=v;for(const w in v.sources)this.addSource(w,v.sources[w],{validate:!1});v.sprite?this._loadSprite(v.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(v.glyphs),this._createLayers(),this.light=new Zt(this.stylesheet.light),this._setProjectionInternal(((h=this.stylesheet.projection)===null||h===void 0?void 0:h.type)||"mercator"),this.sky=new Wt(this.stylesheet.sky),this.map.setTerrain((m=this.stylesheet.terrain)!==null&&m!==void 0?m:null),this.fire(new u.l("data",{dataType:"style"})),this.fire(new u.l("style.load"))}}_createLayers(){const e=u.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const l=u.bx(r);l.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=l}}_loadSprite(e,r=!1,l=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,v,w,M){return u._(this,void 0,void 0,function*(){const A=ut(m),k=w>1?"@2x":"",O={},F={};for(const{id:$,url:q}of A){const te=v.transformRequest(yt(q,k,".json"),"SpriteJSON");O[$]=u.j(te,M);const ee=v.transformRequest(yt(q,k,".png"),"SpriteImage");F[$]=at.getImage(ee,M)}return yield Promise.all([...Object.values(O),...Object.values(F)]),function($,q){return u._(this,void 0,void 0,function*(){const te={};for(const ee in $){te[ee]={};const ie=be.getImageCanvasContext((yield q[ee]).data),se=(yield $[ee]).data;for(const fe in se){const{width:de,height:pe,x:ye,y:ge,sdf:Ie,pixelRatio:Be,stretchX:$e,stretchY:qe,content:Ze,textFitWidth:mt,textFitHeight:ft}=se[fe];te[ee][fe]={data:null,pixelRatio:Be,sdf:Ie,stretchX:$e,stretchY:qe,content:Ze,textFitWidth:mt,textFitHeight:ft,spriteData:{width:de,height:pe,x:ye,y:ge,context:ie}}}}return te})}(O,F)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const v in m){this._spritesImagesIds[v]=[];const w=this._spritesImagesIds[v]?this._spritesImagesIds[v].filter(M=>!(M in m)):[];for(const M of w)this.imageManager.removeImage(M),this._changedImages[M]=!0;for(const M in m[v]){const A=v==="default"?M:`${v}:${M}`;this._spritesImagesIds[v].push(A),A in this.imageManager.images?this.imageManager.updateImage(A,m[v][M],!1):this.imageManager.addImage(A,m[v][M]),r&&(this._changedImages[A]=!0)}}}).catch(m=>{this._spriteRequest=null,h=m,this.fire(new u.k(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"})),l&&l(h)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const l=e.sourceLayer;if(!l)return;const h=r.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(l)===-1)&&this.fire(new u.k(new Error(`Source layer "${l}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?u.by(l):l);const h=[];for(const m of e)if(l[m]){const v=r?u.by(l[m]):l[m];h.push(v)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const l of r){const h=this._layers[l];h.type!=="custom"&&(e[l]=h.serialize())}return e}hasTransitions(){var e,r,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const h in this.sourceCaches)if(this.sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(const v in this._updatedSources){const w=this._updatedSources[v];if(w==="reload")this._reloadSource(v);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(v)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const v in this._updatedPaintProps)this._layers[v].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const h in this.sourceCaches){const m=this.sourceCaches[h];l[h]=m.used,m.used=!1}for(const h of this._order){const m=this._layers[h];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const h in l){const m=this.sourceCaches[h];!!l[h]!=!!m.used&&m.fire(new u.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new u.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var l;this._checkLoaded();const h=this.serialize();if(e=r.transformStyle?r.transformStyle(h,e):e,((l=r.validate)===null||l===void 0||l)&&Es(this,u.y(e)))return!1;(e=u.by(e)).layers=u.bw(e.layers);const m=u.bz(h,e),v=this._getOperationsToPerform(m);if(v.unimplemented.length>0)throw new Error(`Unimplemented: ${v.unimplemented.join(", ")}.`);if(v.operations.length===0)return!1;for(const w of v.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],l=[];for(const h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":r.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":r.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,h.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setSky":r.push(()=>this.setSky.apply(this,h.args));break;case"setProjection":this.setProjection.apply(this,h.args);break;case"setTransition":r.push(()=>{});break;default:l.push(h.command)}return{operations:r,unimplemented:l}}addImage(e,r){if(this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new u.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(u.y.source,`sources.${e}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const h=this.sourceCaches[e]=new L(e,r,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new u.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new u.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,l={}){this._checkLoaded();const h=e.id;if(this.getLayer(h))return void this.fire(new u.k(new Error(`Layer "${h}" already exists on this map.`)));let m;if(e.type==="custom"){if(Es(this,u.bA(e)))return;m=u.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=u.by(e),e=u.e(e,{source:h})),this._validate(u.y.layer,`layers.${h}`,e,{arrayIndex:-1},l))return;m=u.bx(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}const v=r?this._order.indexOf(r):this._order.length;if(r&&v===-1)this.fire(new u.k(new Error(`Cannot add layer "${h}" before non-existing layer "${r}".`)));else{if(this._order.splice(v,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){const w=this._removedLayers[h];delete this._removedLayers[h],w.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new u.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const l=this._order.indexOf(e);this._order.splice(l,1);const h=r?this._order.indexOf(r):this._order.length;r&&h===-1?this.fire(new u.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new u.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,l){this._checkLoaded();const h=this.getLayer(e);h?h.minzoom===r&&h.maxzoom===l||(r!=null&&(h.minzoom=r),l!=null&&(h.maxzoom=l),this._updateLayer(h)):this.fire(new u.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,l={}){this._checkLoaded();const h=this.getLayer(e);if(h){if(!u.bB(h.filter,r))return r==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(u.y.filter,`layers.${h.id}.filter`,r,null,l)||(h.filter=u.by(r),this._updateLayer(h)))}else this.fire(new u.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return u.by(this.getLayer(e).filter)}setLayoutProperty(e,r,l,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.bB(m.getLayoutProperty(r),l)||(m.setLayoutProperty(r,l,h),this._updateLayer(m)):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const l=this.getLayer(e);if(l)return l.getLayoutProperty(r);this.fire(new u.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,l,h={}){this._checkLoaded();const m=this.getLayer(e);m?u.bB(m.getPaintProperty(r),l)||(m.setPaintProperty(r,l,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new u.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const l=e.source,h=e.sourceLayer,m=this.sourceCaches[l];if(m===void 0)return void this.fire(new u.k(new Error(`The source '${l}' does not exist in the map's style.`)));const v=m.getSource().type;v==="geojson"&&h?this.fire(new u.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):v!=="vector"||h?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,e.id,r)):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const l=e.source,h=this.sourceCaches[l];if(h===void 0)return void this.fire(new u.k(new Error(`The source '${l}' does not exist in the map's style.`)));const m=h.getSource().type,v=m==="vector"?e.sourceLayer:void 0;m!=="vector"||v?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new u.k(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(v,e.id,r):this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,l=e.sourceLayer,h=this.sourceCaches[r];if(h!==void 0)return h.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new u.k(new Error("The feature id parameter must be provided."))),h.getFeatureState(l,e.id)):void this.fire(new u.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=u.bC(this.sourceCaches,m=>m.serialize()),r=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,h=this.stylesheet;return u.bD({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,projection:h.projection,sources:e,layers:r,terrain:l},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=v=>this._layers[v].type==="fill-extrusion",l={},h=[];for(let v=this._order.length-1;v>=0;v--){const w=this._order[v];if(r(w)){l[w]=v;for(const M of e){const A=M[w];if(A)for(const k of A)h.push(k)}}}h.sort((v,w)=>w.intersectionZ-v.intersectionZ);const m=[];for(let v=this._order.length-1;v>=0;v--){const w=this._order[v];if(r(w))for(let M=h.length-1;M>=0;M--){const A=h[M].feature;if(l[A.layer.id]<v)break;m.push(A),h.pop()}else for(const M of e){const A=M[w];if(A)for(const k of A)m.push(k.feature)}}return m}queryRenderedFeatures(e,r,l){r&&r.filter&&this._validate(u.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const h={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new u.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const A of r.layers){const k=this._layers[A];if(!k)return this.fire(new u.k(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];h[k.source]=!0}}const m=[];r.availableImages=this._availableImages;const v=this._serializedAllLayers(),w=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,M=Object.assign(Object.assign({},r),{layers:w});for(const A in this.sourceCaches)r.layers&&!h[A]||m.push(Ci(this.sourceCaches[A],this._layers,v,e,M,l));return this.placement&&m.push(function(A,k,O,F,$,q,te){const ee={},ie=q.queryRenderedSymbols(F),se=[];for(const fe of Object.keys(ie).map(Number))se.push(te[fe]);se.sort(Ai);for(const fe of se){const de=fe.featureIndex.lookupSymbolFeatures(ie[fe.bucketInstanceId],k,fe.bucketIndex,fe.sourceLayerIndex,$.filter,$.layers,$.availableImages,A);for(const pe in de){const ye=ee[pe]=ee[pe]||[],ge=de[pe];ge.sort((Ie,Be)=>{const $e=fe.featureSortOrder;if($e){const qe=$e.indexOf(Ie.featureIndex);return $e.indexOf(Be.featureIndex)-qe}return Be.featureIndex-Ie.featureIndex});for(const Ie of ge)ye.push(Ie)}}return function(fe,de,pe){for(const ye in fe)for(const ge of fe[ye])Bi(ge,pe[de[ye].source]);return fe}(ee,A,O)}(this._layers,v,this.sourceCaches,e,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,r){r&&r.filter&&this._validate(u.y.filter,"querySourceFeatures.filter",r.filter,null,r);const l=this.sourceCaches[e];return l?function(h,m){const v=h.getRenderableIds().map(A=>h.getTileByID(A)),w=[],M={};for(let A=0;A<v.length;A++){const k=v[A],O=k.tileID.canonical.key;M[O]||(M[O]=!0,k.querySourceFeatures(w,m))}return w}(l,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const l=this.light.getLight();let h=!1;for(const v in e)if(!u.bB(e[v],l[v])){h=!0;break}if(!h)return;const m={now:be.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(m)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const l=this.getSky();let h=!1;if(!e&&!l)return;if(e&&!l)h=!0;else if(!e&&l)h=!0;else for(const v in e)if(!u.bB(e[v],l[v])){h=!0;break}if(!h)return;const m={now:be.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(m)}_setProjectionInternal(e){const r=function(l){if(Array.isArray(l)){const h=new ll({type:l});return{projection:h,transform:new ou,cameraHelper:new lu(h)}}switch(l){case"mercator":return{projection:new eu,transform:new bn,cameraHelper:new Fn};case"globe":{const h=new ll({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:h,transform:new ou,cameraHelper:new lu(h)}}case"vertical-perspective":return{projection:new os,transform:new su,cameraHelper:new Yn};default:return u.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new eu,transform:new bn,cameraHelper:new Fn}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,r,l,h,m={}){return(!m||m.validate!==!1)&&Es(this,e.call(u.y,u.e({key:r,style:this.serialize(),value:l,styleSpec:u.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Oi().off(bs,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const l=this.sourceCaches[r];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,l,h,m=!1){let v=!1,w=!1;const M={};for(const A of this._order){const k=this._layers[A];if(k.type!=="symbol")continue;if(!M[k.source]){const F=this.sourceCaches[k.source];M[k.source]=F.getRenderableIds(!0).map($=>F.getTileByID($)).sort(($,q)=>q.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(q.tileID)?-1:1))}const O=this.crossTileSymbolIndex.addLayer(k,M[k.source],e.center.lng);v=v||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(be.now(),e.zoom))&&(this.pauseablePlacement=new Ua(e,this.map.terrain,this._order,m,r,l,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,M),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(be.now()),w=!0),v&&this.pauseablePlacement.placement.setStale()),w||v)for(const A of this._order){const k=this._layers[A];k.type==="symbol"&&this.placement.updateLayerOpacities(k,M[k.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(be.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return u._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const h=this.sourceCaches[r.source];return h&&h.setDependencies(r.tileID.key,r.type,r.icons),l})}getGlyphs(e,r){return u._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(r.stacks),h=this.sourceCaches[r.source];return h&&h.setDependencies(r.tileID.key,r.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(u.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,l={},h){this._checkLoaded();const m=[{id:e,url:r}],v=[...ut(this.stylesheet.sprite),...m];this._validate(u.y.sprite,"sprite",v,null,l)||(this.stylesheet.sprite=v,this._loadSprite(m,!0,h))}removeSprite(e){this._checkLoaded();const r=ut(this.stylesheet.sprite);if(r.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;r.splice(r.findIndex(l=>l.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.l("data",{dataType:"style"}))}else this.fire(new u.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return ut(this.stylesheet.sprite)}setSprite(e,r={},l){this._checkLoaded(),e&&this._validate(u.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var ls=u.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class cf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,l,h,m,v,w,M,A){this.context=e;let k=this.boundPaintVertexBuffers.length!==h.length;for(let O=0;!k&&O<h.length;O++)this.boundPaintVertexBuffers[O]!==h[O]&&(k=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||k||this.boundIndexBuffer!==m||this.boundVertexOffset!==v||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==M||this.boundDynamicVertexBuffer3!==A?this.freshBind(r,l,h,m,v,w,M,A):(e.bindVertexArray.set(this.vao),w&&w.bind(),m&&m.dynamicDraw&&m.bind(),M&&M.bind(),A&&A.bind())}freshBind(e,r,l,h,m,v,w,M){const A=e.numAttributes,k=this.context,O=k.gl;this.vao&&this.destroy(),this.vao=k.createVertexArray(),k.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=v,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=M,r.enableAttributes(O,e);for(const F of l)F.enableAttributes(O,e);v&&v.enableAttributes(O,e),w&&w.enableAttributes(O,e),M&&M.enableAttributes(O,e),r.bind(),r.setVertexAttribPointers(O,e,m);for(const F of l)F.bind(),F.setVertexAttribPointers(O,e,m);v&&(v.bind(),v.setVertexAttribPointers(O,e,m)),h&&h.bind(),w&&(w.bind(),w.setVertexAttribPointers(O,e,m)),M&&(M.bind(),M.setVertexAttribPointers(O,e,m)),k.currentNumAttributes=A}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const fh=(d,e,r,l,h)=>({u_texture:0,u_ele_delta:d,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):u.b6.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?0:r?r.calculateFogBlendOpacity(l):0,u_horizon_color:r?r.properties.get("horizon-color"):u.b6.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:h?1:0}),sc={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Xs(d){const e=[];for(let r=0;r<d.length;r++){if(d[r]===null)continue;const l=d[r].split(" ");e.push(l.pop())}return e}class fd{constructor(e,r,l,h,m,v,w,M){const A=e.gl;this.program=A.createProgram();const k=Xs(r.staticAttributes),O=l?l.getBinderAttributes():[],F=k.concat(O),$=Va.prelude.staticUniforms?Xs(Va.prelude.staticUniforms):[],q=w.staticUniforms?Xs(w.staticUniforms):[],te=r.staticUniforms?Xs(r.staticUniforms):[],ee=l?l.getBinderUniforms():[],ie=$.concat(q).concat(te).concat(ee),se=[];for(const Be of ie)se.indexOf(Be)<0&&se.push(Be);const fe=l?l.defines():[];jn(A)&&fe.unshift("#version 300 es"),m&&fe.push("#define OVERDRAW_INSPECTOR;"),v&&fe.push("#define TERRAIN3D;"),M&&fe.push(M);let de=fe.concat(Va.prelude.fragmentSource,w.fragmentSource,r.fragmentSource).join(`
`),pe=fe.concat(Va.prelude.vertexSource,w.vertexSource,r.vertexSource).join(`
`);jn(A)||(de=function(Be){return Be.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(de),pe=function(Be){return Be.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(pe));const ye=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);if(A.shaderSource(ye,de),A.compileShader(ye),!A.getShaderParameter(ye,A.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${A.getShaderInfoLog(ye)}`);A.attachShader(this.program,ye);const ge=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);if(A.shaderSource(ge,pe),A.compileShader(ge),!A.getShaderParameter(ge,A.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${A.getShaderInfoLog(ge)}`);A.attachShader(this.program,ge),this.attributes={};const Ie={};this.numAttributes=F.length;for(let Be=0;Be<this.numAttributes;Be++)F[Be]&&(A.bindAttribLocation(this.program,Be,F[Be]),this.attributes[F[Be]]=Be);if(A.linkProgram(this.program),!A.getProgramParameter(this.program,A.LINK_STATUS))throw new Error(`Program failed to link: ${A.getProgramInfoLog(this.program)}`);A.deleteShader(ge),A.deleteShader(ye);for(let Be=0;Be<se.length;Be++){const $e=se[Be];if($e&&!Ie[$e]){const qe=A.getUniformLocation(this.program,$e);qe&&(Ie[$e]=qe)}}this.fixedUniforms=h(e,Ie),this.terrainUniforms=((Be,$e)=>({u_depth:new u.bE(Be,$e.u_depth),u_terrain:new u.bE(Be,$e.u_terrain),u_terrain_dim:new u.b7(Be,$e.u_terrain_dim),u_terrain_matrix:new u.bG(Be,$e.u_terrain_matrix),u_terrain_unpack:new u.bH(Be,$e.u_terrain_unpack),u_terrain_exaggeration:new u.b7(Be,$e.u_terrain_exaggeration)}))(e,Ie),this.projectionUniforms=((Be,$e)=>({u_projection_matrix:new u.bG(Be,$e.u_projection_matrix),u_projection_tile_mercator_coords:new u.bH(Be,$e.u_projection_tile_mercator_coords),u_projection_clipping_plane:new u.bH(Be,$e.u_projection_clipping_plane),u_projection_transition:new u.b7(Be,$e.u_projection_transition),u_projection_fallback_matrix:new u.bG(Be,$e.u_projection_fallback_matrix)}))(e,Ie),this.binderUniforms=l?l.getUniforms(e,Ie):[]}draw(e,r,l,h,m,v,w,M,A,k,O,F,$,q,te,ee,ie,se,fe){const de=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(h),e.setColorMode(m),e.setCullFace(v),M){e.activeTexture.set(de.TEXTURE2),de.bindTexture(de.TEXTURE_2D,M.depthTexture),e.activeTexture.set(de.TEXTURE3),de.bindTexture(de.TEXTURE_2D,M.texture);for(const ye in this.terrainUniforms)this.terrainUniforms[ye].set(M[ye])}if(A)for(const ye in A)this.projectionUniforms[sc[ye]].set(A[ye]);if(w)for(const ye in this.fixedUniforms)this.fixedUniforms[ye].set(w[ye]);ee&&ee.setUniforms(e,this.binderUniforms,q,{zoom:te});let pe=0;switch(r){case de.LINES:pe=2;break;case de.TRIANGLES:pe=3;break;case de.LINE_STRIP:pe=1}for(const ye of $.get()){const ge=ye.vaos||(ye.vaos={});(ge[k]||(ge[k]=new cf)).bind(e,this,O,ee?ee.getPaintVertexBuffers():[],F,ye.vertexOffset,ie,se,fe),de.drawElements(r,ye.primitiveLength*pe,de.UNSIGNED_SHORT,ye.primitiveOffset*pe*2)}}}function oc(d,e,r){const l=1/u.av(r,1,e.transform.tileZoom),h=Math.pow(2,r.tileID.overscaledZ),m=r.tileSize*Math.pow(2,e.transform.tileZoom)/h,v=m*(r.tileID.canonical.x+r.tileID.wrap*h),w=m*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[l,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[v>>16,w>>16],u_pixel_coord_lower:[65535&v,65535&w]}}const uf=(d,e,r,l)=>{const h=d.style.light,m=h.properties.get("position"),v=[m.x,m.y,m.z],w=u.bK();h.properties.get("anchor")==="viewport"&&u.bL(w,d.transform.bearingInRadians),u.bM(v,v,w);const M=d.transform.transformLightDirection(v),A=h.properties.get("color");return{u_lightpos:v,u_lightpos_globe:M,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[A.r,A.g,A.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:l}},cl=(d,e,r,l,h,m,v)=>u.e(uf(d,e,r,l),oc(m,d,v),{u_height_factor:-Math.pow(2,h.overscaledZ)/v.tileSize/8}),hf=(d,e,r,l)=>u.e(oc(e,d,r),{u_fill_translate:l}),ff=(d,e)=>({u_world:d,u_fill_translate:e}),dh=(d,e,r,l,h)=>u.e(hf(d,e,r,h),{u_world:l}),ul=(d,e,r,l,h)=>{const m=d.transform;let v,w,M=0;if(r.paint.get("circle-pitch-alignment")==="map"){const A=u.av(e,1,m.zoom);v=!0,w=[A,A],M=A/(u.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*h}else v=!1,w=m.pixelsToGLUnits;return{u_camera_to_center_distance:m.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+v,u_device_pixel_ratio:d.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:M,u_translate:l}},ph=d=>({u_pixel_extrude_scale:[1/d.width,1/d.height]}),mh=d=>({u_viewport_size:[d.width,d.height]}),cu=(d,e=1)=>({u_color:d,u_overlay:0,u_overlay_scale:e}),uu=(d,e,r,l)=>{const h=u.av(d,1,e)/(u.Z*Math.pow(2,d.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:u.av(d,1,e),u_intensity:r,u_globe_extrude_scale:h}},hu=(d,e,r,l)=>{const h=u.K();u.bN(h,0,d.width,d.height,0,0,1);const m=d.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:r,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},Ys=(d,e,r)=>{const l=r.paint.get("hillshade-shadow-color"),h=r.paint.get("hillshade-highlight-color"),m=r.paint.get("hillshade-accent-color");let v=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return r.paint.get("hillshade-illumination-anchor")==="viewport"&&(v+=d.transform.bearingInRadians),{u_image:0,u_latrange:df(0,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),v],u_shadow:l,u_highlight:h,u_accent:m}},Po=(d,e)=>{const r=e.stride,l=u.K();return u.bN(l,0,u.Z,-8192,0,0,1),u.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[r,r],u_zoom:d.overscaledZ,u_unpack:e.getUnpackVector()}};function df(d,e){const r=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new u.$(0,l/r).toLngLat().lat,new u.$(0,(l+1)/r).toLngLat().lat]}const Ro=(d,e,r,l)=>{const h=d.transform;return{u_translation:Do(d,e,r),u_ratio:l/u.av(e,1,h.zoom),u_device_pixel_ratio:d.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},dd=(d,e,r,l,h)=>u.e(Ro(d,e,r,l),{u_image:0,u_image_height:h}),lc=(d,e,r,l,h)=>{const m=d.transform,v=hl(e,m);return{u_translation:Do(d,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:l/u.av(e,1,m.zoom),u_device_pixel_ratio:d.pixelRatio,u_image:0,u_scale:[v,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},pf=(d,e,r,l,h,m)=>{const v=d.lineAtlas,w=hl(e,d.transform),M=r.layout.get("line-cap")==="round",A=v.getDash(h.from,M),k=v.getDash(h.to,M),O=A.width*m.fromScale,F=k.width*m.toScale;return u.e(Ro(d,e,r,l),{u_patternscale_a:[w/O,-A.height/2],u_patternscale_b:[w/F,-k.height/2],u_sdfgamma:v.width/(256*Math.min(O,F)*d.pixelRatio)/2,u_image:0,u_tex_y_a:A.y,u_tex_y_b:k.y,u_mix:m.t})};function hl(d,e){return 1/u.av(d,1,e.tileZoom)}function Do(d,e,r){return u.aw(d.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const mf=(d,e,r,l,h)=>{return{u_tl_parent:d,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(v=l.paint.get("raster-saturation"),v>0?1-1/(1.001-v):-v),u_contrast_factor:(m=l.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:cc(l.paint.get("raster-hue-rotate")),u_coords_top:[h[0].x,h[0].y,h[1].x,h[1].y],u_coords_bottom:[h[3].x,h[3].y,h[2].x,h[2].y]};var m,v};function cc(d){d*=Math.PI/180;const e=Math.sin(d),r=Math.cos(d);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const uc=(d,e,r,l,h,m,v,w,M,A,k,O,F)=>{const $=v.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:$.width/$.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:M,u_is_text:+k,u_pitch_with_map:+l,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:O,u_texture:0,u_translation:A,u_pitched_scale:F}},fu=(d,e,r,l,h,m,v,w,M,A,k,O,F,$)=>{const q=v.transform;return u.e(uc(d,e,r,l,h,m,v,w,M,A,k,O,$),{u_gamma_scale:l?Math.cos(q.pitch*Math.PI/180)*q.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:1})},fl=(d,e,r,l,h,m,v,w,M,A,k,O,F)=>u.e(fu(d,e,r,l,h,m,v,w,M,A,!0,k,0,F),{u_texsize_icon:O,u_texture_icon:1}),Ga=(d,e)=>({u_opacity:d,u_color:e}),du=(d,e,r,l,h)=>u.e(function(m,v,w,M){const A=w.imageManager.getPattern(m.from.toString()),k=w.imageManager.getPattern(m.to.toString()),{width:O,height:F}=w.imageManager.getPixelSize(),$=Math.pow(2,M.tileID.overscaledZ),q=M.tileSize*Math.pow(2,w.transform.tileZoom)/$,te=q*(M.tileID.canonical.x+M.tileID.wrap*$),ee=q*M.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:A.tl,u_pattern_br_a:A.br,u_pattern_tl_b:k.tl,u_pattern_br_b:k.br,u_texsize:[O,F],u_mix:v.t,u_pattern_size_a:A.displaySize,u_pattern_size_b:k.displaySize,u_scale_a:v.fromScale,u_scale_b:v.toScale,u_tile_units_to_pixels:1/u.av(M,1,w.transform.tileZoom),u_pixel_coord_upper:[te>>16,ee>>16],u_pixel_coord_lower:[65535&te,65535&ee]}}(r,h,e,l),{u_opacity:d}),hc=(d,e)=>{},pu={fillExtrusion:(d,e)=>({u_lightpos:new u.bI(d,e.u_lightpos),u_lightpos_globe:new u.bI(d,e.u_lightpos_globe),u_lightintensity:new u.b7(d,e.u_lightintensity),u_lightcolor:new u.bI(d,e.u_lightcolor),u_vertical_gradient:new u.b7(d,e.u_vertical_gradient),u_opacity:new u.b7(d,e.u_opacity),u_fill_translate:new u.bJ(d,e.u_fill_translate)}),fillExtrusionPattern:(d,e)=>({u_lightpos:new u.bI(d,e.u_lightpos),u_lightpos_globe:new u.bI(d,e.u_lightpos_globe),u_lightintensity:new u.b7(d,e.u_lightintensity),u_lightcolor:new u.bI(d,e.u_lightcolor),u_vertical_gradient:new u.b7(d,e.u_vertical_gradient),u_height_factor:new u.b7(d,e.u_height_factor),u_opacity:new u.b7(d,e.u_opacity),u_fill_translate:new u.bJ(d,e.u_fill_translate),u_image:new u.bE(d,e.u_image),u_texsize:new u.bJ(d,e.u_texsize),u_pixel_coord_upper:new u.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bJ(d,e.u_pixel_coord_lower),u_scale:new u.bI(d,e.u_scale),u_fade:new u.b7(d,e.u_fade)}),fill:(d,e)=>({u_fill_translate:new u.bJ(d,e.u_fill_translate)}),fillPattern:(d,e)=>({u_image:new u.bE(d,e.u_image),u_texsize:new u.bJ(d,e.u_texsize),u_pixel_coord_upper:new u.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bJ(d,e.u_pixel_coord_lower),u_scale:new u.bI(d,e.u_scale),u_fade:new u.b7(d,e.u_fade),u_fill_translate:new u.bJ(d,e.u_fill_translate)}),fillOutline:(d,e)=>({u_world:new u.bJ(d,e.u_world),u_fill_translate:new u.bJ(d,e.u_fill_translate)}),fillOutlinePattern:(d,e)=>({u_world:new u.bJ(d,e.u_world),u_image:new u.bE(d,e.u_image),u_texsize:new u.bJ(d,e.u_texsize),u_pixel_coord_upper:new u.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bJ(d,e.u_pixel_coord_lower),u_scale:new u.bI(d,e.u_scale),u_fade:new u.b7(d,e.u_fade),u_fill_translate:new u.bJ(d,e.u_fill_translate)}),circle:(d,e)=>({u_camera_to_center_distance:new u.b7(d,e.u_camera_to_center_distance),u_scale_with_map:new u.bE(d,e.u_scale_with_map),u_pitch_with_map:new u.bE(d,e.u_pitch_with_map),u_extrude_scale:new u.bJ(d,e.u_extrude_scale),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_globe_extrude_scale:new u.b7(d,e.u_globe_extrude_scale),u_translate:new u.bJ(d,e.u_translate)}),collisionBox:(d,e)=>({u_pixel_extrude_scale:new u.bJ(d,e.u_pixel_extrude_scale)}),collisionCircle:(d,e)=>({u_viewport_size:new u.bJ(d,e.u_viewport_size)}),debug:(d,e)=>({u_color:new u.bF(d,e.u_color),u_overlay:new u.bE(d,e.u_overlay),u_overlay_scale:new u.b7(d,e.u_overlay_scale)}),depth:hc,clippingMask:hc,heatmap:(d,e)=>({u_extrude_scale:new u.b7(d,e.u_extrude_scale),u_intensity:new u.b7(d,e.u_intensity),u_globe_extrude_scale:new u.b7(d,e.u_globe_extrude_scale)}),heatmapTexture:(d,e)=>({u_matrix:new u.bG(d,e.u_matrix),u_world:new u.bJ(d,e.u_world),u_image:new u.bE(d,e.u_image),u_color_ramp:new u.bE(d,e.u_color_ramp),u_opacity:new u.b7(d,e.u_opacity)}),hillshade:(d,e)=>({u_image:new u.bE(d,e.u_image),u_latrange:new u.bJ(d,e.u_latrange),u_light:new u.bJ(d,e.u_light),u_shadow:new u.bF(d,e.u_shadow),u_highlight:new u.bF(d,e.u_highlight),u_accent:new u.bF(d,e.u_accent)}),hillshadePrepare:(d,e)=>({u_matrix:new u.bG(d,e.u_matrix),u_image:new u.bE(d,e.u_image),u_dimension:new u.bJ(d,e.u_dimension),u_zoom:new u.b7(d,e.u_zoom),u_unpack:new u.bH(d,e.u_unpack)}),line:(d,e)=>({u_translation:new u.bJ(d,e.u_translation),u_ratio:new u.b7(d,e.u_ratio),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_units_to_pixels:new u.bJ(d,e.u_units_to_pixels)}),lineGradient:(d,e)=>({u_translation:new u.bJ(d,e.u_translation),u_ratio:new u.b7(d,e.u_ratio),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_units_to_pixels:new u.bJ(d,e.u_units_to_pixels),u_image:new u.bE(d,e.u_image),u_image_height:new u.b7(d,e.u_image_height)}),linePattern:(d,e)=>({u_translation:new u.bJ(d,e.u_translation),u_texsize:new u.bJ(d,e.u_texsize),u_ratio:new u.b7(d,e.u_ratio),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_image:new u.bE(d,e.u_image),u_units_to_pixels:new u.bJ(d,e.u_units_to_pixels),u_scale:new u.bI(d,e.u_scale),u_fade:new u.b7(d,e.u_fade)}),lineSDF:(d,e)=>({u_translation:new u.bJ(d,e.u_translation),u_ratio:new u.b7(d,e.u_ratio),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_units_to_pixels:new u.bJ(d,e.u_units_to_pixels),u_patternscale_a:new u.bJ(d,e.u_patternscale_a),u_patternscale_b:new u.bJ(d,e.u_patternscale_b),u_sdfgamma:new u.b7(d,e.u_sdfgamma),u_image:new u.bE(d,e.u_image),u_tex_y_a:new u.b7(d,e.u_tex_y_a),u_tex_y_b:new u.b7(d,e.u_tex_y_b),u_mix:new u.b7(d,e.u_mix)}),raster:(d,e)=>({u_tl_parent:new u.bJ(d,e.u_tl_parent),u_scale_parent:new u.b7(d,e.u_scale_parent),u_buffer_scale:new u.b7(d,e.u_buffer_scale),u_fade_t:new u.b7(d,e.u_fade_t),u_opacity:new u.b7(d,e.u_opacity),u_image0:new u.bE(d,e.u_image0),u_image1:new u.bE(d,e.u_image1),u_brightness_low:new u.b7(d,e.u_brightness_low),u_brightness_high:new u.b7(d,e.u_brightness_high),u_saturation_factor:new u.b7(d,e.u_saturation_factor),u_contrast_factor:new u.b7(d,e.u_contrast_factor),u_spin_weights:new u.bI(d,e.u_spin_weights),u_coords_top:new u.bH(d,e.u_coords_top),u_coords_bottom:new u.bH(d,e.u_coords_bottom)}),symbolIcon:(d,e)=>({u_is_size_zoom_constant:new u.bE(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bE(d,e.u_is_size_feature_constant),u_size_t:new u.b7(d,e.u_size_t),u_size:new u.b7(d,e.u_size),u_camera_to_center_distance:new u.b7(d,e.u_camera_to_center_distance),u_pitch:new u.b7(d,e.u_pitch),u_rotate_symbol:new u.bE(d,e.u_rotate_symbol),u_aspect_ratio:new u.b7(d,e.u_aspect_ratio),u_fade_change:new u.b7(d,e.u_fade_change),u_label_plane_matrix:new u.bG(d,e.u_label_plane_matrix),u_coord_matrix:new u.bG(d,e.u_coord_matrix),u_is_text:new u.bE(d,e.u_is_text),u_pitch_with_map:new u.bE(d,e.u_pitch_with_map),u_is_along_line:new u.bE(d,e.u_is_along_line),u_is_variable_anchor:new u.bE(d,e.u_is_variable_anchor),u_texsize:new u.bJ(d,e.u_texsize),u_texture:new u.bE(d,e.u_texture),u_translation:new u.bJ(d,e.u_translation),u_pitched_scale:new u.b7(d,e.u_pitched_scale)}),symbolSDF:(d,e)=>({u_is_size_zoom_constant:new u.bE(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bE(d,e.u_is_size_feature_constant),u_size_t:new u.b7(d,e.u_size_t),u_size:new u.b7(d,e.u_size),u_camera_to_center_distance:new u.b7(d,e.u_camera_to_center_distance),u_pitch:new u.b7(d,e.u_pitch),u_rotate_symbol:new u.bE(d,e.u_rotate_symbol),u_aspect_ratio:new u.b7(d,e.u_aspect_ratio),u_fade_change:new u.b7(d,e.u_fade_change),u_label_plane_matrix:new u.bG(d,e.u_label_plane_matrix),u_coord_matrix:new u.bG(d,e.u_coord_matrix),u_is_text:new u.bE(d,e.u_is_text),u_pitch_with_map:new u.bE(d,e.u_pitch_with_map),u_is_along_line:new u.bE(d,e.u_is_along_line),u_is_variable_anchor:new u.bE(d,e.u_is_variable_anchor),u_texsize:new u.bJ(d,e.u_texsize),u_texture:new u.bE(d,e.u_texture),u_gamma_scale:new u.b7(d,e.u_gamma_scale),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_is_halo:new u.bE(d,e.u_is_halo),u_translation:new u.bJ(d,e.u_translation),u_pitched_scale:new u.b7(d,e.u_pitched_scale)}),symbolTextAndIcon:(d,e)=>({u_is_size_zoom_constant:new u.bE(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new u.bE(d,e.u_is_size_feature_constant),u_size_t:new u.b7(d,e.u_size_t),u_size:new u.b7(d,e.u_size),u_camera_to_center_distance:new u.b7(d,e.u_camera_to_center_distance),u_pitch:new u.b7(d,e.u_pitch),u_rotate_symbol:new u.bE(d,e.u_rotate_symbol),u_aspect_ratio:new u.b7(d,e.u_aspect_ratio),u_fade_change:new u.b7(d,e.u_fade_change),u_label_plane_matrix:new u.bG(d,e.u_label_plane_matrix),u_coord_matrix:new u.bG(d,e.u_coord_matrix),u_is_text:new u.bE(d,e.u_is_text),u_pitch_with_map:new u.bE(d,e.u_pitch_with_map),u_is_along_line:new u.bE(d,e.u_is_along_line),u_is_variable_anchor:new u.bE(d,e.u_is_variable_anchor),u_texsize:new u.bJ(d,e.u_texsize),u_texsize_icon:new u.bJ(d,e.u_texsize_icon),u_texture:new u.bE(d,e.u_texture),u_texture_icon:new u.bE(d,e.u_texture_icon),u_gamma_scale:new u.b7(d,e.u_gamma_scale),u_device_pixel_ratio:new u.b7(d,e.u_device_pixel_ratio),u_is_halo:new u.bE(d,e.u_is_halo),u_translation:new u.bJ(d,e.u_translation),u_pitched_scale:new u.b7(d,e.u_pitched_scale)}),background:(d,e)=>({u_opacity:new u.b7(d,e.u_opacity),u_color:new u.bF(d,e.u_color)}),backgroundPattern:(d,e)=>({u_opacity:new u.b7(d,e.u_opacity),u_image:new u.bE(d,e.u_image),u_pattern_tl_a:new u.bJ(d,e.u_pattern_tl_a),u_pattern_br_a:new u.bJ(d,e.u_pattern_br_a),u_pattern_tl_b:new u.bJ(d,e.u_pattern_tl_b),u_pattern_br_b:new u.bJ(d,e.u_pattern_br_b),u_texsize:new u.bJ(d,e.u_texsize),u_mix:new u.b7(d,e.u_mix),u_pattern_size_a:new u.bJ(d,e.u_pattern_size_a),u_pattern_size_b:new u.bJ(d,e.u_pattern_size_b),u_scale_a:new u.b7(d,e.u_scale_a),u_scale_b:new u.b7(d,e.u_scale_b),u_pixel_coord_upper:new u.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new u.bJ(d,e.u_pixel_coord_lower),u_tile_units_to_pixels:new u.b7(d,e.u_tile_units_to_pixels)}),terrain:(d,e)=>({u_texture:new u.bE(d,e.u_texture),u_ele_delta:new u.b7(d,e.u_ele_delta),u_fog_matrix:new u.bG(d,e.u_fog_matrix),u_fog_color:new u.bF(d,e.u_fog_color),u_fog_ground_blend:new u.b7(d,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.b7(d,e.u_fog_ground_blend_opacity),u_horizon_color:new u.bF(d,e.u_horizon_color),u_horizon_fog_blend:new u.b7(d,e.u_horizon_fog_blend),u_is_globe_mode:new u.b7(d,e.u_is_globe_mode)}),terrainDepth:(d,e)=>({u_ele_delta:new u.b7(d,e.u_ele_delta)}),terrainCoords:(d,e)=>({u_texture:new u.bE(d,e.u_texture),u_terrain_coords_id:new u.b7(d,e.u_terrain_coords_id),u_ele_delta:new u.b7(d,e.u_ele_delta)}),projectionErrorMeasurement:(d,e)=>({u_input:new u.b7(d,e.u_input),u_output_expected:new u.b7(d,e.u_output_expected)}),atmosphere:(d,e)=>({u_sun_pos:new u.bI(d,e.u_sun_pos),u_atmosphere_blend:new u.b7(d,e.u_atmosphere_blend),u_globe_position:new u.bI(d,e.u_globe_position),u_globe_radius:new u.b7(d,e.u_globe_radius),u_inv_proj_matrix:new u.bG(d,e.u_inv_proj_matrix)}),sky:(d,e)=>({u_sky_color:new u.bF(d,e.u_sky_color),u_horizon_color:new u.bF(d,e.u_horizon_color),u_horizon:new u.bJ(d,e.u_horizon),u_horizon_normal:new u.bJ(d,e.u_horizon_normal),u_sky_horizon_blend:new u.b7(d,e.u_sky_horizon_blend),u_sky_blend:new u.b7(d,e.u_sky_blend)})};class gf{constructor(e,r,l){this.context=e;const h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const gh={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Io{constructor(e,r,l,h){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=h,this.context=e;const m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let l=0;l<this.attributes.length;l++){const h=r.attributes[this.attributes[l].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,r,l){for(let h=0;h<this.attributes.length;h++){const m=this.attributes[h],v=r.attributes[m.name];v!==void 0&&e.vertexAttribPointer(v,m.components,e[gh[m.type]],!1,this.itemSize,m.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ti{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class pd extends Ti{getDefault(){return u.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ha extends Ti{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class fc extends Ti{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class _f extends Ti{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class _h extends Ti{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class yf extends Ti{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class yh extends Ti{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class dl extends Ti{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class mu extends Ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class gu extends Ti{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class Ks extends Ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class As extends Ti{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class cs extends Ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class Kn extends Ti{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class vh extends Ti{getDefault(){return u.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ws extends Ti{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Qs extends Ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class zs extends Ti{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class dc extends Ti{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class us extends Ti{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class pl extends Ti{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class pc extends Ti{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class xh extends Ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ml extends Ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class gl extends Ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class vf extends Ti{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class _u extends Ti{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class xi extends Ti{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const l=this.gl;jn(l)?l.bindVertexArray(e):(r=l.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class mc extends Ti{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class $a extends Ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class fa extends Ti{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class wa extends Ti{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class bh extends wa{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class yu extends wa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class gc extends wa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const vu="Framebuffer is not complete";class hs{constructor(e,r,l,h,m){this.context=e,this.width=r,this.height=l;const v=e.gl,w=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new bh(e,w),h)this.depthAttachment=m?new gc(e,w):new yu(e,w);else if(m)throw new Error("Stencil cannot be set without depth");if(v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error(vu)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class _c{constructor(e){var r,l;if(this.gl=e,this.clearColor=new pd(this),this.clearDepth=new ha(this),this.clearStencil=new fc(this),this.colorMask=new _f(this),this.depthMask=new _h(this),this.stencilMask=new yf(this),this.stencilFunc=new yh(this),this.stencilOp=new dl(this),this.stencilTest=new mu(this),this.depthRange=new gu(this),this.depthTest=new Ks(this),this.depthFunc=new As(this),this.blend=new cs(this),this.blendFunc=new Kn(this),this.blendColor=new vh(this),this.blendEquation=new Ws(this),this.cullFace=new Qs(this),this.cullFaceSide=new zs(this),this.frontFace=new dc(this),this.program=new us(this),this.activeTexture=new pl(this),this.viewport=new pc(this),this.bindFramebuffer=new xh(this),this.bindRenderbuffer=new ml(this),this.bindTexture=new gl(this),this.bindVertexBuffer=new vf(this),this.bindElementBuffer=new _u(this),this.bindVertexArray=new xi(this),this.pixelStoreUnpack=new mc(this),this.pixelStoreUnpackPremultiplyAlpha=new $a(this),this.pixelStoreUnpackFlipY=new fa(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),jn(e)){this.HALF_FLOAT=e.HALF_FLOAT;const h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:h==null?void 0:h.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:h==null?void 0:h.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h==null?void 0:h.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new gf(this,e,r)}createVertexBuffer(e,r,l){return new Io(this,e,r,l)}createRenderbuffer(e,r,l){const h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,e,r,l),this.bindRenderbuffer.set(null),m}createFramebuffer(e,r,l,h){return new hs(this,e,r,l,h)}clear({color:e,depth:r,stencil:l}){const h=this.gl;let m=0;e&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),h.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){u.bB(e.blendFunction,Ui.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return jn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return jn(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let fs;function Ps(d,e,r,l,h){const m=d.context,v=d.transform,w=m.gl,M=d.useProgram("collisionBox"),A=[];let k=0,O=0;for(let ie=0;ie<l.length;ie++){const se=l[ie],fe=e.getTile(se).getBucket(r);if(!fe)continue;const de=h?fe.textCollisionBox:fe.iconCollisionBox,pe=fe.collisionCircleArray;pe.length>0&&(A.push({circleArray:pe,circleOffset:O,coord:se}),k+=pe.length/4,O=k),de&&M.draw(m,w.LINES,ni.disabled,mi.disabled,d.colorModeForRenderPass(),oi.disabled,ph(d.transform),d.style.map.terrain&&d.style.map.terrain.getTerrainData(se),v.getProjectionData({overscaledTileID:se,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,null,d.transform.zoom,null,null,de.collisionVertexBuffer)}if(!h||!A.length)return;const F=d.useProgram("collisionCircle"),$=new u.bO;$.resize(4*k),$._trim();let q=0;for(const ie of A)for(let se=0;se<ie.circleArray.length/4;se++){const fe=4*se,de=ie.circleArray[fe+0],pe=ie.circleArray[fe+1],ye=ie.circleArray[fe+2],ge=ie.circleArray[fe+3];$.emplace(q++,de,pe,ye,ge,0),$.emplace(q++,de,pe,ye,ge,1),$.emplace(q++,de,pe,ye,ge,2),$.emplace(q++,de,pe,ye,ge,3)}(!fs||fs.length<2*k)&&(fs=function(ie){const se=2*ie,fe=new u.bQ;fe.resize(se),fe._trim();for(let de=0;de<se;de++){const pe=6*de;fe.uint16[pe+0]=4*de+0,fe.uint16[pe+1]=4*de+1,fe.uint16[pe+2]=4*de+2,fe.uint16[pe+3]=4*de+2,fe.uint16[pe+4]=4*de+3,fe.uint16[pe+5]=4*de+0}return fe}(k));const te=m.createIndexBuffer(fs,!0),ee=m.createVertexBuffer($,u.bP.members,!0);for(const ie of A){const se=mh(d.transform);F.draw(m,w.TRIANGLES,ni.disabled,mi.disabled,d.colorModeForRenderPass(),oi.disabled,se,d.style.map.terrain&&d.style.map.terrain.getTerrainData(ie.coord),null,r.id,ee,te,u.aF.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,d.transform.zoom,null,null,null)}ee.destroy(),te.destroy()}const xu=u.as(new Float32Array(16));function da(d,e,r,l,h,m){const{horizontalAlign:v,verticalAlign:w}=u.aA(d);return new u.P((-(v-.5)*e/h+l[0])*m,(-(w-.5)*r/h+l[1])*m)}function Rs(d,e,r,l,h,m){const v=e.tileAnchorPoint.add(new u.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=l.mult(m);r||(w=w.rotate(-h));const M=v.add(w);return Ne(M.x,M.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const w=zt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(d),M=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return d.add(l.rotate(M))}return d.add(l)}function Ds(d,e,r,l,h,m,v,w,M,A,k,O){const F=d.text.placedSymbolArray,$=d.text.dynamicLayoutVertexArray,q=d.icon.dynamicLayoutVertexArray,te={};$.clear();for(let ee=0;ee<F.length;ee++){const ie=F.get(ee),se=ie.hidden||!ie.crossTileID||d.allowVerticalPlacement&&!ie.placedOrientation?null:l[ie.crossTileID];if(se){const fe=new u.P(ie.anchorX,ie.anchorY),de={getElevation:O,width:h.width,height:h.height,pitchedLabelPlaneMatrix:m,pitchWithMap:r,transform:h,tileAnchorPoint:fe,translation:A,unwrappedTileID:k},pe=r?li(fe.x,fe.y,de):zt(fe.x,fe.y,de),ye=Pe(h.cameraToCenterDistance,pe.signedDistanceFromCamera);let ge=u.ah(d.textSizeData,w,ie)*ye/u.au;r&&(ge*=d.tilePixelRatio/v);const{width:Ie,height:Be,anchor:$e,textOffset:qe,textBoxScale:Ze}=se,mt=da($e,Ie,Be,qe,Ze,ge),ft=h.getPitchedTextCorrection(fe.x+A[0],fe.y+A[1],k),et=Rs(pe.point,de,e,mt,-h.bearingInRadians,ft),Rt=d.allowVerticalPlacement&&ie.placedOrientation===u.ag.vertical?Math.PI/2:0;for(let Ot=0;Ot<ie.numGlyphs;Ot++)u.an($,et,Rt);M&&ie.associatedIconIndex>=0&&(te[ie.associatedIconIndex]={shiftedAnchor:et,angle:Rt})}else Tr(ie.numGlyphs,$)}if(M){q.clear();const ee=d.icon.placedSymbolArray;for(let ie=0;ie<ee.length;ie++){const se=ee.get(ie);if(se.hidden)Tr(se.numGlyphs,q);else{const fe=te[ie];if(fe)for(let de=0;de<se.numGlyphs;de++)u.an(q,fe.shiftedAnchor,fe.angle);else Tr(se.numGlyphs,q)}}d.icon.dynamicLayoutVertexBuffer.updateData(q)}d.text.dynamicLayoutVertexBuffer.updateData($)}function _l(d,e,r){return r.iconsInText&&e?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function yc(d,e,r,l,h,m,v,w,M,A,k,O,F){const $=d.context,q=$.gl,te=d.transform,ee=w==="map",ie=M==="map",se=w!=="viewport"&&r.layout.get("symbol-placement")!=="point",fe=ee&&!ie&&!se,de=!r.layout.get("symbol-sort-key").isConstant();let pe=!1;const ye=d.getDepthModeForSublayer(0,ni.ReadOnly),ge=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ie=[],Be=te.getCircleRadiusCorrection();for(const $e of l){const qe=e.getTile($e),Ze=qe.getBucket(r);if(!Ze)continue;const mt=h?Ze.text:Ze.icon;if(!mt||!mt.segments.get().length||!mt.hasVisibleVertices)continue;const ft=mt.programConfigurations.get(r.id),et=h||Ze.sdfIcons,Rt=h?Ze.textSizeData:Ze.iconSizeData,Ot=ie||te.pitch!==0,Mi=d.useProgram(_l(et,h,Ze),ft),Vi=u.af(Rt,te.zoom),Di=d.style.map.terrain&&d.style.map.terrain.getTerrainData($e);let Li,Fi,bi,Ii,Jr=[0,0],Zi=null;if(h)Fi=qe.glyphAtlasTexture,bi=q.LINEAR,Li=qe.glyphAtlasTexture.size,Ze.iconsInText&&(Jr=qe.imageAtlasTexture.size,Zi=qe.imageAtlasTexture,Ii=Ot||d.options.rotating||d.options.zooming||Rt.kind==="composite"||Rt.kind==="camera"?q.LINEAR:q.NEAREST);else{const ji=r.layout.get("icon-size").constantOr(0)!==1||Ze.iconsNeedLinear;Fi=qe.imageAtlasTexture,bi=et||d.options.rotating||d.options.zooming||ji||Ot?q.LINEAR:q.NEAREST,Li=qe.imageAtlasTexture.size}const er=u.av(qe,1,d.transform.zoom),or=Le(ee,d.transform,er),Jn=u.K();u.ai(Jn,or);const Ka=xe(ie,ee,d.transform,er),Pa=u.aw(te,qe,m,v),ga=te.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),uo=ge&&Ze.hasTextData(),Wa=r.layout.get("icon-text-fit")!=="none"&&uo&&Ze.hasIconData();if(se){const ji=d.style.map.terrain?(Vr,Zr)=>d.style.map.terrain.getElevation($e,Vr,Zr):null,ki=r.layout.get("text-rotation-alignment")==="map";Re(Ze,d,h,or,Jn,ie,A,ki,$e.toUnwrapped(),te.width,te.height,Pa,ji)}const ms=h&&ge||Wa,_a=se||ms?xu:ie?or:d.transform.clipSpaceToPixelsMatrix,Qa=et&&r.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ra;Ra=et?Ze.iconsInText?fl(Rt.kind,Vi,fe,ie,se,ms,d,_a,Ka,Pa,Li,Jr,Be):fu(Rt.kind,Vi,fe,ie,se,ms,d,_a,Ka,Pa,h,Li,0,Be):uc(Rt.kind,Vi,fe,ie,se,ms,d,_a,Ka,Pa,h,Li,Be);const ya={program:Mi,buffers:mt,uniformValues:Ra,projectionData:ga,atlasTexture:Fi,atlasTextureIcon:Zi,atlasInterpolation:bi,atlasInterpolationIcon:Ii,isSDF:et,hasHalo:Qa};if(de&&Ze.canOverlap){pe=!0;const ji=mt.segments.get();for(const ki of ji)Ie.push({segments:new u.aF([ki]),sortKey:ki.sortKey,state:ya,terrainData:Di})}else Ie.push({segments:mt.segments,sortKey:0,state:ya,terrainData:Di})}pe&&Ie.sort(($e,qe)=>$e.sortKey-qe.sortKey);for(const $e of Ie){const qe=$e.state;if($.activeTexture.set(q.TEXTURE0),qe.atlasTexture.bind(qe.atlasInterpolation,q.CLAMP_TO_EDGE),qe.atlasTextureIcon&&($.activeTexture.set(q.TEXTURE1),qe.atlasTextureIcon&&qe.atlasTextureIcon.bind(qe.atlasInterpolationIcon,q.CLAMP_TO_EDGE)),qe.isSDF){const Ze=qe.uniformValues;qe.hasHalo&&(Ze.u_is_halo=1,Nn(qe.buffers,$e.segments,r,d,qe.program,ye,k,O,Ze,qe.projectionData,$e.terrainData)),Ze.u_is_halo=0}Nn(qe.buffers,$e.segments,r,d,qe.program,ye,k,O,qe.uniformValues,qe.projectionData,$e.terrainData)}}function Nn(d,e,r,l,h,m,v,w,M,A,k){const O=l.context;h.draw(O,O.gl.TRIANGLES,m,v,w,oi.backCCW,M,k,A,r.id,d.layoutVertexBuffer,d.indexBuffer,e,r.paint,l.transform.zoom,d.programConfigurations.get(r.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Sa(d,e,r,l,h){const m=d.context,v=m.gl,w=mi.disabled,M=new Ui([v.ONE,v.ONE],u.b6.transparent,[!0,!0,!0,!0]),A=e.getBucket(r);if(!A)return;const k=l.key;let O=r.heatmapFbos.get(k);O||(O=pa(m,e.tileSize,e.tileSize),r.heatmapFbos.set(k,O)),m.bindFramebuffer.set(O.framebuffer),m.viewport.set([0,0,e.tileSize,e.tileSize]),m.clear({color:u.b6.transparent});const F=A.programConfigurations.get(r.id),$=d.useProgram("heatmap",F,!h),q=d.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),te=d.style.map.terrain.getTerrainData(l);$.draw(m,v.TRIANGLES,ni.disabled,w,M,oi.disabled,uu(e,d.transform.zoom,r.paint.get("heatmap-intensity"),1),te,q,r.id,A.layoutVertexBuffer,A.indexBuffer,A.segments,r.paint,d.transform.zoom,F)}function Js(d,e,r,l,h){const m=d.context,v=m.gl,w=d.transform;m.setColorMode(d.colorModeForRenderPass());const M=Ta(m,e),A=r.key,k=e.heatmapFbos.get(A);if(!k)return;m.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,k.colorAttachment.get()),m.activeTexture.set(v.TEXTURE1),M.bind(v.LINEAR,v.CLAMP_TO_EDGE);const O=w.getProjectionData({overscaledTileID:r,applyTerrainMatrix:h,applyGlobeMatrix:!l});d.useProgram("heatmapTexture").draw(m,v.TRIANGLES,ni.disabled,mi.disabled,d.colorModeForRenderPass(),oi.disabled,hu(d,e,0,1),null,O,e.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments,e.paint,w.zoom),k.destroy(),e.heatmapFbos.delete(A)}function pa(d,e,r){var l,h;const m=d.gl,v=m.createTexture();m.bindTexture(m.TEXTURE_2D,v),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const w=(l=d.HALF_FLOAT)!==null&&l!==void 0?l:m.UNSIGNED_BYTE,M=(h=d.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,M,e,r,0,m.RGBA,w,null);const A=d.createFramebuffer(e,r,!1,!1);return A.colorAttachment.set(v),A}function Ta(d,e){return e.colorRampTexture||(e.colorRampTexture=new xt(d,e.colorRamp,d.gl.RGBA)),e.colorRampTexture}function Is(d,e,r,l,h){if(!r||!l||!l.imageAtlas)return;const m=l.imageAtlas.patternPositions;let v=m[r.to.toString()],w=m[r.from.toString()];if(!v&&w&&(v=w),!w&&v&&(w=v),!v||!w){const M=h.getPaintProperty(e);v=m[M],w=m[M]}v&&w&&d.setConstantPatternPositions(v,w)}function bu(d,e,r,l,h,m,v,w){const M=d.context.gl,A="fill-pattern",k=r.paint.get(A),O=k&&k.constantOr(1),F=r.getCrossfadeParameters();let $,q,te,ee,ie;const se=d.transform,fe=r.paint.get("fill-translate"),de=r.paint.get("fill-translate-anchor");v?(q=O&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=M.LINES):(q=O?"fillPattern":"fill",$=M.TRIANGLES);const pe=k.constantOr(null);for(const ye of l){const ge=e.getTile(ye);if(O&&!ge.patternsLoaded())continue;const Ie=ge.getBucket(r);if(!Ie)continue;const Be=Ie.programConfigurations.get(r.id),$e=d.useProgram(q,Be),qe=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ye);O&&(d.context.activeTexture.set(M.TEXTURE0),ge.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),Be.updatePaintBuffers(F)),Is(Be,A,pe,ge,r);const Ze=se.getProjectionData({overscaledTileID:ye,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),mt=u.aw(se,ge,fe,de);if(v){ee=Ie.indexBuffer2,ie=Ie.segments2;const et=[M.drawingBufferWidth,M.drawingBufferHeight];te=q==="fillOutlinePattern"&&O?dh(d,F,ge,et,mt):ff(et,mt)}else ee=Ie.indexBuffer,ie=Ie.segments,te=O?hf(d,F,ge,mt):{u_fill_translate:mt};let ft;if(d.renderPass==="translucent"&&w){const[et]=d.getStencilConfigForOverlapAndUpdateStencilID(l);ft=et[ye.overscaledZ]}else ft=d.stencilModeForClipping(ye);$e.draw(d.context,$,h,ft,m,oi.backCCW,te,qe,Ze,r.id,Ie.layoutVertexBuffer,ee,ie,r.paint,d.transform.zoom,Be)}}function eo(d,e,r,l,h,m,v,w){const M=d.context,A=M.gl,k="fill-extrusion-pattern",O=r.paint.get(k),F=O.constantOr(1),$=r.getCrossfadeParameters(),q=r.paint.get("fill-extrusion-opacity"),te=O.constantOr(null),ee=d.transform;for(const ie of l){const se=e.getTile(ie),fe=se.getBucket(r);if(!fe)continue;const de=d.style.map.terrain&&d.style.map.terrain.getTerrainData(ie),pe=fe.programConfigurations.get(r.id),ye=d.useProgram(F?"fillExtrusionPattern":"fillExtrusion",pe);F&&(d.context.activeTexture.set(A.TEXTURE0),se.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),pe.updatePaintBuffers($));const ge=ee.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!w,applyTerrainMatrix:!0});Is(pe,k,te,se,r);const Ie=u.aw(ee,se,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Be=r.paint.get("fill-extrusion-vertical-gradient"),$e=F?cl(d,Be,q,Ie,ie,$,se):uf(d,Be,q,Ie);ye.draw(M,M.gl.TRIANGLES,h,m,v,oi.backCCW,$e,de,ge,r.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,r.paint,d.transform.zoom,pe,d.style.map.terrain&&fe.centroidVertexBuffer)}}function ko(d,e,r,l,h,m,v,w,M){var A;const k=d.style.projection,O=d.context,F=d.transform,$=O.gl,q=d.useProgram("hillshade"),te=!d.options.moving;for(const ee of l){const ie=e.getTile(ee),se=ie.fbo;if(!se)continue;const fe=k.getMeshFromTileID(O,ee.canonical,w,!0,"raster"),de=(A=d.style.map.terrain)===null||A===void 0?void 0:A.getTerrainData(ee);O.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,se.colorAttachment.get());const pe=F.getProjectionData({overscaledTileID:ee,aligned:te,applyGlobeMatrix:!M,applyTerrainMatrix:!0});q.draw(O,$.TRIANGLES,m,h[ee.overscaledZ],v,oi.backCCW,Ys(d,ie,r),de,pe,r.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const Tn=[new u.P(0,0),new u.P(u.Z,0),new u.P(u.Z,u.Z),new u.P(0,u.Z)];function Ir(d,e,r,l,h,m,v,w,M=!1,A=!1){const k=l[l.length-1].overscaledZ,O=d.context,F=O.gl,$=d.useProgram("raster"),q=d.transform,te=d.style.projection,ee=d.colorModeForRenderPass(),ie=!d.options.moving;for(const se of l){const fe=d.getDepthModeForSublayer(se.overscaledZ-k,r.paint.get("raster-opacity")===1?ni.ReadWrite:ni.ReadOnly,F.LESS),de=e.getTile(se);de.registerFadeDuration(r.paint.get("raster-fade-duration"));const pe=e.findLoadedParent(se,0),ye=e.findLoadedSibling(se),ge=Qt(de,pe||ye||null,e,r,d.transform,d.style.map.terrain);let Ie,Be;const $e=r.paint.get("raster-resampling")==="nearest"?F.NEAREST:F.LINEAR;O.activeTexture.set(F.TEXTURE0),de.texture.bind($e,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(F.TEXTURE1),pe?(pe.texture.bind($e,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),Ie=Math.pow(2,pe.tileID.overscaledZ-de.tileID.overscaledZ),Be=[de.tileID.canonical.x*Ie%1,de.tileID.canonical.y*Ie%1]):de.texture.bind($e,F.CLAMP_TO_EDGE,F.LINEAR_MIPMAP_NEAREST),de.texture.useMipmap&&O.extTextureFilterAnisotropic&&d.transform.pitch>20&&F.texParameterf(F.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const qe=d.style.map.terrain&&d.style.map.terrain.getTerrainData(se),Ze=q.getProjectionData({overscaledTileID:se,aligned:ie,applyGlobeMatrix:!A,applyTerrainMatrix:!0}),mt=mf(Be||[0,0],Ie||1,ge,r,w),ft=te.getMeshFromTileID(O,se.canonical,m,v,"raster");$.draw(O,F.TRIANGLES,fe,h?h[se.overscaledZ]:mi.disabled,ee,M?oi.frontCCW:oi.backCCW,mt,qe,Ze,r.id,ft.vertexBuffer,ft.indexBuffer,ft.segments)}}function Qt(d,e,r,l,h,m){const v=l.paint.get("raster-fade-duration");if(!m&&v>0){const w=be.now(),M=(w-d.timeAdded)/v,A=e?(w-e.timeAdded)/v:-1,k=r.getSource(),O=Rr(h,{tileSize:k.tileSize,roundZoom:k.roundZoom}),F=!e||Math.abs(e.tileID.overscaledZ-O)>Math.abs(d.tileID.overscaledZ-O),$=F&&d.refreshedUponExpiration?1:u.ad(F?M:1-A,0,1);return d.refreshedUponExpiration&&M>=1&&(d.refreshedUponExpiration=!1),e?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const Mn=new u.b6(1,0,0,1),kr=new u.b6(0,1,0,1),vc=new u.b6(0,0,1,1),ks=new u.b6(1,0,1,1),wh=new u.b6(0,1,1,1);function to(d,e,r,l){ps(d,0,e+r/2,d.transform.width,r,l)}function ds(d,e,r,l){ps(d,e-r/2,0,r,d.transform.height,l)}function ps(d,e,r,l,h,m){const v=d.context,w=v.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*d.pixelRatio,r*d.pixelRatio,l*d.pixelRatio,h*d.pixelRatio),v.clear({color:m}),w.disable(w.SCISSOR_TEST)}function yl(d,e,r){const l=d.context,h=l.gl,m=d.useProgram("debug"),v=ni.disabled,w=mi.disabled,M=d.colorModeForRenderPass(),A="$debug",k=d.style.map.terrain&&d.style.map.terrain.getTerrainData(r);l.activeTexture.set(h.TEXTURE0);const O=e.getTileByID(r.key).latestRawTileData,F=Math.floor((O&&O.byteLength||0)/1024),$=e.getTile(r).tileSize,q=512/Math.min($,512)*(r.overscaledZ/d.transform.zoom)*.5;let te=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(te+=` => ${r.overscaledZ}`),function(ie,se){ie.initDebugOverlayCanvas();const fe=ie.debugOverlayCanvas,de=ie.context.gl,pe=ie.debugOverlayCanvas.getContext("2d");pe.clearRect(0,0,fe.width,fe.height),pe.shadowColor="white",pe.shadowBlur=2,pe.lineWidth=1.5,pe.strokeStyle="white",pe.textBaseline="top",pe.font="bold 36px Open Sans, sans-serif",pe.fillText(se,5,5),pe.strokeText(se,5,5),ie.debugOverlayTexture.update(fe),ie.debugOverlayTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)}(d,`${te} ${F}kB`);const ee=d.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(l,h.TRIANGLES,v,w,Ui.alphaBlended,oi.disabled,cu(u.b6.transparent,q),null,ee,A,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments),m.draw(l,h.LINE_STRIP,v,w,M,oi.disabled,cu(u.b6.red),k,ee,A,d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments)}function Lo(d,e,r,l){const{isRenderingGlobe:h}=l,m=d.context,v=m.gl,w=d.transform,M=d.colorModeForRenderPass(),A=d.getDepthModeFor3D(),k=d.useProgram("terrain");m.bindFramebuffer.set(null),m.viewport.set([0,0,d.width,d.height]);for(const O of r){const F=e.getTerrainMesh(O.tileID),$=d.renderToTexture.getTexture(O),q=e.getTerrainData(O.tileID);m.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,$.texture);const te=e.getMeshFrameDelta(w.zoom),ee=w.calculateFogMatrix(O.tileID.toUnwrapped()),ie=fh(te,ee,d.style.sky,w.pitch,h),se=w.getProjectionData({overscaledTileID:O.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});k.draw(m,v.TRIANGLES,A,mi.disabled,M,oi.backCCW,ie,q,se,"terrain",F.vertexBuffer,F.indexBuffer,F.segments)}}function wu(d,e){if(!e.mesh){const r=new u.aE;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const l=new u.aG;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new Bn(d.createVertexBuffer(r,sa.members),d.createIndexBuffer(l),u.aF.simpleSegment(0,0,r.length,l.length))}return e.mesh}class Su{constructor(e,r){this.context=new _c(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=L.maxUnderzooming+L.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Jc}resize(e,r,l){if(this.width=Math.floor(e*l),this.height=Math.floor(r*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const h of this.style._order)this.style._layers[h].resize()}setup(){const e=this.context,r=new u.aE;r.emplaceBack(0,0),r.emplaceBack(u.Z,0),r.emplaceBack(0,u.Z),r.emplaceBack(u.Z,u.Z),this.tileExtentBuffer=e.createVertexBuffer(r,sa.members),this.tileExtentSegments=u.aF.simpleSegment(0,0,4,2);const l=new u.aE;l.emplaceBack(0,0),l.emplaceBack(u.Z,0),l.emplaceBack(0,u.Z),l.emplaceBack(u.Z,u.Z),this.debugBuffer=e.createVertexBuffer(l,sa.members),this.debugSegments=u.aF.simpleSegment(0,0,4,5);const h=new u.bV;h.emplaceBack(0,0,0,0),h.emplaceBack(u.Z,0,u.Z,0),h.emplaceBack(0,u.Z,0,u.Z),h.emplaceBack(u.Z,u.Z,u.Z,u.Z),this.rasterBoundsBuffer=e.createVertexBuffer(h,ls.members),this.rasterBoundsSegments=u.aF.simpleSegment(0,0,4,2);const m=new u.aE;m.emplaceBack(0,0),m.emplaceBack(u.Z,0),m.emplaceBack(0,u.Z),m.emplaceBack(u.Z,u.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(m,sa.members),this.rasterBoundsSegmentsPosOnly=u.aF.simpleSegment(0,0,4,5);const v=new u.aE;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(v,sa.members),this.viewportSegments=u.aF.simpleSegment(0,0,4,2);const w=new u.bW;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const M=new u.aG;M.emplaceBack(1,0,2),M.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(M);const A=this.context.gl;this.stencilClearMode=new mi({func:A.ALWAYS,mask:0},0,255,A.ZERO,A.ZERO,A.ZERO),this.tileExtentMesh=new Bn(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=u.K();u.bN(l,0,this.width,this.height,0,0,1),u.M(l,l,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const h={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,ni.disabled,this.stencilClearMode,Ui.disabled,oi.disabled,null,null,h,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const h=this.context;h.setColorMode(Ui.disabled),h.setDepthMode(ni.disabled);const m={};for(const v of r)m[v.key]=this.nextStencilID++;this._renderTileMasks(m,r,l,!0),this._renderTileMasks(m,r,l,!1),this._tileClippingMaskIDs=m}_renderTileMasks(e,r,l,h){const m=this.context,v=m.gl,w=this.style.projection,M=this.transform,A=this.useProgram("clippingMask");for(const k of r){const O=e[k.key],F=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),$=w.getMeshFromTileID(this.context,k.canonical,h,!0,"stencil"),q=M.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!0,applyTerrainMatrix:!0});A.draw(m,v.TRIANGLES,ni.disabled,new mi({func:v.ALWAYS,mask:0},O,255,v.KEEP,v.KEEP,v.REPLACE),Ui.disabled,l?oi.disabled:oi.backCCW,null,F,q,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,l=this.style.projection,h=this.transform,m=this.useProgram("depth"),v=this.getDepthModeFor3D(),w=Ae(h,{tileSize:h.tileSize});for(const M of w){const A=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),k=l.getMeshFromTileID(this.context,M.canonical,!0,!0,"raster"),O=h.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!0,applyTerrainMatrix:!0});m.draw(e,r.TRIANGLES,v,mi.disabled,Ui.disabled,oi.backCCW,null,A,O,"$clipping",k.vertexBuffer,k.indexBuffer,k.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new mi({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new mi({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,l=e.sort((v,w)=>w.overscaledZ-v.overscaledZ),h=l[l.length-1].overscaledZ,m=l[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const v={};for(let w=0;w<m;w++)v[w+h]=new mi({func:r.GEQUAL,mask:255},w+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=m,[v,l]}return[{[h]:mi.disabled},l]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,l=e.sort((v,w)=>w.overscaledZ-v.overscaledZ),h=l[l.length-1].overscaledZ,m=l[0].overscaledZ-h+1;if(this.clearStencil(),m>1){const v={},w={};for(let M=0;M<m;M++)v[M+h]=new mi({func:r.GREATER,mask:255},m+1+M,255,r.KEEP,r.KEEP,r.REPLACE),w[M+h]=new mi({func:r.GREATER,mask:255},1+M,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*m+1,[v,w,l]}return this.nextStencilID=3,[{[h]:new mi({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[h]:new mi({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Ui([e.CONSTANT_COLOR,e.ONE],new u.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ui.unblended:Ui.alphaBlended}getDepthModeForSublayer(e,r,l){if(!this.opaquePassEnabledForLayer())return ni.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new ni(l||this.context.gl.LEQUAL,r,[h,h])}getDepthModeFor3D(){return new ni(this.context.gl.LEQUAL,ni.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var l,h;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(be.now()),this.imageManager.beginFrame();const m=this.style._order,v=this.style.sourceCaches,w={},M={},A={},k={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const F in v){const $=v[F];$.used&&$.prepare(this.context),w[F]=$.getVisibleCoordinates(!1),M[F]=w[F].slice().reverse(),A[F]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let F=0;F<m.length;F++)if(this.style._layers[m[F]].is3D()){this.opaquePassCutoff=F;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const F of m){const $=this.style._layers[F];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const q=M[$.source];($.type==="custom"||q.length)&&this.renderLayer(this,v[$.source],$,q,k)}if((h=this.style.projection)===null||h===void 0||h.updateGPUdependent({context:this.context,useProgram:F=>this.useProgram(F)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?u.b6.black:u.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(F,$){const q=F.context,te=q.gl,ee=((ye,ge,Ie)=>{const Be=Math.cos(ge.rollInRadians),$e=Math.sin(ge.rollInRadians),qe=on(ge),Ze=ge.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ye.properties.get("sky-color"),u_horizon_color:ye.properties.get("horizon-color"),u_horizon:[(ge.width/2-qe*$e)*Ie,(ge.height/2+qe*Be)*Ie],u_horizon_normal:[-$e,Be],u_sky_horizon_blend:ye.properties.get("sky-horizon-blend")*ge.height/2*Ie,u_sky_blend:Ze}})($,F.style.map.transform,F.pixelRatio),ie=new ni(te.LEQUAL,ni.ReadWrite,[0,1]),se=mi.disabled,fe=F.colorModeForRenderPass(),de=F.useProgram("sky"),pe=wu(q,$);de.draw(q,te.TRIANGLES,ie,se,fe,oi.disabled,ee,null,void 0,"sky",pe.vertexBuffer,pe.indexBuffer,pe.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const F=this.style._layers[m[this.currentLayer]],$=v[F.source],q=w[F.source];this._renderTileClippingMasks(F,q,!1),this.renderLayer(this,$,F,q,k)}this.renderPass="translucent";let O=!1;for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const F=this.style._layers[m[this.currentLayer]],$=v[F.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(F,k))continue;this.opaquePassEnabledForLayer()||O||(O=!0,k.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const q=(F.type==="symbol"?A:M)[F.source];this._renderTileClippingMasks(F,w[F.source],!1),this.renderLayer(this,$,F,q,k)}if(k.isRenderingGlobe&&function(F,$,q){const te=F.context,ee=te.gl,ie=F.useProgram("atmosphere"),se=new ni(ee.LEQUAL,ni.ReadOnly,[0,1]),fe=F.transform,de=function(Ze,mt){const ft=Ze.properties.get("position"),et=[-ft.x,-ft.y,-ft.z],Rt=u.as(new Float64Array(16));return Ze.properties.get("anchor")==="map"&&(u.aZ(Rt,Rt,mt.rollInRadians),u.a_(Rt,Rt,-mt.pitchInRadians),u.aZ(Rt,Rt,mt.bearingInRadians),u.a_(Rt,Rt,mt.center.lat*Math.PI/180),u.bl(Rt,Rt,-mt.center.lng*Math.PI/180)),u.bU(et,et,Rt),et}(q,F.transform),pe=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ye=$.properties.get("atmosphere-blend")*pe.projectionTransition;if(ye===0)return;const ge=Sn(fe.worldSize,fe.center.lat),Ie=fe.inverseProjectionMatrix,Be=new Float64Array(4);Be[3]=1,u.ao(Be,Be,fe.modelViewProjectionMatrix),Be[0]/=Be[3],Be[1]/=Be[3],Be[2]/=Be[3],Be[3]=1,u.ao(Be,Be,Ie),Be[0]/=Be[3],Be[1]/=Be[3],Be[2]/=Be[3],Be[3]=1;const $e=((Ze,mt,ft,et,Rt)=>({u_sun_pos:Ze,u_atmosphere_blend:mt,u_globe_position:ft,u_globe_radius:et,u_inv_proj_matrix:Rt}))(de,ye,[Be[0],Be[1],Be[2]],ge,Ie),qe=wu(te,$);ie.draw(te,ee.TRIANGLES,se,mi.disabled,Ui.alphaBlended,oi.disabled,$e,null,null,"atmosphere",qe.vertexBuffer,qe.indexBuffer,qe.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const F=function($,q){let te=null;const ee=Object.values($._layers).flatMap(de=>de.source&&!de.isHidden(q)?[$.sourceCaches[de.source]]:[]),ie=ee.filter(de=>de.getSource().type==="vector"),se=ee.filter(de=>de.getSource().type!=="vector"),fe=de=>{(!te||te.getSource().maxzoom<de.getSource().maxzoom)&&(te=de)};return ie.forEach(de=>fe(de)),te||se.forEach(de=>fe(de)),te}(this.style,this.transform.zoom);F&&function($,q,te){for(let ee=0;ee<te.length;ee++)yl($,q,te[ee])}(this,F,F.getVisibleCoordinates())}this.options.showPadding&&function(F){const $=F.transform.padding;to(F,F.transform.height-($.top||0),3,Mn),to(F,$.bottom||0,3,kr),ds(F,$.left||0,3,vc),ds(F,F.transform.width-($.right||0),3,ks);const q=F.transform.centerPoint;(function(te,ee,ie,se){ps(te,ee-1,ie-10,2,20,se),ps(te,ee-10,ie-1,20,2,se)})(F,q.x,F.transform.height-q.y,wh)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let h=this.terrainFacilitator.dirty;h||(h=e?!u.bX(r,l):!u.bY(r,l)),h||(h=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),h&&(u.bZ(r,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,v){const w=m.context,M=w.gl,A=m.transform,k=Ui.unblended,O=new ni(M.LEQUAL,ni.ReadWrite,[0,1]),F=v.sourceCache.getRenderableTiles(),$=m.useProgram("terrainDepth");w.bindFramebuffer.set(v.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),w.clear({color:u.b6.transparent,depth:1});for(const q of F){const te=v.getTerrainMesh(q.tileID),ee=v.getTerrainData(q.tileID),ie=A.getProjectionData({overscaledTileID:q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),se={u_ele_delta:v.getMeshFrameDelta(A.zoom)};$.draw(w,M.TRIANGLES,O,mi.disabled,k,oi.backCCW,se,ee,ie,"terrain",te.vertexBuffer,te.indexBuffer,te.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,v){const w=m.context,M=w.gl,A=m.transform,k=Ui.unblended,O=new ni(M.LEQUAL,ni.ReadWrite,[0,1]),F=v.getCoordsTexture(),$=v.sourceCache.getRenderableTiles(),q=m.useProgram("terrainCoords");w.bindFramebuffer.set(v.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),w.clear({color:u.b6.transparent,depth:1}),v.coordsIndex=[];for(const te of $){const ee=v.getTerrainMesh(te.tileID),ie=v.getTerrainData(te.tileID);w.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,F.texture);const se={u_terrain_coords_id:(255-v.coordsIndex.length)/255,u_texture:0,u_ele_delta:v.getMeshFrameDelta(A.zoom)},fe=A.getProjectionData({overscaledTileID:te.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});q.draw(w,M.TRIANGLES,O,mi.disabled,k,oi.backCCW,se,ie,fe,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),v.coordsIndex.push(te.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,r,l,h,m){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(h||[]).length)&&(this.id=l.id,u.b_(l)?function(v,w,M,A,k,O){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:F}=O,$=mi.disabled,q=v.colorModeForRenderPass();(M._unevaluatedLayout.hasValue("text-variable-anchor")||M._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(te,ee,ie,se,fe,de,pe,ye,ge){const Ie=ee.transform,Be=ee.style.map.terrain,$e=fe==="map",qe=de==="map";for(const Ze of te){const mt=se.getTile(Ze),ft=mt.getBucket(ie);if(!ft||!ft.text||!ft.text.segments.get().length)continue;const et=u.af(ft.textSizeData,Ie.zoom),Rt=u.av(mt,1,ee.transform.zoom),Ot=Le($e,ee.transform,Rt),Mi=ie.layout.get("icon-text-fit")!=="none"&&ft.hasIconData();if(et){const Vi=Math.pow(2,Ie.zoom-mt.tileID.overscaledZ),Di=Be?(Li,Fi)=>Be.getElevation(Ze,Li,Fi):null;Ds(ft,$e,qe,ge,Ie,Ot,Vi,et,Mi,u.aw(Ie,mt,pe,ye),Ze.toUnwrapped(),Di)}}}(A,v,M,w,M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),k),M.paint.get("icon-opacity").constantOr(1)!==0&&yc(v,w,M,A,!1,M.paint.get("icon-translate"),M.paint.get("icon-translate-anchor"),M.layout.get("icon-rotation-alignment"),M.layout.get("icon-pitch-alignment"),M.layout.get("icon-keep-upright"),$,q,F),M.paint.get("text-opacity").constantOr(1)!==0&&yc(v,w,M,A,!0,M.paint.get("text-translate"),M.paint.get("text-translate-anchor"),M.layout.get("text-rotation-alignment"),M.layout.get("text-pitch-alignment"),M.layout.get("text-keep-upright"),$,q,F),w.map.showCollisionBoxes&&(Ps(v,w,M,A,!0),Ps(v,w,M,A,!1))}(e,r,l,h,this.style.placement.variableOffsets,m):u.b$(l)?function(v,w,M,A,k){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:O}=k,F=M.paint.get("circle-opacity"),$=M.paint.get("circle-stroke-width"),q=M.paint.get("circle-stroke-opacity"),te=!M.layout.get("circle-sort-key").isConstant();if(F.constantOr(1)===0&&($.constantOr(1)===0||q.constantOr(1)===0))return;const ee=v.context,ie=ee.gl,se=v.transform,fe=v.getDepthModeForSublayer(0,ni.ReadOnly),de=mi.disabled,pe=v.colorModeForRenderPass(),ye=[],ge=se.getCircleRadiusCorrection();for(let Ie=0;Ie<A.length;Ie++){const Be=A[Ie],$e=w.getTile(Be),qe=$e.getBucket(M);if(!qe)continue;const Ze=M.paint.get("circle-translate"),mt=M.paint.get("circle-translate-anchor"),ft=u.aw(se,$e,Ze,mt),et=qe.programConfigurations.get(M.id),Rt=v.useProgram("circle",et),Ot=qe.layoutVertexBuffer,Mi=qe.indexBuffer,Vi=v.style.map.terrain&&v.style.map.terrain.getTerrainData(Be),Di={programConfiguration:et,program:Rt,layoutVertexBuffer:Ot,indexBuffer:Mi,uniformValues:ul(v,$e,M,ft,ge),terrainData:Vi,projectionData:se.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!O,applyTerrainMatrix:!0})};if(te){const Li=qe.segments.get();for(const Fi of Li)ye.push({segments:new u.aF([Fi]),sortKey:Fi.sortKey,state:Di})}else ye.push({segments:qe.segments,sortKey:0,state:Di})}te&&ye.sort((Ie,Be)=>Ie.sortKey-Be.sortKey);for(const Ie of ye){const{programConfiguration:Be,program:$e,layoutVertexBuffer:qe,indexBuffer:Ze,uniformValues:mt,terrainData:ft,projectionData:et}=Ie.state;$e.draw(ee,ie.TRIANGLES,fe,de,pe,oi.backCCW,mt,ft,et,M.id,qe,Ze,Ie.segments,M.paint,v.transform.zoom,Be)}}(e,r,l,h,m):u.c0(l)?function(v,w,M,A,k){if(M.paint.get("heatmap-opacity")===0)return;const O=v.context,{isRenderingToTexture:F,isRenderingGlobe:$}=k;if(v.style.map.terrain){for(const q of A){const te=w.getTile(q);w.hasRenderableParent(q)||(v.renderPass==="offscreen"?Sa(v,te,M,q,$):v.renderPass==="translucent"&&Js(v,M,q,F,$))}O.viewport.set([0,0,v.width,v.height])}else v.renderPass==="offscreen"?function(q,te,ee,ie){const se=q.context,fe=se.gl,de=q.transform,pe=mi.disabled,ye=new Ui([fe.ONE,fe.ONE],u.b6.transparent,[!0,!0,!0,!0]);(function(ge,Ie,Be){const $e=ge.gl;ge.activeTexture.set($e.TEXTURE1),ge.viewport.set([0,0,Ie.width/4,Ie.height/4]);let qe=Be.heatmapFbos.get(u.bR);qe?($e.bindTexture($e.TEXTURE_2D,qe.colorAttachment.get()),ge.bindFramebuffer.set(qe.framebuffer)):(qe=pa(ge,Ie.width/4,Ie.height/4),Be.heatmapFbos.set(u.bR,qe))})(se,q,ee),se.clear({color:u.b6.transparent});for(let ge=0;ge<ie.length;ge++){const Ie=ie[ge];if(te.hasRenderableParent(Ie))continue;const Be=te.getTile(Ie),$e=Be.getBucket(ee);if(!$e)continue;const qe=$e.programConfigurations.get(ee.id),Ze=q.useProgram("heatmap",qe),mt=de.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ft=de.getCircleRadiusCorrection();Ze.draw(se,fe.TRIANGLES,ni.disabled,pe,ye,oi.backCCW,uu(Be,de.zoom,ee.paint.get("heatmap-intensity"),ft),null,mt,ee.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,ee.paint,de.zoom,qe)}se.viewport.set([0,0,q.width,q.height])}(v,w,M,A):v.renderPass==="translucent"&&function(q,te){const ee=q.context,ie=ee.gl;ee.setColorMode(q.colorModeForRenderPass());const se=te.heatmapFbos.get(u.bR);se&&(ee.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,se.colorAttachment.get()),ee.activeTexture.set(ie.TEXTURE1),Ta(ee,te).bind(ie.LINEAR,ie.CLAMP_TO_EDGE),q.useProgram("heatmapTexture").draw(ee,ie.TRIANGLES,ni.disabled,mi.disabled,q.colorModeForRenderPass(),oi.disabled,hu(q,te,0,1),null,null,te.id,q.viewportBuffer,q.quadTriangleIndexBuffer,q.viewportSegments,te.paint,q.transform.zoom))}(v,M)}(e,r,l,h,m):u.c1(l)?function(v,w,M,A,k){if(v.renderPass!=="translucent")return;const{isRenderingToTexture:O}=k,F=M.paint.get("line-opacity"),$=M.paint.get("line-width");if(F.constantOr(1)===0||$.constantOr(1)===0)return;const q=v.getDepthModeForSublayer(0,ni.ReadOnly),te=v.colorModeForRenderPass(),ee=M.paint.get("line-dasharray"),ie=M.paint.get("line-pattern"),se=ie.constantOr(1),fe=M.paint.get("line-gradient"),de=M.getCrossfadeParameters(),pe=se?"linePattern":ee?"lineSDF":fe?"lineGradient":"line",ye=v.context,ge=ye.gl,Ie=v.transform;let Be=!0;for(const $e of A){const qe=w.getTile($e);if(se&&!qe.patternsLoaded())continue;const Ze=qe.getBucket(M);if(!Ze)continue;const mt=Ze.programConfigurations.get(M.id),ft=v.context.program.get(),et=v.useProgram(pe,mt),Rt=Be||et.program!==ft,Ot=v.style.map.terrain&&v.style.map.terrain.getTerrainData($e),Mi=ie.constantOr(null);if(Mi&&qe.imageAtlas){const bi=qe.imageAtlas,Ii=bi.patternPositions[Mi.to.toString()],Jr=bi.patternPositions[Mi.from.toString()];Ii&&Jr&&mt.setConstantPatternPositions(Ii,Jr)}const Vi=Ie.getProjectionData({overscaledTileID:$e,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Di=Ie.getPixelScale(),Li=se?lc(v,qe,M,Di,de):ee?pf(v,qe,M,Di,ee,de):fe?dd(v,qe,M,Di,Ze.lineClipsArray.length):Ro(v,qe,M,Di);if(se)ye.activeTexture.set(ge.TEXTURE0),qe.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),mt.updatePaintBuffers(de);else if(ee&&(Rt||v.lineAtlas.dirty))ye.activeTexture.set(ge.TEXTURE0),v.lineAtlas.bind(ye);else if(fe){const bi=Ze.gradients[M.id];let Ii=bi.texture;if(M.gradientVersion!==bi.version){let Jr=256;if(M.stepInterpolant){const Zi=w.getSource().maxzoom,er=$e.canonical.z===Zi?Math.ceil(1<<v.transform.maxZoom-$e.canonical.z):1;Jr=u.ad(u.bS(Ze.maxLineLength/u.Z*1024*er),256,ye.maxTextureSize)}bi.gradient=u.bT({expression:M.gradientExpression(),evaluationKey:"lineProgress",resolution:Jr,image:bi.gradient||void 0,clips:Ze.lineClipsArray}),bi.texture?bi.texture.update(bi.gradient):bi.texture=new xt(ye,bi.gradient,ge.RGBA),bi.version=M.gradientVersion,Ii=bi.texture}ye.activeTexture.set(ge.TEXTURE0),Ii.bind(M.stepInterpolant?ge.NEAREST:ge.LINEAR,ge.CLAMP_TO_EDGE)}let Fi;if(O){const[bi]=v.getStencilConfigForOverlapAndUpdateStencilID(A);Fi=bi[$e.overscaledZ]}else Fi=v.stencilModeForClipping($e);et.draw(ye,ge.TRIANGLES,q,Fi,te,oi.disabled,Li,Ot,Vi,M.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,M.paint,v.transform.zoom,mt,Ze.layoutVertexBuffer2),Be=!1}}(e,r,l,h,m):u.c2(l)?function(v,w,M,A,k){const O=M.paint.get("fill-color"),F=M.paint.get("fill-opacity");if(F.constantOr(1)===0)return;const{isRenderingToTexture:$}=k,q=v.colorModeForRenderPass(),te=M.paint.get("fill-pattern"),ee=v.opaquePassEnabledForLayer()&&!te.constantOr(1)&&O.constantOr(u.b6.transparent).a===1&&F.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===ee){const ie=v.getDepthModeForSublayer(1,v.renderPass==="opaque"?ni.ReadWrite:ni.ReadOnly);bu(v,w,M,A,ie,q,!1,$)}if(v.renderPass==="translucent"&&M.paint.get("fill-antialias")){const ie=v.getDepthModeForSublayer(M.getPaintProperty("fill-outline-color")?2:0,ni.ReadOnly);bu(v,w,M,A,ie,q,!0,$)}}(e,r,l,h,m):u.c3(l)?function(v,w,M,A,k){const O=M.paint.get("fill-extrusion-opacity");if(O===0)return;const{isRenderingToTexture:F}=k;if(v.renderPass==="translucent"){const $=new ni(v.context.gl.LEQUAL,ni.ReadWrite,v.depthRangeFor3D);if(O!==1||M.paint.get("fill-extrusion-pattern").constantOr(1))eo(v,w,M,A,$,mi.disabled,Ui.disabled,F),eo(v,w,M,A,$,v.stencilModeFor3D(),v.colorModeForRenderPass(),F);else{const q=v.colorModeForRenderPass();eo(v,w,M,A,$,mi.disabled,q,F)}}}(e,r,l,h,m):u.c4(l)?function(v,w,M,A,k){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const{isRenderingToTexture:O}=k,F=v.context,$=v.style.projection.useSubdivision,q=v.getDepthModeForSublayer(0,ni.ReadOnly),te=v.colorModeForRenderPass();if(v.renderPass==="offscreen")(function(ee,ie,se,fe,de,pe,ye){const ge=ee.context,Ie=ge.gl;for(const Be of se){const $e=ie.getTile(Be),qe=$e.dem;if(!qe||!qe.data||!$e.needsHillshadePrepare)continue;const Ze=qe.dim,mt=qe.stride,ft=qe.getPixels();if(ge.activeTexture.set(Ie.TEXTURE1),ge.pixelStoreUnpackPremultiplyAlpha.set(!1),$e.demTexture=$e.demTexture||ee.getTileTexture(mt),$e.demTexture){const Rt=$e.demTexture;Rt.update(ft,{premultiply:!1}),Rt.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE)}else $e.demTexture=new xt(ge,ft,Ie.RGBA,{premultiply:!1}),$e.demTexture.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE);ge.activeTexture.set(Ie.TEXTURE0);let et=$e.fbo;if(!et){const Rt=new xt(ge,{width:Ze,height:Ze,data:null},Ie.RGBA);Rt.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE),et=$e.fbo=ge.createFramebuffer(Ze,Ze,!0,!1),et.colorAttachment.set(Rt.texture)}ge.bindFramebuffer.set(et.framebuffer),ge.viewport.set([0,0,Ze,Ze]),ee.useProgram("hillshadePrepare").draw(ge,Ie.TRIANGLES,de,pe,ye,oi.disabled,Po($e.tileID,qe),null,null,fe.id,ee.rasterBoundsBuffer,ee.quadTriangleIndexBuffer,ee.rasterBoundsSegments),$e.needsHillshadePrepare=!1}})(v,w,A,M,q,mi.disabled,te),F.viewport.set([0,0,v.width,v.height]);else if(v.renderPass==="translucent")if($){const[ee,ie,se]=v.stencilConfigForOverlapTwoPass(A);ko(v,w,M,se,ee,q,te,!1,O),ko(v,w,M,se,ie,q,te,!0,O)}else{const[ee,ie]=v.getStencilConfigForOverlapAndUpdateStencilID(A);ko(v,w,M,ie,ee,q,te,!1,O)}}(e,r,l,h,m):u.c5(l)?function(v,w,M,A,k){if(v.renderPass!=="translucent"||M.paint.get("raster-opacity")===0||!A.length)return;const{isRenderingToTexture:O}=k,F=w.getSource(),$=v.style.projection.useSubdivision;if(F instanceof Pr)Ir(v,w,M,A,null,!1,!1,F.tileCoords,F.flippedWindingOrder,O);else if($){const[q,te,ee]=v.stencilConfigForOverlapTwoPass(A);Ir(v,w,M,ee,q,!1,!0,Tn,!1,O),Ir(v,w,M,ee,te,!0,!0,Tn,!1,O)}else{const[q,te]=v.getStencilConfigForOverlapAndUpdateStencilID(A);Ir(v,w,M,te,q,!1,!0,Tn,!1,O)}}(e,r,l,h,m):u.c6(l)?function(v,w,M,A,k){const O=M.paint.get("background-color"),F=M.paint.get("background-opacity");if(F===0)return;const{isRenderingToTexture:$}=k,q=v.context,te=q.gl,ee=v.style.projection,ie=v.transform,se=ie.tileSize,fe=M.paint.get("background-pattern");if(v.isPatternMissing(fe))return;const de=!fe&&O.a===1&&F===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==de)return;const pe=mi.disabled,ye=v.getDepthModeForSublayer(0,de==="opaque"?ni.ReadWrite:ni.ReadOnly),ge=v.colorModeForRenderPass(),Ie=v.useProgram(fe?"backgroundPattern":"background"),Be=A||Ae(ie,{tileSize:se,terrain:v.style.map.terrain});fe&&(q.activeTexture.set(te.TEXTURE0),v.imageManager.bind(v.context));const $e=M.getCrossfadeParameters();for(const qe of Be){const Ze=ie.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),mt=fe?du(F,v,fe,{tileID:qe,tileSize:se},$e):Ga(F,O),ft=v.style.map.terrain&&v.style.map.terrain.getTerrainData(qe),et=ee.getMeshFromTileID(q,qe.canonical,!1,!0,"raster");Ie.draw(q,te.TRIANGLES,ye,pe,ge,oi.backCCW,mt,ft,Ze,M.id,et.vertexBuffer,et.indexBuffer,et.segments)}}(e,0,l,h,m):u.c7(l)&&function(v,w,M,A){const{isRenderingGlobe:k}=A,O=v.context,F=M.implementation,$=v.style.projection,q=v.transform,te=q.getProjectionDataForCustomLayer(k),ee={farZ:q.farZ,nearZ:q.nearZ,fov:q.fov*Math.PI/180,modelViewProjectionMatrix:q.modelViewProjectionMatrix,projectionMatrix:q.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:te},ie=F.renderingMode?F.renderingMode:"2d";if(v.renderPass==="offscreen"){const se=F.prerender;se&&(v.setCustomLayerDefaults(),O.setColorMode(v.colorModeForRenderPass()),se.call(F,O.gl,ee),O.setDirty(),v.setBaseState())}else if(v.renderPass==="translucent"){v.setCustomLayerDefaults(),O.setColorMode(v.colorModeForRenderPass()),O.setStencilMode(mi.disabled);const se=ie==="3d"?v.getDepthModeFor3D():v.getDepthModeForSublayer(0,ni.ReadOnly);O.setDepthMode(se),F.render(O.gl,ee),O.setDirty(),v.setBaseState(),O.bindFramebuffer.set(null)}}(e,0,l,m))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!r||!l}useProgram(e,r,l=!1){this.cache=this.cache||{};const h=!!this.style.map.terrain,m=this.style.projection,v=e+(r?r.cacheKey:"")+`/${l?Ss:m.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(h?"/terrain":"");return this.cache[v]||(this.cache[v]=new fd(this.context,Va[e],r,pu[e],this._showOverdrawInspector,h,l?Va.projectionMercator:m.shaderPreludeCode,l?pi:m.shaderDefine)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function Tu(d,e){let r,l=!1,h=null,m=null;const v=()=>{h=null,l&&(d.apply(m,r),h=setTimeout(v,e),l=!1)};return(...w)=>(l=!0,m=this,r=w,h||v(),h)}class qa{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(l=h)}),(l&&l[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const l=r.join("/");let h=l;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${l}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let v=window.location.href.replace(/(#.+)?$/,m);v=v.replace("&&","&"),window.history.replaceState(window.history.state,null,v)},this._updateHash=Tu(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,h=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),v=Math.round(r.lng*m)/m,w=Math.round(r.lat*m)/m,M=this._map.getBearing(),A=this._map.getPitch();let k="";if(k+=e?`/${v}/${w}/${l}`:`${l}/${w}/${v}`,(M||A)&&(k+="/"+Math.round(10*M)/10),A&&(k+=`/${Math.round(A)}`),this._hashName){const O=this._hashName;let F=!1;const $=window.location.hash.slice(1).split("&").map(q=>{const te=q.split("=")[0];return te===O?(F=!0,`${te}=${k}`):q}).filter(q=>q);return F||$.push(`${O}=${k}`),`#${$.join("&")}`}return`#${k}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new u.Q(+e[2],+e[1])}catch{return!1}const r=+e[0],l=+(e[3]||0),h=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&l>=-180&&l<=180&&h>=this._map.getMinPitch()&&h<=this._map.getMaxPitch()}}const Bo={linearity:.3,easing:u.c8(0,0,.3,1)},vl=u.e({deceleration:2500,maxSpeed:1400},Bo),Sh=u.e({deceleration:20,maxSpeed:1400},Bo),Oo=u.e({deceleration:1e3,maxSpeed:360},Bo),xl=u.e({deceleration:1e3,maxSpeed:90},Bo),xc=u.e({deceleration:1e3,maxSpeed:360},Bo);class bl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:be.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=be.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)r.zoom+=m.zoomDelta||0,r.bearing+=m.bearingDelta||0,r.pitch+=m.pitchDelta||0,r.roll+=m.rollDelta||0,m.panDelta&&r.pan._add(m.panDelta),m.around&&(r.around=m.around),m.pinchAround&&(r.pinchAround=m.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(r.pan.mag()){const m=Fo(r.pan.mag(),l,u.e({},vl,e||{})),v=r.pan.mult(m.amount/r.pan.mag()),w=this._map.cameraHelper.handlePanInertia(v,this._map.transform);h.center=w.easingCenter,h.offset=w.easingOffset,Ha(h,m)}if(r.zoom){const m=Fo(r.zoom,l,Sh);h.zoom=this._map.transform.zoom+m.amount,Ha(h,m)}if(r.bearing){const m=Fo(r.bearing,l,Oo);h.bearing=this._map.transform.bearing+u.ad(m.amount,-179,179),Ha(h,m)}if(r.pitch){const m=Fo(r.pitch,l,xl);h.pitch=this._map.transform.pitch+m.amount,Ha(h,m)}if(r.roll){const m=Fo(r.roll,l,xc);h.roll=this._map.transform.roll+u.ad(m.amount,-179,179),Ha(h,m)}if(h.zoom||h.bearing){const m=r.pinchAround===void 0?r.around:r.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),u.e(h,{noMoveStart:!0})}}function Ha(d,e){(!d.duration||d.duration<e.duration)&&(d.duration=e.duration,d.easing=e.easing)}function Fo(d,e,r){const{maxSpeed:l,linearity:h,deceleration:m}=r,v=u.ad(d*h/(e/1e3),-l,l),w=Math.abs(v)/(m*h);return{easing:r.easing,duration:1e3*w,amount:v*(w/2)}}class ar extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l,h={}){const m=oe.mousePos(r.getCanvas(),l),v=r.unproject(m);super(e,u.e({point:m,lngLat:v,originalEvent:l},h)),this._defaultPrevented=!1,this.target=r}}class Ur extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){const h=e==="touchend"?l.changedTouches:l.touches,m=oe.touchPos(r.getCanvasContainer(),h),v=m.map(M=>r.unproject(M)),w=m.reduce((M,A,k,O)=>M.add(A.div(O.length)),new u.P(0,0));super(e,{points:m,point:w,lngLats:v,lngLat:r.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class Mu extends u.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Un{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Mu(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new ar(e.type,this._map,e))}mouseup(e){this._map.fire(new ar(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new ar(e.type,this._map,e))}dblclick(e){return this._firePreventable(new ar(e.type,this._map,e))}mouseover(e){this._map.fire(new ar(e.type,this._map,e))}mouseout(e){this._map.fire(new ar(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Ur(e.type,this._map,e))}touchmove(e){this._map.fire(new Ur(e.type,this._map,e))}touchend(e){this._map.fire(new Ur(e.type,this._map,e))}touchcancel(e){this._map.fire(new Ur(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ls{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new ar(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ar("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new ar(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wl{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(u.P.convert(e),this._map.terrain)}}class Cu{constructor(e,r){this._map=e,this._tr=new wl(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(oe.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const l=r;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const h=this._startPos;this._lastPos=l,this._box||(this._box=oe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const m=Math.min(h.x,l.x),v=Math.max(h.x,l.x),w=Math.min(h.y,l.y),M=Math.max(h.y,l.y);oe.setTransform(this._box,`translate(${m}px,${w}px)`),this._box.style.width=v-m+"px",this._box.style.height=M-w+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const l=this._startPos,h=r;if(this.reset(),oe.suppressClick(),l.x!==h.x||l.y!==h.y)return this._map.fire(new u.l("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(l,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(oe.remove(this._box),this._box=null),oe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new u.l(e,{originalEvent:r}))}}function bc(d,e){if(d.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${d.length}, points ${e.length}`);const r={};for(let l=0;l<d.length;l++)r[d[l].identifier]=e[l];return r}class Ma{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(h){const m=new u.P(0,0);for(const v of h)m._add(v);return m.div(h.length)}(r),this.touches=bc(l,r)))}touchmove(e,r,l){if(this.aborted||!this.centroid)return;const h=bc(l,r);for(const m in this.touches){const v=h[m];(!v||v.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,r,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class ma{constructor(e){this.singleTap=new Ma(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,l){this.singleTap.touchstart(e,r,l)}touchmove(e,r,l){this.singleTap.touchmove(e,r,l)}touchend(e,r,l){const h=this.singleTap.touchend(e,r,l);if(h){const m=e.timeStamp-this.lastTime<500,v=!this.lastTap||this.lastTap.dist(h)<30;if(m&&v||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class Ca{constructor(e){this._tr=new wl(e),this._zoomIn=new ma({numTouches:1,numTaps:2}),this._zoomOut=new ma({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,l){this._zoomIn.touchstart(e,r,l),this._zoomOut.touchstart(e,r,l)}touchmove(e,r,l){this._zoomIn.touchmove(e,r,l),this._zoomOut.touchmove(e,r,l)}touchend(e,r,l){const h=this._zoomIn.touchend(e,r,l),m=this._zoomOut.touchend(e,r,l),v=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:v.zoom+1,around:v.unproject(h)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:v.zoom-1,around:v.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const h=Array.isArray(r)?r[0]:r;return!this._moved&&h.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(l,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&oe.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const bt={0:1,2:2};class Qn{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=oe.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,l){const h=bt[l];return r.buttons===void 0||(r.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return oe.mouseButton(e)===this._eventButton}}class Lr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class wc{constructor(e=new Qn({checkCorrectEvent:()=>!0}),r=new Lr){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,l){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const io=d=>{d.mousedown=d.dragStart,d.mousemoveWindow=d.dragMove,d.mouseup=d.dragEnd,d.contextmenu=e=>{e.preventDefault()}};class Sc{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,l){return this._calculateTransform(e,r,l)}touchmove(e,r,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,r,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,l){this._calculateTransform(e,r,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,l){l.length>0&&(this._active=!0);const h=bc(l,r),m=new u.P(0,0),v=new u.P(0,0);let w=0;for(const A in h){const k=h[A],O=this._touches[A];O&&(m._add(k),v._add(k.sub(O)),w++,h[A]=k)}if(this._touches=h,this._shouldBePrevented(w)||!v.mag())return;const M=v.div(w);return this._sum._add(M),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(w),panDelta:M}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,l){if(!this._firstTwoTouches)return;e.preventDefault();const[h,m]=this._firstTwoTouches,v=Gt(l,r,h),w=Gt(l,r,m);if(!v||!w)return;const M=this._aroundCenter?null:v.add(w).div(2);return this._move([v,w],M,e)}touchend(e,r,l){if(!this._firstTwoTouches)return;const[h,m]=this._firstTwoTouches,v=Gt(l,r,h),w=Gt(l,r,m);v&&w||(this._active&&oe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Gt(d,e,r){for(let l=0;l<d.length;l++)if(d[l].identifier===r)return e[l]}function Sl(d,e){return Math.log(d/e)/Math.LN2}class Tl extends Eu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Sl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Sl(this._distance,l),pinchAround:r}}}function ro(d,e){return 180*d.angleWith(e)/Math.PI}class Au extends Eu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,l){const h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ro(this._vector,h),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,l=ro(e,this._startVector);return Math.abs(l)<r}}function no(d){return Math.abs(d.y)>Math.abs(d.x)}class ao extends Eu{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,l){super.touchstart(e,r,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,no(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const h=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,l){if(this._valid!==void 0)return this._valid;const h=e.mag()>=2,m=r.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const v=e.y>0==r.y>0;return no(e)&&no(r)&&v}}const Th={panStep:100,bearingStep:15,pitchStep:10};class zu{constructor(e){this._tr=new wl(e);const r=Th;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,l=0,h=0,m=0,v=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),v=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),v=1);break;default:return}return this._rotationDisabled&&(l=0,h=0),{cameraAnimation:w=>{const M=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:md,zoom:r?Math.round(M.zoom)+r*(e.shiftKey?2:1):M.zoom,bearing:M.bearing+l*this._bearingStep,pitch:M.pitch+h*this._pitchStep,offset:[-m*this._panStep,-v*this._panStep],center:M.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function md(d){return d*(2-d)}const Pu=4.000244140625;class so{constructor(e,r){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new wl(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=be.now(),h=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%Pu==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=oe.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(u.Q.convert(l.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Pu?this._wheelZoomRate:this._defaultZoomRate;let M=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&M!==0&&(M=1/M);const A=typeof this._targetZoom!="number"?e.scale:u.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,u.aa(A*M))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,h=this._easing;let m,v=!1;if(this._type==="wheel"&&l&&h){const w=be.now()-this._lastWheelEventTime,M=Math.min((w+5)/200,1),A=h(M);m=u.B.number(l,r,A),M<1?this._frameId||(this._frameId=!0):v=!0}else m=r,v=!0;return this._active=!0,v&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=m,{noInertia:!0,needsRenderFrame:!v,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=u.ca;if(this._prevEase){const l=this._prevEase,h=(be.now()-l.start)/l.duration,m=l.easing(h+.01)-l.easing(h),v=.27/Math.sqrt(m*m+1e-4)*.01,w=Math.sqrt(.0729-v*v);r=u.c8(v,w,.25,1)}return this._prevEase={start:be.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ru{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xa{constructor(e){this._tr=new wl(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ki{constructor(){this._tap=new ma({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,l){if(!this._swipePoint)if(this._tapTime){const h=r[0],m=e.timeStamp-this._tapTime<500,v=this._tapPoint.dist(h)<30;m&&v?l.length>0&&(this._swipePoint=h,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,r,l)}touchmove(e,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const h=r[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,r,l)}touchend(e,r,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const h=this._tap.touchend(e,r,l);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ea{constructor(e,r,l){this._el=e,this._mousePan=r,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ci{constructor(e,r,l,h){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=l,this._mouseRoll=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Ri{constructor(e,r,l,h){this._el=e,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Er{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=oe.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=r,this._container.appendChild(h);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=l,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(oe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new u.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const oo=d=>d.zoom||d.drag||d.roll||d.pitch||d.rotate;class Ml extends u.l{}function ln(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta||d.rollDelta}class jo{constructor(e,r){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const v=h.type==="renderFrame"?void 0:h,w={needsRenderFrame:!1},M={},A={},k=h.touches,O=k?this._getMapTouches(k):void 0,F=O?oe.touchPos(this._map.getCanvas(),O):oe.mousePos(this._map.getCanvas(),h);for(const{handlerName:te,handler:ee,allowed:ie}of this._handlers){if(!ee.isEnabled())continue;let se;this._blockedByActive(A,ie,te)?ee.reset():ee[m||h.type]&&(se=ee[m||h.type](h,F,O),this.mergeHandlerResult(w,M,se,te,v),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||ee.isActive())&&(A[te]=ee)}const $={};for(const te in this._previousActiveHandlers)A[te]||($[te]=v);this._previousActiveHandlers=A,(Object.keys($).length||ln(w))&&(this._changes.push([w,M,$]),this._triggerRenderFrame()),(Object.keys(A).length||ln(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=w;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new bl(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[h,m,v]of this._listeners)oe.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,v)}destroy(){for(const[e,r,l]of this._listeners)oe.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new Un(r,e));const h=r.boxZoom=new Cu(r,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();const m=r.cooperativeGestures=new Er(r,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();const v=new Ca(r),w=new Xa(r);r.doubleClickZoom=new Ru(w,v),this._add("tapZoom",v),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const M=new Ki;this._add("tapDragZoom",M);const A=r.touchPitch=new ao(r);this._add("touchPitch",A),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const k=()=>r.project(r.getCenter()),O=function({enable:de,clickTolerance:pe,aroundCenter:ye=!0,minPixelCenterThreshold:ge=100,rotateDegreesPerPixelMoved:Ie=.8},Be){const $e=new Qn({checkCorrectEvent:qe=>oe.mouseButton(qe)===0&&qe.ctrlKey||oe.mouseButton(qe)===2&&!qe.ctrlKey});return new Wn({clickTolerance:pe,move:(qe,Ze)=>{const mt=Be();if(ye&&Math.abs(mt.y-qe.y)>ge)return{bearingDelta:u.c9(new u.P(qe.x,Ze.y),Ze,mt)};let ft=(Ze.x-qe.x)*Ie;return ye&&Ze.y<mt.y&&(ft=-ft),{bearingDelta:ft}},moveStateManager:$e,enable:de,assignEvents:io})}(e,k),F=function({enable:de,clickTolerance:pe,pitchDegreesPerPixelMoved:ye=-.5}){const ge=new Qn({checkCorrectEvent:Ie=>oe.mouseButton(Ie)===0&&Ie.ctrlKey||oe.mouseButton(Ie)===2});return new Wn({clickTolerance:pe,move:(Ie,Be)=>({pitchDelta:(Be.y-Ie.y)*ye}),moveStateManager:ge,enable:de,assignEvents:io})}(e),$=function({enable:de,clickTolerance:pe,rollDegreesPerPixelMoved:ye=.3},ge){const Ie=new Qn({checkCorrectEvent:Be=>oe.mouseButton(Be)===2&&Be.ctrlKey});return new Wn({clickTolerance:pe,move:(Be,$e)=>{const qe=ge();let Ze=($e.x-Be.x)*ye;return $e.y<qe.y&&(Ze=-Ze),{rollDelta:Ze}},moveStateManager:Ie,enable:de,assignEvents:io})}(e,k);r.dragRotate=new ci(e,O,F,$),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",F,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const q=function({enable:de,clickTolerance:pe}){const ye=new Qn({checkCorrectEvent:ge=>oe.mouseButton(ge)===0&&!ge.ctrlKey});return new Wn({clickTolerance:pe,move:(ge,Ie)=>({around:Ie,panDelta:Ie.sub(ge)}),activateOnStart:!0,moveStateManager:ye,enable:de,assignEvents:io})}(e),te=new Sc(e,r);r.dragPan=new Ea(l,q,te),this._add("mousePan",q),this._add("touchPan",te,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const ee=new Au,ie=new Tl;r.touchZoomRotate=new Ri(l,ie,ee,M),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const se=r.scrollZoom=new so(r,()=>this._triggerRenderFrame());this._add("scrollZoom",se,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const fe=r.keyboard=new zu(r);this._add("keyboard",fe),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new Ls(r))}_add(e,r,l){this._handlers.push({handlerName:e,handler:r,allowed:l}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!oo(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,l){for(const h in e)if(h!==l&&(!r||r.indexOf(h)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const l of e)this._el.contains(l.target)&&r.push(l);return r}mergeHandlerResult(e,r,l,h,m){if(!l)return;u.e(e,l);const v={handlerName:h,originalEvent:l.originalEvent||m};l.zoomDelta!==void 0&&(r.zoom=v),l.panDelta!==void 0&&(r.drag=v),l.rollDelta!==void 0&&(r.roll=v),l.pitchDelta!==void 0&&(r.pitch=v),l.bearingDelta!==void 0&&(r.rotate=v)}_applyChanges(){const e={},r={},l={};for(const[h,m,v]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new u.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.rollDelta&&(e.rollDelta=(e.rollDelta||0)+h.rollDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),u.e(r,m),u.e(l,v);this._updateMapTransform(e,r,l),this._changes=[]}_updateMapTransform(e,r,l){const h=this._map,m=h._getTransformForUpdate(),v=h.terrain;if(!(ln(e)||v&&this._terrainMovement))return this._fireEvents(r,l,!0);h._stop(!0);let{panDelta:w,zoomDelta:M,bearingDelta:A,pitchDelta:k,rollDelta:O,around:F,pinchAround:$}=e;$!==void 0&&(F=$),F=F||h.transform.centerPoint,v&&!m.isPointOnMapSurface(F)&&(F=m.centerPoint);const q={panDelta:w,zoomDelta:M,rollDelta:O,pitchDelta:k,bearingDelta:A,around:F};this._map.cameraHelper.useGlobeControls&&!m.isPointOnMapSurface(F)&&(F=m.centerPoint);const te=F.distSqr(m.centerPoint)<.01?m.center:m.screenPointToLocation(w?F.sub(w):F);v?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(q,m),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?m.setCenter(m.screenPointToLocation(m.centerPoint.sub(w))):this._map.cameraHelper.handleMapControlsPan(q,m,te):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(q,m,te))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(q,m),this._map.cameraHelper.handleMapControlsPan(q,m,te)),h._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,l,!0)}_fireEvents(e,r,l){const h=oo(this._eventsInProgress),m=oo(e),v={};for(const O in e){const{originalEvent:F}=e[O];this._eventsInProgress[O]||(v[`${O}start`]=F),this._eventsInProgress[O]=e[O]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(const O in v)this._fireEvent(O,v[O]);m&&this._fireEvent("move",m.originalEvent);for(const O in e){const{originalEvent:F}=e[O];this._fireEvent(O,F)}const w={};let M;for(const O in this._eventsInProgress){const{handlerName:F,originalEvent:$}=this._eventsInProgress[O];this._handlersById[F].isActive()||(delete this._eventsInProgress[O],M=r[F]||$,w[`${O}end`]=M)}for(const O in w)this._fireEvent(O,w[O]);const A=oo(this._eventsInProgress),k=(h||m)&&!A;if(k&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const O=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&O.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(O)}if(l&&k){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!O||!O.essential&&be.prefersReducedMotion?(this._map.fire(new u.l("moveend",{originalEvent:M})),F(this._map.getBearing())&&this._map.resetNorth()):(F(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:M})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new u.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Ml("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class It extends u.E{constructor(e,r,l){super(),this._renderFrameCallback=()=>{const h=Math.min((be.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new u.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,l){return e=u.P.convert(e).mult(-1),this.panTo(this.transform.center,u.e({offset:e},r),l)}panTo(e,r,l){return this.easeTo(u.e({center:e},r),l)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,l){return this.easeTo(u.e({zoom:e},r),l)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new u.l("movestart",r)).fire(new u.l("move",r)).fire(new u.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,l){return this.easeTo(u.e({bearing:e},r),l)}resetNorth(e,r){return this.rotateTo(0,u.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(u.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=Ei.convert(e).adjustAntiMeridian();const l=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,r)}_cameraForBoxAndBearing(e,r,l,h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=u.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const A=h.padding;h.padding={top:A,bottom:A,right:A,left:A}}const v=u.e(m,h.padding);h.padding=v;const w=this.transform,M=new Ei(e,r);return this.cameraHelper.cameraForBoxAndBearing(h,v,M,l,w)}fitBounds(e,r,l){return this._fitInternal(this.cameraForBounds(e,r),r,l)}fitScreenCoordinates(e,r,l,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(u.P.convert(e)),this.transform.screenPointToLocation(u.P.convert(r)),l,h),h,m)}_fitInternal(e,r,l){return e?(delete(r=u.e(e,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(e,r){this.stop();const l=this._getTransformForUpdate();let h=!1,m=!1,v=!1;const w=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const M=l.zoom!==w;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(h=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(m=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(v=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new u.l("movestart",r)).fire(new u.l("move",r)),M&&this.fire(new u.l("zoomstart",r)).fire(new u.l("zoom",r)).fire(new u.l("zoomend",r)),h&&this.fire(new u.l("rotatestart",r)).fire(new u.l("rotate",r)).fire(new u.l("rotateend",r)),m&&this.fire(new u.l("pitchstart",r)).fire(new u.l("pitch",r)).fire(new u.l("pitchend",r)),v&&this.fire(new u.l("rollstart",r)).fire(new u.l("roll",r)).fire(new u.l("rollend",r)),this.fire(new u.l("moveend",r))}calculateCameraOptionsFromTo(e,r,l,h=0){const m=u.$.fromLngLat(e,r),v=u.$.fromLngLat(l,h),w=v.x-m.x,M=v.y-m.y,A=v.z-m.z,k=Math.hypot(w,M,A);if(k===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(w,M),F=u.aa(this.transform.cameraToCenterDistance/k/this.transform.tileSize),$=180*Math.atan2(w,-M)/Math.PI;let q=180*Math.acos(O/k)/Math.PI;return q=A<0?90-q:90+q,{center:v.toLngLat(),elevation:h,zoom:F,pitch:q,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,l,h,m){const v=this.transform.calculateCenterFromCameraLngLatAlt(e,r,l,h);return{center:v.center,elevation:v.elevation,zoom:v.zoom,bearing:l,pitch:h,roll:m}}easeTo(e,r){this._stop(!1,e.easeId),((e=u.e({offset:[0,0],duration:500,easing:u.ca},e)).animate===!1||!e.essential&&be.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),h=this.getBearing(),m=l.pitch,v=l.roll,w="bearing"in e?this._normalizeBearing(e.bearing,h):h,M="pitch"in e?+e.pitch:m,A="roll"in e?this._normalizeBearing(e.roll,v):v,k="padding"in e?e.padding:l.padding,O=u.P.convert(e.offset);let F,$;e.around&&(F=u.Q.convert(e.around),$=l.locationToScreenPoint(F));const q={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},te=this.cameraHelper.handleEaseTo(l,{bearing:w,pitch:M,roll:A,padding:k,around:F,aroundPoint:$,offsetAsPoint:O,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||h!==w,this._pitching=this._pitching||M!==m,this._rolling=this._rolling||A!==v,this._padding=!l.isPaddingEqual(k),this._zooming=this._zooming||te.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,q),this.terrain&&this._prepareElevation(te.elevationCenter),this._ease(ee=>{te.easeFunc(ee),this.terrain&&!e.freezeElevation&&this._updateElevation(ee),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},ee=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,ee)},e),this}_prepareEase(e,r,l={}){this._moving=!0,r||l.moving||this.fire(new u.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new u.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new u.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new u.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new u.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(r-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(u.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),l=e.getCameraAltitude(),h=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(l<h){const m=this.calculateCameraOptionsFromTo(r,h,e.center,e.elevation);return{pitch:m.pitch,zoom:m.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&r.push(h=>this.transformCameraUpdate(h)),!r.length)return;const l=e.clone();for(const h of r){const m=l.clone(),{center:v,zoom:w,roll:M,pitch:A,bearing:k,elevation:O}=h(m);v&&m.setCenter(v),O!==void 0&&m.setElevation(O),w!==void 0&&m.setZoom(w),M!==void 0&&m.setRoll(M),A!==void 0&&m.setPitch(A),k!==void 0&&m.setBearing(k),l.apply(m)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new u.l("move",e)),this._zooming&&this.fire(new u.l("zoom",e)),this._rotating&&this.fire(new u.l("rotate",e)),this._pitching&&this.fire(new u.l("pitch",e)),this._rolling&&this.fire(new u.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const l=this._zooming,h=this._rotating,m=this._pitching,v=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new u.l("zoomend",e)),h&&this.fire(new u.l("rotateend",e)),m&&this.fire(new u.l("pitchend",e)),v&&this.fire(new u.l("rollend",e)),this.fire(new u.l("moveend",e))}flyTo(e,r){if(!e.essential&&be.prefersReducedMotion){const Ze=u.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Ze,r)}this.stop(),e=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.ca},e);const l=this._getTransformForUpdate(),h=l.bearing,m=l.pitch,v=l.roll,w=l.padding,M="bearing"in e?this._normalizeBearing(e.bearing,h):h,A="pitch"in e?+e.pitch:m,k="roll"in e?this._normalizeBearing(e.roll,v):v,O="padding"in e?e.padding:l.padding,F=u.P.convert(e.offset);let $=l.centerPoint.add(F);const q=l.screenPointToLocation($),te=this.cameraHelper.handleFlyTo(l,{bearing:M,pitch:A,roll:k,padding:O,locationAtOffset:q,offsetAsPoint:F,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ee=e.curve;const ie=Math.max(l.width,l.height),se=ie/te.scaleOfZoom,fe=te.pixelPathLength;typeof te.scaleOfMinZoom=="number"&&(ee=Math.sqrt(ie/te.scaleOfMinZoom/fe*2));const de=ee*ee;function pe(Ze){const mt=(se*se-ie*ie+(Ze?-1:1)*de*de*fe*fe)/(2*(Ze?se:ie)*de*fe);return Math.log(Math.sqrt(mt*mt+1)-mt)}function ye(Ze){return(Math.exp(Ze)-Math.exp(-Ze))/2}function ge(Ze){return(Math.exp(Ze)+Math.exp(-Ze))/2}const Ie=pe(!1);let Be=function(Ze){return ge(Ie)/ge(Ie+ee*Ze)},$e=function(Ze){return ie*((ge(Ie)*(ye(mt=Ie+ee*Ze)/ge(mt))-ye(Ie))/de)/fe;var mt},qe=(pe(!0)-Ie)/ee;if(Math.abs(fe)<2e-6||!isFinite(qe)){if(Math.abs(ie-se)<1e-6)return this.easeTo(e,r);const Ze=se<ie?-1:1;qe=Math.abs(Math.log(se/ie))/ee,$e=()=>0,Be=mt=>Math.exp(Ze*ee*mt)}return e.duration="duration"in e?+e.duration:1e3*qe/("screenSpeed"in e?+e.screenSpeed/ee:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=h!==M,this._pitching=A!==m,this._rolling=k!==v,this._padding=!l.isPaddingEqual(O),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(te.targetCenter),this._ease(Ze=>{const mt=Ze*qe,ft=1/Be(mt),et=$e(mt);this._rotating&&l.setBearing(u.B.number(h,M,Ze)),this._pitching&&l.setPitch(u.B.number(m,A,Ze)),this._rolling&&l.setRoll(u.B.number(v,k,Ze)),this._padding&&(l.interpolatePadding(w,O,Ze),$=l.centerPoint.add(F)),te.easeFunc(Ze,ft,et,$),this.terrain&&!e.freezeElevation&&this._updateElevation(Ze),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,r)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,r,l){l.animate===!1||l.duration===0?(e(1),r()):(this._easeStart=be.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=u.aK(e,-180,180);const l=Math.abs(e-r);return Math.abs(e-360-r)<l&&(e-=360),Math.abs(e+360-r)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(u.Q.convert(e),this.transform.tileZoom):null}}const Ft={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Tc{constructor(e=Ft){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=oe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=oe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=oe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){oe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,r){const l=this._map._getUIString(`AttributionControl.${r}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}const r=this._map.style.sourceCaches;for(const h in r){const m=r[h];if(m.used||m.usedForTerrain){const v=m.getSource();v.attribution&&e.indexOf(v.attribution)<0&&e.push(v.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,m)=>h.length-m.length),e=e.filter((h,m)=>{for(let v=m+1;v<e.length;v++)if(e[v].indexOf(h)>=0)return!1;return!0});const l=e.join(" | ");l!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=oe.sanitize(l),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class sr{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=oe.create("div","maplibregl-ctrl");const r=oe.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){oe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Mc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const h of l)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Pn=u.aC([{name:"a_pos3d",type:"Int16",components:3}]);class Mh extends u.E{constructor(e){super(),this._lastTilesetChange=be.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const l={};for(const h of Ae(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.terrainRttPosMatrix32f=new Float64Array(16),u.bN(h.terrainRttPosMatrix32f,0,u.Z,u.Z,0,0,1),this._tiles[h.key]=new hr(h,this.tileSize),this._lastTilesetChange=be.now());for(const h in this._tiles)l[h]||delete this._tiles[h]}freeRtt(e){for(const r in this._tiles){const l=this._tiles[r];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const r={};for(const l of this._renderableTilesKeys){const h=this._tiles[l].tileID,m=e.clone(),v=u.b1();if(h.canonical.equals(e.canonical))u.bN(v,0,u.Z,u.Z,0,0,1);else if(h.canonical.isChildOf(e.canonical)){const w=h.canonical.z-e.canonical.z,M=h.canonical.x-(h.canonical.x>>w<<w),A=h.canonical.y-(h.canonical.y>>w<<w),k=u.Z>>w;u.bN(v,0,k,k,0,0,1),u.L(v,v,[-M*k,-A*k,0])}else{if(!e.canonical.isChildOf(h.canonical))continue;{const w=e.canonical.z-h.canonical.z,M=e.canonical.x-(e.canonical.x>>w<<w),A=e.canonical.y-(e.canonical.y>>w<<w),k=u.Z>>w;u.bN(v,0,u.Z,u.Z,0,0,1),u.L(v,v,[M*k,A*k,0]),u.M(v,v,[1/2**w,1/2**w,0])}}m.terrainRttPosMatrix32f=new Float32Array(v),r[l]=m}return r}getSourceTile(e,r){const l=this.sourceCache._source;let h=e.overscaledZ-this.deltaZoom;if(h>l.maxzoom&&(h=l.maxzoom),h<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&r)for(;h>=l.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(h--).key);return m}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Ya{constructor(e,r,l){this._meshCache={},this.painter=e,this.sourceCache=new Mh(r),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,l,h=u.Z){var m;if(!(r>=0&&r<h&&l>=0&&l<h))return 0;const v=this.getTerrainData(e),w=(m=v.tile)===null||m===void 0?void 0:m.dem;if(!w)return 0;const M=u.cb([],[r/h*u.Z,l/h*u.Z],v.u_terrain_matrix),A=[M[0]*w.dim,M[1]*w.dim],k=Math.floor(A[0]),O=Math.floor(A[1]),F=A[0]-k,$=A[1]-O;return w.get(k,O)*(1-F)*(1-$)+w.get(k+1,O)*F*(1-$)+w.get(k,O+1)*(1-F)*$+w.get(k+1,O+1)*F*$}getElevationForLngLatZoom(e,r){if(!u.cc(r,e.wrap()))return 0;const{tileID:l,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(l,h%u.Z,m%u.Z,u.Z)}getElevation(e,r,l,h=u.Z){return this.getDEMElevation(e,r,l,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const h=this.painter.context,m=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new xt(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new xt(h,new u.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.as([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const h=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new xt(h,r.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),r.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const l=r&&r+r.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const h=this.sourceCache.sourceCache._source.maxzoom;let m=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?m=e.canonical.z-h:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const v=e.canonical.x-(e.canonical.x>>m<<m),w=e.canonical.y-(e.canonical.y>>m<<m),M=u.cd(new Float64Array(16),[1/(u.Z<<m),1/(u.Z<<m),0]);u.L(M,M,[v*u.Z,w*u.Z,0]),this._demMatrixCache[e.key]={matrix:M,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,l=r.width/devicePixelRatio,h=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new xt(r.context,{width:l,height:h,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new xt(r.context,{width:l,height:h,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(l,h,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,l,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,v=0;m<this._coordsTextureSize;m++)for(let w=0;w<this._coordsTextureSize;w++,v+=4)r[v+0]=255&w,r[v+1]=255&m,r[v+2]=w>>8<<4|m>>8,r[v+3]=0;const l=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),h=new xt(e,l,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),l=this.painter.context,h=l.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),v=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,w-v-1,1,1,h.RGBA,h.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null);const M=r[0]+(r[2]>>4<<8),A=r[1]+((15&r[2])<<8),k=this.coordsIndex[255-r[3]],O=k&&this.sourceCache.getTileByID(k);if(!O)return null;const F=this._coordsTextureSize,$=(1<<O.tileID.canonical.z)*F;return new u.$((O.tileID.canonical.x*F+M)/$+O.tileID.wrap,(O.tileID.canonical.y*F+A)/$,this.getElevation(O.tileID,M,A,F))}depthAtPoint(e){const r=new Uint8Array(4),l=this.painter.context,h=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const l=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,h=l&&e.canonical.y===0,m=l&&e.canonical.y===(1<<e.canonical.z)-1,v=`m_${h?"n":""}_${m?"s":""}`;if(this._meshCache[v])return this._meshCache[v];const w=this.painter.context,M=new u.ce,A=new u.aG,k=this.meshSize,O=u.Z/k,F=k*k;for(let ge=0;ge<=k;ge++)for(let Ie=0;Ie<=k;Ie++)M.emplaceBack(Ie*O,ge*O,0);for(let ge=0;ge<F;ge+=k+1)for(let Ie=0;Ie<k;Ie++)A.emplaceBack(Ie+ge,k+Ie+ge+1,k+Ie+ge+2),A.emplaceBack(Ie+ge,k+Ie+ge+2,Ie+ge+1);const $=M.length,q=$+(k+1),te=(k+1)*k,ee=h?u.b8:0,ie=h?0:1,se=m?u.b9:u.Z,fe=m?0:1;for(let ge=0;ge<=k;ge++)M.emplaceBack(ge*O,ee,ie);for(let ge=0;ge<=k;ge++)M.emplaceBack(ge*O,se,fe);for(let ge=0;ge<k;ge++)A.emplaceBack(te+ge,q+ge,q+ge+1),A.emplaceBack(te+ge,q+ge+1,te+ge+1),A.emplaceBack(0+ge,$+ge+1,$+ge),A.emplaceBack(0+ge,0+ge+1,$+ge+1);const de=M.length,pe=de+2*(k+1);for(const ge of[0,1])for(let Ie=0;Ie<=k;Ie++)for(const Be of[0,1])M.emplaceBack(ge*u.Z,Ie*O,Be);for(let ge=0;ge<2*k;ge+=2)A.emplaceBack(de+ge,de+ge+1,de+ge+3),A.emplaceBack(de+ge,de+ge+3,de+ge+2),A.emplaceBack(pe+ge,pe+ge+3,pe+ge+1),A.emplaceBack(pe+ge,pe+ge+2,pe+ge+3);const ye=new Bn(w.createVertexBuffer(M,Pn.members),w.createIndexBuffer(A),u.aF.simpleSegment(0,0,M.length,A.length));return this._meshCache[v]=ye,ye}getMeshFrameDelta(e){return 2*Math.PI*u.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var l;const{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(l=this.getMinMaxElevation(h).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return r&&r.dem&&(l.minElevation=r.dem.min*this.exaggeration,l.maxElevation=r.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,r){const l=u.$.fromLngLat(e.wrap()),h=(1<<r)*u.Z,m=l.x*h,v=l.y*h,w=Math.floor(m/u.Z),M=Math.floor(v/u.Z);return{tileID:new u.Y(r,0,r,w,M),mercatorX:m,mercatorY:v}}}class gd{constructor(e,r,l){this._context=e,this._size=r,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new xt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(l.texture),{id:e,fbo:r,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Aa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Qi{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new gd(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(r)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const h=e.sourceCaches[l].getVisibleCoordinates();for(const m of h){const v=this.terrain.sourceCache.getTerrainCoords(m);for(const w in v)this._coordsAscending[l][w]||(this._coordsAscending[l][w]=[]),this._coordsAscending[l][w].push(v[w])}}this._coordsAscendingStr={};for(const l of e._order){const h=e._layers[l],m=h.source;if(Aa[h.type]&&!this._coordsAscendingStr[m]){this._coordsAscendingStr[m]={};for(const v in this._coordsAscending[m])this._coordsAscendingStr[m][v]=this._coordsAscending[m][v].map(w=>w.key).sort().join()}}for(const l of this._renderableTiles)for(const h in this._coordsAscendingStr){const m=this._coordsAscendingStr[h][l.tileID.key];m&&m!==l.rttCoords[h]&&(l.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),h=e.type,m=this.painter,v=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Aa[h]&&(this._prevType&&Aa[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(e.id),!v))return!0;if(Aa[this._prevType]||Aa[h]&&v){this._prevType=h;const w=this._stacks.length-1,M=this._stacks[w]||[];for(const A of this._renderableTiles){if(this.pool.isFull()&&(Lo(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(A),A.rtt[w]){const O=this.pool.getObjectForId(A.rtt[w].id);if(O.stamp===A.rtt[w].stamp){this.pool.useObject(O);continue}}const k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),A.rtt[w]={id:k.id,stamp:k.stamp},m.context.bindFramebuffer.set(k.fbo.framebuffer),m.context.clear({color:u.b6.transparent,stencil:0}),m.currentStencilSource=void 0;for(let O=0;O<M.length;O++){const F=m.style._layers[M[O]],$=F.source?this._coordsAscending[F.source][A.tileID.key]:[A.tileID];m.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),m._renderTileClippingMasks(F,$,!0),m.renderLayer(m,m.style.sourceCaches[F.source],F,$,l),F.source&&(A.rttCoords[F.source]=this._coordsAscendingStr[F.source][A.tileID.key])}}return Lo(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Aa[h]}return!1}}const pr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Vn=ce,Ji={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ft,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},No={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Uo{constructor(e,r,l=!1){this.mousedown=m=>{this.startMove(m,oe.mousePos(this.element,m)),oe.addEventListener(window,"mousemove",this.mousemove),oe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=m=>{this.move(m,oe.mousePos(this.element,m))},this.mouseup=m=>{this._rotatePitchHanlder.dragEnd(m),this.offTemp()},this.touchstart=m=>{m.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe.touchPos(this.element,m.targetTouches)[0],this.startMove(m,this._startPos),oe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),oe.addEventListener(window,"touchend",this.touchend))},this.touchmove=m=>{m.targetTouches.length!==1?this.reset():(this._lastPos=oe.touchPos(this.element,m.targetTouches)[0],this.move(m,this._lastPos))},this.touchend=m=>{m.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const h=new wc;this._rotatePitchHanlder=new Wn({clickTolerance:3,move:(m,v)=>{const w=r.getBoundingClientRect(),M=new u.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:u.c9(new u.P(m.x,v.y),v,M),pitchDelta:l?-.5*(v.y-m.y):void 0}},moveStateManager:h,enable:!0,assignEvents:()=>{}}),this.map=e,oe.addEventListener(r,"mousedown",this.mousedown),oe.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),oe.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),oe.disableDrag()}move(e,r){const l=this.map,{bearingDelta:h,pitchDelta:m}=this._rotatePitchHanlder.dragMove(e,r)||{};h&&l.setBearing(l.getBearing()+h),m&&l.setPitch(l.getPitch()+m)}off(){const e=this.element;oe.removeEventListener(e,"mousedown",this.mousedown),oe.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),oe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),oe.removeEventListener(window,"touchend",this.touchend),oe.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){oe.enableDrag(),oe.removeEventListener(window,"mousemove",this.mousemove),oe.removeEventListener(window,"mouseup",this.mouseup),oe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),oe.removeEventListener(window,"touchend",this.touchend)}}let za;function Cl(d,e,r){const l=new u.Q(d.lng,d.lat);if(d=new u.Q(d.lng,d.lat),e){const h=new u.Q(d.lng-360,d.lat),m=new u.Q(d.lng+360,d.lat),v=r.locationToScreenPoint(d).distSqr(e);r.locationToScreenPoint(h).distSqr(e)<v?d=h:r.locationToScreenPoint(m).distSqr(e)<v&&(d=m)}for(;Math.abs(d.lng-r.center.lng)>180;){const h=r.locationToScreenPoint(d);if(h.x>=0&&h.y>=0&&h.x<=r.width&&h.y<=r.height)break;d.lng>r.center.lng?d.lng-=360:d.lng+=360}return d.lng!==l.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(d))?d:l}const Zn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Vo(d,e,r){const l=d.classList;for(const h in Zn)l.remove(`maplibregl-${r}-anchor-${h}`);l.add(`maplibregl-${r}-anchor-${e}`)}class Zo extends u.E{constructor(e){if(super(),this._onKeyPress=r=>{const l=r.code,h=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=r=>{const l=r.originalEvent.target,h=this._element;this._popup&&(l===h||h.contains(l))&&this.togglePopup()},this._update=r=>{var l;if(!this._map)return;const h=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Cl(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),oe.setTransform(this._element,`${Zn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${m}`),be.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.l("dragstart"))),this.fire(new u.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=u.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=oe.create("div");const r=oe.createNS("http://www.w3.org/2000/svg","svg"),l=41,h=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${l}px`),r.setAttributeNS(null,"width",`${h}px`),r.setAttributeNS(null,"viewBox",`0 0 ${h} ${l}`);const m=oe.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const v=oe.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"fill-rule","nonzero");const w=oe.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const M=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ie of M){const se=oe.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",ie.rx),se.setAttributeNS(null,"ry",ie.ry),w.appendChild(se)}const A=oe.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill",this._color);const k=oe.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),A.appendChild(k);const O=oe.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const F=oe.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(F);const $=oe.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const q=oe.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const te=oe.createNS("http://www.w3.org/2000/svg","circle");te.setAttributeNS(null,"fill","#000000"),te.setAttributeNS(null,"opacity","0.25"),te.setAttributeNS(null,"cx","5.5"),te.setAttributeNS(null,"cy","5.5"),te.setAttributeNS(null,"r","5.4999962");const ee=oe.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),q.appendChild(te),q.appendChild(ee),v.appendChild(w),v.appendChild(A),v.appendChild(O),v.appendChild($),v.appendChild(q),r.appendChild(v),r.setAttributeNS(null,"height",l*this._scale+"px"),r.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(r),this._offset=u.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Vo(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),oe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=u.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,l;if(!(!((r=this._map)===null||r===void 0)&&r.terrain)){const O=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==O&&(this._element.style.opacity=O))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const h=this._map,m=h.terrain.depthAtPoint(this._pos),v=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,v)-m<.006)return void(this._element.style.opacity=this._opacity);const w=-this._offset.y/h.transform.pixelsPerMeter,M=Math.sin(h.getPitch()*Math.PI/180)*w,A=h.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),k=h.transform.lngLatToCameraDepth(this._lngLat,v+M)-A>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=u.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const Cc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Go=0,lo=!1;const Du={maxWidth:100,unit:"metric"};function Ec(d,e,r){const l=r&&r.maxWidth||100,h=d._container.clientHeight/2,m=d._container.clientWidth/2,v=d.unproject([m-l/2,h]),w=d.unproject([m+l/2,h]),M=Math.round(d.project(w).x-d.project(v).x),A=Math.min(l,M,d._container.clientWidth),k=v.distanceTo(w);if(r&&r.unit==="imperial"){const O=3.2808*k;O>5280?co(e,A,O/5280,d._getUIString("ScaleControl.Miles")):co(e,A,O,d._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?co(e,A,k/1852,d._getUIString("ScaleControl.NauticalMiles")):k>=1e3?co(e,A,k/1e3,d._getUIString("ScaleControl.Kilometers")):co(e,A,k,d._getUIString("ScaleControl.Meters"))}function co(d,e,r,l){const h=function(m){const v=Math.pow(10,`${Math.floor(m)}`.length-1);let w=m/v;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(M){const A=Math.pow(10,Math.ceil(-Math.log(M)/Math.LN10));return Math.round(M*A)/A}(w),v*w}(r);d.style.width=e*(h/r)+"px",d.innerHTML=`${h}&nbsp;${l}`}const Ac={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},zc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Pc(d){if(d){if(typeof d=="number"){const e=Math.round(Math.abs(d)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,d),"top-left":new u.P(e,e),"top-right":new u.P(-e,e),bottom:new u.P(0,-d),"bottom-left":new u.P(e,-e),"bottom-right":new u.P(-e,-e),left:new u.P(d,0),right:new u.P(-d,0)}}if(d instanceof u.P||Array.isArray(d)){const e=u.P.convert(d);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:u.P.convert(d.center||[0,0]),top:u.P.convert(d.top||[0,0]),"top-left":u.P.convert(d["top-left"]||[0,0]),"top-right":u.P.convert(d["top-right"]||[0,0]),bottom:u.P.convert(d.bottom||[0,0]),"bottom-left":u.P.convert(d["bottom-left"]||[0,0]),"bottom-right":u.P.convert(d["bottom-right"]||[0,0]),left:u.P.convert(d.left||[0,0]),right:u.P.convert(d.right||[0,0])}}return Pc(new u.P(0,0))}const Iu=ce;z.AJAXError=u.ci,z.Event=u.l,z.Evented=u.E,z.LngLat=u.Q,z.MercatorCoordinate=u.$,z.Point=u.P,z.addProtocol=u.cj,z.config=u.a,z.removeProtocol=u.ck,z.AttributionControl=Tc,z.BoxZoomHandler=Cu,z.CanvasSource=ti,z.CooperativeGesturesHandler=Er,z.DoubleClickZoomHandler=Ru,z.DragPanHandler=Ea,z.DragRotateHandler=ci,z.EdgeInsets=Nr,z.FullscreenControl=class extends u.E{constructor(d={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){oe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const d=this._fullscreenButton=oe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);oe.create("span","maplibregl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},z.GeoJSONSource=nn,z.GeolocateControl=class extends u.E{constructor(d){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new u.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new u.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,h=this._map.getBearing(),m=u.e({bearing:h},this.options.fitBoundsOptions),v=Ei.fromLngLat(r,l);this._map.fitBounds(v,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new u.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&lo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=oe.create("button","maplibregl-ctrl-geolocate",this._container),oe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=oe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Zo({element:this._dotElement}),this._circleElement=oe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Zo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.l("trackuserlocationend")),this.fire(new u.l("userlocationlostfocus")))})}},this.options=u.e({},Cc,d)}onAdd(d){return this._map=d,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(e=!1){if(za!==void 0&&!e)return za;if(window.navigator.permissions===void 0)return za=!!window.navigator.geolocation,za;try{za=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{za=!!window.navigator.geolocation}return za})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),oe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Go=0,lo=!1}_isOutOfMapMaxBounds(d){const e=this._map.getMaxBounds(),r=d.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const d=this._map.getBounds(),e=d.getSouthEast(),r=d.getNorthEast(),l=e.distanceTo(r),h=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Go--,lo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.l("trackuserlocationstart")),this.fire(new u.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Go++,Go>1?(d={maximumAge:6e5,timeout:0},lo=!0):(d=this.options.positionOptions,lo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},z.GlobeControl=class{constructor(){this._toggleProjection=()=>{var d;const e=(d=this._map.getProjection())===null||d===void 0?void 0:d.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var d;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((d=this._map.getProjection())===null||d===void 0?void 0:d.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(d){return this._map=d,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=oe.create("button","maplibregl-ctrl-globe",this._container),oe.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){oe.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},z.Hash=qa,z.ImageSource=Pr,z.KeyboardHandler=zu,z.LngLatBounds=Ei,z.LogoControl=sr,z.Map=class extends It{constructor(d){var e,r;u.cf.mark(u.cg.create);const l=Object.assign(Object.assign(Object.assign({},Ji),d),{canvasContextAttributes:Object.assign(Object.assign({},Ji.canvasContextAttributes),d.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const h=new bn,m=new Fn;if(l.minZoom!==void 0&&h.setMinZoom(l.minZoom),l.maxZoom!==void 0&&h.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&h.setMinPitch(l.minPitch),l.maxPitch!==void 0&&h.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&h.setRenderWorldCopies(l.renderWorldCopies),super(h,m,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Mc,this._controls=[],this._mapId=u.a3(),this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},pr),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=at.addThrottleControl(()=>this.isMoving()),this._requestManager=new Oe(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const M=Tu(A=>{this._trackResize&&!this._removed&&(this.resize(A),this.redraw())},50);this._resizeObserver=new ResizeObserver(A=>{w?M(A):w=!0}),this._resizeObserver.observe(this._container)}this.handlers=new jo(this,l),this._hash=l.hash&&new qa(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,u.e({},l.fitBoundsOptions,{duration:0}))));const v=typeof l.style=="string"||((r=(e=l.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,v),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Tc(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new sr,l.logoPosition),this.on("style.load",()=>{if(v||this._resizeTransform(),this.transform.unmodified){const w=u.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}}),this.on("data",w=>{this._update(w.dataType==="style"),this.fire(new u.l(`${w.dataType}data`,w))}),this.on("dataloading",w=>{this.fire(new u.l(`${w.dataType}dataloading`,w))}),this.on("dataabort",w=>{this.fire(new u.l("sourcedataabort",w))})}_getMapId(){return this._mapId}addControl(d,e){if(e===void 0&&(e=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new u.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=d.onAdd(this);this._controls.push(d);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new u.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(d);return e>-1&&this._controls.splice(e,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}calculateCameraOptionsFromTo(d,e,r,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(d,e,r,l)}resize(d,e=!0){const[r,l]=this._containerDimensions(),h=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,h),this.painter.resize(r,l,h),this.painter.overLimit()){const v=this.painter.context.gl;this._maxCanvasSize=[v.drawingBufferWidth,v.drawingBufferHeight];const w=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,w),this.painter.resize(r,l,w)}this._resizeTransform(e);const m=!this._moving;return m&&(this.stop(),this.fire(new u.l("movestart",d)).fire(new u.l("move",d))),this.fire(new u.l("resize",d)),m&&this.fire(new u.l("moveend",d)),this}_resizeTransform(d=!0){var e;const[r,l]=this._containerDimensions();this.transform.resize(r,l,d),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,l,d)}_getClampedPixelRatio(d,e){const{0:r,1:l}=this._maxCanvasSize,h=this.getPixelRatio(),m=d*h,v=e*h;return Math.min(m>r?r/m:1,v>l?l/v:1)*h}getPixelRatio(){var d;return(d=this._overridePixelRatio)!==null&&d!==void 0?d:devicePixelRatio}setPixelRatio(d){this._overridePixelRatio=d,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(d){return this.transform.setMaxBounds(Ei.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.setMinZoom(d),this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.setMaxZoom(d),this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.setMinPitch(d),this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(d>=this.transform.minPitch)return this.transform.setMaxPitch(d),this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.setRenderWorldCopies(d),this._update()}project(d){return this.transform.locationToScreenPoint(u.Q.convert(d),this.style&&this.terrain)}unproject(d){return this.transform.screenPointToLocation(u.P.convert(d),this.terrain)}isMoving(){var d;return this._moving||((d=this.handlers)===null||d===void 0?void 0:d.isMoving())}isZooming(){var d;return this._zooming||((d=this.handlers)===null||d===void 0?void 0:d.isZooming())}isRotating(){var d;return this._rotating||((d=this.handlers)===null||d===void 0?void 0:d.isRotating())}_createDelegatedListener(d,e,r){if(d==="mouseenter"||d==="mouseover"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:m=>{const v=e.filter(M=>this.getLayer(M)),w=v.length!==0?this.queryRenderedFeatures(m.point,{layers:v}):[];w.length?l||(l=!0,r.call(this,new ar(d,this,m.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(d==="mouseleave"||d==="mouseout"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:v=>{const w=e.filter(M=>this.getLayer(M));(w.length!==0?this.queryRenderedFeatures(v.point,{layers:w}):[]).length?l=!0:l&&(l=!1,r.call(this,new ar(d,this,v.originalEvent)))},mouseout:v=>{l&&(l=!1,r.call(this,new ar(d,this,v.originalEvent)))}}}}{const l=h=>{const m=e.filter(w=>this.getLayer(w)),v=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];v.length&&(h.features=v,r.call(this,h),delete h.features)};return{layers:e,listener:r,delegates:{[d]:l}}}}_saveDelegatedListener(d,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(e)}_removeDelegatedListener(d,e,r){if(!this._delegatedListeners||!this._delegatedListeners[d])return;const l=this._delegatedListeners[d];for(let h=0;h<l.length;h++){const m=l[h];if(m.listener===r&&m.layers.length===e.length&&m.layers.every(v=>e.includes(v))){for(const v in m.delegates)this.off(v,m.delegates[v]);return void l.splice(h,1)}}}on(d,e,r){if(r===void 0)return super.on(d,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(d,l,r);this._saveDelegatedListener(d,h);for(const m in h.delegates)this.on(m,h.delegates[m]);return{unsubscribe:()=>{this._removeDelegatedListener(d,l,r)}}}once(d,e,r){if(r===void 0)return super.once(d,e);const l=typeof e=="string"?[e]:e,h=this._createDelegatedListener(d,l,r);for(const m in h.delegates){const v=h.delegates[m];h.delegates[m]=(...w)=>{this._removeDelegatedListener(d,l,r),v(...w)}}this._saveDelegatedListener(d,h);for(const m in h.delegates)this.once(m,h.delegates[m]);return this}off(d,e,r){return r===void 0?super.off(d,e):(this._removeDelegatedListener(d,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(d,e){if(!this.style)return[];let r;const l=d instanceof u.P||Array.isArray(d),h=l?d:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:d)||{},h instanceof u.P||typeof h[0]=="number")r=[u.P.convert(h)];else{const m=u.P.convert(h[0]),v=u.P.convert(h[1]);r=[m,new u.P(v.x,m.y),v,new u.P(m.x,v.y),m]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(d,e){return this.style.querySourceFeatures(d,e)}setStyle(d,e){return(e=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(d,e))}setTransformRequest(d){return this._requestManager.setTransformRequest(d),this}_getUIString(d){const e=this._locale[d];if(e==null)throw new Error(`Missing UI string '${d}'`);return e}_updateStyle(d,e){var r,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(d,e));const h=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!d)),d?(this.style=new ac(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d,e,h):this.style.loadJSON(d,e,h),this):((l=(r=this.style)===null||r===void 0?void 0:r.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ac(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,e){if(typeof d=="string"){const r=this._requestManager.transformRequest(d,"Style");u.j(r,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new u.k(l))})}else typeof d=="object"&&this._updateDiff(d,e)}_updateDiff(d,e){try{this.style.setState(d,e)&&this._update(!0)}catch(r){u.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(d,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(d,e){return this._lazyInitEmptyStyle(),this.style.addSource(d,e),this._update(!0)}isSourceLoaded(d){const e=this.style&&this.style.sourceCaches[d];if(e!==void 0)return e.loaded();this.fire(new u.k(new Error(`There is no source with ID '${d}'`)))}setTerrain(d){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),d){const e=this.style.sourceCaches[d.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${d.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const l=this.style._layers[r];l.type==="hillshade"&&l.source===d.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ya(this.painter,e,d),this.painter.renderToTexture=new Qi(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==d.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new u.l("terrain",{terrain:d})),this}getTerrain(){var d,e;return(e=(d=this.terrain)===null||d===void 0?void 0:d.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const d=this.style&&this.style.sourceCaches;for(const e in d){const r=d[e]._tiles;for(const l in r){const h=r[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(d){return this.style.removeSource(d),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,e,r={}){const{pixelRatio:l=1,sdf:h=!1,stretchX:m,stretchY:v,content:w,textFitWidth:M,textFitHeight:A}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||u.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:k,height:O,data:F}=e,$=e;return this.style.addImage(d,{data:new u.R({width:k,height:O},new Uint8Array(F)),pixelRatio:l,stretchX:m,stretchY:v,content:w,textFitWidth:M,textFitHeight:A,sdf:h,version:0,userImage:$}),$.onAdd&&$.onAdd(this,d),this}}{const{width:k,height:O,data:F}=be.getImageData(e);this.style.addImage(d,{data:new u.R({width:k,height:O},F),pixelRatio:l,stretchX:m,stretchY:v,content:w,textFitWidth:M,textFitHeight:A,sdf:h,version:0})}}updateImage(d,e){const r=this.style.getImage(d);if(!r)return this.fire(new u.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||u.b(e)?be.getImageData(e):e,{width:h,height:m,data:v}=l;if(h===void 0||m===void 0)return this.fire(new u.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==r.data.width||m!==r.data.height)return this.fire(new u.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||u.b(e));return r.data.replace(v,w),this.style.updateImage(d,r),this}getImage(d){return this.style.getImage(d)}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new u.k(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d){return at.getImage(this._requestManager.transformRequest(d,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(d,e){return this._lazyInitEmptyStyle(),this.style.addLayer(d,e),this._update(!0)}moveLayer(d,e){return this.style.moveLayer(d,e),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(d,e,r){return this.style.setLayerZoomRange(d,e,r),this._update(!0)}setFilter(d,e,r={}){return this.style.setFilter(d,e,r),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,e,r,l={}){return this.style.setPaintProperty(d,e,r,l),this._update(!0)}getPaintProperty(d,e){return this.style.getPaintProperty(d,e)}setLayoutProperty(d,e,r,l={}){return this.style.setLayoutProperty(d,e,r,l),this._update(!0)}getLayoutProperty(d,e){return this.style.getLayoutProperty(d,e)}setGlyphs(d,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(d,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(d,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(d,e,r,l=>{l||this._update(!0)}),this}removeSprite(d){return this._lazyInitEmptyStyle(),this.style.removeSprite(d),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(d,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(d,e,r=>{r||this._update(!0)}),this}setLight(d,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(d,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(d,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(d,e){return this.style.setFeatureState(d,e),this._update()}removeFeatureState(d,e){return this.style.removeFeatureState(d,e),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let d=0,e=0;return this._container&&(d=this._container.clientWidth||400,e=this._container.clientHeight||300),[d,e]}_setupContainer(){const d=this._container;d.classList.add("maplibregl-map");const e=this._canvasContainer=oe.create("div","maplibregl-canvas-container",d);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=oe.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),l=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],l);const h=this._controlContainer=oe.create("div","maplibregl-control-container",d),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{m[v]=oe.create("div",`maplibregl-ctrl-${v} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,e,r){this._canvas.width=Math.floor(r*d),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const d=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:d},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,d):this._canvas.getContext("webgl2",d)||this._canvas.getContext("webgl",d),!r){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new Su(r,this.transform),we.testSupport(r)}migrateProjection(d,e){super.migrateProjection(d,e),this.painter.transform=d,this.fire(new u.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_render(d){var e,r,l,h,m;const v=this._idleTriggered?this._fadeDuration:0,w=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._removed)return;let M=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,F=be.now();this.style.zoomHistory.update(O,F);const $=new u.C(O,{now:F,fadeDuration:v,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),q=$.crossFadingFactor();q===1&&q===this._crossFadingFactor||(M=!0,this._crossFadingFactor=q),this.style.update($)}const A=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==w;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((h=this.style.projection)===null||h===void 0?void 0:h.transitionState,(m=this.style.projection)===null||m===void 0?void 0:m.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||A)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,A),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,showPadding:this.showPadding}),this.fire(new u.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.cf.mark(u.cg.load),this.fire(new u.l("load"))),this.style&&(this.style.hasTransitions()||M)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const k=this._sourcesDirty||this._styleDirty||this._placementDirty;return k||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.l("idle")),!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,u.cf.mark(u.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var d;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),at.removeThrottleControl(this._imageQueueHandle),(d=this._resizeObserver)===null||d===void 0||d.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),oe.remove(this._canvasContainer),oe.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),u.cf.clearMetrics(),this._removed=!0,this.fire(new u.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,be.frame(this._frameRequest,d=>{u.cf.frame(d),this._frameRequest=null;try{this._render(d)}catch(e){if(!u.ch(e)&&!function(r){return r.message===vu}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get version(){return Vn}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(d){return this._lazyInitEmptyStyle(),this.style.setProjection(d),this._update(!0)}},z.MapMouseEvent=ar,z.MapTouchEvent=Ur,z.MapWheelEvent=Mu,z.Marker=Zo,z.NavigationControl=class{constructor(d){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const l=this._map._getUIString(`NavigationControl.${r}`);e.title=l,e.setAttribute("aria-label",l)},this.options=u.e({},No,d),this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),oe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),oe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=oe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Uo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){oe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,e){const r=oe.create("button",d,this._container);return r.type="button",r.addEventListener("click",e),r}},z.Popup=class extends u.E{constructor(d){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&oe.remove(this._content),this._container&&(oe.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=oe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=oe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const w of this.options.className.split(" "))this._container.classList.add(w);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Cl(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let h=this.options.anchor;const m=Pc(this.options.offset);if(!h){const w=this._container.offsetWidth,M=this._container.offsetHeight;let A;A=l.y+m.bottom.y<M?["top"]:l.y>this._map.transform.height-M?["bottom"]:[],l.x<w/2?A.push("left"):l.x>this._map.transform.width-w/2&&A.push("right"),h=A.length===0?"bottom":A.join("-")}let v=l.add(m[h]);this.options.subpixelPositioning||(v=v.round()),oe.setTransform(this._container,`${Zn[h]} translate(${v.x}px,${v.y}px)`),Vo(this._container,h,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(Ac),d)}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=u.Q.convert(d),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const e=document.createDocumentFragment(),r=document.createElement("body");let l;for(r.innerHTML=d;l=r.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var d;return(d=this._container)===null||d===void 0?void 0:d.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=oe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){return this._container&&this._container.classList.add(d),this}removeClassName(d){return this._container&&this._container.classList.remove(d),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){if(this._container)return this._container.classList.toggle(d)}setSubpixelPositioning(d){this.options.subpixelPositioning=d}_createCloseButton(){this.options.closeButton&&(this._closeButton=oe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(zc);d&&d.focus()}},z.RasterDEMTileSource=zi,z.RasterTileSource=Sr,z.ScaleControl=class{constructor(d){this._onMove=()=>{Ec(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ec(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Du),d)}getDefaultPosition(){return"bottom-left"}onAdd(d){return this._map=d,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){oe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},z.ScrollZoomHandler=so,z.Style=ac,z.TerrainControl=class{constructor(d){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=d}onAdd(d){return this._map=d,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=oe.create("button","maplibregl-ctrl-terrain",this._container),oe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){oe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},z.TwoFingersTouchPitchHandler=ao,z.TwoFingersTouchRotateHandler=Au,z.TwoFingersTouchZoomHandler=Tl,z.TwoFingersTouchZoomRotateHandler=Ri,z.VectorTileSource=yn,z.VideoSource=vn,z.addSourceType=(d,e)=>u._(void 0,void 0,void 0,function*(){if(Yr(d))throw new Error(`A source type called "${d}" already exists.`);((r,l)=>{rs[r]=l})(d,e)}),z.clearPrewarmedResources=function(){const d=wt;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(rt),wt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},z.createTileMesh=Za,z.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},z.getRTLTextPluginStatus=function(){return Oi().getRTLTextPluginStatus()},z.getVersion=function(){return Iu},z.getWorkerCount=function(){return At.workerCount},z.getWorkerUrl=function(){return u.a.WORKER_URL},z.importScriptInWorkers=function(d){return hi().broadcast("IS",d)},z.prewarm=function(){Yt().acquire(rt)},z.setMaxParallelImageRequests=function(d){u.a.MAX_PARALLEL_IMAGE_REQUESTS=d},z.setRTLTextPlugin=function(d,e){return Oi().setRTLTextPlugin(d,e)},z.setWorkerCount=function(d){At.workerCount=d},z.setWorkerUrl=function(d){u.a.WORKER_URL=d}});var G=P;return G})}(lm)),lm.exports}var Yy=Xy();const mp={black:"#000",white:"#fff"},ed={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},td={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},id={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},rd={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},nd={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},up={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Ky={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function af(y,...S){const P=new URL(`https://mui.com/production-error/?code=${y}`);return S.forEach(R=>P.searchParams.append("args[]",R)),`Minified MUI error #${y}; visit ${P} for the full message.`}const Yc="$$material";function mm(){return mm=Object.assign?Object.assign.bind():function(y){for(var S=1;S<arguments.length;S++){var P=arguments[S];for(var R in P)({}).hasOwnProperty.call(P,R)&&(y[R]=P[R])}return y},mm.apply(null,arguments)}function Wy(y){if(y.sheet)return y.sheet;for(var S=0;S<document.styleSheets.length;S++)if(document.styleSheets[S].ownerNode===y)return document.styleSheets[S]}function Qy(y){var S=document.createElement("style");return S.setAttribute("data-emotion",y.key),y.nonce!==void 0&&S.setAttribute("nonce",y.nonce),S.appendChild(document.createTextNode("")),S.setAttribute("data-s",""),S}var Jy=function(){function y(P){var R=this;this._insertTag=function(B){var G;R.tags.length===0?R.insertionPoint?G=R.insertionPoint.nextSibling:R.prepend?G=R.container.firstChild:G=R.before:G=R.tags[R.tags.length-1].nextSibling,R.container.insertBefore(B,G),R.tags.push(B)},this.isSpeedy=P.speedy===void 0?!0:P.speedy,this.tags=[],this.ctr=0,this.nonce=P.nonce,this.key=P.key,this.container=P.container,this.prepend=P.prepend,this.insertionPoint=P.insertionPoint,this.before=null}var S=y.prototype;return S.hydrate=function(R){R.forEach(this._insertTag)},S.insert=function(R){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Qy(this));var B=this.tags[this.tags.length-1];if(this.isSpeedy){var G=Wy(B);try{G.insertRule(R,G.cssRules.length)}catch{}}else B.appendChild(document.createTextNode(R));this.ctr++},S.flush=function(){this.tags.forEach(function(R){var B;return(B=R.parentNode)==null?void 0:B.removeChild(R)}),this.tags=[],this.ctr=0},y}(),Oa="-ms-",gm="-moz-",qi="-webkit-",G_="comm",xg="rule",bg="decl",e0="@import",$_="@keyframes",t0="@layer",i0=Math.abs,xm=String.fromCharCode,r0=Object.assign;function n0(y,S){return xa(y,0)^45?(((S<<2^xa(y,0))<<2^xa(y,1))<<2^xa(y,2))<<2^xa(y,3):0}function q_(y){return y.trim()}function a0(y,S){return(y=S.exec(y))?y[0]:y}function Hi(y,S,P){return y.replace(S,P)}function ag(y,S){return y.indexOf(S)}function xa(y,S){return y.charCodeAt(S)|0}function gp(y,S,P){return y.slice(S,P)}function Ql(y){return y.length}function wg(y){return y.length}function nm(y,S){return S.push(y),y}function s0(y,S){return y.map(S).join("")}var bm=1,od=1,H_=0,xs=0,Ln=0,ld="";function wm(y,S,P,R,B,G,z){return{value:y,root:S,parent:P,type:R,props:B,children:G,line:bm,column:od,length:z,return:""}}function hp(y,S){return r0(wm("",null,null,"",null,null,0),y,{length:-y.length},S)}function o0(){return Ln}function l0(){return Ln=xs>0?xa(ld,--xs):0,od--,Ln===10&&(od=1,bm--),Ln}function Vs(){return Ln=xs<H_?xa(ld,xs++):0,od++,Ln===10&&(od=1,bm++),Ln}function tc(){return xa(ld,xs)}function cm(){return xs}function vp(y,S){return gp(ld,y,S)}function _p(y){switch(y){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function X_(y){return bm=od=1,H_=Ql(ld=y),xs=0,[]}function Y_(y){return ld="",y}function um(y){return q_(vp(xs-1,sg(y===91?y+2:y===40?y+1:y)))}function c0(y){for(;(Ln=tc())&&Ln<33;)Vs();return _p(y)>2||_p(Ln)>3?"":" "}function u0(y,S){for(;--S&&Vs()&&!(Ln<48||Ln>102||Ln>57&&Ln<65||Ln>70&&Ln<97););return vp(y,cm()+(S<6&&tc()==32&&Vs()==32))}function sg(y){for(;Vs();)switch(Ln){case y:return xs;case 34:case 39:y!==34&&y!==39&&sg(Ln);break;case 40:y===41&&sg(y);break;case 92:Vs();break}return xs}function h0(y,S){for(;Vs()&&y+Ln!==57;)if(y+Ln===84&&tc()===47)break;return"/*"+vp(S,xs-1)+"*"+xm(y===47?y:Vs())}function f0(y){for(;!_p(tc());)Vs();return vp(y,xs)}function d0(y){return Y_(hm("",null,null,null,[""],y=X_(y),0,[0],y))}function hm(y,S,P,R,B,G,z,u,ce){for(var ae=0,Ce=0,Ee=z,be=0,oe=0,we=0,ze=1,dt=1,gt=1,St=0,vt="",at=B,Oe=G,ut=R,yt=vt;dt;)switch(we=St,St=Vs()){case 40:if(we!=108&&xa(yt,Ee-1)==58){ag(yt+=Hi(um(St),"&","&\f"),"&\f")!=-1&&(gt=-1);break}case 34:case 39:case 91:yt+=um(St);break;case 9:case 10:case 13:case 32:yt+=c0(we);break;case 92:yt+=u0(cm()-1,7);continue;case 47:switch(tc()){case 42:case 47:nm(p0(h0(Vs(),cm()),S,P),ce);break;default:yt+="/"}break;case 123*ze:u[ae++]=Ql(yt)*gt;case 125*ze:case 59:case 0:switch(St){case 0:case 125:dt=0;case 59+Ce:gt==-1&&(yt=Hi(yt,/\f/g,"")),oe>0&&Ql(yt)-Ee&&nm(oe>32?i_(yt+";",R,P,Ee-1):i_(Hi(yt," ","")+";",R,P,Ee-2),ce);break;case 59:yt+=";";default:if(nm(ut=t_(yt,S,P,ae,Ce,B,u,vt,at=[],Oe=[],Ee),G),St===123)if(Ce===0)hm(yt,S,ut,ut,at,G,Ee,u,Oe);else switch(be===99&&xa(yt,3)===110?100:be){case 100:case 108:case 109:case 115:hm(y,ut,ut,R&&nm(t_(y,ut,ut,0,0,B,u,vt,B,at=[],Ee),Oe),B,Oe,Ee,u,R?at:Oe);break;default:hm(yt,ut,ut,ut,[""],Oe,0,u,Oe)}}ae=Ce=oe=0,ze=gt=1,vt=yt="",Ee=z;break;case 58:Ee=1+Ql(yt),oe=we;default:if(ze<1){if(St==123)--ze;else if(St==125&&ze++==0&&l0()==125)continue}switch(yt+=xm(St),St*ze){case 38:gt=Ce>0?1:(yt+="\f",-1);break;case 44:u[ae++]=(Ql(yt)-1)*gt,gt=1;break;case 64:tc()===45&&(yt+=um(Vs())),be=tc(),Ce=Ee=Ql(vt=yt+=f0(cm())),St++;break;case 45:we===45&&Ql(yt)==2&&(ze=0)}}return G}function t_(y,S,P,R,B,G,z,u,ce,ae,Ce){for(var Ee=B-1,be=B===0?G:[""],oe=wg(be),we=0,ze=0,dt=0;we<R;++we)for(var gt=0,St=gp(y,Ee+1,Ee=i0(ze=z[we])),vt=y;gt<oe;++gt)(vt=q_(ze>0?be[gt]+" "+St:Hi(St,/&\f/g,be[gt])))&&(ce[dt++]=vt);return wm(y,S,P,B===0?xg:u,ce,ae,Ce)}function p0(y,S,P){return wm(y,S,P,G_,xm(o0()),gp(y,2,-2),0)}function i_(y,S,P,R){return wm(y,S,P,bg,gp(y,0,R),gp(y,R+1,-1),R)}function ad(y,S){for(var P="",R=wg(y),B=0;B<R;B++)P+=S(y[B],B,y,S)||"";return P}function m0(y,S,P,R){switch(y.type){case t0:if(y.children.length)break;case e0:case bg:return y.return=y.return||y.value;case G_:return"";case $_:return y.return=y.value+"{"+ad(y.children,R)+"}";case xg:y.value=y.props.join(",")}return Ql(P=ad(y.children,R))?y.return=y.value+"{"+P+"}":""}function g0(y){var S=wg(y);return function(P,R,B,G){for(var z="",u=0;u<S;u++)z+=y[u](P,R,B,G)||"";return z}}function _0(y){return function(S){S.root||(S=S.return)&&y(S)}}function K_(y){var S=Object.create(null);return function(P){return S[P]===void 0&&(S[P]=y(P)),S[P]}}var y0=function(S,P,R){for(var B=0,G=0;B=G,G=tc(),B===38&&G===12&&(P[R]=1),!_p(G);)Vs();return vp(S,xs)},v0=function(S,P){var R=-1,B=44;do switch(_p(B)){case 0:B===38&&tc()===12&&(P[R]=1),S[R]+=y0(xs-1,P,R);break;case 2:S[R]+=um(B);break;case 4:if(B===44){S[++R]=tc()===58?"&\f":"",P[R]=S[R].length;break}default:S[R]+=xm(B)}while(B=Vs());return S},x0=function(S,P){return Y_(v0(X_(S),P))},r_=new WeakMap,b0=function(S){if(!(S.type!=="rule"||!S.parent||S.length<1)){for(var P=S.value,R=S.parent,B=S.column===R.column&&S.line===R.line;R.type!=="rule";)if(R=R.parent,!R)return;if(!(S.props.length===1&&P.charCodeAt(0)!==58&&!r_.get(R))&&!B){r_.set(S,!0);for(var G=[],z=x0(P,G),u=R.props,ce=0,ae=0;ce<z.length;ce++)for(var Ce=0;Ce<u.length;Ce++,ae++)S.props[ae]=G[ce]?z[ce].replace(/&\f/g,u[Ce]):u[Ce]+" "+z[ce]}}},w0=function(S){if(S.type==="decl"){var P=S.value;P.charCodeAt(0)===108&&P.charCodeAt(2)===98&&(S.return="",S.value="")}};function W_(y,S){switch(n0(y,S)){case 5103:return qi+"print-"+y+y;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return qi+y+y;case 5349:case 4246:case 4810:case 6968:case 2756:return qi+y+gm+y+Oa+y+y;case 6828:case 4268:return qi+y+Oa+y+y;case 6165:return qi+y+Oa+"flex-"+y+y;case 5187:return qi+y+Hi(y,/(\w+).+(:[^]+)/,qi+"box-$1$2"+Oa+"flex-$1$2")+y;case 5443:return qi+y+Oa+"flex-item-"+Hi(y,/flex-|-self/,"")+y;case 4675:return qi+y+Oa+"flex-line-pack"+Hi(y,/align-content|flex-|-self/,"")+y;case 5548:return qi+y+Oa+Hi(y,"shrink","negative")+y;case 5292:return qi+y+Oa+Hi(y,"basis","preferred-size")+y;case 6060:return qi+"box-"+Hi(y,"-grow","")+qi+y+Oa+Hi(y,"grow","positive")+y;case 4554:return qi+Hi(y,/([^-])(transform)/g,"$1"+qi+"$2")+y;case 6187:return Hi(Hi(Hi(y,/(zoom-|grab)/,qi+"$1"),/(image-set)/,qi+"$1"),y,"")+y;case 5495:case 3959:return Hi(y,/(image-set\([^]*)/,qi+"$1$`$1");case 4968:return Hi(Hi(y,/(.+:)(flex-)?(.*)/,qi+"box-pack:$3"+Oa+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+qi+y+y;case 4095:case 3583:case 4068:case 2532:return Hi(y,/(.+)-inline(.+)/,qi+"$1$2")+y;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Ql(y)-1-S>6)switch(xa(y,S+1)){case 109:if(xa(y,S+4)!==45)break;case 102:return Hi(y,/(.+:)(.+)-([^]+)/,"$1"+qi+"$2-$3$1"+gm+(xa(y,S+3)==108?"$3":"$2-$3"))+y;case 115:return~ag(y,"stretch")?W_(Hi(y,"stretch","fill-available"),S)+y:y}break;case 4949:if(xa(y,S+1)!==115)break;case 6444:switch(xa(y,Ql(y)-3-(~ag(y,"!important")&&10))){case 107:return Hi(y,":",":"+qi)+y;case 101:return Hi(y,/(.+:)([^;!]+)(;|!.+)?/,"$1"+qi+(xa(y,14)===45?"inline-":"")+"box$3$1"+qi+"$2$3$1"+Oa+"$2box$3")+y}break;case 5936:switch(xa(y,S+11)){case 114:return qi+y+Oa+Hi(y,/[svh]\w+-[tblr]{2}/,"tb")+y;case 108:return qi+y+Oa+Hi(y,/[svh]\w+-[tblr]{2}/,"tb-rl")+y;case 45:return qi+y+Oa+Hi(y,/[svh]\w+-[tblr]{2}/,"lr")+y}return qi+y+Oa+y+y}return y}var S0=function(S,P,R,B){if(S.length>-1&&!S.return)switch(S.type){case bg:S.return=W_(S.value,S.length);break;case $_:return ad([hp(S,{value:Hi(S.value,"@","@"+qi)})],B);case xg:if(S.length)return s0(S.props,function(G){switch(a0(G,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ad([hp(S,{props:[Hi(G,/:(read-\w+)/,":"+gm+"$1")]})],B);case"::placeholder":return ad([hp(S,{props:[Hi(G,/:(plac\w+)/,":"+qi+"input-$1")]}),hp(S,{props:[Hi(G,/:(plac\w+)/,":"+gm+"$1")]}),hp(S,{props:[Hi(G,/:(plac\w+)/,Oa+"input-$1")]})],B)}return""})}},T0=[S0],M0=function(S){var P=S.key;if(P==="css"){var R=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(R,function(ze){var dt=ze.getAttribute("data-emotion");dt.indexOf(" ")!==-1&&(document.head.appendChild(ze),ze.setAttribute("data-s",""))})}var B=S.stylisPlugins||T0,G={},z,u=[];z=S.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+P+' "]'),function(ze){for(var dt=ze.getAttribute("data-emotion").split(" "),gt=1;gt<dt.length;gt++)G[dt[gt]]=!0;u.push(ze)});var ce,ae=[b0,w0];{var Ce,Ee=[m0,_0(function(ze){Ce.insert(ze)})],be=g0(ae.concat(B,Ee)),oe=function(dt){return ad(d0(dt),be)};ce=function(dt,gt,St,vt){Ce=St,oe(dt?dt+"{"+gt.styles+"}":gt.styles),vt&&(we.inserted[gt.name]=!0)}}var we={key:P,sheet:new Jy({key:P,container:z,nonce:S.nonce,speedy:S.speedy,prepend:S.prepend,insertionPoint:S.insertionPoint}),nonce:S.nonce,inserted:G,registered:{},insert:ce};return we.sheet.hydrate(u),we},Km={exports:{}},Wi={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n_;function C0(){if(n_)return Wi;n_=1;var y=typeof Symbol=="function"&&Symbol.for,S=y?Symbol.for("react.element"):60103,P=y?Symbol.for("react.portal"):60106,R=y?Symbol.for("react.fragment"):60107,B=y?Symbol.for("react.strict_mode"):60108,G=y?Symbol.for("react.profiler"):60114,z=y?Symbol.for("react.provider"):60109,u=y?Symbol.for("react.context"):60110,ce=y?Symbol.for("react.async_mode"):60111,ae=y?Symbol.for("react.concurrent_mode"):60111,Ce=y?Symbol.for("react.forward_ref"):60112,Ee=y?Symbol.for("react.suspense"):60113,be=y?Symbol.for("react.suspense_list"):60120,oe=y?Symbol.for("react.memo"):60115,we=y?Symbol.for("react.lazy"):60116,ze=y?Symbol.for("react.block"):60121,dt=y?Symbol.for("react.fundamental"):60117,gt=y?Symbol.for("react.responder"):60118,St=y?Symbol.for("react.scope"):60119;function vt(Oe){if(typeof Oe=="object"&&Oe!==null){var ut=Oe.$$typeof;switch(ut){case S:switch(Oe=Oe.type,Oe){case ce:case ae:case R:case G:case B:case Ee:return Oe;default:switch(Oe=Oe&&Oe.$$typeof,Oe){case u:case Ce:case we:case oe:case z:return Oe;default:return ut}}case P:return ut}}}function at(Oe){return vt(Oe)===ae}return Wi.AsyncMode=ce,Wi.ConcurrentMode=ae,Wi.ContextConsumer=u,Wi.ContextProvider=z,Wi.Element=S,Wi.ForwardRef=Ce,Wi.Fragment=R,Wi.Lazy=we,Wi.Memo=oe,Wi.Portal=P,Wi.Profiler=G,Wi.StrictMode=B,Wi.Suspense=Ee,Wi.isAsyncMode=function(Oe){return at(Oe)||vt(Oe)===ce},Wi.isConcurrentMode=at,Wi.isContextConsumer=function(Oe){return vt(Oe)===u},Wi.isContextProvider=function(Oe){return vt(Oe)===z},Wi.isElement=function(Oe){return typeof Oe=="object"&&Oe!==null&&Oe.$$typeof===S},Wi.isForwardRef=function(Oe){return vt(Oe)===Ce},Wi.isFragment=function(Oe){return vt(Oe)===R},Wi.isLazy=function(Oe){return vt(Oe)===we},Wi.isMemo=function(Oe){return vt(Oe)===oe},Wi.isPortal=function(Oe){return vt(Oe)===P},Wi.isProfiler=function(Oe){return vt(Oe)===G},Wi.isStrictMode=function(Oe){return vt(Oe)===B},Wi.isSuspense=function(Oe){return vt(Oe)===Ee},Wi.isValidElementType=function(Oe){return typeof Oe=="string"||typeof Oe=="function"||Oe===R||Oe===ae||Oe===G||Oe===B||Oe===Ee||Oe===be||typeof Oe=="object"&&Oe!==null&&(Oe.$$typeof===we||Oe.$$typeof===oe||Oe.$$typeof===z||Oe.$$typeof===u||Oe.$$typeof===Ce||Oe.$$typeof===dt||Oe.$$typeof===gt||Oe.$$typeof===St||Oe.$$typeof===ze)},Wi.typeOf=vt,Wi}var a_;function E0(){return a_||(a_=1,Km.exports=C0()),Km.exports}var Wm,s_;function A0(){if(s_)return Wm;s_=1;var y=E0(),S={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},P={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},R={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},B={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},G={};G[y.ForwardRef]=R,G[y.Memo]=B;function z(we){return y.isMemo(we)?B:G[we.$$typeof]||S}var u=Object.defineProperty,ce=Object.getOwnPropertyNames,ae=Object.getOwnPropertySymbols,Ce=Object.getOwnPropertyDescriptor,Ee=Object.getPrototypeOf,be=Object.prototype;function oe(we,ze,dt){if(typeof ze!="string"){if(be){var gt=Ee(ze);gt&&gt!==be&&oe(we,gt,dt)}var St=ce(ze);ae&&(St=St.concat(ae(ze)));for(var vt=z(we),at=z(ze),Oe=0;Oe<St.length;++Oe){var ut=St[Oe];if(!P[ut]&&!(dt&&dt[ut])&&!(at&&at[ut])&&!(vt&&vt[ut])){var yt=Ce(ze,ut);try{u(we,ut,yt)}catch{}}}}return we}return Wm=oe,Wm}A0();var z0=!0;function Q_(y,S,P){var R="";return P.split(" ").forEach(function(B){y[B]!==void 0?S.push(y[B]+";"):B&&(R+=B+" ")}),R}var Sg=function(S,P,R){var B=S.key+"-"+P.name;(R===!1||z0===!1)&&S.registered[B]===void 0&&(S.registered[B]=P.styles)},Tg=function(S,P,R){Sg(S,P,R);var B=S.key+"-"+P.name;if(S.inserted[P.name]===void 0){var G=P;do S.insert(P===G?"."+B:"",G,S.sheet,!0),G=G.next;while(G!==void 0)}};function P0(y){for(var S=0,P,R=0,B=y.length;B>=4;++R,B-=4)P=y.charCodeAt(R)&255|(y.charCodeAt(++R)&255)<<8|(y.charCodeAt(++R)&255)<<16|(y.charCodeAt(++R)&255)<<24,P=(P&65535)*1540483477+((P>>>16)*59797<<16),P^=P>>>24,S=(P&65535)*1540483477+((P>>>16)*59797<<16)^(S&65535)*1540483477+((S>>>16)*59797<<16);switch(B){case 3:S^=(y.charCodeAt(R+2)&255)<<16;case 2:S^=(y.charCodeAt(R+1)&255)<<8;case 1:S^=y.charCodeAt(R)&255,S=(S&65535)*1540483477+((S>>>16)*59797<<16)}return S^=S>>>13,S=(S&65535)*1540483477+((S>>>16)*59797<<16),((S^S>>>15)>>>0).toString(36)}var R0={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},D0=/[A-Z]|^ms/g,I0=/_EMO_([^_]+?)_([^]*?)_EMO_/g,J_=function(S){return S.charCodeAt(1)===45},o_=function(S){return S!=null&&typeof S!="boolean"},Qm=K_(function(y){return J_(y)?y:y.replace(D0,"-$&").toLowerCase()}),l_=function(S,P){switch(S){case"animation":case"animationName":if(typeof P=="string")return P.replace(I0,function(R,B,G){return Jl={name:B,styles:G,next:Jl},B})}return R0[S]!==1&&!J_(S)&&typeof P=="number"&&P!==0?P+"px":P};function yp(y,S,P){if(P==null)return"";var R=P;if(R.__emotion_styles!==void 0)return R;switch(typeof P){case"boolean":return"";case"object":{var B=P;if(B.anim===1)return Jl={name:B.name,styles:B.styles,next:Jl},B.name;var G=P;if(G.styles!==void 0){var z=G.next;if(z!==void 0)for(;z!==void 0;)Jl={name:z.name,styles:z.styles,next:Jl},z=z.next;var u=G.styles+";";return u}return k0(y,S,P)}case"function":{if(y!==void 0){var ce=Jl,ae=P(y);return Jl=ce,yp(y,S,ae)}break}}var Ce=P;if(S==null)return Ce;var Ee=S[Ce];return Ee!==void 0?Ee:Ce}function k0(y,S,P){var R="";if(Array.isArray(P))for(var B=0;B<P.length;B++)R+=yp(y,S,P[B])+";";else for(var G in P){var z=P[G];if(typeof z!="object"){var u=z;S!=null&&S[u]!==void 0?R+=G+"{"+S[u]+"}":o_(u)&&(R+=Qm(G)+":"+l_(G,u)+";")}else if(Array.isArray(z)&&typeof z[0]=="string"&&(S==null||S[z[0]]===void 0))for(var ce=0;ce<z.length;ce++)o_(z[ce])&&(R+=Qm(G)+":"+l_(G,z[ce])+";");else{var ae=yp(y,S,z);switch(G){case"animation":case"animationName":{R+=Qm(G)+":"+ae+";";break}default:R+=G+"{"+ae+"}"}}}return R}var c_=/label:\s*([^\s;{]+)\s*(;|$)/g,Jl;function xp(y,S,P){if(y.length===1&&typeof y[0]=="object"&&y[0]!==null&&y[0].styles!==void 0)return y[0];var R=!0,B="";Jl=void 0;var G=y[0];if(G==null||G.raw===void 0)R=!1,B+=yp(P,S,G);else{var z=G;B+=z[0]}for(var u=1;u<y.length;u++)if(B+=yp(P,S,y[u]),R){var ce=G;B+=ce[u]}c_.lastIndex=0;for(var ae="",Ce;(Ce=c_.exec(B))!==null;)ae+="-"+Ce[1];var Ee=P0(B)+ae;return{name:Ee,styles:B,next:Jl}}var L0=function(S){return S()},ey=ng.useInsertionEffect?ng.useInsertionEffect:!1,ty=ey||L0,u_=ey||pt.useLayoutEffect,iy=pt.createContext(typeof HTMLElement<"u"?M0({key:"css"}):null);iy.Provider;var Mg=function(S){return pt.forwardRef(function(P,R){var B=pt.useContext(iy);return S(P,B,R)})},bp=pt.createContext({}),Cg={}.hasOwnProperty,og="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",B0=function(S,P){var R={};for(var B in P)Cg.call(P,B)&&(R[B]=P[B]);return R[og]=S,R},O0=function(S){var P=S.cache,R=S.serialized,B=S.isStringTag;return Sg(P,R,B),ty(function(){return Tg(P,R,B)}),null},F0=Mg(function(y,S,P){var R=y.css;typeof R=="string"&&S.registered[R]!==void 0&&(R=S.registered[R]);var B=y[og],G=[R],z="";typeof y.className=="string"?z=Q_(S.registered,G,y.className):y.className!=null&&(z=y.className+" ");var u=xp(G,void 0,pt.useContext(bp));z+=S.key+"-"+u.name;var ce={};for(var ae in y)Cg.call(y,ae)&&ae!=="css"&&ae!==og&&(ce[ae]=y[ae]);return ce.className=z,P&&(ce.ref=P),pt.createElement(pt.Fragment,null,pt.createElement(O0,{cache:S,serialized:u,isStringTag:typeof B=="string"}),pt.createElement(B,ce))}),j0=F0,h_=function(S,P){var R=arguments;if(P==null||!Cg.call(P,"css"))return pt.createElement.apply(void 0,R);var B=R.length,G=new Array(B);G[0]=j0,G[1]=B0(S,P);for(var z=2;z<B;z++)G[z]=R[z];return pt.createElement.apply(null,G)};(function(y){var S;S||(S=y.JSX||(y.JSX={}))})(h_||(h_={}));var N0=Mg(function(y,S){var P=y.styles,R=xp([P],void 0,pt.useContext(bp)),B=pt.useRef();return u_(function(){var G=S.key+"-global",z=new S.sheet.constructor({key:G,nonce:S.sheet.nonce,container:S.sheet.container,speedy:S.sheet.isSpeedy}),u=!1,ce=document.querySelector('style[data-emotion="'+G+" "+R.name+'"]');return S.sheet.tags.length&&(z.before=S.sheet.tags[0]),ce!==null&&(u=!0,ce.setAttribute("data-emotion",G),z.hydrate([ce])),B.current=[z,u],function(){z.flush()}},[S]),u_(function(){var G=B.current,z=G[0],u=G[1];if(u){G[1]=!1;return}if(R.next!==void 0&&Tg(S,R.next,!0),z.tags.length){var ce=z.tags[z.tags.length-1].nextElementSibling;z.before=ce,z.flush()}S.insert("",R,z,!1)},[S,R.name]),null});function Eg(){for(var y=arguments.length,S=new Array(y),P=0;P<y;P++)S[P]=arguments[P];return xp(S)}function wp(){var y=Eg.apply(void 0,arguments),S="animation-"+y.name;return{name:S,styles:"@keyframes "+S+"{"+y.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var U0=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,V0=K_(function(y){return U0.test(y)||y.charCodeAt(0)===111&&y.charCodeAt(1)===110&&y.charCodeAt(2)<91}),Z0=V0,G0=function(S){return S!=="theme"},f_=function(S){return typeof S=="string"&&S.charCodeAt(0)>96?Z0:G0},d_=function(S,P,R){var B;if(P){var G=P.shouldForwardProp;B=S.__emotion_forwardProp&&G?function(z){return S.__emotion_forwardProp(z)&&G(z)}:G}return typeof B!="function"&&R&&(B=S.__emotion_forwardProp),B},$0=function(S){var P=S.cache,R=S.serialized,B=S.isStringTag;return Sg(P,R,B),ty(function(){return Tg(P,R,B)}),null},q0=function y(S,P){var R=S.__emotion_real===S,B=R&&S.__emotion_base||S,G,z;P!==void 0&&(G=P.label,z=P.target);var u=d_(S,P,R),ce=u||f_(B),ae=!ce("as");return function(){var Ce=arguments,Ee=R&&S.__emotion_styles!==void 0?S.__emotion_styles.slice(0):[];if(G!==void 0&&Ee.push("label:"+G+";"),Ce[0]==null||Ce[0].raw===void 0)Ee.push.apply(Ee,Ce);else{var be=Ce[0];Ee.push(be[0]);for(var oe=Ce.length,we=1;we<oe;we++)Ee.push(Ce[we],be[we])}var ze=Mg(function(dt,gt,St){var vt=ae&&dt.as||B,at="",Oe=[],ut=dt;if(dt.theme==null){ut={};for(var yt in dt)ut[yt]=dt[yt];ut.theme=pt.useContext(bp)}typeof dt.className=="string"?at=Q_(gt.registered,Oe,dt.className):dt.className!=null&&(at=dt.className+" ");var xt=xp(Ee.concat(Oe),gt.registered,ut);at+=gt.key+"-"+xt.name,z!==void 0&&(at+=" "+z);var lt=ae&&u===void 0?f_(vt):ce,Q={};for(var st in dt)ae&&st==="as"||lt(st)&&(Q[st]=dt[st]);return Q.className=at,St&&(Q.ref=St),pt.createElement(pt.Fragment,null,pt.createElement($0,{cache:gt,serialized:xt,isStringTag:typeof vt=="string"}),pt.createElement(vt,Q))});return ze.displayName=G!==void 0?G:"Styled("+(typeof B=="string"?B:B.displayName||B.name||"Component")+")",ze.defaultProps=S.defaultProps,ze.__emotion_real=ze,ze.__emotion_base=B,ze.__emotion_styles=Ee,ze.__emotion_forwardProp=u,Object.defineProperty(ze,"toString",{value:function(){return"."+z}}),ze.withComponent=function(dt,gt){var St=y(dt,mm({},P,gt,{shouldForwardProp:d_(ze,gt,!0)}));return St.apply(void 0,Ee)},ze}},H0=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],lg=q0.bind(null);H0.forEach(function(y){lg[y]=lg(y)});function X0(y){return y==null||Object.keys(y).length===0}function ry(y){const{styles:S,defaultTheme:P={}}=y,R=typeof S=="function"?B=>S(X0(B)?P:B):S;return Jt.jsx(N0,{styles:R})}/**
 * @mui/styled-engine v6.4.6
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function ny(y,S){return lg(y,S)}function Y0(y,S){Array.isArray(y.__emotion_styles)&&(y.__emotion_styles=S(y.__emotion_styles))}const p_=[];function m_(y){return p_[0]=y,xp(p_)}var Jm={exports:{}},ur={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g_;function K0(){if(g_)return ur;g_=1;var y=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),z=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),ce=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),Ee=Symbol.for("react.lazy"),be=Symbol.for("react.offscreen"),oe=Symbol.for("react.client.reference");function we(ze){if(typeof ze=="object"&&ze!==null){var dt=ze.$$typeof;switch(dt){case y:switch(ze=ze.type,ze){case P:case B:case R:case ce:case ae:return ze;default:switch(ze=ze&&ze.$$typeof,ze){case z:case u:case Ee:case Ce:return ze;case G:return ze;default:return dt}}case S:return dt}}}return ur.ContextConsumer=G,ur.ContextProvider=z,ur.Element=y,ur.ForwardRef=u,ur.Fragment=P,ur.Lazy=Ee,ur.Memo=Ce,ur.Portal=S,ur.Profiler=B,ur.StrictMode=R,ur.Suspense=ce,ur.SuspenseList=ae,ur.isContextConsumer=function(ze){return we(ze)===G},ur.isContextProvider=function(ze){return we(ze)===z},ur.isElement=function(ze){return typeof ze=="object"&&ze!==null&&ze.$$typeof===y},ur.isForwardRef=function(ze){return we(ze)===u},ur.isFragment=function(ze){return we(ze)===P},ur.isLazy=function(ze){return we(ze)===Ee},ur.isMemo=function(ze){return we(ze)===Ce},ur.isPortal=function(ze){return we(ze)===S},ur.isProfiler=function(ze){return we(ze)===B},ur.isStrictMode=function(ze){return we(ze)===R},ur.isSuspense=function(ze){return we(ze)===ce},ur.isSuspenseList=function(ze){return we(ze)===ae},ur.isValidElementType=function(ze){return typeof ze=="string"||typeof ze=="function"||ze===P||ze===B||ze===R||ze===ce||ze===ae||ze===be||typeof ze=="object"&&ze!==null&&(ze.$$typeof===Ee||ze.$$typeof===Ce||ze.$$typeof===z||ze.$$typeof===G||ze.$$typeof===u||ze.$$typeof===oe||ze.getModuleId!==void 0)},ur.typeOf=we,ur}var __;function W0(){return __||(__=1,Jm.exports=K0()),Jm.exports}var ay=W0();function ec(y){if(typeof y!="object"||y===null)return!1;const S=Object.getPrototypeOf(y);return(S===null||S===Object.prototype||Object.getPrototypeOf(S)===null)&&!(Symbol.toStringTag in y)&&!(Symbol.iterator in y)}function sy(y){if(pt.isValidElement(y)||ay.isValidElementType(y)||!ec(y))return y;const S={};return Object.keys(y).forEach(P=>{S[P]=sy(y[P])}),S}function Zs(y,S,P={clone:!0}){const R=P.clone?{...y}:y;return ec(y)&&ec(S)&&Object.keys(S).forEach(B=>{pt.isValidElement(S[B])||ay.isValidElementType(S[B])?R[B]=S[B]:ec(S[B])&&Object.prototype.hasOwnProperty.call(y,B)&&ec(y[B])?R[B]=Zs(y[B],S[B],P):P.clone?R[B]=ec(S[B])?sy(S[B]):S[B]:R[B]=S[B]}),R}const Q0=y=>{const S=Object.keys(y).map(P=>({key:P,val:y[P]}))||[];return S.sort((P,R)=>P.val-R.val),S.reduce((P,R)=>({...P,[R.key]:R.val}),{})};function J0(y){const{values:S={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:P="px",step:R=5,...B}=y,G=Q0(S),z=Object.keys(G);function u(be){return`@media (min-width:${typeof S[be]=="number"?S[be]:be}${P})`}function ce(be){return`@media (max-width:${(typeof S[be]=="number"?S[be]:be)-R/100}${P})`}function ae(be,oe){const we=z.indexOf(oe);return`@media (min-width:${typeof S[be]=="number"?S[be]:be}${P}) and (max-width:${(we!==-1&&typeof S[z[we]]=="number"?S[z[we]]:oe)-R/100}${P})`}function Ce(be){return z.indexOf(be)+1<z.length?ae(be,z[z.indexOf(be)+1]):u(be)}function Ee(be){const oe=z.indexOf(be);return oe===0?u(z[1]):oe===z.length-1?ce(z[oe]):ae(be,z[z.indexOf(be)+1]).replace("@media","@media not all and")}return{keys:z,values:G,up:u,down:ce,between:ae,only:Ce,not:Ee,unit:P,...B}}function ev(y,S){if(!y.containerQueries)return S;const P=Object.keys(S).filter(R=>R.startsWith("@container")).sort((R,B)=>{var z,u;const G=/min-width:\s*([0-9.]+)/;return+(((z=R.match(G))==null?void 0:z[1])||0)-+(((u=B.match(G))==null?void 0:u[1])||0)});return P.length?P.reduce((R,B)=>{const G=S[B];return delete R[B],R[B]=G,R},{...S}):S}function tv(y,S){return S==="@"||S.startsWith("@")&&(y.some(P=>S.startsWith(`@${P}`))||!!S.match(/^@\d/))}function iv(y,S){const P=S.match(/^@([^/]+)?\/?(.+)?$/);if(!P)return null;const[,R,B]=P,G=Number.isNaN(+R)?R||0:+R;return y.containerQueries(B).up(G)}function rv(y){const S=(G,z)=>G.replace("@media",z?`@container ${z}`:"@container");function P(G,z){G.up=(...u)=>S(y.breakpoints.up(...u),z),G.down=(...u)=>S(y.breakpoints.down(...u),z),G.between=(...u)=>S(y.breakpoints.between(...u),z),G.only=(...u)=>S(y.breakpoints.only(...u),z),G.not=(...u)=>{const ce=S(y.breakpoints.not(...u),z);return ce.includes("not all and")?ce.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):ce}}const R={},B=G=>(P(R,G),R);return P(B),{...y,containerQueries:B}}const nv={borderRadius:4};function pp(y,S){return S?Zs(y,S,{clone:!1}):y}const Sm={xs:0,sm:600,md:900,lg:1200,xl:1536},y_={keys:["xs","sm","md","lg","xl"],up:y=>`@media (min-width:${Sm[y]}px)`},av={containerQueries:y=>({up:S=>{let P=typeof S=="number"?S:Sm[S]||S;return typeof P=="number"&&(P=`${P}px`),y?`@container ${y} (min-width:${P})`:`@container (min-width:${P})`}})};function Kc(y,S,P){const R=y.theme||{};if(Array.isArray(S)){const G=R.breakpoints||y_;return S.reduce((z,u,ce)=>(z[G.up(G.keys[ce])]=P(S[ce]),z),{})}if(typeof S=="object"){const G=R.breakpoints||y_;return Object.keys(S).reduce((z,u)=>{if(tv(G.keys,u)){const ce=iv(R.containerQueries?R:av,u);ce&&(z[ce]=P(S[u],u))}else if(Object.keys(G.values||Sm).includes(u)){const ce=G.up(u);z[ce]=P(S[u],u)}else{const ce=u;z[ce]=S[ce]}return z},{})}return P(S)}function sv(y={}){var P;return((P=y.keys)==null?void 0:P.reduce((R,B)=>{const G=y.up(B);return R[G]={},R},{}))||{}}function ov(y,S){return y.reduce((P,R)=>{const B=P[R];return(!B||Object.keys(B).length===0)&&delete P[R],P},S)}function To(y){if(typeof y!="string")throw new Error(af(7));return y.charAt(0).toUpperCase()+y.slice(1)}function Tm(y,S,P=!0){if(!S||typeof S!="string")return null;if(y&&y.vars&&P){const R=`vars.${S}`.split(".").reduce((B,G)=>B&&B[G]?B[G]:null,y);if(R!=null)return R}return S.split(".").reduce((R,B)=>R&&R[B]!=null?R[B]:null,y)}function _m(y,S,P,R=P){let B;return typeof y=="function"?B=y(P):Array.isArray(y)?B=y[P]||R:B=Tm(y,P)||R,S&&(B=S(B,R,y)),B}function zn(y){const{prop:S,cssProperty:P=y.prop,themeKey:R,transform:B}=y,G=z=>{if(z[S]==null)return null;const u=z[S],ce=z.theme,ae=Tm(ce,R)||{};return Kc(z,u,Ee=>{let be=_m(ae,B,Ee);return Ee===be&&typeof Ee=="string"&&(be=_m(ae,B,`${S}${Ee==="default"?"":To(Ee)}`,Ee)),P===!1?be:{[P]:be}})};return G.propTypes={},G.filterProps=[S],G}function lv(y){const S={};return P=>(S[P]===void 0&&(S[P]=y(P)),S[P])}const cv={m:"margin",p:"padding"},uv={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},v_={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},hv=lv(y=>{if(y.length>2)if(v_[y])y=v_[y];else return[y];const[S,P]=y.split(""),R=cv[S],B=uv[P]||"";return Array.isArray(B)?B.map(G=>R+G):[R+B]}),Ag=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],zg=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Ag,...zg];function Sp(y,S,P,R){const B=Tm(y,S,!0)??P;return typeof B=="number"||typeof B=="string"?G=>typeof G=="string"?G:typeof B=="string"?`calc(${G} * ${B})`:B*G:Array.isArray(B)?G=>{if(typeof G=="string")return G;const z=Math.abs(G),u=B[z];return G>=0?u:typeof u=="number"?-u:`-${u}`}:typeof B=="function"?B:()=>{}}function Pg(y){return Sp(y,"spacing",8)}function Tp(y,S){return typeof S=="string"||S==null?S:y(S)}function fv(y,S){return P=>y.reduce((R,B)=>(R[B]=Tp(S,P),R),{})}function dv(y,S,P,R){if(!S.includes(P))return null;const B=hv(P),G=fv(B,R),z=y[P];return Kc(y,z,G)}function oy(y,S){const P=Pg(y.theme);return Object.keys(y).map(R=>dv(y,S,R,P)).reduce(pp,{})}function gn(y){return oy(y,Ag)}gn.propTypes={};gn.filterProps=Ag;function _n(y){return oy(y,zg)}_n.propTypes={};_n.filterProps=zg;function ly(y=8,S=Pg({spacing:y})){if(y.mui)return y;const P=(...R)=>(R.length===0?[1]:R).map(G=>{const z=S(G);return typeof z=="number"?`${z}px`:z}).join(" ");return P.mui=!0,P}function Mm(...y){const S=y.reduce((R,B)=>(B.filterProps.forEach(G=>{R[G]=B}),R),{}),P=R=>Object.keys(R).reduce((B,G)=>S[G]?pp(B,S[G](R)):B,{});return P.propTypes={},P.filterProps=y.reduce((R,B)=>R.concat(B.filterProps),[]),P}function So(y){return typeof y!="number"?y:`${y}px solid`}function Mo(y,S){return zn({prop:y,themeKey:"borders",transform:S})}const pv=Mo("border",So),mv=Mo("borderTop",So),gv=Mo("borderRight",So),_v=Mo("borderBottom",So),yv=Mo("borderLeft",So),vv=Mo("borderColor"),xv=Mo("borderTopColor"),bv=Mo("borderRightColor"),wv=Mo("borderBottomColor"),Sv=Mo("borderLeftColor"),Tv=Mo("outline",So),Mv=Mo("outlineColor"),Cm=y=>{if(y.borderRadius!==void 0&&y.borderRadius!==null){const S=Sp(y.theme,"shape.borderRadius",4),P=R=>({borderRadius:Tp(S,R)});return Kc(y,y.borderRadius,P)}return null};Cm.propTypes={};Cm.filterProps=["borderRadius"];Mm(pv,mv,gv,_v,yv,vv,xv,bv,wv,Sv,Cm,Tv,Mv);const Em=y=>{if(y.gap!==void 0&&y.gap!==null){const S=Sp(y.theme,"spacing",8),P=R=>({gap:Tp(S,R)});return Kc(y,y.gap,P)}return null};Em.propTypes={};Em.filterProps=["gap"];const Am=y=>{if(y.columnGap!==void 0&&y.columnGap!==null){const S=Sp(y.theme,"spacing",8),P=R=>({columnGap:Tp(S,R)});return Kc(y,y.columnGap,P)}return null};Am.propTypes={};Am.filterProps=["columnGap"];const zm=y=>{if(y.rowGap!==void 0&&y.rowGap!==null){const S=Sp(y.theme,"spacing",8),P=R=>({rowGap:Tp(S,R)});return Kc(y,y.rowGap,P)}return null};zm.propTypes={};zm.filterProps=["rowGap"];const Cv=zn({prop:"gridColumn"}),Ev=zn({prop:"gridRow"}),Av=zn({prop:"gridAutoFlow"}),zv=zn({prop:"gridAutoColumns"}),Pv=zn({prop:"gridAutoRows"}),Rv=zn({prop:"gridTemplateColumns"}),Dv=zn({prop:"gridTemplateRows"}),Iv=zn({prop:"gridTemplateAreas"}),kv=zn({prop:"gridArea"});Mm(Em,Am,zm,Cv,Ev,Av,zv,Pv,Rv,Dv,Iv,kv);function sd(y,S){return S==="grey"?S:y}const Lv=zn({prop:"color",themeKey:"palette",transform:sd}),Bv=zn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:sd}),Ov=zn({prop:"backgroundColor",themeKey:"palette",transform:sd});Mm(Lv,Bv,Ov);function Us(y){return y<=1&&y!==0?`${y*100}%`:y}const Fv=zn({prop:"width",transform:Us}),Rg=y=>{if(y.maxWidth!==void 0&&y.maxWidth!==null){const S=P=>{var B,G,z,u,ce;const R=((z=(G=(B=y.theme)==null?void 0:B.breakpoints)==null?void 0:G.values)==null?void 0:z[P])||Sm[P];return R?((ce=(u=y.theme)==null?void 0:u.breakpoints)==null?void 0:ce.unit)!=="px"?{maxWidth:`${R}${y.theme.breakpoints.unit}`}:{maxWidth:R}:{maxWidth:Us(P)}};return Kc(y,y.maxWidth,S)}return null};Rg.filterProps=["maxWidth"];const jv=zn({prop:"minWidth",transform:Us}),Nv=zn({prop:"height",transform:Us}),Uv=zn({prop:"maxHeight",transform:Us}),Vv=zn({prop:"minHeight",transform:Us});zn({prop:"size",cssProperty:"width",transform:Us});zn({prop:"size",cssProperty:"height",transform:Us});const Zv=zn({prop:"boxSizing"});Mm(Fv,Rg,jv,Nv,Uv,Vv,Zv);const Mp={border:{themeKey:"borders",transform:So},borderTop:{themeKey:"borders",transform:So},borderRight:{themeKey:"borders",transform:So},borderBottom:{themeKey:"borders",transform:So},borderLeft:{themeKey:"borders",transform:So},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:So},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Cm},color:{themeKey:"palette",transform:sd},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:sd},backgroundColor:{themeKey:"palette",transform:sd},p:{style:_n},pt:{style:_n},pr:{style:_n},pb:{style:_n},pl:{style:_n},px:{style:_n},py:{style:_n},padding:{style:_n},paddingTop:{style:_n},paddingRight:{style:_n},paddingBottom:{style:_n},paddingLeft:{style:_n},paddingX:{style:_n},paddingY:{style:_n},paddingInline:{style:_n},paddingInlineStart:{style:_n},paddingInlineEnd:{style:_n},paddingBlock:{style:_n},paddingBlockStart:{style:_n},paddingBlockEnd:{style:_n},m:{style:gn},mt:{style:gn},mr:{style:gn},mb:{style:gn},ml:{style:gn},mx:{style:gn},my:{style:gn},margin:{style:gn},marginTop:{style:gn},marginRight:{style:gn},marginBottom:{style:gn},marginLeft:{style:gn},marginX:{style:gn},marginY:{style:gn},marginInline:{style:gn},marginInlineStart:{style:gn},marginInlineEnd:{style:gn},marginBlock:{style:gn},marginBlockStart:{style:gn},marginBlockEnd:{style:gn},displayPrint:{cssProperty:!1,transform:y=>({"@media print":{display:y}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Em},rowGap:{style:zm},columnGap:{style:Am},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Us},maxWidth:{style:Rg},minWidth:{transform:Us},height:{transform:Us},maxHeight:{transform:Us},minHeight:{transform:Us},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function Gv(...y){const S=y.reduce((R,B)=>R.concat(Object.keys(B)),[]),P=new Set(S);return y.every(R=>P.size===Object.keys(R).length)}function $v(y,S){return typeof y=="function"?y(S):y}function qv(){function y(P,R,B,G){const z={[P]:R,theme:B},u=G[P];if(!u)return{[P]:R};const{cssProperty:ce=P,themeKey:ae,transform:Ce,style:Ee}=u;if(R==null)return null;if(ae==="typography"&&R==="inherit")return{[P]:R};const be=Tm(B,ae)||{};return Ee?Ee(z):Kc(z,R,we=>{let ze=_m(be,Ce,we);return we===ze&&typeof we=="string"&&(ze=_m(be,Ce,`${P}${we==="default"?"":To(we)}`,we)),ce===!1?ze:{[ce]:ze}})}function S(P){const{sx:R,theme:B={}}=P||{};if(!R)return null;const G=B.unstable_sxConfig??Mp;function z(u){let ce=u;if(typeof u=="function")ce=u(B);else if(typeof u!="object")return u;if(!ce)return null;const ae=sv(B.breakpoints),Ce=Object.keys(ae);let Ee=ae;return Object.keys(ce).forEach(be=>{const oe=$v(ce[be],B);if(oe!=null)if(typeof oe=="object")if(G[be])Ee=pp(Ee,y(be,oe,B,G));else{const we=Kc({theme:B},oe,ze=>({[be]:ze}));Gv(we,oe)?Ee[be]=S({sx:oe,theme:B}):Ee=pp(Ee,we)}else Ee=pp(Ee,y(be,oe,B,G))}),ev(B,ov(Ce,Ee))}return Array.isArray(R)?R.map(z):z(R)}return S}const nh=qv();nh.filterProps=["sx"];function Hv(y,S){var R;const P=this;if(P.vars){if(!((R=P.colorSchemes)!=null&&R[y])||typeof P.getColorSchemeSelector!="function")return{};let B=P.getColorSchemeSelector(y);return B==="&"?S:((B.includes("data-")||B.includes("."))&&(B=`*:where(${B.replace(/\s*&$/,"")}) &`),{[B]:S})}return P.palette.mode===y?S:{}}function Dg(y={},...S){const{breakpoints:P={},palette:R={},spacing:B,shape:G={},...z}=y,u=J0(P),ce=ly(B);let ae=Zs({breakpoints:u,direction:"ltr",components:{},palette:{mode:"light",...R},spacing:ce,shape:{...nv,...G}},z);return ae=rv(ae),ae.applyStyles=Hv,ae=S.reduce((Ce,Ee)=>Zs(Ce,Ee),ae),ae.unstable_sxConfig={...Mp,...z==null?void 0:z.unstable_sxConfig},ae.unstable_sx=function(Ee){return nh({sx:Ee,theme:this})},ae}function Xv(y){return Object.keys(y).length===0}function cy(y=null){const S=pt.useContext(bp);return!S||Xv(S)?y:S}const Yv=Dg();function uy(y=Yv){return cy(y)}function Kv({styles:y,themeId:S,defaultTheme:P={}}){const R=uy(P),B=typeof y=="function"?y(S&&R[S]||R):y;return Jt.jsx(ry,{styles:B})}const Wv=y=>{var R;const S={systemProps:{},otherProps:{}},P=((R=y==null?void 0:y.theme)==null?void 0:R.unstable_sxConfig)??Mp;return Object.keys(y).forEach(B=>{P[B]?S.systemProps[B]=y[B]:S.otherProps[B]=y[B]}),S};function Qv(y){const{sx:S,...P}=y,{systemProps:R,otherProps:B}=Wv(P);let G;return Array.isArray(S)?G=[R,...S]:typeof S=="function"?G=(...z)=>{const u=S(...z);return ec(u)?{...R,...u}:R}:G={...R,...S},{...B,sx:G}}const x_=y=>y,Jv=()=>{let y=x_;return{configure(S){y=S},generate(S){return y(S)},reset(){y=x_}}},hy=Jv();function fy(y){var S,P,R="";if(typeof y=="string"||typeof y=="number")R+=y;else if(typeof y=="object")if(Array.isArray(y)){var B=y.length;for(S=0;S<B;S++)y[S]&&(P=fy(y[S]))&&(R&&(R+=" "),R+=P)}else for(P in y)y[P]&&(R&&(R+=" "),R+=P);return R}function Ns(){for(var y,S,P=0,R="",B=arguments.length;P<B;P++)(y=arguments[P])&&(S=fy(y))&&(R&&(R+=" "),R+=S);return R}function ex(y={}){const{themeId:S,defaultTheme:P,defaultClassName:R="MuiBox-root",generateClassName:B}=y,G=ny("div",{shouldForwardProp:u=>u!=="theme"&&u!=="sx"&&u!=="as"})(nh);return pt.forwardRef(function(ce,ae){const Ce=uy(P),{className:Ee,component:be="div",...oe}=Qv(ce);return Jt.jsx(G,{as:be,ref:ae,className:Ns(Ee,B?B(R):R),theme:S&&Ce[S]||Ce,...oe})})}const tx={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Pm(y,S,P="Mui"){const R=tx[S];return R?`${P}-${R}`:`${hy.generate(y)}-${S}`}function Cp(y,S,P="Mui"){const R={};return S.forEach(B=>{R[B]=Pm(y,B,P)}),R}function dy(y){const{variants:S,...P}=y,R={variants:S,style:m_(P),isProcessed:!0};return R.style===P||S&&S.forEach(B=>{typeof B.style!="function"&&(B.style=m_(B.style))}),R}const ix=Dg();function eg(y){return y!=="ownerState"&&y!=="theme"&&y!=="sx"&&y!=="as"}function rx(y){return y?(S,P)=>P[y]:null}function nx(y,S,P){y.theme=ox(y.theme)?P:y.theme[S]||y.theme}function fm(y,S){const P=typeof S=="function"?S(y):S;if(Array.isArray(P))return P.flatMap(R=>fm(y,R));if(Array.isArray(P==null?void 0:P.variants)){let R;if(P.isProcessed)R=P.style;else{const{variants:B,...G}=P;R=G}return py(y,P.variants,[R])}return P!=null&&P.isProcessed?P.style:P}function py(y,S,P=[]){var B;let R;e:for(let G=0;G<S.length;G+=1){const z=S[G];if(typeof z.props=="function"){if(R??(R={...y,...y.ownerState,ownerState:y.ownerState}),!z.props(R))continue}else for(const u in z.props)if(y[u]!==z.props[u]&&((B=y.ownerState)==null?void 0:B[u])!==z.props[u])continue e;typeof z.style=="function"?(R??(R={...y,...y.ownerState,ownerState:y.ownerState}),P.push(z.style(R))):P.push(z.style)}return P}function ax(y={}){const{themeId:S,defaultTheme:P=ix,rootShouldForwardProp:R=eg,slotShouldForwardProp:B=eg}=y;function G(u){nx(u,S,P)}return(u,ce={})=>{Y0(u,Oe=>Oe.filter(ut=>ut!==nh));const{name:ae,slot:Ce,skipVariantsResolver:Ee,skipSx:be,overridesResolver:oe=rx(cx(Ce)),...we}=ce,ze=Ee!==void 0?Ee:Ce&&Ce!=="Root"&&Ce!=="root"||!1,dt=be||!1;let gt=eg;Ce==="Root"||Ce==="root"?gt=R:Ce?gt=B:lx(u)&&(gt=void 0);const St=ny(u,{shouldForwardProp:gt,label:sx(),...we}),vt=Oe=>{if(typeof Oe=="function"&&Oe.__emotion_real!==Oe)return function(yt){return fm(yt,Oe)};if(ec(Oe)){const ut=dy(Oe);return ut.variants?function(xt){return fm(xt,ut)}:ut.style}return Oe},at=(...Oe)=>{const ut=[],yt=Oe.map(vt),xt=[];if(ut.push(G),ae&&oe&&xt.push(function(Et){var Je,Zt;const ei=(Zt=(Je=Et.theme.components)==null?void 0:Je[ae])==null?void 0:Zt.styleOverrides;if(!ei)return null;const di={};for(const kt in ei)di[kt]=fm(Et,ei[kt]);return oe(Et,di)}),ae&&!ze&&xt.push(function(Et){var di,Je;const Vt=Et.theme,ei=(Je=(di=Vt==null?void 0:Vt.components)==null?void 0:di[ae])==null?void 0:Je.variants;return ei?py(Et,ei):null}),dt||xt.push(nh),Array.isArray(yt[0])){const st=yt.shift(),Et=new Array(ut.length).fill(""),Vt=new Array(xt.length).fill("");let ei;ei=[...Et,...st,...Vt],ei.raw=[...Et,...st.raw,...Vt],ut.unshift(ei)}const lt=[...ut,...yt,...xt],Q=St(...lt);return u.muiName&&(Q.muiName=u.muiName),Q};return St.withConfig&&(at.withConfig=St.withConfig),at}}function sx(y,S){return void 0}function ox(y){for(const S in y)return!1;return!0}function lx(y){return typeof y=="string"&&y.charCodeAt(0)>96}function cx(y){return y&&y.charAt(0).toLowerCase()+y.slice(1)}function cg(y,S){const P={...S};for(const R in y)if(Object.prototype.hasOwnProperty.call(y,R)){const B=R;if(B==="components"||B==="slots")P[B]={...y[B],...P[B]};else if(B==="componentsProps"||B==="slotProps"){const G=y[B],z=S[B];if(!z)P[B]=G||{};else if(!G)P[B]=z;else{P[B]={...z};for(const u in G)if(Object.prototype.hasOwnProperty.call(G,u)){const ce=u;P[B][ce]=cg(G[ce],z[ce])}}}else P[B]===void 0&&(P[B]=y[B])}return P}const my=typeof window<"u"?pt.useLayoutEffect:pt.useEffect;function ux(y,S=Number.MIN_SAFE_INTEGER,P=Number.MAX_SAFE_INTEGER){return Math.max(S,Math.min(y,P))}function Ig(y,S=0,P=1){return ux(y,S,P)}function hx(y){y=y.slice(1);const S=new RegExp(`.{1,${y.length>=6?2:1}}`,"g");let P=y.match(S);return P&&P[0].length===1&&(P=P.map(R=>R+R)),P?`rgb${P.length===4?"a":""}(${P.map((R,B)=>B<3?parseInt(R,16):Math.round(parseInt(R,16)/255*1e3)/1e3).join(", ")})`:""}function ah(y){if(y.type)return y;if(y.charAt(0)==="#")return ah(hx(y));const S=y.indexOf("("),P=y.substring(0,S);if(!["rgb","rgba","hsl","hsla","color"].includes(P))throw new Error(af(9,y));let R=y.substring(S+1,y.length-1),B;if(P==="color"){if(R=R.split(" "),B=R.shift(),R.length===4&&R[3].charAt(0)==="/"&&(R[3]=R[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(B))throw new Error(af(10,B))}else R=R.split(",");return R=R.map(G=>parseFloat(G)),{type:P,values:R,colorSpace:B}}const fx=y=>{const S=ah(y);return S.values.slice(0,3).map((P,R)=>S.type.includes("hsl")&&R!==0?`${P}%`:P).join(" ")},fp=(y,S)=>{try{return fx(y)}catch{return y}};function Rm(y){const{type:S,colorSpace:P}=y;let{values:R}=y;return S.includes("rgb")?R=R.map((B,G)=>G<3?parseInt(B,10):B):S.includes("hsl")&&(R[1]=`${R[1]}%`,R[2]=`${R[2]}%`),S.includes("color")?R=`${P} ${R.join(" ")}`:R=`${R.join(", ")}`,`${S}(${R})`}function gy(y){y=ah(y);const{values:S}=y,P=S[0],R=S[1]/100,B=S[2]/100,G=R*Math.min(B,1-B),z=(ae,Ce=(ae+P/30)%12)=>B-G*Math.max(Math.min(Ce-3,9-Ce,1),-1);let u="rgb";const ce=[Math.round(z(0)*255),Math.round(z(8)*255),Math.round(z(4)*255)];return y.type==="hsla"&&(u+="a",ce.push(S[3])),Rm({type:u,values:ce})}function ug(y){y=ah(y);let S=y.type==="hsl"||y.type==="hsla"?ah(gy(y)).values:y.values;return S=S.map(P=>(y.type!=="color"&&(P/=255),P<=.03928?P/12.92:((P+.055)/1.055)**2.4)),Number((.2126*S[0]+.7152*S[1]+.0722*S[2]).toFixed(3))}function dx(y,S){const P=ug(y),R=ug(S);return(Math.max(P,R)+.05)/(Math.min(P,R)+.05)}function hg(y,S){return y=ah(y),S=Ig(S),(y.type==="rgb"||y.type==="hsl")&&(y.type+="a"),y.type==="color"?y.values[3]=`/${S}`:y.values[3]=S,Rm(y)}function am(y,S,P){try{return hg(y,S)}catch{return y}}function kg(y,S){if(y=ah(y),S=Ig(S),y.type.includes("hsl"))y.values[2]*=1-S;else if(y.type.includes("rgb")||y.type.includes("color"))for(let P=0;P<3;P+=1)y.values[P]*=1-S;return Rm(y)}function br(y,S,P){try{return kg(y,S)}catch{return y}}function Lg(y,S){if(y=ah(y),S=Ig(S),y.type.includes("hsl"))y.values[2]+=(100-y.values[2])*S;else if(y.type.includes("rgb"))for(let P=0;P<3;P+=1)y.values[P]+=(255-y.values[P])*S;else if(y.type.includes("color"))for(let P=0;P<3;P+=1)y.values[P]+=(1-y.values[P])*S;return Rm(y)}function wr(y,S,P){try{return Lg(y,S)}catch{return y}}function px(y,S=.15){return ug(y)>.5?kg(y,S):Lg(y,S)}function sm(y,S,P){try{return px(y,S)}catch{return y}}function mx(y,S){typeof y=="function"?y(S):y&&(y.current=S)}let b_=0;function gx(y){const[S,P]=pt.useState(y),R=y||S;return pt.useEffect(()=>{S==null&&(b_+=1,P(`mui-${b_}`))},[S]),R}const _x={...ng},w_=_x.useId;function yx(y){if(w_!==void 0){const S=w_();return y??S}return gx(y)}function dm(y){const S=pt.useRef(y);return my(()=>{S.current=y}),pt.useRef((...P)=>(0,S.current)(...P)).current}function S_(...y){return pt.useMemo(()=>y.every(S=>S==null)?null:S=>{y.forEach(P=>{mx(P,S)})},y)}const T_={};function _y(y,S){const P=pt.useRef(T_);return P.current===T_&&(P.current=y(S)),P}const vx=[];function xx(y){pt.useEffect(y,vx)}class Bg{constructor(){op(this,"currentId",null);op(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});op(this,"disposeEffect",()=>this.clear)}static create(){return new Bg}start(S,P){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,P()},S)}}function bx(){const y=_y(Bg.create).current;return xx(y.disposeEffect),y}function M_(y){try{return y.matches(":focus-visible")}catch{}return!1}function Og(y,S,P=void 0){const R={};for(const B in y){const G=y[B];let z="",u=!0;for(let ce=0;ce<G.length;ce+=1){const ae=G[ce];ae&&(z+=(u===!0?"":" ")+S(ae),u=!1,P&&P[ae]&&(z+=" "+P[ae]))}R[B]=z}return R}const yy=pt.createContext(null);function Fg(){return pt.useContext(yy)}const wx=typeof Symbol=="function"&&Symbol.for,Sx=wx?Symbol.for("mui.nested"):"__THEME_NESTED__";function Tx(y,S){return typeof S=="function"?S(y):{...y,...S}}function Mx(y){const{children:S,theme:P}=y,R=Fg(),B=pt.useMemo(()=>{const G=R===null?{...P}:Tx(R,P);return G!=null&&(G[Sx]=R!==null),G},[P,R]);return Jt.jsx(yy.Provider,{value:B,children:S})}const Cx=pt.createContext();function Ex({value:y,...S}){return Jt.jsx(Cx.Provider,{value:y??!0,...S})}const vy=pt.createContext(void 0);function Ax({value:y,children:S}){return Jt.jsx(vy.Provider,{value:y,children:S})}function zx(y){const{theme:S,name:P,props:R}=y;if(!S||!S.components||!S.components[P])return R;const B=S.components[P];return B.defaultProps?cg(B.defaultProps,R):!B.styleOverrides&&!B.variants?cg(B,R):R}function Px({props:y,name:S}){const P=pt.useContext(vy);return zx({props:y,name:S,theme:{components:P}})}const C_={};function E_(y,S,P,R=!1){return pt.useMemo(()=>{const B=y&&S[y]||S;if(typeof P=="function"){const G=P(B),z=y?{...S,[y]:G}:G;return R?()=>z:z}return y?{...S,[y]:P}:{...S,...P}},[y,S,P,R])}function xy(y){const{children:S,theme:P,themeId:R}=y,B=cy(C_),G=Fg()||C_,z=E_(R,B,P),u=E_(R,G,P,!0),ce=(R?z[R]:z).direction==="rtl";return Jt.jsx(Mx,{theme:u,children:Jt.jsx(bp.Provider,{value:z,children:Jt.jsx(Ex,{value:ce,children:Jt.jsx(Ax,{value:R?z[R].components:z.components,children:S})})})})}const A_={theme:void 0};function Rx(y){let S,P;return function(B){let G=S;return(G===void 0||B.theme!==P)&&(A_.theme=B.theme,G=dy(y(A_)),S=G,P=B.theme),G}}const jg="mode",Ng="color-scheme",Dx="data-color-scheme";function Ix(y){const{defaultMode:S="system",defaultLightColorScheme:P="light",defaultDarkColorScheme:R="dark",modeStorageKey:B=jg,colorSchemeStorageKey:G=Ng,attribute:z=Dx,colorSchemeNode:u="document.documentElement",nonce:ce}=y||{};let ae="",Ce=z;if(z==="class"&&(Ce=".%s"),z==="data"&&(Ce="[data-%s]"),Ce.startsWith(".")){const be=Ce.substring(1);ae+=`${u}.classList.remove('${be}'.replace('%s', light), '${be}'.replace('%s', dark));
      ${u}.classList.add('${be}'.replace('%s', colorScheme));`}const Ee=Ce.match(/\[([^\]]+)\]/);if(Ee){const[be,oe]=Ee[1].split("=");oe||(ae+=`${u}.removeAttribute('${be}'.replace('%s', light));
      ${u}.removeAttribute('${be}'.replace('%s', dark));`),ae+=`
      ${u}.setAttribute('${be}'.replace('%s', colorScheme), ${oe?`${oe}.replace('%s', colorScheme)`:'""'});`}else ae+=`${u}.setAttribute('${Ce}', colorScheme);`;return Jt.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?ce:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${B}') || '${S}';
  const dark = localStorage.getItem('${G}-dark') || '${R}';
  const light = localStorage.getItem('${G}-light') || '${P}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${ae}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function kx(){}const Lx=({key:y,storageWindow:S})=>(!S&&typeof window<"u"&&(S=window),{get(P){if(typeof window>"u")return;if(!S)return P;let R;try{R=S.localStorage.getItem(y)}catch{}return R||P},set:P=>{if(S)try{S.localStorage.setItem(y,P)}catch{}},subscribe:P=>{if(!S)return kx;const R=B=>{const G=B.newValue;B.key===y&&P(G)};return S.addEventListener("storage",R),()=>{S.removeEventListener("storage",R)}}});function tg(){}function z_(y){if(typeof window<"u"&&typeof window.matchMedia=="function"&&y==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function by(y,S){if(y.mode==="light"||y.mode==="system"&&y.systemMode==="light")return S("light");if(y.mode==="dark"||y.mode==="system"&&y.systemMode==="dark")return S("dark")}function Bx(y){return by(y,S=>{if(S==="light")return y.lightColorScheme;if(S==="dark")return y.darkColorScheme})}function Ox(y){const{defaultMode:S="light",defaultLightColorScheme:P,defaultDarkColorScheme:R,supportedColorSchemes:B=[],modeStorageKey:G=jg,colorSchemeStorageKey:z=Ng,storageWindow:u=typeof window>"u"?void 0:window,storageManager:ce=Lx,noSsr:ae=!1}=y,Ce=B.join(","),Ee=B.length>1,be=pt.useMemo(()=>ce==null?void 0:ce({key:G,storageWindow:u}),[ce,G,u]),oe=pt.useMemo(()=>ce==null?void 0:ce({key:`${z}-light`,storageWindow:u}),[ce,z,u]),we=pt.useMemo(()=>ce==null?void 0:ce({key:`${z}-dark`,storageWindow:u}),[ce,z,u]),[ze,dt]=pt.useState(()=>{const xt=(be==null?void 0:be.get(S))||S,lt=(oe==null?void 0:oe.get(P))||P,Q=(we==null?void 0:we.get(R))||R;return{mode:xt,systemMode:z_(xt),lightColorScheme:lt,darkColorScheme:Q}}),[gt,St]=pt.useState(ae||!Ee);pt.useEffect(()=>{St(!0)},[]);const vt=Bx(ze),at=pt.useCallback(xt=>{dt(lt=>{if(xt===lt.mode)return lt;const Q=xt??S;return be==null||be.set(Q),{...lt,mode:Q,systemMode:z_(Q)}})},[be,S]),Oe=pt.useCallback(xt=>{xt?typeof xt=="string"?xt&&!Ce.includes(xt)?console.error(`\`${xt}\` does not exist in \`theme.colorSchemes\`.`):dt(lt=>{const Q={...lt};return by(lt,st=>{st==="light"&&(oe==null||oe.set(xt),Q.lightColorScheme=xt),st==="dark"&&(we==null||we.set(xt),Q.darkColorScheme=xt)}),Q}):dt(lt=>{const Q={...lt},st=xt.light===null?P:xt.light,Et=xt.dark===null?R:xt.dark;return st&&(Ce.includes(st)?(Q.lightColorScheme=st,oe==null||oe.set(st)):console.error(`\`${st}\` does not exist in \`theme.colorSchemes\`.`)),Et&&(Ce.includes(Et)?(Q.darkColorScheme=Et,we==null||we.set(Et)):console.error(`\`${Et}\` does not exist in \`theme.colorSchemes\`.`)),Q}):dt(lt=>(oe==null||oe.set(P),we==null||we.set(R),{...lt,lightColorScheme:P,darkColorScheme:R}))},[Ce,oe,we,P,R]),ut=pt.useCallback(xt=>{ze.mode==="system"&&dt(lt=>{const Q=xt!=null&&xt.matches?"dark":"light";return lt.systemMode===Q?lt:{...lt,systemMode:Q}})},[ze.mode]),yt=pt.useRef(ut);return yt.current=ut,pt.useEffect(()=>{if(typeof window.matchMedia!="function"||!Ee)return;const xt=(...Q)=>yt.current(...Q),lt=window.matchMedia("(prefers-color-scheme: dark)");return lt.addListener(xt),xt(lt),()=>{lt.removeListener(xt)}},[Ee]),pt.useEffect(()=>{if(Ee){const xt=(be==null?void 0:be.subscribe(st=>{(!st||["light","dark","system"].includes(st))&&at(st||S)}))||tg,lt=(oe==null?void 0:oe.subscribe(st=>{(!st||Ce.match(st))&&Oe({light:st})}))||tg,Q=(we==null?void 0:we.subscribe(st=>{(!st||Ce.match(st))&&Oe({dark:st})}))||tg;return()=>{xt(),lt(),Q()}}},[Oe,at,Ce,S,u,Ee,be,oe,we]),{...ze,mode:gt?ze.mode:void 0,systemMode:gt?ze.systemMode:void 0,colorScheme:gt?vt:void 0,setMode:at,setColorScheme:Oe}}const Fx="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function jx(y){const{themeId:S,theme:P={},modeStorageKey:R=jg,colorSchemeStorageKey:B=Ng,disableTransitionOnChange:G=!1,defaultColorScheme:z,resolveTheme:u}=y,ce={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},ae=pt.createContext(void 0),Ce=()=>pt.useContext(ae)||ce,Ee={},be={};function oe(gt){var Yr,bs,Fa,na;const{children:St,theme:vt,modeStorageKey:at=R,colorSchemeStorageKey:Oe=B,disableTransitionOnChange:ut=G,storageManager:yt,storageWindow:xt=typeof window>"u"?void 0:window,documentNode:lt=typeof document>"u"?void 0:document,colorSchemeNode:Q=typeof document>"u"?void 0:document.documentElement,disableNestedContext:st=!1,disableStyleSheetGeneration:Et=!1,defaultMode:Vt="system",noSsr:ei}=gt,di=pt.useRef(!1),Je=Fg(),Zt=pt.useContext(ae),kt=!!Zt&&!st,Wt=pt.useMemo(()=>vt||(typeof P=="function"?P():P),[vt]),ve=Wt[S],rt=ve||Wt,{colorSchemes:At=Ee,components:Lt=be,cssVarPrefix:wt}=rt,Xt=Object.keys(At).filter(Oi=>!!At[Oi]).join(","),Yt=pt.useMemo(()=>Xt.split(","),[Xt]),Xi=typeof z=="string"?z:z.light,hi=typeof z=="string"?z:z.dark,vi=At[Xi]&&At[hi]?Vt:((bs=(Yr=At[rt.defaultColorScheme])==null?void 0:Yr.palette)==null?void 0:bs.mode)||((Fa=rt.palette)==null?void 0:Fa.mode),{mode:Ci,setMode:Ai,systemMode:Bi,lightColorScheme:zr,darkColorScheme:Ei,colorScheme:qn,setColorScheme:yn}=Ox({supportedColorSchemes:Yt,defaultLightColorScheme:Xi,defaultDarkColorScheme:hi,modeStorageKey:at,colorSchemeStorageKey:Oe,defaultMode:vi,storageManager:yt,storageWindow:xt,noSsr:ei});let Sr=Ci,zi=qn;kt&&(Sr=Zt.mode,zi=Zt.colorScheme);const nn=pt.useMemo(()=>{var ja;const Oi=zi||rt.defaultColorScheme,hr=((ja=rt.generateThemeVars)==null?void 0:ja.call(rt))||rt.vars,fr={...rt,components:Lt,colorSchemes:At,cssVarPrefix:wt,vars:hr};if(typeof fr.generateSpacing=="function"&&(fr.spacing=fr.generateSpacing()),Oi){const an=At[Oi];an&&typeof an=="object"&&Object.keys(an).forEach(Kr=>{an[Kr]&&typeof an[Kr]=="object"?fr[Kr]={...fr[Kr],...an[Kr]}:fr[Kr]=an[Kr]})}return u?u(fr):fr},[rt,zi,Lt,At,wt]),Pr=rt.colorSchemeSelector;my(()=>{if(zi&&Q&&Pr&&Pr!=="media"){const Oi=Pr;let hr=Pr;if(Oi==="class"&&(hr=".%s"),Oi==="data"&&(hr="[data-%s]"),Oi!=null&&Oi.startsWith("data-")&&!Oi.includes("%s")&&(hr=`[${Oi}="%s"]`),hr.startsWith("."))Q.classList.remove(...Yt.map(fr=>hr.substring(1).replace("%s",fr))),Q.classList.add(hr.substring(1).replace("%s",zi));else{const fr=hr.replace("%s",zi).match(/\[([^\]]+)\]/);if(fr){const[ja,an]=fr[1].split("=");an||Yt.forEach(Kr=>{Q.removeAttribute(ja.replace(zi,Kr))}),Q.setAttribute(ja,an?an.replace(/"|'/g,""):"")}else Q.setAttribute(hr,zi)}}},[zi,Pr,Q,Yt]),pt.useEffect(()=>{let Oi;if(ut&&di.current&&lt){const hr=lt.createElement("style");hr.appendChild(lt.createTextNode(Fx)),lt.head.appendChild(hr),window.getComputedStyle(lt.body),Oi=setTimeout(()=>{lt.head.removeChild(hr)},1)}return()=>{clearTimeout(Oi)}},[zi,ut,lt]),pt.useEffect(()=>(di.current=!0,()=>{di.current=!1}),[]);const vn=pt.useMemo(()=>({allColorSchemes:Yt,colorScheme:zi,darkColorScheme:Ei,lightColorScheme:zr,mode:Sr,setColorScheme:yn,setMode:Ai,systemMode:Bi}),[Yt,zi,Ei,zr,Sr,yn,Ai,Bi,nn.colorSchemeSelector]);let ti=!0;(Et||rt.cssVariables===!1||kt&&(Je==null?void 0:Je.cssVarPrefix)===wt)&&(ti=!1);const rs=Jt.jsxs(pt.Fragment,{children:[Jt.jsx(xy,{themeId:ve?S:void 0,theme:nn,children:St}),ti&&Jt.jsx(ry,{styles:((na=nn.generateStyleSheets)==null?void 0:na.call(nn))||[]})]});return kt?rs:Jt.jsx(ae.Provider,{value:vn,children:rs})}const we=typeof z=="string"?z:z.light,ze=typeof z=="string"?z:z.dark;return{CssVarsProvider:oe,useColorScheme:Ce,getInitColorSchemeScript:gt=>Ix({colorSchemeStorageKey:B,defaultLightColorScheme:we,defaultDarkColorScheme:ze,modeStorageKey:R,...gt})}}function Nx(y=""){function S(...R){if(!R.length)return"";const B=R[0];return typeof B=="string"&&!B.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${y?`${y}-`:""}${B}${S(...R.slice(1))})`:`, ${B}`}return(R,...B)=>`var(--${y?`${y}-`:""}${R}${S(...B)})`}const P_=(y,S,P,R=[])=>{let B=y;S.forEach((G,z)=>{z===S.length-1?Array.isArray(B)?B[Number(G)]=P:B&&typeof B=="object"&&(B[G]=P):B&&typeof B=="object"&&(B[G]||(B[G]=R.includes(G)?[]:{}),B=B[G])})},Ux=(y,S,P)=>{function R(B,G=[],z=[]){Object.entries(B).forEach(([u,ce])=>{(!P||P&&!P([...G,u]))&&ce!=null&&(typeof ce=="object"&&Object.keys(ce).length>0?R(ce,[...G,u],Array.isArray(ce)?[...z,u]:z):S([...G,u],ce,z))})}R(y)},Vx=(y,S)=>typeof S=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(R=>y.includes(R))||y[y.length-1].toLowerCase().includes("opacity")?S:`${S}px`:S;function ig(y,S){const{prefix:P,shouldSkipGeneratingVar:R}=S||{},B={},G={},z={};return Ux(y,(u,ce,ae)=>{if((typeof ce=="string"||typeof ce=="number")&&(!R||!R(u,ce))){const Ce=`--${P?`${P}-`:""}${u.join("-")}`,Ee=Vx(u,ce);Object.assign(B,{[Ce]:Ee}),P_(G,u,`var(${Ce})`,ae),P_(z,u,`var(${Ce}, ${Ee})`,ae)}},u=>u[0]==="vars"),{css:B,vars:G,varsWithDefaults:z}}function Zx(y,S={}){const{getSelector:P=dt,disableCssColorScheme:R,colorSchemeSelector:B}=S,{colorSchemes:G={},components:z,defaultColorScheme:u="light",...ce}=y,{vars:ae,css:Ce,varsWithDefaults:Ee}=ig(ce,S);let be=Ee;const oe={},{[u]:we,...ze}=G;if(Object.entries(ze||{}).forEach(([vt,at])=>{const{vars:Oe,css:ut,varsWithDefaults:yt}=ig(at,S);be=Zs(be,yt),oe[vt]={css:ut,vars:Oe}}),we){const{css:vt,vars:at,varsWithDefaults:Oe}=ig(we,S);be=Zs(be,Oe),oe[u]={css:vt,vars:at}}function dt(vt,at){var ut,yt;let Oe=B;if(B==="class"&&(Oe=".%s"),B==="data"&&(Oe="[data-%s]"),B!=null&&B.startsWith("data-")&&!B.includes("%s")&&(Oe=`[${B}="%s"]`),vt){if(Oe==="media")return y.defaultColorScheme===vt?":root":{[`@media (prefers-color-scheme: ${((yt=(ut=G[vt])==null?void 0:ut.palette)==null?void 0:yt.mode)||vt})`]:{":root":at}};if(Oe)return y.defaultColorScheme===vt?`:root, ${Oe.replace("%s",String(vt))}`:Oe.replace("%s",String(vt))}return":root"}return{vars:be,generateThemeVars:()=>{let vt={...ae};return Object.entries(oe).forEach(([,{vars:at}])=>{vt=Zs(vt,at)}),vt},generateStyleSheets:()=>{var xt,lt;const vt=[],at=y.defaultColorScheme||"light";function Oe(Q,st){Object.keys(st).length&&vt.push(typeof Q=="string"?{[Q]:{...st}}:Q)}Oe(P(void 0,{...Ce}),Ce);const{[at]:ut,...yt}=oe;if(ut){const{css:Q}=ut,st=(lt=(xt=G[at])==null?void 0:xt.palette)==null?void 0:lt.mode,Et=!R&&st?{colorScheme:st,...Q}:{...Q};Oe(P(at,{...Et}),Et)}return Object.entries(yt).forEach(([Q,{css:st}])=>{var ei,di;const Et=(di=(ei=G[Q])==null?void 0:ei.palette)==null?void 0:di.mode,Vt=!R&&Et?{colorScheme:Et,...st}:{...st};Oe(P(Q,{...Vt}),Vt)}),vt}}}function Gx(y){return function(P){return y==="media"?`@media (prefers-color-scheme: ${P})`:y?y.startsWith("data-")&&!y.includes("%s")?`[${y}="${P}"] &`:y==="class"?`.${P} &`:y==="data"?`[data-${P}] &`:`${y.replace("%s",P)} &`:"&"}}function wy(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:mp.white,default:mp.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const $x=wy();function Sy(){return{text:{primary:mp.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:mp.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const R_=Sy();function D_(y,S,P,R){const B=R.light||R,G=R.dark||R*1.5;y[S]||(y.hasOwnProperty(P)?y[S]=y[P]:S==="light"?y.light=Lg(y.main,B):S==="dark"&&(y.dark=kg(y.main,G)))}function qx(y="light"){return y==="dark"?{main:id[200],light:id[50],dark:id[400]}:{main:id[700],light:id[400],dark:id[800]}}function Hx(y="light"){return y==="dark"?{main:td[200],light:td[50],dark:td[400]}:{main:td[500],light:td[300],dark:td[700]}}function Xx(y="light"){return y==="dark"?{main:ed[500],light:ed[300],dark:ed[700]}:{main:ed[700],light:ed[400],dark:ed[800]}}function Yx(y="light"){return y==="dark"?{main:rd[400],light:rd[300],dark:rd[700]}:{main:rd[700],light:rd[500],dark:rd[900]}}function Kx(y="light"){return y==="dark"?{main:nd[400],light:nd[300],dark:nd[700]}:{main:nd[800],light:nd[500],dark:nd[900]}}function Wx(y="light"){return y==="dark"?{main:up[400],light:up[300],dark:up[700]}:{main:"#ed6c02",light:up[500],dark:up[900]}}function Ug(y){const{mode:S="light",contrastThreshold:P=3,tonalOffset:R=.2,...B}=y,G=y.primary||qx(S),z=y.secondary||Hx(S),u=y.error||Xx(S),ce=y.info||Yx(S),ae=y.success||Kx(S),Ce=y.warning||Wx(S);function Ee(ze){return dx(ze,R_.text.primary)>=P?R_.text.primary:$x.text.primary}const be=({color:ze,name:dt,mainShade:gt=500,lightShade:St=300,darkShade:vt=700})=>{if(ze={...ze},!ze.main&&ze[gt]&&(ze.main=ze[gt]),!ze.hasOwnProperty("main"))throw new Error(af(11,dt?` (${dt})`:"",gt));if(typeof ze.main!="string")throw new Error(af(12,dt?` (${dt})`:"",JSON.stringify(ze.main)));return D_(ze,"light",St,R),D_(ze,"dark",vt,R),ze.contrastText||(ze.contrastText=Ee(ze.main)),ze};let oe;return S==="light"?oe=wy():S==="dark"&&(oe=Sy()),Zs({common:{...mp},mode:S,primary:be({color:G,name:"primary"}),secondary:be({color:z,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:be({color:u,name:"error"}),warning:be({color:Ce,name:"warning"}),info:be({color:ce,name:"info"}),success:be({color:ae,name:"success"}),grey:Ky,contrastThreshold:P,getContrastText:Ee,augmentColor:be,tonalOffset:R,...oe},B)}function Qx(y){const S={};return Object.entries(y).forEach(R=>{const[B,G]=R;typeof G=="object"&&(S[B]=`${G.fontStyle?`${G.fontStyle} `:""}${G.fontVariant?`${G.fontVariant} `:""}${G.fontWeight?`${G.fontWeight} `:""}${G.fontStretch?`${G.fontStretch} `:""}${G.fontSize||""}${G.lineHeight?`/${G.lineHeight} `:""}${G.fontFamily||""}`)}),S}function Jx(y,S){return{toolbar:{minHeight:56,[y.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[y.up("sm")]:{minHeight:64}},...S}}function eb(y){return Math.round(y*1e5)/1e5}const I_={textTransform:"uppercase"},k_='"Roboto", "Helvetica", "Arial", sans-serif';function Ty(y,S){const{fontFamily:P=k_,fontSize:R=14,fontWeightLight:B=300,fontWeightRegular:G=400,fontWeightMedium:z=500,fontWeightBold:u=700,htmlFontSize:ce=16,allVariants:ae,pxToRem:Ce,...Ee}=typeof S=="function"?S(y):S,be=R/14,oe=Ce||(dt=>`${dt/ce*be}rem`),we=(dt,gt,St,vt,at)=>({fontFamily:P,fontWeight:dt,fontSize:oe(gt),lineHeight:St,...P===k_?{letterSpacing:`${eb(vt/gt)}em`}:{},...at,...ae}),ze={h1:we(B,96,1.167,-1.5),h2:we(B,60,1.2,-.5),h3:we(G,48,1.167,0),h4:we(G,34,1.235,.25),h5:we(G,24,1.334,0),h6:we(z,20,1.6,.15),subtitle1:we(G,16,1.75,.15),subtitle2:we(z,14,1.57,.1),body1:we(G,16,1.5,.15),body2:we(G,14,1.43,.15),button:we(z,14,1.75,.4,I_),caption:we(G,12,1.66,.4),overline:we(G,12,2.66,1,I_),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Zs({htmlFontSize:ce,pxToRem:oe,fontFamily:P,fontSize:R,fontWeightLight:B,fontWeightRegular:G,fontWeightMedium:z,fontWeightBold:u,...ze},Ee,{clone:!1})}const tb=.2,ib=.14,rb=.12;function Xr(...y){return[`${y[0]}px ${y[1]}px ${y[2]}px ${y[3]}px rgba(0,0,0,${tb})`,`${y[4]}px ${y[5]}px ${y[6]}px ${y[7]}px rgba(0,0,0,${ib})`,`${y[8]}px ${y[9]}px ${y[10]}px ${y[11]}px rgba(0,0,0,${rb})`].join(",")}const nb=["none",Xr(0,2,1,-1,0,1,1,0,0,1,3,0),Xr(0,3,1,-2,0,2,2,0,0,1,5,0),Xr(0,3,3,-2,0,3,4,0,0,1,8,0),Xr(0,2,4,-1,0,4,5,0,0,1,10,0),Xr(0,3,5,-1,0,5,8,0,0,1,14,0),Xr(0,3,5,-1,0,6,10,0,0,1,18,0),Xr(0,4,5,-2,0,7,10,1,0,2,16,1),Xr(0,5,5,-3,0,8,10,1,0,3,14,2),Xr(0,5,6,-3,0,9,12,1,0,3,16,2),Xr(0,6,6,-3,0,10,14,1,0,4,18,3),Xr(0,6,7,-4,0,11,15,1,0,4,20,3),Xr(0,7,8,-4,0,12,17,2,0,5,22,4),Xr(0,7,8,-4,0,13,19,2,0,5,24,4),Xr(0,7,9,-4,0,14,21,2,0,5,26,4),Xr(0,8,9,-5,0,15,22,2,0,6,28,5),Xr(0,8,10,-5,0,16,24,2,0,6,30,5),Xr(0,8,11,-5,0,17,26,2,0,6,32,5),Xr(0,9,11,-5,0,18,28,2,0,7,34,6),Xr(0,9,12,-6,0,19,29,2,0,7,36,6),Xr(0,10,13,-6,0,20,31,3,0,8,38,7),Xr(0,10,13,-6,0,21,33,3,0,8,40,7),Xr(0,10,14,-6,0,22,35,3,0,8,42,7),Xr(0,11,14,-7,0,23,36,3,0,9,44,8),Xr(0,11,15,-7,0,24,38,3,0,9,46,8)],ab={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},sb={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function L_(y){return`${Math.round(y)}ms`}function ob(y){if(!y)return 0;const S=y/36;return Math.min(Math.round((4+15*S**.25+S/5)*10),3e3)}function lb(y){const S={...ab,...y.easing},P={...sb,...y.duration};return{getAutoHeightDuration:ob,create:(B=["all"],G={})=>{const{duration:z=P.standard,easing:u=S.easeInOut,delay:ce=0,...ae}=G;return(Array.isArray(B)?B:[B]).map(Ce=>`${Ce} ${typeof z=="string"?z:L_(z)} ${u} ${typeof ce=="string"?ce:L_(ce)}`).join(",")},...y,easing:S,duration:P}}const cb={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function ub(y){return ec(y)||typeof y>"u"||typeof y=="string"||typeof y=="boolean"||typeof y=="number"||Array.isArray(y)}function My(y={}){const S={...y};function P(R){const B=Object.entries(R);for(let G=0;G<B.length;G++){const[z,u]=B[G];!ub(u)||z.startsWith("unstable_")?delete R[z]:ec(u)&&(R[z]={...u},P(R[z]))}}return P(S),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(S,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function fg(y={},...S){const{breakpoints:P,mixins:R={},spacing:B,palette:G={},transitions:z={},typography:u={},shape:ce,...ae}=y;if(y.vars&&y.generateThemeVars===void 0)throw new Error(af(20));const Ce=Ug(G),Ee=Dg(y);let be=Zs(Ee,{mixins:Jx(Ee.breakpoints,R),palette:Ce,shadows:nb.slice(),typography:Ty(Ce,u),transitions:lb(z),zIndex:{...cb}});return be=Zs(be,ae),be=S.reduce((oe,we)=>Zs(oe,we),be),be.unstable_sxConfig={...Mp,...ae==null?void 0:ae.unstable_sxConfig},be.unstable_sx=function(we){return nh({sx:we,theme:this})},be.toRuntimeSource=My,be}function hb(y){let S;return y<1?S=5.11916*y**2:S=4.5*Math.log(y+1)+2,Math.round(S*10)/1e3}const fb=[...Array(25)].map((y,S)=>{if(S===0)return"none";const P=hb(S);return`linear-gradient(rgba(255 255 255 / ${P}), rgba(255 255 255 / ${P}))`});function Cy(y){return{inputPlaceholder:y==="dark"?.5:.42,inputUnderline:y==="dark"?.7:.42,switchTrackDisabled:y==="dark"?.2:.12,switchTrack:y==="dark"?.3:.38}}function Ey(y){return y==="dark"?fb:[]}function db(y){const{palette:S={mode:"light"},opacity:P,overlays:R,...B}=y,G=Ug(S);return{palette:G,opacity:{...Cy(G.mode),...P},overlays:R||Ey(G.mode),...B}}function pb(y){var S;return!!y[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!y[0].match(/sxConfig$/)||y[0]==="palette"&&!!((S=y[1])!=null&&S.match(/(mode|contrastThreshold|tonalOffset)/))}const mb=y=>[...[...Array(25)].map((S,P)=>`--${y?`${y}-`:""}overlays-${P}`),`--${y?`${y}-`:""}palette-AppBar-darkBg`,`--${y?`${y}-`:""}palette-AppBar-darkColor`],gb=y=>(S,P)=>{const R=y.rootSelector||":root",B=y.colorSchemeSelector;let G=B;if(B==="class"&&(G=".%s"),B==="data"&&(G="[data-%s]"),B!=null&&B.startsWith("data-")&&!B.includes("%s")&&(G=`[${B}="%s"]`),y.defaultColorScheme===S){if(S==="dark"){const z={};return mb(y.cssVarPrefix).forEach(u=>{z[u]=P[u],delete P[u]}),G==="media"?{[R]:P,"@media (prefers-color-scheme: dark)":{[R]:z}}:G?{[G.replace("%s",S)]:z,[`${R}, ${G.replace("%s",S)}`]:P}:{[R]:{...P,...z}}}if(G&&G!=="media")return`${R}, ${G.replace("%s",String(S))}`}else if(S){if(G==="media")return{[`@media (prefers-color-scheme: ${String(S)})`]:{[R]:P}};if(G)return G.replace("%s",String(S))}return R};function _b(y,S){S.forEach(P=>{y[P]||(y[P]={})})}function Ke(y,S,P){!y[S]&&P&&(y[S]=P)}function dp(y){return typeof y!="string"||!y.startsWith("hsl")?y:gy(y)}function Hc(y,S){`${S}Channel`in y||(y[`${S}Channel`]=fp(dp(y[S])))}function yb(y){return typeof y=="number"?`${y}px`:typeof y=="string"||typeof y=="function"||Array.isArray(y)?y:"8px"}const Wl=y=>{try{return y()}catch{}},vb=(y="mui")=>Nx(y);function rg(y,S,P,R){if(!S)return;S=S===!0?{}:S;const B=R==="dark"?"dark":"light";if(!P){y[R]=db({...S,palette:{mode:B,...S==null?void 0:S.palette}});return}const{palette:G,...z}=fg({...P,palette:{mode:B,...S==null?void 0:S.palette}});return y[R]={...S,palette:G,opacity:{...Cy(B),...S==null?void 0:S.opacity},overlays:(S==null?void 0:S.overlays)||Ey(B)},z}function xb(y={},...S){const{colorSchemes:P={light:!0},defaultColorScheme:R,disableCssColorScheme:B=!1,cssVarPrefix:G="mui",shouldSkipGeneratingVar:z=pb,colorSchemeSelector:u=P.light&&P.dark?"media":void 0,rootSelector:ce=":root",...ae}=y,Ce=Object.keys(P)[0],Ee=R||(P.light&&Ce!=="light"?"light":Ce),be=vb(G),{[Ee]:oe,light:we,dark:ze,...dt}=P,gt={...dt};let St=oe;if((Ee==="dark"&&!("dark"in P)||Ee==="light"&&!("light"in P))&&(St=!0),!St)throw new Error(af(21,Ee));const vt=rg(gt,St,ae,Ee);we&&!gt.light&&rg(gt,we,void 0,"light"),ze&&!gt.dark&&rg(gt,ze,void 0,"dark");let at={defaultColorScheme:Ee,...vt,cssVarPrefix:G,colorSchemeSelector:u,rootSelector:ce,getCssVar:be,colorSchemes:gt,font:{...Qx(vt.typography),...vt.font},spacing:yb(ae.spacing)};Object.keys(at.colorSchemes).forEach(lt=>{const Q=at.colorSchemes[lt].palette,st=Et=>{const Vt=Et.split("-"),ei=Vt[1],di=Vt[2];return be(Et,Q[ei][di])};if(Q.mode==="light"&&(Ke(Q.common,"background","#fff"),Ke(Q.common,"onBackground","#000")),Q.mode==="dark"&&(Ke(Q.common,"background","#000"),Ke(Q.common,"onBackground","#fff")),_b(Q,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),Q.mode==="light"){Ke(Q.Alert,"errorColor",br(Q.error.light,.6)),Ke(Q.Alert,"infoColor",br(Q.info.light,.6)),Ke(Q.Alert,"successColor",br(Q.success.light,.6)),Ke(Q.Alert,"warningColor",br(Q.warning.light,.6)),Ke(Q.Alert,"errorFilledBg",st("palette-error-main")),Ke(Q.Alert,"infoFilledBg",st("palette-info-main")),Ke(Q.Alert,"successFilledBg",st("palette-success-main")),Ke(Q.Alert,"warningFilledBg",st("palette-warning-main")),Ke(Q.Alert,"errorFilledColor",Wl(()=>Q.getContrastText(Q.error.main))),Ke(Q.Alert,"infoFilledColor",Wl(()=>Q.getContrastText(Q.info.main))),Ke(Q.Alert,"successFilledColor",Wl(()=>Q.getContrastText(Q.success.main))),Ke(Q.Alert,"warningFilledColor",Wl(()=>Q.getContrastText(Q.warning.main))),Ke(Q.Alert,"errorStandardBg",wr(Q.error.light,.9)),Ke(Q.Alert,"infoStandardBg",wr(Q.info.light,.9)),Ke(Q.Alert,"successStandardBg",wr(Q.success.light,.9)),Ke(Q.Alert,"warningStandardBg",wr(Q.warning.light,.9)),Ke(Q.Alert,"errorIconColor",st("palette-error-main")),Ke(Q.Alert,"infoIconColor",st("palette-info-main")),Ke(Q.Alert,"successIconColor",st("palette-success-main")),Ke(Q.Alert,"warningIconColor",st("palette-warning-main")),Ke(Q.AppBar,"defaultBg",st("palette-grey-100")),Ke(Q.Avatar,"defaultBg",st("palette-grey-400")),Ke(Q.Button,"inheritContainedBg",st("palette-grey-300")),Ke(Q.Button,"inheritContainedHoverBg",st("palette-grey-A100")),Ke(Q.Chip,"defaultBorder",st("palette-grey-400")),Ke(Q.Chip,"defaultAvatarColor",st("palette-grey-700")),Ke(Q.Chip,"defaultIconColor",st("palette-grey-700")),Ke(Q.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Ke(Q.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Ke(Q.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Ke(Q.LinearProgress,"primaryBg",wr(Q.primary.main,.62)),Ke(Q.LinearProgress,"secondaryBg",wr(Q.secondary.main,.62)),Ke(Q.LinearProgress,"errorBg",wr(Q.error.main,.62)),Ke(Q.LinearProgress,"infoBg",wr(Q.info.main,.62)),Ke(Q.LinearProgress,"successBg",wr(Q.success.main,.62)),Ke(Q.LinearProgress,"warningBg",wr(Q.warning.main,.62)),Ke(Q.Skeleton,"bg",`rgba(${st("palette-text-primaryChannel")} / 0.11)`),Ke(Q.Slider,"primaryTrack",wr(Q.primary.main,.62)),Ke(Q.Slider,"secondaryTrack",wr(Q.secondary.main,.62)),Ke(Q.Slider,"errorTrack",wr(Q.error.main,.62)),Ke(Q.Slider,"infoTrack",wr(Q.info.main,.62)),Ke(Q.Slider,"successTrack",wr(Q.success.main,.62)),Ke(Q.Slider,"warningTrack",wr(Q.warning.main,.62));const Et=sm(Q.background.default,.8);Ke(Q.SnackbarContent,"bg",Et),Ke(Q.SnackbarContent,"color",Wl(()=>Q.getContrastText(Et))),Ke(Q.SpeedDialAction,"fabHoverBg",sm(Q.background.paper,.15)),Ke(Q.StepConnector,"border",st("palette-grey-400")),Ke(Q.StepContent,"border",st("palette-grey-400")),Ke(Q.Switch,"defaultColor",st("palette-common-white")),Ke(Q.Switch,"defaultDisabledColor",st("palette-grey-100")),Ke(Q.Switch,"primaryDisabledColor",wr(Q.primary.main,.62)),Ke(Q.Switch,"secondaryDisabledColor",wr(Q.secondary.main,.62)),Ke(Q.Switch,"errorDisabledColor",wr(Q.error.main,.62)),Ke(Q.Switch,"infoDisabledColor",wr(Q.info.main,.62)),Ke(Q.Switch,"successDisabledColor",wr(Q.success.main,.62)),Ke(Q.Switch,"warningDisabledColor",wr(Q.warning.main,.62)),Ke(Q.TableCell,"border",wr(am(Q.divider,1),.88)),Ke(Q.Tooltip,"bg",am(Q.grey[700],.92))}if(Q.mode==="dark"){Ke(Q.Alert,"errorColor",wr(Q.error.light,.6)),Ke(Q.Alert,"infoColor",wr(Q.info.light,.6)),Ke(Q.Alert,"successColor",wr(Q.success.light,.6)),Ke(Q.Alert,"warningColor",wr(Q.warning.light,.6)),Ke(Q.Alert,"errorFilledBg",st("palette-error-dark")),Ke(Q.Alert,"infoFilledBg",st("palette-info-dark")),Ke(Q.Alert,"successFilledBg",st("palette-success-dark")),Ke(Q.Alert,"warningFilledBg",st("palette-warning-dark")),Ke(Q.Alert,"errorFilledColor",Wl(()=>Q.getContrastText(Q.error.dark))),Ke(Q.Alert,"infoFilledColor",Wl(()=>Q.getContrastText(Q.info.dark))),Ke(Q.Alert,"successFilledColor",Wl(()=>Q.getContrastText(Q.success.dark))),Ke(Q.Alert,"warningFilledColor",Wl(()=>Q.getContrastText(Q.warning.dark))),Ke(Q.Alert,"errorStandardBg",br(Q.error.light,.9)),Ke(Q.Alert,"infoStandardBg",br(Q.info.light,.9)),Ke(Q.Alert,"successStandardBg",br(Q.success.light,.9)),Ke(Q.Alert,"warningStandardBg",br(Q.warning.light,.9)),Ke(Q.Alert,"errorIconColor",st("palette-error-main")),Ke(Q.Alert,"infoIconColor",st("palette-info-main")),Ke(Q.Alert,"successIconColor",st("palette-success-main")),Ke(Q.Alert,"warningIconColor",st("palette-warning-main")),Ke(Q.AppBar,"defaultBg",st("palette-grey-900")),Ke(Q.AppBar,"darkBg",st("palette-background-paper")),Ke(Q.AppBar,"darkColor",st("palette-text-primary")),Ke(Q.Avatar,"defaultBg",st("palette-grey-600")),Ke(Q.Button,"inheritContainedBg",st("palette-grey-800")),Ke(Q.Button,"inheritContainedHoverBg",st("palette-grey-700")),Ke(Q.Chip,"defaultBorder",st("palette-grey-700")),Ke(Q.Chip,"defaultAvatarColor",st("palette-grey-300")),Ke(Q.Chip,"defaultIconColor",st("palette-grey-300")),Ke(Q.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Ke(Q.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Ke(Q.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Ke(Q.LinearProgress,"primaryBg",br(Q.primary.main,.5)),Ke(Q.LinearProgress,"secondaryBg",br(Q.secondary.main,.5)),Ke(Q.LinearProgress,"errorBg",br(Q.error.main,.5)),Ke(Q.LinearProgress,"infoBg",br(Q.info.main,.5)),Ke(Q.LinearProgress,"successBg",br(Q.success.main,.5)),Ke(Q.LinearProgress,"warningBg",br(Q.warning.main,.5)),Ke(Q.Skeleton,"bg",`rgba(${st("palette-text-primaryChannel")} / 0.13)`),Ke(Q.Slider,"primaryTrack",br(Q.primary.main,.5)),Ke(Q.Slider,"secondaryTrack",br(Q.secondary.main,.5)),Ke(Q.Slider,"errorTrack",br(Q.error.main,.5)),Ke(Q.Slider,"infoTrack",br(Q.info.main,.5)),Ke(Q.Slider,"successTrack",br(Q.success.main,.5)),Ke(Q.Slider,"warningTrack",br(Q.warning.main,.5));const Et=sm(Q.background.default,.98);Ke(Q.SnackbarContent,"bg",Et),Ke(Q.SnackbarContent,"color",Wl(()=>Q.getContrastText(Et))),Ke(Q.SpeedDialAction,"fabHoverBg",sm(Q.background.paper,.15)),Ke(Q.StepConnector,"border",st("palette-grey-600")),Ke(Q.StepContent,"border",st("palette-grey-600")),Ke(Q.Switch,"defaultColor",st("palette-grey-300")),Ke(Q.Switch,"defaultDisabledColor",st("palette-grey-600")),Ke(Q.Switch,"primaryDisabledColor",br(Q.primary.main,.55)),Ke(Q.Switch,"secondaryDisabledColor",br(Q.secondary.main,.55)),Ke(Q.Switch,"errorDisabledColor",br(Q.error.main,.55)),Ke(Q.Switch,"infoDisabledColor",br(Q.info.main,.55)),Ke(Q.Switch,"successDisabledColor",br(Q.success.main,.55)),Ke(Q.Switch,"warningDisabledColor",br(Q.warning.main,.55)),Ke(Q.TableCell,"border",br(am(Q.divider,1),.68)),Ke(Q.Tooltip,"bg",am(Q.grey[700],.92))}Hc(Q.background,"default"),Hc(Q.background,"paper"),Hc(Q.common,"background"),Hc(Q.common,"onBackground"),Hc(Q,"divider"),Object.keys(Q).forEach(Et=>{const Vt=Q[Et];Et!=="tonalOffset"&&Vt&&typeof Vt=="object"&&(Vt.main&&Ke(Q[Et],"mainChannel",fp(dp(Vt.main))),Vt.light&&Ke(Q[Et],"lightChannel",fp(dp(Vt.light))),Vt.dark&&Ke(Q[Et],"darkChannel",fp(dp(Vt.dark))),Vt.contrastText&&Ke(Q[Et],"contrastTextChannel",fp(dp(Vt.contrastText))),Et==="text"&&(Hc(Q[Et],"primary"),Hc(Q[Et],"secondary")),Et==="action"&&(Vt.active&&Hc(Q[Et],"active"),Vt.selected&&Hc(Q[Et],"selected")))})}),at=S.reduce((lt,Q)=>Zs(lt,Q),at);const Oe={prefix:G,disableCssColorScheme:B,shouldSkipGeneratingVar:z,getSelector:gb(at)},{vars:ut,generateThemeVars:yt,generateStyleSheets:xt}=Zx(at,Oe);return at.vars=ut,Object.entries(at.colorSchemes[at.defaultColorScheme]).forEach(([lt,Q])=>{at[lt]=Q}),at.generateThemeVars=yt,at.generateStyleSheets=xt,at.generateSpacing=function(){return ly(ae.spacing,Pg(this))},at.getColorSchemeSelector=Gx(u),at.spacing=at.generateSpacing(),at.shouldSkipGeneratingVar=z,at.unstable_sxConfig={...Mp,...ae==null?void 0:ae.unstable_sxConfig},at.unstable_sx=function(Q){return nh({sx:Q,theme:this})},at.toRuntimeSource=My,at}function B_(y,S,P){y.colorSchemes&&P&&(y.colorSchemes[S]={...P!==!0&&P,palette:Ug({...P===!0?{}:P.palette,mode:S})})}function Ep(y={},...S){const{palette:P,cssVariables:R=!1,colorSchemes:B=P?void 0:{light:!0},defaultColorScheme:G=P==null?void 0:P.mode,...z}=y,u=G||"light",ce=B==null?void 0:B[u],ae={...B,...P?{[u]:{...typeof ce!="boolean"&&ce,palette:P}}:void 0};if(R===!1){if(!("colorSchemes"in y))return fg(y,...S);let Ce=P;"palette"in y||ae[u]&&(ae[u]!==!0?Ce=ae[u].palette:u==="dark"&&(Ce={mode:"dark"}));const Ee=fg({...y,palette:Ce},...S);return Ee.defaultColorScheme=u,Ee.colorSchemes=ae,Ee.palette.mode==="light"&&(Ee.colorSchemes.light={...ae.light!==!0&&ae.light,palette:Ee.palette},B_(Ee,"dark",ae.dark)),Ee.palette.mode==="dark"&&(Ee.colorSchemes.dark={...ae.dark!==!0&&ae.dark,palette:Ee.palette},B_(Ee,"light",ae.light)),Ee}return!P&&!("light"in ae)&&u==="light"&&(ae.light=!0),xb({...z,colorSchemes:ae,defaultColorScheme:u,...typeof R!="boolean"&&R},...S)}const Ay=Ep();function bb(y){return y!=="ownerState"&&y!=="theme"&&y!=="sx"&&y!=="as"}const wb=y=>bb(y)&&y!=="classes",sh=ax({themeId:Yc,defaultTheme:Ay,rootShouldForwardProp:wb});function O_({theme:y,...S}){const P=Yc in y?y[Yc]:void 0;return Jt.jsx(xy,{...S,themeId:P?Yc:void 0,theme:P||y})}const om={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:Sb}=jx({themeId:Yc,theme:()=>Ep({cssVariables:!0}),colorSchemeStorageKey:om.colorSchemeStorageKey,modeStorageKey:om.modeStorageKey,defaultColorScheme:{light:om.defaultLightColorScheme,dark:om.defaultDarkColorScheme},resolveTheme:y=>{const S={...y,typography:Ty(y.palette,y.typography)};return S.unstable_sx=function(R){return nh({sx:R,theme:this})},S}}),Tb=Sb;function Mb({theme:y,...S}){return typeof y=="function"?Jt.jsx(O_,{theme:y,...S}):"colorSchemes"in(Yc in y?y[Yc]:y)?Jt.jsx(Tb,{theme:y,...S}):Jt.jsx(O_,{theme:y,...S})}function Cb(y){return Jt.jsx(Kv,{...y,defaultTheme:Ay,themeId:Yc})}function zy(y){return function(P){return Jt.jsx(Cb,{styles:typeof y=="function"?R=>y({theme:R,...P}):y})}}const ym=Rx;function Ap(y){return Px(y)}function Eb(y,S){if(y==null)return{};var P={};for(var R in y)if({}.hasOwnProperty.call(y,R)){if(S.indexOf(R)!==-1)continue;P[R]=y[R]}return P}function dg(y,S){return dg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(P,R){return P.__proto__=R,P},dg(y,S)}function Ab(y,S){y.prototype=Object.create(S.prototype),y.prototype.constructor=y,dg(y,S)}const F_=rh.createContext(null);function zb(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function Vg(y,S){var P=function(G){return S&&pt.isValidElement(G)?S(G):G},R=Object.create(null);return y&&pt.Children.map(y,function(B){return B}).forEach(function(B){R[B.key]=P(B)}),R}function Pb(y,S){y=y||{},S=S||{};function P(Ce){return Ce in S?S[Ce]:y[Ce]}var R=Object.create(null),B=[];for(var G in y)G in S?B.length&&(R[G]=B,B=[]):B.push(G);var z,u={};for(var ce in S){if(R[ce])for(z=0;z<R[ce].length;z++){var ae=R[ce][z];u[R[ce][z]]=P(ae)}u[ce]=P(ce)}for(z=0;z<B.length;z++)u[B[z]]=P(B[z]);return u}function nf(y,S,P){return P[S]!=null?P[S]:y.props[S]}function Rb(y,S){return Vg(y.children,function(P){return pt.cloneElement(P,{onExited:S.bind(null,P),in:!0,appear:nf(P,"appear",y),enter:nf(P,"enter",y),exit:nf(P,"exit",y)})})}function Db(y,S,P){var R=Vg(y.children),B=Pb(S,R);return Object.keys(B).forEach(function(G){var z=B[G];if(pt.isValidElement(z)){var u=G in S,ce=G in R,ae=S[G],Ce=pt.isValidElement(ae)&&!ae.props.in;ce&&(!u||Ce)?B[G]=pt.cloneElement(z,{onExited:P.bind(null,z),in:!0,exit:nf(z,"exit",y),enter:nf(z,"enter",y)}):!ce&&u&&!Ce?B[G]=pt.cloneElement(z,{in:!1}):ce&&u&&pt.isValidElement(ae)&&(B[G]=pt.cloneElement(z,{onExited:P.bind(null,z),in:ae.props.in,exit:nf(z,"exit",y),enter:nf(z,"enter",y)}))}}),B}var Ib=Object.values||function(y){return Object.keys(y).map(function(S){return y[S]})},kb={component:"div",childFactory:function(S){return S}},Zg=function(y){Ab(S,y);function S(R,B){var G;G=y.call(this,R,B)||this;var z=G.handleExited.bind(zb(G));return G.state={contextValue:{isMounting:!0},handleExited:z,firstRender:!0},G}var P=S.prototype;return P.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},P.componentWillUnmount=function(){this.mounted=!1},S.getDerivedStateFromProps=function(B,G){var z=G.children,u=G.handleExited,ce=G.firstRender;return{children:ce?Rb(B,u):Db(B,z,u),firstRender:!1}},P.handleExited=function(B,G){var z=Vg(this.props.children);B.key in z||(B.props.onExited&&B.props.onExited(G),this.mounted&&this.setState(function(u){var ce=mm({},u.children);return delete ce[B.key],{children:ce}}))},P.render=function(){var B=this.props,G=B.component,z=B.childFactory,u=Eb(B,["component","childFactory"]),ce=this.state.contextValue,ae=Ib(this.state.children).map(z);return delete u.appear,delete u.enter,delete u.exit,G===null?rh.createElement(F_.Provider,{value:ce},ae):rh.createElement(F_.Provider,{value:ce},rh.createElement(G,u,ae))},S}(rh.Component);Zg.propTypes={};Zg.defaultProps=kb;class vm{constructor(){op(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new vm}static use(){const S=_y(vm.create).current,[P,R]=pt.useState(!1);return S.shouldMount=P,S.setShouldMount=R,pt.useEffect(S.mountEffect,[P]),S}mount(){return this.mounted||(this.mounted=Bb(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...S){this.mount().then(()=>{var P;return(P=this.ref.current)==null?void 0:P.start(...S)})}stop(...S){this.mount().then(()=>{var P;return(P=this.ref.current)==null?void 0:P.stop(...S)})}pulsate(...S){this.mount().then(()=>{var P;return(P=this.ref.current)==null?void 0:P.pulsate(...S)})}}function Lb(){return vm.use()}function Bb(){let y,S;const P=new Promise((R,B)=>{y=R,S=B});return P.resolve=y,P.reject=S,P}function Ob(y){const{className:S,classes:P,pulsate:R=!1,rippleX:B,rippleY:G,rippleSize:z,in:u,onExited:ce,timeout:ae}=y,[Ce,Ee]=pt.useState(!1),be=Ns(S,P.ripple,P.rippleVisible,R&&P.ripplePulsate),oe={width:z,height:z,top:-(z/2)+G,left:-(z/2)+B},we=Ns(P.child,Ce&&P.childLeaving,R&&P.childPulsate);return!u&&!Ce&&Ee(!0),pt.useEffect(()=>{if(!u&&ce!=null){const ze=setTimeout(ce,ae);return()=>{clearTimeout(ze)}}},[ce,u,ae]),Jt.jsx("span",{className:be,style:oe,children:Jt.jsx("span",{className:we})})}const wo=Cp("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),pg=550,Fb=80,jb=wp`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,Nb=wp`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,Ub=wp`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,Vb=sh("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Zb=sh(Ob,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${wo.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${jb};
    animation-duration: ${pg}ms;
    animation-timing-function: ${({theme:y})=>y.transitions.easing.easeInOut};
  }

  &.${wo.ripplePulsate} {
    animation-duration: ${({theme:y})=>y.transitions.duration.shorter}ms;
  }

  & .${wo.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${wo.childLeaving} {
    opacity: 0;
    animation-name: ${Nb};
    animation-duration: ${pg}ms;
    animation-timing-function: ${({theme:y})=>y.transitions.easing.easeInOut};
  }

  & .${wo.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${Ub};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:y})=>y.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,Gb=pt.forwardRef(function(S,P){const R=Ap({props:S,name:"MuiTouchRipple"}),{center:B=!1,classes:G={},className:z,...u}=R,[ce,ae]=pt.useState([]),Ce=pt.useRef(0),Ee=pt.useRef(null);pt.useEffect(()=>{Ee.current&&(Ee.current(),Ee.current=null)},[ce]);const be=pt.useRef(!1),oe=bx(),we=pt.useRef(null),ze=pt.useRef(null),dt=pt.useCallback(at=>{const{pulsate:Oe,rippleX:ut,rippleY:yt,rippleSize:xt,cb:lt}=at;ae(Q=>[...Q,Jt.jsx(Zb,{classes:{ripple:Ns(G.ripple,wo.ripple),rippleVisible:Ns(G.rippleVisible,wo.rippleVisible),ripplePulsate:Ns(G.ripplePulsate,wo.ripplePulsate),child:Ns(G.child,wo.child),childLeaving:Ns(G.childLeaving,wo.childLeaving),childPulsate:Ns(G.childPulsate,wo.childPulsate)},timeout:pg,pulsate:Oe,rippleX:ut,rippleY:yt,rippleSize:xt},Ce.current)]),Ce.current+=1,Ee.current=lt},[G]),gt=pt.useCallback((at={},Oe={},ut=()=>{})=>{const{pulsate:yt=!1,center:xt=B||Oe.pulsate,fakeElement:lt=!1}=Oe;if((at==null?void 0:at.type)==="mousedown"&&be.current){be.current=!1;return}(at==null?void 0:at.type)==="touchstart"&&(be.current=!0);const Q=lt?null:ze.current,st=Q?Q.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Et,Vt,ei;if(xt||at===void 0||at.clientX===0&&at.clientY===0||!at.clientX&&!at.touches)Et=Math.round(st.width/2),Vt=Math.round(st.height/2);else{const{clientX:di,clientY:Je}=at.touches&&at.touches.length>0?at.touches[0]:at;Et=Math.round(di-st.left),Vt=Math.round(Je-st.top)}if(xt)ei=Math.sqrt((2*st.width**2+st.height**2)/3),ei%2===0&&(ei+=1);else{const di=Math.max(Math.abs((Q?Q.clientWidth:0)-Et),Et)*2+2,Je=Math.max(Math.abs((Q?Q.clientHeight:0)-Vt),Vt)*2+2;ei=Math.sqrt(di**2+Je**2)}at!=null&&at.touches?we.current===null&&(we.current=()=>{dt({pulsate:yt,rippleX:Et,rippleY:Vt,rippleSize:ei,cb:ut})},oe.start(Fb,()=>{we.current&&(we.current(),we.current=null)})):dt({pulsate:yt,rippleX:Et,rippleY:Vt,rippleSize:ei,cb:ut})},[B,dt,oe]),St=pt.useCallback(()=>{gt({},{pulsate:!0})},[gt]),vt=pt.useCallback((at,Oe)=>{if(oe.clear(),(at==null?void 0:at.type)==="touchend"&&we.current){we.current(),we.current=null,oe.start(0,()=>{vt(at,Oe)});return}we.current=null,ae(ut=>ut.length>0?ut.slice(1):ut),Ee.current=Oe},[oe]);return pt.useImperativeHandle(P,()=>({pulsate:St,start:gt,stop:vt}),[St,gt,vt]),Jt.jsx(Vb,{className:Ns(wo.root,G.root,z),ref:ze,...u,children:Jt.jsx(Zg,{component:null,exit:!0,children:ce})})});function $b(y){return Pm("MuiButtonBase",y)}const qb=Cp("MuiButtonBase",["root","disabled","focusVisible"]),Hb=y=>{const{disabled:S,focusVisible:P,focusVisibleClassName:R,classes:B}=y,z=Og({root:["root",S&&"disabled",P&&"focusVisible"]},$b,B);return P&&R&&(z.root+=` ${R}`),z},Xb=sh("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(y,S)=>S.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${qb.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Yb=pt.forwardRef(function(S,P){const R=Ap({props:S,name:"MuiButtonBase"}),{action:B,centerRipple:G=!1,children:z,className:u,component:ce="button",disabled:ae=!1,disableRipple:Ce=!1,disableTouchRipple:Ee=!1,focusRipple:be=!1,focusVisibleClassName:oe,LinkComponent:we="a",onBlur:ze,onClick:dt,onContextMenu:gt,onDragLeave:St,onFocus:vt,onFocusVisible:at,onKeyDown:Oe,onKeyUp:ut,onMouseDown:yt,onMouseLeave:xt,onMouseUp:lt,onTouchEnd:Q,onTouchMove:st,onTouchStart:Et,tabIndex:Vt=0,TouchRippleProps:ei,touchRippleRef:di,type:Je,...Zt}=R,kt=pt.useRef(null),Wt=Lb(),ve=S_(Wt.ref,di),[rt,At]=pt.useState(!1);ae&&rt&&At(!1),pt.useImperativeHandle(B,()=>({focusVisible:()=>{At(!0),kt.current.focus()}}),[]);const Lt=Wt.shouldMount&&!Ce&&!ae;pt.useEffect(()=>{rt&&be&&!Ce&&Wt.pulsate()},[Ce,be,rt,Wt]);const wt=Xc(Wt,"start",yt,Ee),Xt=Xc(Wt,"stop",gt,Ee),Yt=Xc(Wt,"stop",St,Ee),Xi=Xc(Wt,"stop",lt,Ee),hi=Xc(Wt,"stop",ti=>{rt&&ti.preventDefault(),xt&&xt(ti)},Ee),vi=Xc(Wt,"start",Et,Ee),Ci=Xc(Wt,"stop",Q,Ee),Ai=Xc(Wt,"stop",st,Ee),Bi=Xc(Wt,"stop",ti=>{M_(ti.target)||At(!1),ze&&ze(ti)},!1),zr=dm(ti=>{kt.current||(kt.current=ti.currentTarget),M_(ti.target)&&(At(!0),at&&at(ti)),vt&&vt(ti)}),Ei=()=>{const ti=kt.current;return ce&&ce!=="button"&&!(ti.tagName==="A"&&ti.href)},qn=dm(ti=>{be&&!ti.repeat&&rt&&ti.key===" "&&Wt.stop(ti,()=>{Wt.start(ti)}),ti.target===ti.currentTarget&&Ei()&&ti.key===" "&&ti.preventDefault(),Oe&&Oe(ti),ti.target===ti.currentTarget&&Ei()&&ti.key==="Enter"&&!ae&&(ti.preventDefault(),dt&&dt(ti))}),yn=dm(ti=>{be&&ti.key===" "&&rt&&!ti.defaultPrevented&&Wt.stop(ti,()=>{Wt.pulsate(ti)}),ut&&ut(ti),dt&&ti.target===ti.currentTarget&&Ei()&&ti.key===" "&&!ti.defaultPrevented&&dt(ti)});let Sr=ce;Sr==="button"&&(Zt.href||Zt.to)&&(Sr=we);const zi={};Sr==="button"?(zi.type=Je===void 0?"button":Je,zi.disabled=ae):(!Zt.href&&!Zt.to&&(zi.role="button"),ae&&(zi["aria-disabled"]=ae));const nn=S_(P,kt),Pr={...R,centerRipple:G,component:ce,disabled:ae,disableRipple:Ce,disableTouchRipple:Ee,focusRipple:be,tabIndex:Vt,focusVisible:rt},vn=Hb(Pr);return Jt.jsxs(Xb,{as:Sr,className:Ns(vn.root,u),ownerState:Pr,onBlur:Bi,onClick:dt,onContextMenu:Xt,onFocus:zr,onKeyDown:qn,onKeyUp:yn,onMouseDown:wt,onMouseLeave:hi,onMouseUp:Xi,onDragLeave:Yt,onTouchEnd:Ci,onTouchMove:Ai,onTouchStart:vi,ref:nn,tabIndex:ae?-1:Vt,type:Je,...zi,...Zt,children:[z,Lt?Jt.jsx(Gb,{ref:ve,center:G,...ei}):null]})});function Xc(y,S,P,R=!1){return dm(B=>(P&&P(B),R||y[S](B),!0))}function Kb(y){return typeof y.main=="string"}function Wb(y,S=[]){if(!Kb(y))return!1;for(const P of S)if(!y.hasOwnProperty(P)||typeof y[P]!="string")return!1;return!0}function mg(y=[]){return([,S])=>S&&Wb(S,y)}function Qb(y){return Pm("MuiCircularProgress",y)}Cp("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const ih=44,gg=wp`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,_g=wp`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,Jb=typeof gg!="string"?Eg`
        animation: ${gg} 1.4s linear infinite;
      `:null,e1=typeof _g!="string"?Eg`
        animation: ${_g} 1.4s ease-in-out infinite;
      `:null,t1=y=>{const{classes:S,variant:P,color:R,disableShrink:B}=y,G={root:["root",P,`color${To(R)}`],svg:["svg"],circle:["circle",`circle${To(P)}`,B&&"circleDisableShrink"]};return Og(G,Qb,S)},i1=sh("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(y,S)=>{const{ownerState:P}=y;return[S.root,S[P.variant],S[`color${To(P.color)}`]]}})(ym(({theme:y})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:y.transitions.create("transform")}},{props:{variant:"indeterminate"},style:Jb||{animation:`${gg} 1.4s linear infinite`}},...Object.entries(y.palette).filter(mg()).map(([S])=>({props:{color:S},style:{color:(y.vars||y).palette[S].main}}))]}))),r1=sh("svg",{name:"MuiCircularProgress",slot:"Svg",overridesResolver:(y,S)=>S.svg})({display:"block"}),n1=sh("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(y,S)=>{const{ownerState:P}=y;return[S.circle,S[`circle${To(P.variant)}`],P.disableShrink&&S.circleDisableShrink]}})(ym(({theme:y})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:y.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:S})=>S.variant==="indeterminate"&&!S.disableShrink,style:e1||{animation:`${_g} 1.4s ease-in-out infinite`}}]}))),a1=pt.forwardRef(function(S,P){const R=Ap({props:S,name:"MuiCircularProgress"}),{className:B,color:G="primary",disableShrink:z=!1,size:u=40,style:ce,thickness:ae=3.6,value:Ce=0,variant:Ee="indeterminate",...be}=R,oe={...R,color:G,disableShrink:z,size:u,thickness:ae,value:Ce,variant:Ee},we=t1(oe),ze={},dt={},gt={};if(Ee==="determinate"){const St=2*Math.PI*((ih-ae)/2);ze.strokeDasharray=St.toFixed(3),gt["aria-valuenow"]=Math.round(Ce),ze.strokeDashoffset=`${((100-Ce)/100*St).toFixed(3)}px`,dt.transform="rotate(-90deg)"}return Jt.jsx(i1,{className:Ns(we.root,B),style:{width:u,height:u,...dt,...ce},ownerState:oe,ref:P,role:"progressbar",...gt,...be,children:Jt.jsx(r1,{className:we.svg,ownerState:oe,viewBox:`${ih/2} ${ih/2} ${ih} ${ih}`,children:Jt.jsx(n1,{className:we.circle,style:ze,ownerState:oe,cx:ih,cy:ih,r:(ih-ae)/2,fill:"none",strokeWidth:ae})})})});function s1(y){return Pm("MuiIconButton",y)}const j_=Cp("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),o1=y=>{const{classes:S,disabled:P,color:R,edge:B,size:G,loading:z}=y,u={root:["root",z&&"loading",P&&"disabled",R!=="default"&&`color${To(R)}`,B&&`edge${To(B)}`,`size${To(G)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Og(u,s1,S)},l1=sh(Yb,{name:"MuiIconButton",slot:"Root",overridesResolver:(y,S)=>{const{ownerState:P}=y;return[S.root,P.loading&&S.loading,P.color!=="default"&&S[`color${To(P.color)}`],P.edge&&S[`edge${To(P.edge)}`],S[`size${To(P.size)}`]]}})(ym(({theme:y})=>({textAlign:"center",flex:"0 0 auto",fontSize:y.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(y.vars||y).palette.action.active,transition:y.transitions.create("background-color",{duration:y.transitions.duration.shortest}),variants:[{props:S=>!S.disableRipple,style:{"--IconButton-hoverBg":y.vars?`rgba(${y.vars.palette.action.activeChannel} / ${y.vars.palette.action.hoverOpacity})`:hg(y.palette.action.active,y.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),ym(({theme:y})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(y.palette).filter(mg()).map(([S])=>({props:{color:S},style:{color:(y.vars||y).palette[S].main}})),...Object.entries(y.palette).filter(mg()).map(([S])=>({props:{color:S},style:{"--IconButton-hoverBg":y.vars?`rgba(${(y.vars||y).palette[S].mainChannel} / ${y.vars.palette.action.hoverOpacity})`:hg((y.vars||y).palette[S].main,y.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:y.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:y.typography.pxToRem(28)}}],[`&.${j_.disabled}`]:{backgroundColor:"transparent",color:(y.vars||y).palette.action.disabled},[`&.${j_.loading}`]:{color:"transparent"}}))),c1=sh("span",{name:"MuiIconButton",slot:"LoadingIndicator",overridesResolver:(y,S)=>S.loadingIndicator})(({theme:y})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(y.vars||y).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),u1=pt.forwardRef(function(S,P){const R=Ap({props:S,name:"MuiIconButton"}),{edge:B=!1,children:G,className:z,color:u="default",disabled:ce=!1,disableFocusRipple:ae=!1,size:Ce="medium",id:Ee,loading:be=null,loadingIndicator:oe,...we}=R,ze=yx(Ee),dt=oe??Jt.jsx(a1,{"aria-labelledby":ze,color:"inherit",size:16}),gt={...R,edge:B,color:u,disabled:ce,disableFocusRipple:ae,loading:be,loadingIndicator:dt,size:Ce},St=o1(gt);return Jt.jsxs(l1,{id:be?ze:Ee,className:Ns(St.root,z),centerRipple:!0,focusRipple:!ae,disabled:ce||be,ref:P,...we,ownerState:gt,children:[typeof be=="boolean"&&Jt.jsx("span",{className:St.loadingWrapper,style:{display:"contents"},children:Jt.jsx(c1,{className:St.loadingIndicator,ownerState:gt,children:be&&dt})}),G]})}),h1=Cp("MuiBox",["root"]),f1=Ep(),d1=ex({themeId:Yc,defaultTheme:f1,defaultClassName:h1.root,generateClassName:hy.generate}),yg=typeof zy({})=="function",p1=(y,S)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...S&&!y.vars&&{colorScheme:y.palette.mode}}),m1=y=>({color:(y.vars||y).palette.text.primary,...y.typography.body1,backgroundColor:(y.vars||y).palette.background.default,"@media print":{backgroundColor:(y.vars||y).palette.common.white}}),Py=(y,S=!1)=>{var G,z;const P={};S&&y.colorSchemes&&typeof y.getColorSchemeSelector=="function"&&Object.entries(y.colorSchemes).forEach(([u,ce])=>{var Ce,Ee;const ae=y.getColorSchemeSelector(u);ae.startsWith("@")?P[ae]={":root":{colorScheme:(Ce=ce.palette)==null?void 0:Ce.mode}}:P[ae.replace(/\s*&/,"")]={colorScheme:(Ee=ce.palette)==null?void 0:Ee.mode}});let R={html:p1(y,S),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:y.typography.fontWeightBold},body:{margin:0,...m1(y),"&::backdrop":{backgroundColor:(y.vars||y).palette.background.default}},...P};const B=(z=(G=y.components)==null?void 0:G.MuiCssBaseline)==null?void 0:z.styleOverrides;return B&&(R=[R,B]),R},pm="mui-ecs",g1=y=>{const S=Py(y,!1),P=Array.isArray(S)?S[0]:S;return!y.vars&&P&&(P.html[`:root:has(${pm})`]={colorScheme:y.palette.mode}),y.colorSchemes&&Object.entries(y.colorSchemes).forEach(([R,B])=>{var z,u;const G=y.getColorSchemeSelector(R);G.startsWith("@")?P[G]={[`:root:not(:has(.${pm}))`]:{colorScheme:(z=B.palette)==null?void 0:z.mode}}:P[G.replace(/\s*&/,"")]={[`&:not(:has(.${pm}))`]:{colorScheme:(u=B.palette)==null?void 0:u.mode}}}),S},_1=zy(yg?({theme:y,enableColorScheme:S})=>Py(y,S):({theme:y})=>g1(y));function y1(y){const S=Ap({props:y,name:"MuiCssBaseline"}),{children:P,enableColorScheme:R=!1}=S;return Jt.jsxs(pt.Fragment,{children:[yg&&Jt.jsx(_1,{enableColorScheme:R}),!yg&&!R&&Jt.jsx("span",{className:pm,style:{display:"none"}}),P]})}const Ry="MgzBbNp1YWKC1XOuP7AN",v1=localStorage.getItem("theme")||"light";let Dy=`https://api.maptiler.com/maps/streets-v2/style.json?key=${Ry}`;v1==="dark"&&(Dy=`https://api.maptiler.com/maps/streets-v2-dark/style.json?key=${Ry}`);const x1=Dy,N_=y=>{let S;const P=new Set,R=(ae,Ce)=>{const Ee=typeof ae=="function"?ae(S):ae;if(!Object.is(Ee,S)){const be=S;S=Ce??(typeof Ee!="object"||Ee===null)?Ee:Object.assign({},S,Ee),P.forEach(oe=>oe(S,be))}},B=()=>S,u={setState:R,getState:B,getInitialState:()=>ce,subscribe:ae=>(P.add(ae),()=>P.delete(ae))},ce=S=y(R,B,u);return u},b1=y=>y?N_(y):N_,w1=y=>y;function S1(y,S=w1){const P=rh.useSyncExternalStore(y.subscribe,()=>S(y.getState()),()=>S(y.getInitialState()));return rh.useDebugValue(P),P}const U_=y=>{const S=b1(y),P=R=>S1(S,R);return Object.assign(P,S),P},T1=y=>y?U_(y):U_,M1=T1(y=>({map:null,setMap:S=>y({map:S})}));function C1(){const y=pt.useRef(null),{map:S,setMap:P}=M1();return pt.useEffect(()=>{if(S||!y.current)return;const R=new Yy.Map({container:y.current,style:x1,center:[78,21],zoom:4,attributionControl:!1});return P(R),()=>{P(null),y.current=null}},[S,P]),Jt.jsx(Jt.Fragment,{children:Jt.jsx(d1,{ref:y,sx:{height:"10px",width:"100vw",overflow:"hidden"}})})}const E1=()=>Jt.jsx(C1,{}),V_=({iconName:y})=>{switch(y){case"light":return Jt.jsx("svg",{width:"25x",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Jt.jsx("path",{d:"M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z",stroke:"#000000",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})});case"dark":return Jt.jsxs("svg",{width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[Jt.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M18 2.75C17.5858 2.75 17.25 2.41421 17.25 2C17.25 1.58579 17.5858 1.25 18 1.25H22C22.3034 1.25 22.5768 1.43273 22.6929 1.71299C22.809 1.99324 22.7449 2.31583 22.5304 2.53033L19.8107 5.25H22C22.4142 5.25 22.75 5.58579 22.75 6C22.75 6.41421 22.4142 6.75 22 6.75H18C17.6967 6.75 17.4232 6.56727 17.3071 6.28701C17.191 6.00676 17.2552 5.68417 17.4697 5.46967L20.1894 2.75H18ZM13.5 8.75C13.0858 8.75 12.75 8.41421 12.75 8C12.75 7.58579 13.0858 7.25 13.5 7.25H16.5C16.8034 7.25 17.0768 7.43273 17.1929 7.71299C17.309 7.99324 17.2449 8.31583 17.0304 8.53033L15.3107 10.25H16.5C16.9142 10.25 17.25 10.5858 17.25 11C17.25 11.4142 16.9142 11.75 16.5 11.75H13.5C13.1967 11.75 12.9232 11.5673 12.8071 11.287C12.691 11.0068 12.7552 10.6842 12.9697 10.4697L14.6894 8.75H13.5Z",fill:"#1C274C"}),Jt.jsx("path",{opacity:"0.5",d:"M12 22C17.5228 22 22 17.5228 22 12C22 11.5373 21.3065 11.4608 21.0672 11.8568C19.9289 13.7406 17.8615 15 15.5 15C11.9101 15 9 12.0899 9 8.5C9 6.13845 10.2594 4.07105 12.1432 2.93276C12.5392 2.69347 12.4627 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",fill:"#1C274C"})]});default:return Jt.jsx(Jt.Fragment,{})}},A1=Ep({palette:{mode:"light",primary:{main:"#3498db",light:"#85c1e9",dark:"#21618c",contrastText:"#ffffff"},secondary:{main:"#f39c12",light:"#f7c266",dark:"#b57e1d",contrastText:"#ffffff"},background:{default:"#f8f9fa",paper:"#ffffff"},text:{primary:"#333333",secondary:"#555555"}},typography:{fontFamily:"Inter, Arial, sans-serif"}}),z1=Ep({palette:{mode:"dark",primary:{main:"#1abc9c",light:"#48c9b0",dark:"#16a085",contrastText:"#ffffff"},secondary:{main:"#e74c3c",light:"#ec7063",dark:"#943126",contrastText:"#ffffff"},background:{default:"#121212",paper:"#1e1e1e"},text:{primary:"#ffffff",secondary:"#b3b3b3"}}});function P1(){const y=localStorage.getItem("theme")||"light",[S,P]=pt.useState(y);pt.useEffect(()=>{localStorage.setItem("theme",S)},[S]);const R=()=>{P(B=>B==="light"?"dark":"light")};return Jt.jsxs(Mb,{theme:S==="light"?A1:z1,children:[Jt.jsx(y1,{}),Jt.jsx(u1,{onClick:R,sx:{position:"absolute",top:10,right:10},children:S==="light"?Jt.jsx(V_,{iconName:"dark"}):Jt.jsx(V_,{iconName:"light"})}),Jt.jsx(E1,{})]})}qy.createRoot(document.getElementById("root")).render(Jt.jsx(pt.StrictMode,{children:Jt.jsx(P1,{})}));
